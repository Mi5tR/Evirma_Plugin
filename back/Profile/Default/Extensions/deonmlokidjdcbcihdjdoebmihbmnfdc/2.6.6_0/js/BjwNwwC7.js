var mv=Object.defineProperty;var pv=(e,t,s)=>t in e?mv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var Aa=(e,t,s)=>pv(e,typeof t!="symbol"?t+"":t,s);import{d as R,u as hv,l as fv,i as gv,c as yv,e as wv,f as Xg,g as u,h as Sv,s as xv,j as bv,k as _,m as $,r as Ae,n as I,t as N,o as F,p as S,q as vv,v as jv,w as n,x as P,R as m,b as Cv,M as $v,y as kv,C as Nv,z as fa,A as ey,B as ne,T as Tv,F as Pv,D as Mv,E as il,G as ls,H as fn,I as Co,J as Fv,K as ty,L as Dv,N as Av,O as ro,P as Lv,Q as rn,S as Ts,U as Rv,V as sy,W as au,X as Se,Y as Ev,Z as _v}from"./DSGbj4hz.js";import{a as ll,b as Iv,i as Ov,d as Vv,e as qv,f as Bv,s as ny,u as Wv,h as oy,l as Vi}from"./DE3akDVi.js";import{g as W,r as cs,a as Nr,R as zv,E as io,b as Ws,c as Ue,S as Qe,p as Ft,d as ay,A as Dt}from"./D8j6JjnZ.js";import{g as ry,a as iy,F as f,L as bt,A as ga,b as dt,B as A,I as z,c as As,d as Te,s as Gv}from"./BlUKqefZ.js";import{g as Kv,S as Hv,B as Uv,m as Qv,d as Yv,c as Jv}from"./BdjLkPll.js";import"./BsPQu0W_.js";import{r as Yt,a as Jt,R as Tr,S as ra,A as ds,v as Zv,b as Xv,u as ej,c as tj,d as sj,e as nj,f as oj,g as aj,h as rj,i as ij,j as lj,k as cj,H as nr,N as ru,V as dj,T as uj,l as Tn,m as lo,n as ly,o as iu,s as cy,p as ya,q as lu,t as mj,w as $o,x as dy,y as uy}from"./DetAIFwH.js";import{a as cu}from"./CzfjByzk.js";import{M as pj,C as hj,a as fj,F as gj,b as yj,R as wj,c as Sj,S as xj,d as bj,e as vj,f as jj,E as Cj,g as $j,G as kj,A as Nj}from"./49OujIyA.js";import{u as Yo,w as Tj,r as Pj}from"./C--LeXQ3.js";import{l as Em}from"./FSs5A10t.js";import"./CQx-Q2Z_.js";import"./CwuAAFsv.js";import"./DztEdZpe.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0150861e-b8fe-4eef-89c1-6f1efa7783e5",e._sentryDebugIdIdentifier="sentry-dbid-0150861e-b8fe-4eef-89c1-6f1efa7783e5")}catch{}})();const du=e=>t=>{const s=o=>{if(typeof e.key=="function"?e.key(o.item.key):o.item.key===e.key){const r=e.parser?e.parser(o.item.value):o.item.value;return t(r),!0}return!1};return Em.on(s),()=>Em.removeListener(s)};function Mj(){R.extend(hv),R.extend(fv),R.extend(gv),R.extend(yv),R.locale("ru")}const Q=e=>t=>wv(`${e}/${t}`),k=e=>t=>t?`${e}/${t}`:e,D=e=>(t,{payload:s})=>{t[e]=s},fd=e=>(t,{payload:s})=>{t[e]||(t[e]=[]),t[e]=[...t[e],...s]},my=e=>(t,{payload:s})=>{e.forEach(o=>{t[o]=s[o]})},Je=e=>(t,{payload:s})=>{t[e]||(t[e]={}),t[e]={...t[e],...s}},wt=e=>(t,{payload:s})=>{t[e]||(t[e]={}),t[e][s.key]=s.value},Le=(e,t)=>s=>{s[e]=t},Fj=e=>(t,{payload:s})=>{t[e]?Object.keys(s||{}).forEach(o=>{t[e][o]?t[e][o]=[...t[e][o],...s[o]||[]]:t[e][o]=s[o]}):t[e]=s};function cl(e,t){const s=o=>o[e];return t?t.selector(s):s}function V(e,t){return(s,o)=>{const a=r=>{var l;const i=(l=r[e])==null?void 0:l[s];return o!==void 0?i??o:i};return t?t.selector(a):a}}function b(e){return()=>Xg(e)}function te(e){return t=>Xg(s=>e(s,t))}const M=e=>function*({payload:s}){return yield u(e,s)};function T(e,t){let s=e;return t.reverse().forEach(o=>{s=o(s)}),s}const zt=e=>function*({callback:s,...o}){const a=yield u(e,o);return s&&s(),a},wa={array:[],object:{}},_m=k("feedback"),co={modelName:_m(),loading:{send:_m("send")},validation:{message:{length:50}}},E=Sv({}).withLazyLoadedSlices(),py=[],Im="regexp:";function Dj(e){return Object.keys(e).reduce((t,s)=>{const o=e[s];switch(typeof o){case"string":{t[s]=o.startsWith(Im)?RegExp(o.substring(Im.length)):o;break}default:t[s]=o}return t},{})}function Aj(e){e.forEach(({disable:t,...s})=>{t||py.push(Dj(s))})}function La(e,t){return t?typeof t=="string"?e===t:t.test(e):!0}function Lj(e,t,s){const o=py.find(a=>{const r=La(e.name,a.name),i="data"in e&&e.data.message?La(e.data.message,a.message):La(e.message,a.message),l=La(s||"",a.saga),c=La(t||"",a.client);return r&&i&&l&&c});return o?o.allow:!0}const Rj=Kv().filter(e=>!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(e.name)),on=new Hv,hy=new Uv({release:W.release,dsn:"https://f10d3e7bf312f170b06fb79afd5b8b0a@o4508761895862272.ingest.de.sentry.io/4508766067425360",transport:Qv,stackParser:Yv,autoSessionTracking:!1,normalizeDepth:10,integrations:Rj,beforeSend:async(e,t)=>{var i;on.setLastEventId(e.event_id);const s=t.originalException,o=(i=e.tags)==null?void 0:i["saga-action"],a=await ry(),r=await iy();return Lj(s,a,o)?(e.tags={...e.tags,release:W.release,clientId:a,clientSessionId:r},e):null}});on.setClient(hy);hy.init();class Sa extends Error{constructor(s,{cause:o,attachments:a,extras:r}){super(s,{cause:o});Aa(this,"attachments");Aa(this,"extras");this.name="Error",this.attachments=a,this.extras=r,Object.setPrototypeOf(this,Sa.prototype)}}function Zs(e,t){let s=Math.abs(e);return s%=100,s>=5&&s<=20?t[2]:(s%=10,s===1?t[0]:s>=2&&s<=4?t[1]:t[2])}const{locale:Bn}=W,v={dateShort:e=>e?(e instanceof Date?e:new Date(e)).toLocaleDateString(Bn,{day:"2-digit",month:"short",year:void 0}):"",date:e=>{if(!e)return"";const t=new Date(e),s=t.toLocaleDateString(),o=t.toLocaleDateString(Bn,{weekday:"short"});return`${s} / ${o}`},dateClean:e=>e?new Date(e).toLocaleDateString(Bn):"",dateFull:e=>e?new Date(e).toLocaleDateString(Bn,{day:"numeric",month:"short",year:"2-digit"}):"",month:e=>e?(e instanceof Date?e:new Date(e)).toLocaleDateString(Bn,{month:"long"}):"",hours:e=>e?e.toLocaleString(Bn)+" —á.":"",quantity:e=>typeof e=="number"?e.toLocaleString(Bn)+" —à—Ç.":"",numeric:(e,t={})=>{const{zero:s=!0,zeroFraction:o=!1,fraction:a}=t;return e==null||e===0&&!s?"":e.toLocaleString(void 0,{minimumFractionDigits:e===0&&!o?0:a,maximumFractionDigits:a})},currency:(e,t={})=>{const{zero:s=!0,zeroFraction:o=!1,fraction:a}=t;return e==null||e===0&&!s?"":e.toLocaleString(void 0,{style:"currency",currency:"RUB",minimumFractionDigits:e===0&&!o?0:a,maximumFractionDigits:a})},percent:(e,t={})=>{const{zero:s=!0,zeroFraction:o=!1,fraction:a}=t;return e==null||e===0&&!s?"":e.toLocaleString(void 0,{minimumFractionDigits:e===0&&!o?0:a,maximumFractionDigits:a})+"%"}},Ej={"-":" ",_:" ","&lt;":"","&gt;":"","&#039;":"","&amp;":"","&quot;":"",√Ä:"A",√Å:"A",√Ç:"A",√É:"A",√Ñ:"Ae","&Auml;":"A",√Ö:"A",ƒÄ:"A",ƒÑ:"A",ƒÇ:"A",√Ü:"Ae",√á:"C",ƒÜ:"C",ƒå:"C",ƒà:"C",ƒä:"C",ƒé:"D",ƒê:"D",√ê:"D",√à:"E",√â:"E",√ä:"E",√ã:"E",ƒí:"E",ƒò:"E",ƒö:"E",ƒî:"E",ƒñ:"E",ƒú:"G",ƒû:"G",ƒ†:"G",ƒ¢:"G",ƒ§:"H",ƒ¶:"H",√å:"I",√ç:"I",√é:"I",√è:"I",ƒ™:"I",ƒ®:"I",ƒ¨:"I",ƒÆ:"I",ƒ∞:"I",ƒ≤:"IJ",ƒ¥:"J",ƒ∂:"K",≈Å:"K",ƒΩ:"K",ƒπ:"K",ƒª:"K",ƒø:"K",√ë:"N",≈É:"N",≈á:"N",≈Ö:"N",≈ä:"N",√í:"O",√ì:"O",√î:"O",√ï:"O",√ñ:"Oe","&Ouml;":"Oe",√ò:"O",≈å:"O",≈ê:"O",≈é:"O",≈í:"OE",≈î:"R",≈ò:"R",≈ñ:"R",≈ö:"S",≈†:"S",≈û:"S",≈ú:"S",»ò:"S",≈§:"T",≈¢:"T",≈¶:"T",»ö:"T",√ô:"U",√ö:"U",√õ:"U",√ú:"Ue",≈™:"U","&Uuml;":"Ue",≈Æ:"U",≈∞:"U",≈¨:"U",≈®:"U",≈≤:"U",≈¥:"W",√ù:"Y",≈∂:"Y",≈∏:"Y",≈π:"Z",≈Ω:"Z",≈ª:"Z",√û:"T",√†:"a",√°:"a",√¢:"a",√£:"a",√§:"ae","&auml;":"ae",√•:"a",ƒÅ:"a",ƒÖ:"a",ƒÉ:"a",√¶:"ae",√ß:"c",ƒá:"c",ƒç:"c",ƒâ:"c",ƒã:"c",ƒè:"d",ƒë:"d",√∞:"d",√®:"e",√©:"e",√™:"e",√´:"e",ƒì:"e",ƒô:"e",ƒõ:"e",ƒï:"e",ƒó:"e",∆í:"f",ƒù:"g",ƒü:"g",ƒ°:"g",ƒ£:"g",ƒ•:"h",ƒß:"h",√¨:"i",√≠:"i",√Æ:"i",√Ø:"i",ƒ´:"i",ƒ©:"i",ƒ≠:"i",ƒØ:"i",ƒ±:"i",ƒ≥:"ij",ƒµ:"j",ƒ∑:"k",ƒ∏:"k",≈Ç:"l",ƒæ:"l",ƒ∫:"l",ƒº:"l",≈Ä:"l",√±:"n",≈Ñ:"n",≈à:"n",≈Ü:"n",≈â:"n",≈ã:"n",√≤:"o",√≥:"o",√¥:"o",√µ:"o",√∂:"oe","&ouml;":"oe",√∏:"o",≈ç:"o",≈ë:"o",≈è:"o",≈ì:"oe",≈ï:"r",≈ô:"r",≈ó:"r",≈°:"s",√π:"u",√∫:"u",√ª:"u",√º:"ue",≈´:"u","&uuml;":"ue",≈Ø:"u",≈±:"u",≈≠:"u",≈©:"u",≈≥:"u",≈µ:"w",√Ω:"y",√ø:"y",≈∑:"y",≈æ:"z",≈º:"z",≈∫:"z",√æ:"t",√ü:"ss",≈ø:"ss",—ã–π:"iy",–ê:"A",–ë:"B",–í:"V",–ì:"G",–î:"D",–ï:"E",–Å:"YO",–ñ:"ZH",–ó:"Z",–ò:"I",–ô:"Y",–ö:"K",–õ:"L",–ú:"M",–ù:"N",–û:"O",–ü:"P",–†:"R",–°:"S",–¢:"T",–£:"U",–§:"F",–•:"H",–¶:"C",–ß:"CH",–®:"SH",–©:"SCH",–™:"",–´:"Y",–¨:"",–≠:"E",–Æ:"YU",–Ø:"YA",–∞:"a",–±:"b",–≤:"v",–≥:"g",–¥:"d",–µ:"e",—ë:"yo",–∂:"zh",–∑:"z",–∏:"i",–π:"y",–∫:"k",–ª:"l",–º:"m",–Ω:"n",–æ:"o",–ø:"p",—Ä:"r",—Å:"s",—Ç:"t",—É:"u",—Ñ:"f",—Ö:"h",—Ü:"c",—á:"ch",—à:"sh",—â:"sch",—ä:"",—ã:"y",—å:"",—ç:"e",—é:"yu",—è:"ya"};function Ra(e){if(!e)return"";let t=e.split("").map(s=>Ej[s]||s).join("");return t=t.replace(/[^a-zA-Z0-9\s]/g,""),t.replace(/\s+/g,"_").trim()}function fy(e){if(!e)return;const t=e.replace(/\+/g,"%20");try{return decodeURIComponent(t)}catch{return decodeURIComponent(t.replace(/%(?![0-9A-Fa-f]{2})/g,"%25"))}}async function Re(e){const{background:t=!0,rawResponse:s,...o}=e,a=new Headers(o.headers);try{const{data:r}=await Yt({responseType:"json",...o,basePath:"https://evirma.ru/api",headers:a,adapter:i=>t?cs(i):Nr(i)});return s?r:r.result||r.data}catch(r){throw Jt(r,"evirma",e)}}const _j="/v1/keyword";function Ij(e,t=!0){return Re({method:"POST",url:`${_j}/list`,data:e,params:{_t:new Date().valueOf()},background:t})}const gd={getList:Ij},uu=e=>e==="recommendation"?"/v1/alog":"/v1/plog";function Oj(e){return Re({method:"POST",url:`${uu(e.type)}/get`,data:e})}function Vj(e){return Re({method:"POST",url:`${uu(e.type)}/get/date`,data:e})}function qj({items:e,type:t}){return Re({method:"POST",url:`${uu(t)}/save`,data:{data:e}})}const mu={get:Oj,getDay:Vj,save:qj},Bj="/v1/cluster";function Wj(e){return Re({method:"GET",url:`${Bj}/search`,params:e})}const zj={search:Wj},Et="/v1/data";function Gj(e){return Re({method:"POST",url:`${Et}/kfu`,data:e,background:!1})}function Kj({debug:e}){const t={};return e&&(t.debug=1),Re({method:"GET",url:`${Et}/kfuc`,params:t})}function Hj({supplier:e}){return Re({method:"POST",url:`${Et}/tlasf`,data:{supplier:e}})}function Uj(e){return Re({method:"POST",url:`${Et}/lasf`,data:e})}function Qj(e){return Re({method:"POST",url:`${Et}/s314i`,data:e})}function Yj({supplier:e}){return Re({method:"POST",url:`${Et}/ptkc`,data:{s:e}})}function Jj({token:e,supplier:t}){return Re({method:"POST",url:`${Et}/ptki`,data:{t:e,s:t}})}function Zj({subjectIds:e,debug:t}){return Re({method:"POST",url:`${Et}/seat`,data:{subjects:e,debug:t}})}function Xj({subjectId:e,data:t}){return Re({method:"POST",url:`${Et}/sea`,data:{subject:e,data:t}})}function eC({supplier:e,subjectIds:t,debug:s}){return Re({method:"POST",url:`${Et}/seaft`,data:{supplier:e,subjects:t,debug:s}})}function tC({supplier:e,subjectId:t,data:s}){return Re({method:"POST",url:`${Et}/seaf`,data:{supplier:e,subject:t,data:s}})}function sC(e){return Re({method:"POST",url:`${Et}/kct`,data:e})}function nC(e){return Re({method:"POST",url:`${Et}/kmd/save`,data:e})}function oC({supplier:e,value:t}){return Re({method:"POST",url:`${Et}/pto`,data:{supplier_id:e,turnover:t}})}const Lt={uploadFamousKeywords:Gj,checkUploadFamousKeywords:Kj,checkFunnelData:Hj,uploadFunnelData:Uj,uploadDiscountData:Qj,checkWbApiToken:Yj,sendWbApiToken:Jj,checkFunnelSeasonalityData:Zj,sendFunnelSeasonalityData:Xj,checkFunnelComparisonsData:eC,sendFunnelComparisonsData:tC,sendKeywordsCtrData:sC,sendTurnoverData:oC,sendKeywordMetadataMap:nC},pu="/v1/deeplink/supplier";function aC(e){return Re({method:"POST",url:`${pu}/create`,data:e})}function rC(e){return Re({method:"POST",url:`${pu}/list`,data:e})}function iC(e){return Re({method:"POST",url:`${pu}/delete`,data:e})}const hu={create:aC,list:rC,remove:iC},lC="/v1/error-rules.json";function cC(){return Re({method:"GET",url:lC,rawResponse:!0})}const dC={list:cC},uC="/v5";function mC(e,t,s){return Tr({method:"PUT",url:`${uC}/set-plus`,data:{advert_id:e.toString(),plus:t,fixed:s},rate:{limit:1,interval:2e3},withAccessToken:!0})}const pC={setPlus:mC},hC="/v6/atrevds";function fC(e){const{pageSize:t,pageNumber:s,type:o,search:a,status:r,order:i,direction:l}=e;return Tr({method:"GET",url:`${hC}`,params:{page_size:t,page_number:s,search:a,type:o,status:r,order:i,direction:l},withAccessToken:!0})}const gC={getList:fC},yC="/v5/campaign-info";function wC(e){return Tr({method:"GET",url:`${yC}`,params:{advertID:e},cache:{expiredAt:"+10m"},withAccessToken:!0})}const SC={getInfo:wC},xC="/v5/fullstat";async function bC({interval:e,appType:t,placementType:s,id:o}){const a=await Tr({method:"GET",url:`${xC}`,params:{advertID:o,appType:t,placementType:s,from:e.begin,to:e.end},rate:{limit:1,interval:1e3},cache:{expiredAt:"+10m"},withAccessToken:!0});if(typeof a=="string")throw new ra("wb",202,{message:a});return a}const vC={getStats:bC},jC="/v3/fullstat";function CC({interval:e,appType:t,id:s}){return Tr({method:"GET",url:`${jC}`,responseType:"arrayBuffer",params:{advertID:s,appType:t,from:e.begin,to:e.end},rate:{limit:1,interval:1e3},cache:{expiredAt:"+10m"},withAccessToken:!0})}const $C={getStats:CC},yd={},kC=e=>{yd.apiToken=e},gy=()=>{if(yd.apiToken)return yd.apiToken;throw new ds("wb","apiToken")};async function Pn(e){const{withApiToken:t=!0,...s}=e,o=new Headers(s.headers);t&&o.set("Authorization",gy());try{const{data:a}=await Yt({...s,basePath:"https://advert-api.wildberries.ru/adv",headers:o,responseType:"json",adapter:r=>cs(r)});return a}catch(a){throw Jt(a,"wb",e)}}const NC="/v1/promotion";function TC(e){return Pn({method:"POST",url:`${NC}/adverts`,data:e.ids,withApiToken:!0})}const yy={getAdverts:TC},PC="/v1/stat";function MC(e){return Pn({method:"GET",url:`${PC}/words`,params:{id:e},withApiToken:!0})}const FC={getWords:MC},DC="/v1/auto",AC=(e,t)=>Pn({method:"POST",url:`${DC}/set-excluded`,params:{id:e},data:{excluded:t},withApiToken:!0}),LC={setExcluded:AC},fu="/v1/search",RC=(e,t)=>Pn({method:"POST",url:`${fu}/set-excluded`,params:{id:e},data:{excluded:t},withApiToken:!0}),EC=(e,t)=>Pn({method:"POST",url:`${fu}/set-plus`,params:{id:e},data:{pluse:t},withApiToken:!0});function _C(e,t){return Pn({method:"GET",url:`${fu}/set-plus`,params:{id:e,fixed:t?"true":"false"},withApiToken:!0})}const gu={setExcluded:RC,setPlus:EC,enablePlus:_C},IC="/v2/auto";function OC(e){return Pn({method:"GET",url:`${IC}/stat-words`,params:{id:e},withApiToken:!0})}const VC={getStatWords:OC},qC="/v2/fullstats";async function BC(e){const t=await Pn({method:"POST",url:`${qC}`,data:[e],rate:{limit:1,interval:6e4},cache:{expiredAt:"+10m"},withApiToken:!0});if(!t)throw new ra("wb",400,{message:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥"});return t}const WC={getStats:BC},Ha={},zC=async()=>{const e=cu.get("_wbauid"),t=new Date().toISOString().replace(/\D+/gi,"").substring(0,14);return`qid${e}${t}`},GC=async()=>(Ha.queryId||(Ha.queryId=await zC()),Ha.queryId),KC=e=>{Ha.accessToken=e},Om=()=>Ha.accessToken;async function HC(e){const{withQueryId:t,withAuth:s,...o}=e,a=new Headers(o.headers);t&&a.set("X-Queryid",await GC()),s&&Om()&&a.set("authorization",`Bearer ${Om()}`);try{const{data:r}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...o,basePath:"https://search.wb.ru/exactmatch/ru/common",headers:a,adapter:i=>cs(i)});return r}catch(r){throw Jt(r,"wb",e)}}const UC="/v13/search";function QC({appType:e=32,dest:t,query:s,spp:o=32,sort:a="popular",suppressSpellcheck:r=!1,resultset:i="catalog",curr:l="rub",page:c,hide_dtype:d=10,uclusters:p=0,lang:h="ru"},g){return HC({method:"GET",url:`${UC}`,params:{ab_testing:"false",appType:e,curr:l,dest:t,hide_dtype:d,lang:h,page:c,query:s,resultset:i,sort:a,spp:o,suppressSpellcheck:r,uclusters:p},rate:{limit:1,interval:100},credentials:"omit",responseTransformer:Zv.search,signal:g,withQueryId:!0,withAuth:!1})}const Pr={search:QC},Gl={},YC=async()=>{const e=cu.get("_wbauid"),t=new Date().toISOString().replace(/\D+/gi,"").substring(0,14);return`qid${e}${t}`},JC=async()=>(Gl.queryId||(Gl.queryId=await YC()),Gl.queryId);async function ZC(e){const{withQueryId:t,...s}=e,o=new Headers(s.headers);t&&o.set("X-Queryid",await JC());try{const{data:a}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...s,basePath:"https://recom.wb.ru/recom/ru/common",headers:o,adapter:r=>cs(r)});return a}catch(a){throw Jt(a,"wb",e)}}const XC="/v5/search";function e$(e,t){const{appType:s=32,dest:o,query:a,spp:r=32,suppressSpellcheck:i=!1,resultset:l="catalog",curr:c="rub",page:d,limit:p=300}=e;return ZC({method:"GET",url:`${XC}`,params:{ab_testing:"false",appType:s,curr:c,dest:o,page:d,query:a,resultset:l,spp:r,suppressSpellcheck:i,limit:p},rate:{limit:1,interval:250},credentials:"omit",responseTransformer:Xv.search,signal:t,withQueryId:!0})}const wy={search:e$};async function Sy(e){const{...t}=e,s=new Headers(t.headers);try{const{data:o}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...t,basePath:"https://catalog.wb.ru",headers:s,adapter:a=>cs(a)});return o}catch(o){throw Jt(o,"wb",e)}}const t$="/catalog/:shard/v2/catalog";function s$(e,t){const{appType:s=32,dest:o,spp:a=32,sort:r="popular",curr:i="rub",page:l,shard:c}=e,d=new URLSearchParams(e.query),p=Object.fromEntries(d.entries());return Sy({method:"GET",url:ej(t$,{shard:c}),params:{appType:s,...p,curr:i,dest:o,page:l,sort:r,spp:a},rate:{limit:1,interval:200},credentials:"omit",responseTransformer:tj.search,signal:t})}const n$={search:s$},o$="/sellers/v2/catalog";function a$(e,t){const{appType:s=32,dest:o,spp:a=32,sort:r="popular",curr:i="rub",page:l,supplier:c}=e;return Sy({method:"GET",url:o$,params:{appType:s,curr:i,dest:o,page:l,sort:r,spp:a,supplier:c},rate:{limit:4,interval:1e3},credentials:"omit",responseTransformer:sj.search,signal:t})}const r$={search:a$};async function dl(e){const{background:t=!0,basePath:s,...o}=e,a=new Headers(o.headers);try{const{data:r}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...o,basePath:s||"https://static-basket-01.wbbasket.ru",headers:a,adapter:i=>t?cs(i):Nr(i)});return r}catch(r){throw Jt(r,"wb",o)}}const i$="/vol0/data";function l$({background:e}){return dl({method:"GET",url:`${i$}/main-menu-ru-ru-v3.json`,rate:{limit:1,interval:1e3},background:e,cache:{expiredAt:"+24h"}})}const Vm={get:l$},c$="/vol0/data";function d$({background:e}){return dl({method:"GET",url:`${c$}/stores-data.json`,rate:{limit:1,interval:1e3},background:e,cache:{expiredAt:"+24h"}})}const qm={get:d$},u$="/vol0/data";function m$({background:e}){return dl({method:"GET",url:`${u$}/subject-base.json`,rate:{limit:1,interval:1e3},background:e,cache:{expiredAt:"+24h"}})}const Bm={get:m$};function p$({background:e}){return dl({method:"GET",basePath:"https://cdn.wbbasket.ru/api/v3",url:"/upstreams",background:e,rate:{limit:1,interval:1e3},params:{t:new Date().valueOf()},cache:{cacheKey:t=>(t.url.searchParams.delete("t"),t),expiredAt:"+24h"}})}const Wm={get:p$},h$=oj+"/v2/filters";function f$(e,t){const{tags:s=[],brands:o=[]}=e;return nj({method:"POST",url:`${h$}/subjects`,data:{brands:o,tags:s},rate:{limit:1,interval:1e3},cache:{expiredAt:"+12h",cacheKey:a=>({...a,data:{...a.data||{},supplierUUID:t}})},withAccessToken:!0})}const xy={subjects:f$};async function g$(e){const{withApiToken:t,...s}=e,o=new Headers(s.headers);t&&o.set("Authorization",gy());try{const{data:a}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...s,basePath:"https://seller-analytics-api.wildberries.ru/api",headers:o,adapter:r=>cs(r)});return a}catch(a){throw Jt(a,"wb",e)}}const y$="/v2/nm-report";function w$(e){const{period:t,nmIDs:s,timezone:o="Europe/Moscow",aggregationLevel:a="day"}=e;return g$({method:"POST",url:`${y$}/detail/history`,data:{nmIDs:s,period:t,timezone:o,aggregationLevel:a},rate:{limit:3,interval:6e4},withApiToken:!0,cache:{expiredAt:"+10m"}})}const S$={detail:w$};async function by(e){const{background:t,...s}=e,o=new Headers(s.headers);try{const{data:a}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...s,basePath:"https://card.wb.ru/cards",headers:o,adapter:r=>t?cs(r):Nr(r)});return a}catch(a){throw Jt(a,"wb",e)}}const x$="/v2/detail";function b$(e,t=!0,s){const{appType:o=32,curr:a="rub",dest:r,nms:i=[]}=e;return by({method:"GET",url:x$,params:{appType:o,curr:a,dest:r,hide_dtype:13,spp:30,ab_testing:!1,lang:"ru",nm:i.join(";")},rate:{limit:1,interval:200},responseTransformer:aj.search,background:t,signal:s})}const zm={search:b$},v$="/v4/detail";function j$(e,t=!0,s){const{appType:o=32,curr:a="rub",dest:r,nms:i=[]}=e;return by({method:"GET",url:v$,params:{appType:o,curr:a,dest:r,hide_dtype:13,spp:30,ab_testing:!1,lang:"ru",nm:i.join(";")},rate:{limit:1,interval:200},responseTransformer:rj.search,background:t,signal:s})}const Gm={search:j$},C$="/suppliers/suppliers-portal-core/suppliers";async function $$(){var s;const e={id:"json-rpc_5",jsonrpc:"2.0",method:"getUserSuppliers",params:{}};return(s=(await ij({method:"POST",url:C$,data:[e],rate:{limit:1,interval:1e3},cache:{expiredAt:"+10m"},credentials:"include",withAccessToken:!0})).find(({id:o})=>o===e.id))==null?void 0:s.result}const k$={getUserSuppliers:$$};async function vy(e){const t=new Headers(e.headers);try{const{data:s}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...e,basePath:"https://seller-auth.wildberries.ru/auth/v2",headers:t,adapter:o=>cs(o)});return s}catch(s){throw Jt(s,"wb",e)}}const jy="/auth/slide-v3";function N$(){return vy({method:"POST",url:jy,credentials:"include"})}function T$(e){return vy({method:"POST",url:`${jy}-confirm`,data:{sticker:e},credentials:"include"})}const Km={getToken:N$,confirmToken:T$};async function P$(e){const{background:t=!0,withAccessToken:s,...o}=e,a=new Headers(o.headers);s&&a.set("Authorizev3",lj());try{const{data:r}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...o,basePath:"https://seller-weekly-report.wildberries.ru/ns",headers:a,adapter:i=>t?cs(i):Nr(i)});return r}catch(r){throw Jt(r,"wb",e)}}const M$="/trending-searches";function F$(e,t){const{period:s}=e;return P$({method:"GET",url:`${M$}/suppliers-portal-analytics/file`,params:{period:s},rate:{limit:1,interval:1e3},credentials:"include",responseType:"blob",background:!1,withAccessToken:!0,signal:t})}const D$={getFamousKeywords:F$};async function A$(e){const{withAccessToken:t,...s}=e,o=new Headers(s.headers);t&&o.set("Authorizev3",cj());try{const{data:a}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...s,basePath:"https://discounts-prices.wildberries.ru/ns/dp-api/discounts-prices/suppliers/api",headers:o,adapter:r=>Nr(r)});return a}catch(a){throw Jt(a,"wb",s)}}const L$="/v1/list/goods";function R$(e,t){const{limit:s,offset:o}=e;return A$({method:"POST",url:`${L$}/filter`,data:{facets:[],filterWithLeftovers:!0,filterWithoutPrice:!1,limit:s,offset:o,sortPrice:!0,sortPriceValue:0},rate:{limit:1,interval:1e3},credentials:"include",withAccessToken:!0,signal:t})}const E$={list:R$};async function _$(e){const t=new Headers(e.headers);try{const{data:s}=await Yt({rate:{limit:4,interval:1e3},responseType:"json",...e,basePath:"https://user-geo-data.wildberries.ru",headers:t,adapter:o=>cs(o)});return s}catch(s){throw Jt(s,"wb",e)}}const I$="/get-geo-info";function O$(e){return _$({method:"GET",url:I$,credentials:"include",params:e})}const V$={get:O$};function q$(e,t=on){const s=t.clone();let o=e;for(;o!==void 0;){if(o instanceof Sa&&(o.attachments&&o.attachments.forEach(a=>{s.addAttachment(a)}),o.extras&&s.setExtras(o.extras)),o instanceof nr&&o.data.handled)return;(o instanceof nr||o instanceof ru)&&o.raw&&s.addBreadcrumb({category:"request",level:"debug",message:o.message,data:o.raw}),o=o.cause}return s.captureException(e)}function B$(e){const t={};return(s,o)=>{if(t[s])return t[s];const a=e(o);return t[s]=a,a}}const Cy=xv({onError(e,{sagaStack:t}){const s=on.clone();s.addBreadcrumb({level:"debug",category:"sagaUnhandled",message:t}),s.captureException(e,{mechanism:{handled:!1}})}}),K=B$(Cy.run),W$=bv({reducer:E,middleware:e=>e({serializableCheck:!1}).concat([Cy]),devTools:!1,enhancers:e=>e()}),Hm={},z$=Q(co.modelName),$y=_({name:co.modelName,initialState:Hm,reducers:{setShowModal:D("showModal"),setScreenCapture:D("screenCapture"),reset:()=>Hm}}),G$=E.inject($y),ul={...$y.actions,send:z$("send")},ky=V(co.modelName,G$),K$=ky("showModal"),H$=ky("screenCapture"),wd={useShowModal:b(K$),useScreenCapture:b(H$)},U$=k("error"),Mr={modelName:U$()},Um={},Qm=Q(Mr.modelName),Ny=_({name:Mr.modelName,initialState:Um,reducers:{set:(e,{payload:t})=>{e[t.name]=t.value},remove:(e,{payload:t})=>{t&&e[t]&&delete e[t]},clear:()=>Um}}),Q$=E.inject(Ny),uo={...Ny.actions,notification:Qm("notification"),retry:Qm("retry")},yu=cl(Mr.modelName,Q$),Ym=$(yu,(e,t)=>t,(e,t)=>e[t]??!1),Y$=$(yu,(e,t)=>t,(e,t)=>(t==null?void 0:t.map(s=>e[s]).find(Boolean))??!1),J$=te(Y$),wu={errors:yu,errorByName:Ym,useError:te(Ym),useSomeError:(e,t=[])=>{const s=Ae.useMemo(()=>e,t);return J$(s)}},O=e=>t=>function*(...o){return yield u(Su.withError,{saga:t,name:e,args:o})},et=e=>t=>function*(...o){return yield u(Su.withNotificationError,{saga:t,name:e,args:o})};let Ty=!0;function Z$(){Ty=!1}function Mn({error:e,args:t,name:s}){if(!Ty)return;const o=on.clone();return o.setTag("saga-action",s),o.addBreadcrumb({category:"saga",level:"debug",message:s,data:{args:t}}),q$(e,o)}function*X$({payload:e}){e&&(yield u(console.log,{content:e}))}function*ek({payload:e}){const t=yield F(wu.errorByName,e);t&&(yield S({type:t.name,payload:t.args[0]}))}function*Py(e){const t=yield F(wu.errors);e&&t[e]&&(yield S(uo.remove(e)))}function*My(e){yield S(uo.set({name:e.name,value:e}))}function*tk(e){var s;const t="data"in e?(s=e.data)==null?void 0:s.message:e.message;console.error(e),yield S(uo.notification(t))}function*sk({saga:e,name:t,args:s}){yield u(Py,t);try{return yield u(e,...s)}catch(o){const a=o,r=Mn({error:a,name:t,args:s});return yield u(My,{error:a,name:t,args:s,id:r})}}function*nk({saga:e,name:t,args:s}){yield u(Py,t);try{return yield u(e,...s)}catch(o){if(o instanceof dj)return yield u(My,{error:o,name:t,args:s});throw o}}function*ok({saga:e,name:t,args:s}){try{return yield u(e,...s)}catch(o){const a=o;return Mn({error:a,name:t,args:s}),yield u(tk,a)}}function*ak(){yield I([N(uo.notification,X$),N(uo.retry,ek)])}K(Mr.modelName,ak);const Su={withError:sk,withNotificationError:ok,withValidationError:nk},x=e=>{const t=vv();return Ae.useMemo(()=>jv(e,t),[e,t])};function ml({className:e,classNames:t,style:s,...o}){return n.jsxs(f,{type:"horizontal",align:"center",className:P(e,t==null?void 0:t.wrapper),style:s,...o,children:[n.jsx(bt,{className:t==null?void 0:t.logo}),n.jsx(ga,{className:t==null?void 0:t.name})]})}function ee({value:e,showLogo:t,onRetry:s}){var y;const{error:o,id:a,name:r}=e,{retry:i}=x(uo),l=Ae.useCallback(()=>{s?s():i(r)},[s,r]),c=n.jsx(A,{onClick:l,size:"small",children:"–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞"});let d="–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫",p=o.message,h=n.jsxs(n.Fragment,{children:[c,n.jsx(A,{onClick:()=>g({eventId:a}),size:"small",children:"–°–æ–æ–±—â–∏—Ç—å –æ—Ç –æ—à–∏–±–∫–µ"})]});const{setShowModal:g}=x(bu.actions);if(console.error(o),o instanceof nr){switch(o.service){case"wb":d=`${W.wb.name} –Ω–µ –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ`,h=c;break;case"evirma":d=`${W.appName.toUpperCase()} –Ω–µ –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ`,h=c;break;default:d="–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"}p=(y=o.data.message)==null?void 0:y.substring(0,1e3),o.data.additional&&(p=n.jsxs(n.Fragment,{children:[n.jsxs("p",{children:[p,":"]}),n.jsx("ul",{children:o.data.additional.map(({field:w,description:C},j)=>n.jsxs("li",{children:[w,": ",C]},j))})]})),o instanceof uj&&(p="–í—ã —Å–¥–µ–ª–∞–ª–∏ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥–æ–∂–¥–∏—Ç–µ ‚Äî —Å–∫–æ—Ä–æ –≤—Å—ë —Å–Ω–æ–≤–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!")}return o instanceof zv&&(d="–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ",p="–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ",h=n.jsx(A,{onClick:()=>window.location.reload(),size:"small",children:"–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"})),n.jsx(dt,{showLogo:t,type:"error",title:d,message:p,buttons:h})}function Fy({eventId:e,showLogo:t,onClose:s,className:o,style:a}){const{setShowModal:r}=x(bu.actions);return n.jsx(dt,{type:"error",title:"–£–ø—Å",message:n.jsx(n.Fragment,{children:"–í —Ä–∞–±–æ—Ç–µ –ø–ª–∞–≥–∏–Ω–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –∫–æ—Ç–æ—Ä—É—é –Ω–µ —É–¥–∞–ª–æ—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å üòû"}),buttons:n.jsx(A,{onClick:()=>r({eventId:e}),size:"small",children:"–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ"}),showLogo:t,onCloseClick:s,className:o,style:a})}class H extends m.Component{constructor(){super(...arguments);Aa(this,"state",{hasError:!1,eventId:void 0})}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(s){const o=on.captureException(s,{mechanism:{handled:!1}});this.setState(a=>({...a,eventId:o}))}render(){if(this.state.hasError){if(this.props.fallback){const s=this.props.fallback;return n.jsx(s,{eventId:this.state.eventId})}return":-("}return this.props.children}}Aa(H,"defaultProps",{fallback:Fy});const rk="yWesxeP",Fr={fixFonts:rk},ik="oGIsk6B",lk="ozEeiXN",Kl={wrapper:ik,alert:lk};function Qt({eventId:e}){const[t,s]=m.useState(!1);return m.useEffect(()=>{const o=document.querySelector(`.${Kl.wrapper}`);s(!o)},[]),t?n.jsx("div",{className:P(Kl.wrapper,Fr.fixFonts),children:n.jsx(H,{children:n.jsx(Fy,{showLogo:!0,eventId:e,onClose:()=>s(!1),className:Kl.alert})})}):null}const Z={config:Mr,actions:uo,sagas:Su,selectors:wu},xu={modelName:"loader",globalLoader:"global"},ck={},Dy=_({name:xu.modelName,initialState:ck,reducers:{show:(e,{payload:t})=>{e[t]=!0},hide:(e,{payload:t})=>{delete e[t]}}}),dk=E.inject(Dy),{actions:Sd}=Dy,Ay=cl(xu.modelName,dk),Jm=$(Ay,(e,t)=>t,(e,t)=>t?e[t]??!1:!1),uk=$(Ay,(e,t)=>t,(e,t)=>{var s;return((s=t==null?void 0:t.map(o=>o?e[o]??!1:!1))==null?void 0:s.some(Boolean))??!1}),mk=te(uk),pk={isLoading:Jm,useLoader:te(Jm),useSomeLoader:(e,t=[])=>{const s=Ae.useMemo(()=>e,t);return mk(s)}};function*hk({saga:e,loader:t,args:s}){try{return yield S(Sd.show(t)),yield u(e,...s)}finally{yield S(Sd.hide(t))}}const Ly={withLoader:hk},L=e=>t=>function*(...o){return yield u(Ly.withLoader,{saga:t,loader:e,args:o})},G={config:xu,actions:Sd,sagas:Ly,selectors:pk},fk=async e=>{const t=await fetch(e);return new Uint8Array(await t.arrayBuffer())};function*gk({fields:e,eventId:t}){const[s,o]=yield I([u(ry),u(iy)]),a=e.type==="error"?"üö®":"üí°",r={email:e.contacts,message:`${a} ${e.message}`,associatedEventId:t,tags:{clientId:s,clientSessionId:o,release:W.release,isProposal:e.type==="proposal"}},i=[];if(e.screenshot){const l=yield u(fk,e.screenshot.url);i.push({data:l,filename:e.screenshot.filename,contentType:"application/png"})}Jv(r,{attachments:i},on)}function*yk(){yield I([N(ul.send,T(gk,[M,et(co.loading.send),L(co.loading.send),zt]))])}K(co.modelName,yk);const Ps=m.memo(({targetElement:e,targetClassName:t,selector:s,children:o,className:a,append:r="last",tagName:i="div"})=>{const l=m.useRef((()=>{const c=document.createElement(i);return a&&(c.classList.add(...a.split(/\s+/)),c.classList.add(Fr.fixFonts)),c})());return m.useEffect(()=>{const c=s?e==null?void 0:e.querySelector(s):e,d=(t||"").split(" ").filter(Boolean);if(c)switch(d.length&&c.classList.add(...d),r){case"after":{c.after(l.current);break}case"before":{c.before(l.current);break}case"first":{c.prepend(l.current);break}case"last":default:{c.append(l.current);break}}return()=>{var p;c&&d.length&&c.classList.remove(...d),(p=l.current.parentElement)==null||p.removeChild(l.current)}},[e]),Cv.createPortal(o,l.current)});Ps.displayName="Injector";function Zm(e){const t=Array.isArray(e)?e:[e];for(const s of t){const o=document.querySelector(s);if(o)return o}}function Fn(e){const[t,s]=m.useState(typeof e=="function"?e:Zm(e));return m.useEffect(()=>{const o=new MutationObserver(()=>{s(typeof e=="function"?e():Zm(e))});return o.observe(document.documentElement,{childList:!0,subtree:!0}),()=>{o.disconnect()}},[]),t||void 0}const J=m.memo(({selector:e,...t})=>{const s=Fn(e);return s?n.jsx(Ps,{targetElement:s,...t}):null});J.displayName="InjectorObservable";const wk="tr9zkTV",Sk="AlNlazk",xk="OD1W4XO",bk="PR02-WB",vk="vKLnskk",jk="Wc-Vjyi",Ck="_2u7gg-h",$k="H-jA9Ec",kk="_2tRbano",Nk="_0KEUWAO",ts={dialog:wk,container:Sk,mask:xk,header:bk,title:vk,logo:jk,iconClose:Ck,buttonClose:$k,body:kk,footer:Nk},Tk=document.body,Pk=ts.dialog;function Ye({open:e,onCloseClick:t,actions:s,children:o,title:a,style:r,classNames:i,maskClosable:l}){return m.useEffect(()=>(e&&document.body&&(document.body.style.overflow="hidden"),()=>{document.body&&(document.body.style.overflow="auto")}),[e]),e?n.jsx(Ps,{targetElement:Tk,className:i==null?void 0:i.root,children:n.jsx("div",{className:P(i==null?void 0:i.mask,ts.mask),onClick:l?t:void 0,children:n.jsx("div",{className:P(i==null?void 0:i.dialog,ts.dialog),style:r,onClick:l?c=>c.stopPropagation():void 0,children:n.jsxs("div",{className:P(i==null?void 0:i.container,ts.container,Fr.fixFonts),children:[n.jsxs("div",{className:P(i==null?void 0:i.header,ts.header),children:[a&&n.jsxs(f,{as:"h3",gap:"s",align:"center",className:ts.title,children:[n.jsx(bt,{className:ts.logo}),a]}),n.jsx("button",{onClick:t,className:ts.buttonClose,children:n.jsx(z.Cross,{className:ts.iconClose})})]}),n.jsx("div",{className:P(i==null?void 0:i.body,ts.body),children:o}),s!==void 0&&n.jsx("div",{className:ts.footer,children:s})]})})})}):null}const Mk="cDfyfhV",Fk="wBGlRxR",Dk="-ifinqY",Ak="lqApIZa",Lk="BLSu3Fg",Rk="uv9XOtf",Ek="avZGajS",_k="iFnvunV",Ls={badge:Mk,info:Fk,success:Dk,error:Ak,warning:Lk,red:Rk,default:"YZbdXTK",gray:Ek,small:_k};function be({type:e,children:t,className:s,style:o,size:a,...r}){const i=P(Ls.badge,s,{[Ls.info]:e==="info",[Ls.error]:e==="error",[Ls.success]:e==="success",[Ls.warning]:e==="warning",[Ls.red]:e==="red",[Ls.default]:e==="default",[Ls.gray]:e==="gray",[Ls.small]:a==="small"});return n.jsx("span",{className:i,style:o,...r,children:t})}const Ik="vXA4X02",Ok="_8t3S1El",Vk="h8Y6w5O",Xr={button:Ik,sub:Ok,selected:Vk};function an({options:e,value:t,onChange:s,className:o,style:a}){return n.jsx("div",{className:P(o,Xr.button),style:a,children:n.jsx(f,{type:"horizontal",children:e.map((r,i)=>n.jsx("button",{disabled:t===r.value,onClick:l=>s(r.value,l),className:P(Xr.button,Xr.sub,{[Xr.selected]:t===r.value}),children:n.jsxs(f,{type:"horizontal",gap:"xs",wrap:!1,align:"center",children:[r.icon,n.jsx("span",{children:r.label}),r.badge!==void 0&&n.jsx(be,{type:"info",children:r.badge})]})},r.value||i.toString()))})})}const qk="Xmx2wX7",Bk="AjlPj5R",Wk="RM3QV5K",zk="BJaCDn1",Gk="yGJ4FZl",Bs={label:qk,labelTextarea:Bk,wrapper:Wk,input:zk,textarea:Gk};function Ry({className:e,style:t,...s}){return n.jsx("label",{className:P([e,Bs.label,Bs.labelTextarea]),style:t,children:n.jsx("div",{className:Bs.wrapper,children:n.jsx("textarea",{...s,className:P([Bs.input,Bs.textarea])})})})}const xe=({type:e,className:t,style:s,...o})=>n.jsx("label",{className:P([t,Bs.label],{[Bs.labelTextarea]:e==="textarea"}),style:s,children:n.jsx("div",{className:Bs.wrapper,children:n.jsx("input",{type:e,className:Bs.input,...o})})});xe.Textarea=Ry;const Kk="bRu24v9",Hk="_8T-3tra",Xm={labelText:Kk,label:Hk};function ns({as:e,children:t,title:s,error:o,className:a,style:r,labelClassName:i,...l}){const c=e||"label",d=P(a,Xm.label);return n.jsxs(c,{className:d,style:r,...l,children:[n.jsx("div",{className:P(i,Xm.labelText),children:s||n.jsx(n.Fragment,{children:"¬†"})}),t,o&&n.jsx("div",{children:o})]})}const Uk=async e=>{const t=await navigator.mediaDevices.getDisplayMedia({video:{width:window.innerWidth*window.devicePixelRatio,height:window.innerHeight*window.devicePixelRatio},audio:!1,monitorTypeSurfaces:"exclude",preferCurrentTab:!0,selfBrowserSurface:"include",surfaceSwitching:"exclude"}),s=document.createElement("video");new Promise((o,a)=>{try{s.srcObject=t,s.onloadedmetadata=()=>{e(s),t.getTracks().forEach(r=>r.stop()),o(!0)},s.play()}catch(r){a(r)}})},Qk=async()=>new Promise((e,t)=>{Uk(s=>{const o=document.createElement("canvas"),a=o.getContext("2d");if(!a)return t(Error("Could not get canvas context"));o.width=s.videoWidth,o.height=s.videoHeight,o.style.width="100%",o.style.height="100%",a.drawImage(s,0,0),o.toBlob(r=>{if(r){const i=new File([r],`screen_${new Date().valueOf()}.png`,{type:"image/png"});return e(i)}t("Can't make screenshot")},"image/png",.95)}).catch(t)}),Yk=[{label:"–û—à–∏–±–∫–∞",value:"error"},{label:"–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ",value:"proposal"}];function Jk({eventId:e,onCancel:t}){const{send:s,setScreenCapture:o}=x(ul),[a,r]=m.useState({message:"",type:"error"}),i=(d,p)=>{r({...a,[d]:p})},l=async()=>{try{o(!0);const d=await Qk();i("screenshot",{filename:d.name,url:URL.createObjectURL(d)})}finally{o(!1)}},c=()=>{a&&s({fields:a,eventId:e||on.lastEventId(),callback:t})};return m.useEffect(()=>()=>{var d;(d=a.screenshot)!=null&&d.url&&URL.revokeObjectURL(a.screenshot.url)},[a.screenshot]),n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(f,{type:"horizontal",children:n.jsx(an,{options:Yk,value:a.type,onChange:d=>i("type",d)})}),n.jsx(ns,{title:"–ö–æ–Ω—Ç–∞–∫—Ç—ã",children:n.jsx(xe,{type:"text",placeholder:"email, telegram –∏–ª–∏ –¥—Ä—É–≥–æ–µ",value:a==null?void 0:a.contacts,onChange:d=>i("contacts",d.target.value)})}),n.jsx(ns,{title:"–û–ø–∏—Å–∞–Ω–∏–µ *",children:n.jsx(xe.Textarea,{value:a==null?void 0:a.message,onChange:d=>i("message",d.target.value),placeholder:"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ, —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å"})}),a.type==="error"&&n.jsx(ns,{title:"–°–∫—Ä–∏–Ω—à–æ—Ç",children:a.screenshot?n.jsx("img",{src:a.screenshot.url,alt:a.screenshot.filename,style:{maxHeight:150,maxWidth:150}}):n.jsx("div",{children:n.jsx(A,{onClick:l,children:"–î–æ–±–∞–≤–∏—Ç—å"})})}),n.jsx("div",{style:{textAlign:"right"},children:n.jsx(A,{type:"purple",onClick:c,disabled:a.message.length===0&&a.screenshot===void 0,children:"–û—Ç–ø—Ä–∞–≤–∏—Ç—å"})})]})}const Zk="srkZKwU",Xk={modalHidden:Zk};function e0(){const e=wd.useShowModal(),t=wd.useScreenCapture(),{reset:s}=x(ul);return n.jsx(Ye,{classNames:{mask:t?Xk.modalHidden:void 0},open:!!e,onCloseClick:()=>s(),title:"–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å",style:{maxWidth:600},children:n.jsx(Jk,{eventId:e==null?void 0:e.eventId,onCancel:()=>s()})})}const bu={config:co,actions:ul,selectors:wd},vu={modelName:"router"},t0={pathname:"/",hash:"",search:""},Ey=_({name:vu.modelName,initialState:t0,reducers:{setPathname:D("pathname"),setHash:D("hash"),setSearch:D("search")}}),s0=E.inject(Ey),{actions:n0}=Ey,Dr=cl(vu.modelName,s0),o0=$(Dr,e=>{const t="http://localhost/",s=new URL("http://localhost/");return e&&(s.pathname=e.pathname,s.hash=e.hash,s.search=e.search),s.href.replace(t,"")}),a0=$(Dr,e=>(e==null?void 0:e.pathname)??"/"),r0=$(Dr,e=>(e==null?void 0:e.hash)??""),_y=$(Dr,e=>(e==null?void 0:e.search)??""),ep=$(_y,e=>{const t=e.substring(1).split("&").map(s=>{const o=s.indexOf("=");return o>0?[s.substring(0,o),s.substring(o+1)]:[s]});return Object.fromEntries(t)}),i0={location:Dr,locationString:o0,pathName:a0,hash:r0,queryParams:ep,searchString:_y,useQueryParams:b(ep)},l0=()=>{const[e,t]=m.useState(window.location.href);return m.useLayoutEffect(()=>{const s=new MutationObserver((o,a)=>{window.location.href!==e&&(t(window.location.href),a.disconnect())});return s.observe(document,{subtree:!0,childList:!0}),()=>{s.disconnect()}},[e]),window.location};function c0(){const e=kv(),t=l0(),{clear:s}=x(Z.actions),{setPathname:o,setSearch:a,setHash:r}=x(n0);return m.useEffect(()=>{e.push(t.pathname),o(t.pathname),s()},[t.pathname]),m.useEffect(()=>{a(t.search),s()},[t.search]),m.useEffect(()=>{r(t.hash),s()},[t.hash]),null}function Hl({children:e,host:t}){return(Array.isArray(t)?t:[t]).includes(window.location.host)?n.jsxs($v,{children:[n.jsx(c0,{}),e]}):null}const ju={config:vu,selectors:i0},Ul=k("feature/wb-minus-phrase-stats"),Us={modelName:Ul(),loading:{load:Ul("load")},view:{grid:Ul("view/grid")}},d0=Q(Us.modelName),tp={},Iy=_({name:Us.modelName,initialState:tp,reducers:{setShowModal:D("showModal"),reset:()=>tp}}),u0=E.inject(Iy),Oy={...Iy.actions,load:d0("load")},Ea=k("view-options"),Xs={modelName:Ea(),storageKey:`${W.appName}/${Ea("storage-key")}`,loading:{load:Ea("load"),save:Ea("save")},event:{save:Ea("save")}},m0={value:{},ready:{}},Vy=_({name:Xs.modelName,initialState:m0,reducers:{set:(e,{payload:t})=>{e.value={...e.value,...t};const s=Object.keys(t).reduce((o,a)=>(o[a]=!0,o),{});e.ready={...e.ready,...s}}}}),p0=E.inject(Vy),sp=Q(Xs.modelName),jn={...Vy.actions,save:sp("save"),load:sp("load")},qy=cl(Xs.modelName,p0),np=$(qy,(e,t)=>t,(e,t)=>e.value[t]),op=$(qy,(e,t)=>t,(e,t)=>e.ready[t]),qi={viewOptions:np,viewIsReady:op,useViewOptions:te(np),useViewIsReady:te(op)},ap=window.crypto.randomUUID();function Dn(e){return{subscribe:o=>{const a=r=>{var i,l;return r.source===io.ContentScript&&r.action===Ws.Broadcast&&((i=r.data)==null?void 0:i.name)===e&&((l=r.data)==null?void 0:l.tabId)!==ap?(o(r.data.payload),!0):!1};return chrome.runtime.onMessage.addListener(a),()=>{chrome.runtime.onMessage.removeListener(a)}},post:o=>chrome.runtime.sendMessage({source:io.ContentScript,action:Ws.Broadcast,data:{tabId:ap,name:e,payload:o}})}}function ia(e,...t){const s=new AbortController,o=[...t,s.signal];return u((...a)=>{const r=e(...a);return r[Nv]=()=>s.abort(),r},...o)}function h0(e,...t){return u(function*(){try{return yield u(e,...t)}catch(s){return s}})}function Ar(e){return fa(t=>e(s=>t(s)))}function Cu(e){return fa(t=>e(s=>t(s)))}function An(e){return fa(t=>e(s=>t(s)))}const rp=new Map;function By(e){const t=`${Xs.storageKey}/${e}`;let s=rp.get(t);return s||(s=Ue(t,{type:Qe.Sync}),rp.set(t,s)),s}const Wy=Dn(Xs.event.save);function*f0({viewId:e,saga:t,args:s}){const o=Array.isArray(e)?e:[e];return yield I(o.map(a=>S(jn.load(a)))),yield u(t,...s)}function*g0(e){if(!(yield F(s=>qi.viewOptions(s,e))))try{yield S(G.actions.show(e));const s=By(e),o=yield u(s.get);yield S(jn.set({[e]:o}))}finally{yield S(G.actions.hide(e))}}function*y0({data:e,syncTabs:t}){yield S(jn.set(e));const s=Object.entries(e).map(([o,a])=>{const r=By(o);return u(r.set,a)});yield I(s),t&&(yield u(Wy.post,e))}function*w0(){const t=yield u(()=>An(Wy.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*S0(){const{channel:e,takeEvent:t}=yield u(w0);try{for(;;){const s=yield u(t);yield S(jn.set(s))}}finally{e.close()}}function*x0(){yield I([ey(300,jn.save,T(y0,[M,et(Xs.loading.save)])),N(jn.load,T(g0,[M,et(Xs.loading.save)]))])}K(Xs.modelName,x0);const zy={withViewOptions:f0,watchSaveChannelSaga:S0},vt=e=>t=>function*(...o){return yield u(zy.withViewOptions,{viewId:e,saga:t,args:o})};function he(e,t={}){const{syncTabs:s=!0,withLoad:o=!1}=t,a=qi.useViewOptions(e),r=qi.useViewIsReady(e),{save:i,load:l}=x(jn),c=m.useCallback(p=>{p!==a&&i({data:{[e]:p},syncTabs:s})},[e,s]),d=m.useCallback(()=>{l(e)},[e]);return m.useEffect(()=>{o&&d()},[d,o]),{isReady:r,state:a,save:c,load:d}}const b0={config:Xs,actions:jn,sagas:zy,selectors:qi},v0=k("entity/evirma/minus-phrase"),$u={modelName:v0()},ip={},Gy=_({name:$u.modelName,initialState:ip,reducers:{setList:D("list"),reset:()=>ip}}),j0=E.inject(Gy),Ky={...Gy.actions},C0=V($u.modelName,j0),lp=C0("list"),$0={list:lp,useList:b(lp)};function ze(e,t){return parseFloat(e.toFixed(t))}function k0(e){return e!=null&&e.clusters?e.clusters.map(t=>{var d,p;const{keyword:s,product_count:o,freq_syn:a,subjects:r,dr:i}=t,l=r==null?void 0:r[0],c=o&&a.monthly?ze(o/a.monthly,2):void 0;return{phrase:s,words:Ft(s),freqMonthly:a.monthly??a.weekly*4,freqDaily:Math.round(a.weekly/7),freqWeeklyTrend:a.weekly_trend,subjectId:l,subject:(p=(d=e.subjects)==null?void 0:d[l])==null?void 0:p.name,productCount:o,dr:i,competition:c}}):[]}function*N0(e){const t=yield u(zj.search,{query:e});yield S(Ky.setList(k0(t)))}const T0={load:N0},dn={phrase:"–ö–ª—é—á–µ–≤–∞—è —Ñ—Ä–∞–∑–∞",words:"–°–ª–æ–≤–∞",freqMonthly:"–ü–æ–∫–∞–∑–æ–≤ –≤ –º–µ—Å—è—Ü",freqDaily:"–ü–æ–∫–∞–∑–æ–≤ –≤ —Å—É—Ç–∫–∏",freqWeeklyTrend:"–¢—Ä–µ–Ω–¥",subject:"–ü—Ä–µ–¥–º–µ—Ç",subjectId:"–ü—Ä–µ–¥–º–µ—Ç ID",productCount:"–¢–æ–≤–∞—Ä–æ–≤",dr:"–°–ª–æ–∂–Ω–æ—Å—Ç—å",competition:"–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è"},P0="KL3FIKh",M0={overlay:P0};function Oe(e){return n.jsx(Tv,{overlayClassName:P(M0.overlay,Fr.fixFonts),transitionName:"ant-zoom-big-fast",...e})}const F0="Dz14jvL",D0="basduIE",cp={stem:F0,word:D0};function Hy({stem:e,word:t,onClick:s}){return e?n.jsx(Oe,{placement:"top",overlay:n.jsxs(n.Fragment,{children:["–ò—Å–∫–ª—é—á–∏—Ç—å –≤—Å–µ —Ñ—Ä–∞–∑—ã —Å–æ —Å–ª–æ–≤–æ–º"," ",n.jsxs("span",{className:cp.word,children:['"',t,'"']})]}),mouseEnterDelay:.3,children:n.jsx("span",{onClick:()=>s({stem:e,word:t}),className:cp.stem,children:t})}):n.jsx("span",{children:t})}const ku={config:$u,actions:Ky,selectors:$0,sagas:T0};function*A0(e){yield u(ku.sagas.load,e)}function*L0(){yield I([N(Oy.load,T(A0,[M,vt([Us.view.grid]),O(Us.loading.load),L(Us.loading.load)]))])}K(Us.modelName,L0);const R0={},E0=V(Us.modelName,u0),_0=E0("showModal"),I0=$(ku.selectors.list,(e,t)=>t,(e,t)=>e?t?e==null?void 0:e.filter(s=>!t.find(o=>s.phrase.includes(o))):e:[]),O0={useShowModal:b(_0),useFilteredData:te(I0)},V0="-l3VcP1",q0={customTooltip:V0};function B0({value:e,hideTooltipCallback:t}){const s=()=>{t==null||t()};return n.jsx("div",{className:q0.customTooltip,onClick:s,dangerouslySetInnerHTML:{__html:e||""}})}const W0=({data:e,colDef:t})=>t.field?ll(e,t.field,0):0,z0={dateShort:{valueFormatter:({value:e})=>v.dateShort(e)},dateClean:{valueFormatter:({value:e})=>v.dateClean(e)},date:{valueFormatter:({value:e})=>v.date(e)},currency:{valueFormatter:({value:e})=>v.currency(e)},"currency.0":{valueFormatter:({value:e})=>v.currency(e,{fraction:0})},"currency.1":{valueFormatter:({value:e})=>v.currency(e,{fraction:1})},"currency.2":{valueFormatter:({value:e})=>v.currency(e,{fraction:2})},percent:{valueFormatter:({value:e})=>v.percent(e)},"percent.0":{valueFormatter:({value:e})=>v.percent(e,{fraction:0})},"percent.1":{valueFormatter:({value:e})=>v.percent(e,{fraction:1})},"percent.2":{valueFormatter:({value:e})=>v.percent(e,{fraction:2})},numeric:{valueFormatter:({value:e})=>v.numeric(e)},"numeric.0":{valueFormatter:({value:e})=>v.numeric(e,{fraction:0})},"numeric.1":{valueFormatter:({value:e})=>v.numeric(e,{fraction:1})},"numeric.2":{valueFormatter:({value:e})=>v.numeric(e,{fraction:2})},zeroValue:{valueGetter:W0}};function Ql(e,t){var a;const s=(a=t.getColumn(e.colId))==null?void 0:a.getColDef();return!(!s||s.hide&&s.suppressColumnsToolPanel&&s.suppressFiltersToolPanel&&s.suppressHeaderContextMenu)}const G0=e=>{const t=!!e.field,s=e.hide;return t&&!s},Uy=(e,t)=>t&&t(e)?!0:e.api.getSelectedNodes().length>0?!e.node.isSelected():!1,Qy=(e,t)=>{if(!e)return;const{fileName:s,sheetsConfig:o}=t;if(!o||o.length===0)return;const a=o.map(({sheetName:r,shouldRowBeSkipped:i,...l})=>e.getSheetDataForExcel({sheetName:r,...l,shouldRowBeSkipped:c=>Uy(c,i)})).filter(r=>typeof r=="string");a.length!==0&&e.exportMultipleSheetsAsExcel({data:a,fileName:s})},Yy=(e=[],t=[])=>{const o=[...["cut","paste","copyWithGroupHeaders"],...t].map(a=>a.toLowerCase());return e.filter(a=>typeof a=="string"?!o.includes(a.toLowerCase()):!0)},Cn=({column:e,value:t})=>{const o=e.getColDef().valueFormatter;if(o&&typeof o=="function"){const a=o({value:t,column:e});return typeof t=="number"?a.replace(/[^\d.,]/g,""):a}return t},dp={selectAll:"(–í—ã–¥–µ–ª–∏—Ç—å –≤—Å–µ)",selectAllSearchResults:"(–í—ã–¥–µ–ª–∏—Ç—å –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞)",searchOoo:"–ü–æ–∏—Å–∫...",blanks:"(–ü—É—Å—Ç–æ)",blank:"–ü—É—Å—Ç–æ–µ",notBlank:"–ù–µ–ø—É—Å—Ç–æ–µ",noMatches:"–ù–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π",filterOoo:"–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è...",equals:"–†–∞–≤–Ω–æ",notEqual:"–ù–µ —Ä–∞–≤–Ω–æ",empty:"–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω",lessThan:"–ú–µ–Ω—å—à–µ, —á–µ–º",greaterThan:"–ë–æ–ª—å—à–µ, —á–µ–º",lessThanOrEqual:"–ú–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ",greaterThanOrEqual:"–ë–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ",inRange:"–í –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ",inRangeStart:"–æ—Ç",inRangeEnd:"–¥–æ",contains:"–°–æ–¥–µ—Ä–∂–∏—Ç",notContains:"–ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç",startsWith:"–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å",endsWith:"–ö–æ–Ω—á–∞–µ—Ç—Å—è –Ω–∞",dateFormatOoo:"dd-mm-yyyy",andCondition:"–ò",orCondition:"–ò–õ–ò",applyFilter:"–ü—Ä–∏–º–µ–Ω–∏—Ç—å",resetFilter:"–°–±—Ä–æ—Å–∏—Ç—å",clearFilter:"–û—á–∏—Å—Ç–∏—Ç—å",cancelFilter:"–û—Ç–º–µ–Ω–∏—Ç—å",textFilter:"–¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä",numberFilter:"–ß–∏—Å–ª–æ–≤–æ–π —Ñ–∏–ª—å—Ç—Ä",dateFilter:"–§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ",setFilter:"–í—ã–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä",columns:"–°—Ç–æ–ª–±—Ü—ã",filters:"–§–∏–ª—å—Ç—Ä—ã",pivotMode:"–†–µ–∂–∏–º —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã",groups:"–ì—Ä—É–ø–ø—ã —Å—Ç—Ä–æ–∫",rowGroupColumnsEmptyMessage:"–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ —Å—Ç—Ä–æ–∫–∞–º",values:"–ó–Ω–∞—á–µ–Ω–∏—è",valueColumnsEmptyMessage:"–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞ –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏",pivots:"–ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤",pivotColumnsEmptyMessage:"–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å—Ç–æ–ª–±—Ü–∞–º",group:"–ì—Ä—É–ø–ø–∞",loadingOoo:"–ó–∞–≥—Ä—É–∑–∫–∞...",noRowsToShow:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",enabled:"–í–∫–ª—é—á–µ–Ω–æ",pinColumn:"–ó–∞–∫—Ä–µ–ø–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü",pinLeft:"–ó–∞–∫—Ä–µ–ø–∏—Ç—å —Å–ª–µ–≤–∞",pinRight:"–ó–∞–∫—Ä–µ–ø–∏—Ç—å —Å–ø—Ä–∞–≤–∞",noPin:"–ù–µ –∑–∞–∫—Ä–µ–ø–ª—è—Ç—å",valueAggregation:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é",autosizeThisColumn:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–∞–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —ç—Ç–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞",autosizeAllColumns:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–∞–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º",groupBy:"–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ",ungroupBy:"–†–∞–∑–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ",resetColumns:"–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–æ–ª–±—Ü—ã",expandAll:"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ",collapseAll:"–°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ",copy:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å",ctrlC:"Ctrl+C",copyWithHeaders:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏",paste:"–í—Å—Ç–∞–≤–∏—Ç—å",ctrlV:"Ctrl+V",export:"–≠–∫—Å–ø–æ—Ä—Ç",csvExport:"–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV (.csv)",excelExport:"–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel (.xlsx)",excelXmlExport:"–≠–∫—Å–ø–æ—Ä—Ç –≤ XML (.xml)",columnChooser:"–í—ã–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤",sortAscending:"–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é",sortDescending:"–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É–±—ã–≤–∞–Ω–∏—é",sortUnSort:"–°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É",sum:"–°—É–º–º–∞",min:"–ú–∏–Ω–∏–º—É–º",max:"–ú–∞–∫—Å–∏–º—É–º",none:"–ü—É—Å—Ç–æ",count:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",avg:"–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ",filteredRows:"–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ",selectedRows:"–í—ã–±—Ä–∞–Ω–æ",totalRows:"–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫",totalAndFilteredRows:"–°—Ç—Ä–æ–∫–∏",more:"–º–Ω–æ–≥–∏—Ö",to:"–ø–æ",of:"–∏–∑",page:"–°—Ç—Ä–∞–Ω–∏—Ü–∞",nextPage:"–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",lastPage:"–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",firstPage:"–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",previousPage:"–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",pivotChartAndPivotMode:"–°–≤–æ–¥–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ & —Ä–µ–∂–∏–º —Å–≤–µ–¥–µ–Ω–∏—è",pivotChart:"–°–≤–æ–¥–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞",chartRange:"–î–∏–∞–ø–∞–∑–æ–Ω –¥–∏–∞–≥—Ä–∞–º–º—ã",columnChart:"–°—Ç–æ–ª–±–∏–∫–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞",groupedColumn:"–°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è",stackedColumn:"–°–ª–æ–∂–µ–Ω–Ω–∞—è",normalizedColumn:"100% –°–ª–æ–∂–µ–Ω–Ω–∞—è",barChart:"–ü–∞–Ω–µ–ª—å",groupedBar:"–°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è",stackedBar:"–°–ª–æ–∂–µ–Ω–Ω–∞—è",normalizedBar:"100% –°–ª–æ–∂–µ–Ω–Ω–∞—è",pieChart:"–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞",pie:"–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞",doughnut:"–ö–æ–ª—å—Ü–µ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞",line:"–õ–∏–Ω–∏—è",xyChart:"X Y (–†–∞–∑–±—Ä–æ—Å)",scatter:"–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ—è–Ω–∏—è",bubble:"–ü—É–∑—ã—Ä—å–∫–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞",areaChart:"–û–±–ª–∞—Å—Ç—å",area:"–î–∏–∞–≥—Ä–∞–º–º–∞ —Å –æ–±–ª–∞—Å—Ç—è–º–∏",stackedArea:"–°–ª–æ–∂–µ–Ω–Ω–∞—è",normalizedArea:"100% –°–ª–æ–∂–µ–Ω–Ω–∞—è",histogramChart:"–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞",pivotChartTitle:"–°–≤–æ–¥–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞",rangeChartTitle:"–ì—Ä–∞—Ñ–∏–∫ –¥–∏–∞–ø–∞–∑–æ–Ω–∞",settings:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏",data:"–î–∞–Ω–Ω—ã–µ",format:"–§–æ—Ä–º–∞—Ç",categories:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏",defaultCategory:"(–ü—É—Å—Ç–æ)",series:"–°–µ—Ä–∏–∏",xyValues:"X Y –ó–Ω–∞—á–µ–Ω–∏—è",paired:"–ü–∞—Ä–Ω—ã–π —Ä–µ–∂–∏–º",axis:"–û—Å—å",navigator:"–ù–∞–≤–∏–≥–∞—Ü–∏—è",color:"–¶–≤–µ—Ç",thickness:"–¢–æ–ª—â–∏–Ω–∞",xType:"X –¢–∏–ø",automatic:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏",category:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è",number:"–ß–∏—Å–ª–æ",time:"–í—Ä–µ–º—è",xRotation:"X –ü–æ–≤–æ—Ä–æ—Ç",yRotation:"Y –ü–æ–≤–æ—Ä–æ—Ç",ticks:"–û—Ç–º–µ—Ç–∫–∏",width:"–®–∏—Ä–∏–Ω–∞",height:"–í—ã—Å–æ—Ç–∞",length:"–î–ª–∏–Ω–∞",padding:"–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—Å—Ç—É–ø",spacing:"–û—Ç—Å—Ç—É–ø",chart:"–î–∏–∞–≥—Ä–∞–º–º–∞",title:"–ó–∞–≥–æ–ª–æ–≤–æ–∫",titlePlaceholder:"–ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–∏–∞–≥—Ä–∞–º–º—ã - –¥–≤–æ–π–Ω–æ–π —â–µ–ª—á–æ–∫ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è",background:"–§–æ–Ω",font:"–®—Ä–∏—Ñ—Ç",top:"–í–µ—Ä—Ö",right:"–ü—Ä–∞–≤–æ",bottom:"–ù–∏–∑",left:"–õ–µ–≤–æ",labels:"–ú–µ—Ç–∫–∏",size:"–†–∞–∑–º–µ—Ä",minSize:"–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä",maxSize:"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä",legend:"–õ–µ–≥–µ–Ω–¥–∞",position:"–ü–æ–∑–∏—Ü–∏—è",markerSize:"–†–∞–∑–º–µ—Ä –º–∞—Ä–∫–µ—Ä–∞",markerStroke:"–û–±–≤–æ–¥–∫–∞ –º–∞—Ä–∫–µ—Ä–∞",markerPadding:"–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—Å—Ç—É–ø –º–∞—Ä–∫–µ—Ä–∞",itemSpacing:"–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏",itemPaddingX:"–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—Å—Ç—É–ø –ø—Ä–µ–¥–º–µ—Ç–∞ –ø–æ X",itemPaddingY:"–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—Å—Ç—É–ø –ø—Ä–µ–¥–º–µ—Ç–∞ –ø–æ Y",layoutHorizontalSpacing:"–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø",layoutVerticalSpacing:"–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø",strokeWidth:"–®–∏—Ä–∏–Ω–∞ –æ–±–≤–æ–¥–∫–∏",offset:"–°–º–µ—â–µ–Ω–∏–µ",offsets:"–°–º–µ—â–µ–Ω–∏—è",tooltips:"–í—Å–ø–ª—ã–≤–∞—é—â–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏",callout:"–í—ã–∑–æ–≤",markers:"–ú–∞—Ä–∫–µ—Ä—ã",shadow:"–¢–µ–Ω—å",blur:"–†–∞–∑–º—ã—Ç–∏–µ",xOffset:"–°–º–µ—â–µ–Ω–∏–µ –ø–æ X",yOffset:"–°–º–µ—â–µ–Ω–∏–µ –ø–æ Y",lineWidth:"–®–∏—Ä–∏–Ω–∞ –ª–∏–Ω–∏–∏",normal:"–ù–æ—Ä–º–∞–ª—å–Ω—ã–π",bold:"–ñ–∏—Ä–Ω—ã–π",italic:"–ù–∞–∫–ª–æ–Ω–µ–Ω–Ω—ã–π",boldItalic:"–ñ–∏—Ä–Ω—ã–π –Ω–∞–∫–ª–æ–Ω–µ–Ω–Ω—ã–π",predefined:"–ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π",fillOpacity:"–ù–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∑–∞–ª–∏–≤–∫–∏",strokeOpacity:"–ù–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –ª–∏–Ω–∏–∏",histogramBinCount:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤",columnGroup:"–°—Ç–æ–ª–±–µ—Ü",barGroup:"–ü–∞–Ω–µ–ª—å",pieGroup:"–ö—Ä—É–≥–æ–≤–∞—è",lineGroup:"–õ–∏–Ω–µ–π–Ω–∞—è",scatterGroup:"X Y (–†–∞–∑–±—Ä–æ—Å)",areaGroup:"–ó–æ–Ω–∞–ª—å–Ω–∞—è",histogramGroup:"–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞",groupedColumnTooltip:"–°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è",stackedColumnTooltip:"–°–ª–æ–∂–µ–Ω–Ω–∞—è",normalizedColumnTooltip:"100% –°–ª–æ–∂–µ–Ω–Ω–∞—è",groupedBarTooltip:"–°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è",stackedBarTooltip:"–°–ª–æ–∂–µ–Ω–Ω–∞—è",normalizedBarTooltip:"100% –°–ª–æ–∂–µ–Ω–Ω–∞—è",pieTooltip:"–ö—Ä—É–≥–æ–≤–∞—è",doughnutTooltip:"–ö–æ–ª—å—Ü–µ–≤–∞—è",lineTooltip:"–õ–∏–Ω–µ–π–Ω–∞—è",groupedAreaTooltip:"–ó–æ–Ω–∞–ª—å–Ω–∞—è",stackedAreaTooltip:"–°–ª–æ–∂–µ–Ω–Ω–∞—è",normalizedAreaTooltip:"100% –°–ª–æ–∂–µ–Ω–Ω–∞—è",scatterTooltip:"–†–∞—Å—Å–µ—è–Ω–∏—è",bubbleTooltip:"–ü—É–∑—ã—Ä—å–∫–æ–≤–∞—è",histogramTooltip:"–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞",noDataToChart:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –≤–∏–¥–µ –¥–∏–∞–≥—Ä–∞–º–º—ã.",pivotChartRequiresPivotMode:"–î–ª—è —Å–≤–æ–¥–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º —Å–≤–æ–¥–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã.",chartSettingsToolbarTooltip:"–ú–µ–Ω—é",chartLinkToolbarTooltip:"–°–≤—è–∑–∞—Ç—å —Å —Å–µ—Ç–∫–æ–π",chartUnlinkToolbarTooltip:"–ù–µ —Å–≤—è–∑—ã–≤–∞—Ç—å —Å —Å–µ—Ç–∫–æ–π",chartDownloadToolbarTooltip:"–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—É",ariaHidden:"—Å–∫—Ä—ã—Ç—ã–π",ariaVisible:"–≤–∏–¥–∏–º—ã–π",ariaChecked:"–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π",ariaUnchecked:"–Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π",ariaIndeterminate:"–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π",ariaColumnSelectAll:"–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤",ariaInputEditor:"–†–µ–¥–∞–∫—Ç–æ—Ä –≤–≤–æ–¥–∞",ariaDateFilterInput:"–í–≤–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–∞—Ç—ã",ariaFilterInput:"–í–≤–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞",ariaFilterColumnsInput:"–í–≤–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤",ariaFilterValue:"–ó–Ω–∞—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞",ariaFilterFromValue:"–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è",ariaFilterToValue:"–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –¥–æ –∑–Ω–∞—á–µ–Ω–∏—è",ariaFilteringOperator:"–û–ø–µ—Ä–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏",ariaColumnToggleVisibility:"–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å —Å—Ç–æ–ª–±—Ü–∞",ariaColumnGroupToggleVisibility:"–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –≥—Ä—É–ø–ø—ã —Å—Ç–æ–ª–±—Ü–æ–≤",ariaRowSelect:"–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏",ariaRowDeselect:"–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è —Å–Ω—è—Ç–∏—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏",ariaRowToggleSelection:"–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏",ariaRowSelectAll:"–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫",ariaSearch:"–ü–æ–∏—Å–∫",ariaSearchFilterValues:"–ü–æ–∏—Å–∫ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —Ñ–∏–ª—å—Ç—Ä—É"},K0="fr-hwK2",H0="q08yZhj",U0="_4d2Ra00",ei={table:K0,compact:H0,oddRow:U0},up="ag-d9f5ece0-theme-quartz";pj.registerModules([hj,fj,gj,yj,wj,Sj,xj,bj,vj,jj,Cj,$j]);kj.setLicenseKey("Using_this_{AG_Grid}_Enterprise_key_{AG-086539}_in_excess_of_the_licence_granted_is_not_permitted___Please_report_misuse_to_legal@ag-grid.com___For_help_with_changing_this_key_please_contact_info@ag-grid.com___{EVIRMA}_is_granted_a_{Single_Application}_Developer_License_for_the_application_{EVIRMA}_only_for_{1}_Front-End_JavaScript_developer___All_Front-End_JavaScript_developers_working_on_{EVIRMA}_need_to_be_licensed___{EVIRMA}_has_been_granted_a_Deployment_License_Add-on_for_{1}_Production_Environment___This_key_works_with_{AG_Grid}_Enterprise_versions_released_before_{15_April_2026}____[v3]_[01]_MTc3NjIwNzYwMDAwMA==3c6c96aef283fe84cdec70fb2dab539a");const Q0=42,Y0=48;function Ce({gridRef:e,columnDefs:t,columnsState:s,onColumnsStateChanged:o,defaultColDef:a,style:r,className:i,isCompact:l,onGridReady:c,rowClassRules:d,maxRowsOnScreen:p,defaultExcelExportParams:h,processCellForClipboard:g,onSortChanged:y,...w}){const C=m.useRef(null),j=m.useRef(null),[q,B]=m.useState();m.useImperativeHandle(e,()=>j.current,[]);const X=m.useMemo(()=>({toolPanels:[{id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel",toolPanelParams:{suppressRowGroups:!0,suppressValues:!0,suppressPivots:!0,suppressPivotMode:!0}}]}),[]),U=m.useCallback(ae=>{if(!["autosizeColumns","api"].includes(ae.source)&&o){const $t=ae.api.getColumnState();o($t.filter(Do=>Ql(Do,ae.api)).map(Do=>({...Do,aggFunc:void 0})))}},[o]),fe=m.useCallback(ae=>{U(ae),y&&y(ae)},[U,y]),$e=m.useCallback((ae,nt)=>{if(!s)return;if(!nt){const Zt=s.filter(qn=>Ql(qn,ae)).map(qn=>({...qn,aggFunc:void 0}));ae.applyColumnState({state:Zt,applyOrder:!0});return}const $t=[],Do=new Map(nt.filter(Zt=>Ql(Zt,ae)).map((Zt,qn)=>[Zt.colId,{colState:Zt,index:qn}]));s.forEach(Zt=>{Do.delete(Zt.colId)&&$t.push({...Zt,aggFunc:void 0})}),Do.forEach(({colState:Zt,index:qn})=>{$t.splice(qn,0,Zt)}),ae.applyColumnState({state:$t,applyOrder:!0})},[s]),ut=m.useMemo(()=>({...a,suppressHeaderMenuButton:!0,tooltipComponent:B0,autoHeaderHeight:!0,wrapHeaderText:!0}),[a]),[Y,ce]=m.useState(),se=m.useCallback(()=>{var nt;const ae=((nt=C.current)==null?void 0:nt.closest(`.${Pk}`))||document.body;ae.classList.add(up,ei.popup),ce(ae)},[C]),tt=m.useCallback(ae=>{const nt=ae.api.getColumnState().map($t=>({...$t,aggFunc:void 0}));$e(ae.api,nt),B(nt),se(),c&&c(ae)},[]),Ct=m.useCallback(({defaultItems:ae})=>{const nt={name:dp.resetColumns,action:({api:$t})=>{$t.applyColumnState({state:q,applyOrder:!0})}};return(ae||[]).map($t=>$t==="resetColumns"?nt:$t)},[q]),Vn=m.useMemo(()=>({[ei.oddRow]:ae=>ae.node.rowIndex!==null&&ae.node.rowIndex%2!==0,...d}),[d]),{style:Jr,domLayout:Fo}=m.useMemo(()=>{var ae;return p?w.rowData&&((ae=w.rowData)==null?void 0:ae.length)>=p?{style:{...r,height:p*Q0+Y0},domLayout:void 0}:{style:r,domLayout:"autoHeight"}:{style:r}},[w.rowData]),Zr=m.useMemo(()=>({sheetName:"–î–∞–Ω–Ω—ã–µ",allColumns:!1,columnKeys:(t||[]).filter(G0).map(nt=>nt.field),...h,processCellCallback:(h==null?void 0:h.processCellCallback)||Cn,fileName:`–≠–∫—Å–ø–æ—Ä—Ç_${(h==null?void 0:h.fileName)||""}_${R().format("YYYY-MM-DD_HH-mm")}.xlsx`,shouldRowBeSkipped:nt=>Uy(nt,h==null?void 0:h.shouldRowBeSkipped)}),[h,t]),uv=m.useCallback(ae=>{const nt=Yy(ae.defaultItems);if(typeof w.getContextMenuItems=="function"){const $t=w.getContextMenuItems(ae);return[...nt,...$t]}return nt},[w.getContextMenuItems]);return m.useEffect(()=>{var ae;(ae=j.current)!=null&&ae.api&&$e(j.current.api)},[$e]),n.jsx("div",{ref:C,className:P([up,ei.table,i],{[ei.compact]:l}),style:Jr,children:n.jsx(Nj,{ref:j,localeText:dp,columnDefs:t,columnTypes:z0,defaultColDef:ut,defaultExcelExportParams:Zr,tooltipShowDelay:500,onSortChanged:fe,onColumnMoved:U,onColumnResized:U,onColumnVisible:U,sideBar:X,popupParent:Y,onGridReady:tt,rowClassRules:Vn,domLayout:Fo,getMainMenuItems:Ct,suppressCsvExport:!0,enableRangeSelection:!0,getContextMenuItems:uv,processCellForClipboard:g||Cn,...w})})}const J0="_7q4idcC",Z0={button:J0};function Nu({children:e,onClick:t,className:s}){return n.jsx("div",{className:P(Z0.button,s),onClick:t,children:e})}function xa({api:e,gridRef:t,exportOptions:s,size:o,disabled:a}){const r=()=>{var l;const i=e||((l=t==null?void 0:t.current)==null?void 0:l.api);i&&(s?Qy(i,s):i.exportDataAsExcel())};return n.jsxs(A,{prefix:n.jsx(z.Download,{}),onClick:r,type:"grey",size:o,disabled:a,children:["–≠–∫—Å–ø–æ—Ä—Ç",o!=="small-grid"&&" –≤ Excel"]})}const X0="JpdW2YZ",e1={wrapper:X0};function Nt({onModelChange:e}){const[t,s]=m.useState(""),[o,a]=m.useState("");m.useEffect(()=>{e(r())},[t,o]);const r=()=>t&&o?{filterType:"number",type:"inRange",filter:Number(t),filterTo:Number(o)}:!t&&!o?void 0:{filterType:"number",type:t?"greaterThanOrEqual":"lessThanOrEqual",filter:Number(t||o)},i=({target:{value:c}})=>{s(c)},l=({target:{value:c}})=>{a(c)};return n.jsxs(f,{type:"vertical",gap:"xs",display:"block",className:e1.wrapper,children:[n.jsx("input",{value:t,className:"ag-input-field-input ag-number-field-input",type:"number",min:"0",onInput:i,placeholder:"–û—Ç"}),n.jsx("input",{value:o,className:"ag-input-field-input ag-number-field-input",type:"number",min:"0",onInput:l,placeholder:"–î–æ"})]})}const Tt=e=>{var o,a;const t=e.column.getColDef().field;if(!t)return;const s=(o=e.node)!=null&&o.group?(a=e.node.aggData)==null?void 0:a[t]:ll(e.data,t);return s||0},mp=(e,t,s)=>{const o=t.getSelectedNodes();let a=o.length;s&&(a=o.filter(i=>i.firstChild).length);const r=e.childrenAfterFilter;return{select:a,total:(r==null?void 0:r.length)||e.rowIndex||0}};function Tu({getItemNoun:e=o=>Zs(o,["—ç–ª–µ–º–µ–Ω—Ç","—ç–ª–µ–º–µ–Ω—Ç–∞","—ç–ª–µ–º–µ–Ω—Ç–æ–≤"]),countOnlyMainNodes:t=!1,...s}){const{api:o,node:a}=s,[r,i]=m.useState(()=>mp(a,o,t));return m.useEffect(()=>{const l=()=>i(mp(a,o,t));return o.addEventListener("selectionChanged",l),o.addEventListener("filterChanged",l),()=>{o.removeEventListener("selectionChanged",l),o.removeEventListener("filterChanged",l)}},[]),r.select>0?`${Zs(r.select,["–í—ã–±—Ä–∞–Ω","–í—ã–±—Ä–∞–Ω–æ","–í—ã–±—Ä–∞–Ω–æ"])} ${v.numeric(r.select)} ${e(r.select,!0)}`:`–ò—Ç–æ–≥–æ ${v.numeric(r.total)} ${e(r.total)}`}function t1(e){var o,a;const t=[...((o=e.wordPlus)==null?void 0:o.flatMap(r=>Ft(r).map(i=>i.stem).filter(Boolean)))||[]],s=[...((a=e.wordMinus)==null?void 0:a.flatMap(r=>Ft(r).map(i=>i.stem).filter(Boolean)))||[]];return{plus:[...new Set(t.filter(r=>typeof r=="string"))],minus:[...new Set(s.filter(r=>typeof r=="string"))]}}function s1({onModelChange:e,...t}){const{filters:s}=t,o=m.useMemo(()=>s?t1(s):{plus:[],minus:[]},[s]),a=m.useCallback(()=>o.plus.length===0&&o.minus.length===0?null:{filterType:"stems",filterStems:o},[o]);return Ae.useEffect(()=>{const r=a();e(r)},[o,e,a]),null}const n1="LelteEi",Jy={cellVerticalAlignMiddle:n1};function o1({onWordClick:e,...t}){const{data:s}=t;return s==null?void 0:s.words.map(({word:o,stem:a})=>n.jsxs(m.Fragment,{children:[n.jsx(Hy,{word:o,stem:a,onClick:r=>r.stem?e(r.stem,t):void 0})," "]},o))}const a1="dvNbS-r",r1="SJWhHCs",Yl={default:"pB0DJjb",positive:a1,negative:r1};function so({value:e,formatter:t,showSign:s=!0}){if(e==null)return null;const o=P(Yl.default,{[Yl.positive]:e>0,[Yl.negative]:e<0});let a="";s&&(e>0&&(a="‚ñ≤"),e<0&&(a="‚ñº"));const r=t?t(e):e;return n.jsxs("span",{className:o,children:[a,"¬†",r]})}function i1({value:e}){return n.jsx(so,{formatter:v.percent,value:e||void 0})}const l1=({onWordClick:e})=>[{field:"phrase",filter:"agTextColumnFilter",headerName:dn.phrase,cellRenderer:o1,cellRendererParams:{onWordClick:e},width:380},{field:"freqMonthly",type:["numeric","rightAligned"],filter:"agNumberColumnFilter",headerName:dn.freqMonthly,width:105,sort:"desc",floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt,aggFunc:"sum"},{field:"freqDaily",type:["numeric","rightAligned"],filter:"agNumberColumnFilter",headerName:dn.freqDaily,width:105,floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt,aggFunc:"sum"},{field:"freqWeeklyTrend",type:["rightAligned"],filter:"agNumberColumnFilter",headerName:dn.freqWeeklyTrend,cellRenderer:i1,width:90,floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt},{field:"competition",type:["numeric","rightAligned"],filter:"agNumberColumnFilter",headerName:dn.competition,headerTooltip:"–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–ª—é—á—É –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–µ—Å—è—Ü –ø–æ —ç—Ç–æ–º—É –∫–ª—é—á—É",width:104,floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt},{field:"dr",type:["numeric","rightAligned"],filter:"agNumberColumnFilter",headerName:dn.dr,width:92,floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt},{field:"productCount",type:["numeric","rightAligned"],filter:"agNumberColumnFilter",headerName:dn.productCount,width:100,floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt}],Jl=k("feature/wb-minus-words-stats"),pl={modelName:Jl(),loading:{load:Jl("load")},view:{grid:Jl("view/grid")}},pp={selected:[]},Zy=_({name:pl.modelName,initialState:pp,reducers:{addSelected:(e,{payload:t})=>{e.selected=[...e.selected,t]},removeSelected:(e,{payload:t})=>{e.selected=e.selected.filter(s=>s!==t)},reset:()=>pp}}),c1=E.inject(Zy),{actions:d1}=Zy;function u1(e){const t=new Map;return e.forEach(({words:s,freqMonthly:o})=>{s.forEach(({word:a,stem:r})=>{if(!r)return;let i=t.get(r);i||(i={stem:r,word:a,count:0,freqMonthly:0},t.set(r,i)),i.count+=1,i.freqMonthly+=o||0})}),[...t.values()].sort((s,o)=>o.count-s.count)}const m1=V(pl.modelName,c1),xd=m1("selected"),Xy=$(ku.selectors.list,e=>e?u1(e):wa.array),p1=$([Xy,(e,t)=>t],(e,t)=>{const s=[];return e==null||e.forEach(o=>{o.stem&&(t!=null&&t.includes(o.stem))||s.push(o)}),s}),hp=$([Xy,xd],(e,t)=>{const s=new Set(t),o=[];return e==null||e.forEach(a=>{a.stem&&s.delete(a.stem)&&o.push(a)}),o}),h1={selected:xd,selectedStems:hp,useSelected:b(hp),useSelectedStems:b(xd),useFilteredData:te(p1)};function f1({onWordClick:e,...t}){const{data:s}=t;if(s)return n.jsx(Hy,{word:s.word,stem:s.stem,onClick:o=>o.stem?e(o.stem,t):void 0})}const Jo={word:"–°–ª–æ–≤–æ",stem:"–ö–æ—Ä–µ–Ω—å",freqMonthly:"–°—É–º–º–∞—Ä–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞",count:"–ö–æ–ª-–≤–æ —Ñ—Ä–∞–∑"},g1=({onWordClick:e})=>[{field:"word",filter:"agTextColumnFilter",headerName:Jo.word,cellRenderer:f1,cellRendererParams:{onWordClick:e}},{field:"stem",filter:"agTextColumnFilter",headerName:Jo.stem},{field:"freqMonthly",type:["numeric","rightAligned"],filter:"agTextColumnFilter",headerName:Jo.freqMonthly,sort:"desc"},{field:"count",type:["numeric","rightAligned"],filter:"agTextColumnFilter",headerName:Jo.count}];function y1({data:e,gridRef:t,style:s,onWordClick:o}){const a=he(pl.view.grid),r=m.useMemo(()=>[...g1({onWordClick:o})],[o]),i=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:r,defaultColDef:i,columnsState:a.state,onColumnsStateChanged:a.save})}const Pt={config:pl,selectors:h1,actions:d1},w1="DSdb8CE",S1="eiw8-Xo",x1="yitL--S",bd={headerRowsReversed:w1,compact:S1,downloadButton:x1},b1=["phrase","freqMonthly","freqDaily","freqWeeklyTrend","competition","dr","productCount","subject"],fp=["word","stem","count","freqMonthly"];function Zl(e,t,s){const o=e.map(a=>t.reduce((r,i)=>(r[s[i]]=a[i],r),{}));return Yo.json_to_sheet(o,{header:t.map(a=>s[a])})}function v1({ignoreWords:e=[],phrases:t=[],words:s=[]}){const o=Yo.book_new(),a=Zl(t,b1,dn);a["!cols"]=[{wch:50}],Yo.book_append_sheet(o,a,"–ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã");const r=Zl(s,fp,Jo);r["!cols"]=[{wch:25},{wch:25}],Yo.book_append_sheet(o,r,"–°–ª–æ–≤–∞");const i=Zl(e,fp,Jo);i["!cols"]=[{wch:25},{wch:25}],Yo.book_append_sheet(o,i,"–ò—Å–∫–ª—é—á–µ–Ω–∏—è");const l=Tj(o,{type:"array",bookType:"xlsx"}),c=[W.appName,new Date().toJSON().replace(/\D+/g,""),"keywords",...e.map(({stem:d})=>d)];return{blob:new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),fileName:`${c.join("-")}.xlsx`}}function j1(){const e=Pt.selectors.useSelectedStems(),t=Pt.selectors.useSelected(),s=is.selectors.useFilteredData(e),o=Pt.selectors.useFilteredData(e),a=()=>{const{blob:r,fileName:i}=v1({phrases:s,words:o,ignoreWords:t});Pv.saveAs(r,i)};return n.jsx(A,{className:bd.downloadButton,type:"purple",prefix:n.jsx(z.Excel,{}),disabled:(s==null?void 0:s.length)===0&&(o==null?void 0:o.length)===0,onClick:a,size:"small",children:"–°–∫–∞—á–∞—Ç—å –≤ Excel"})}function C1({data:e,gridRef:t,style:s,onWordClick:o}){const a=he(Us.view.grid),r=m.useMemo(()=>[...l1({onWordClick:o})],[o]),i=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),l=m.useMemo(()=>({statusPanels:[{statusPanel:j1,align:"left"}]}),[]);return n.jsx(Ce,{isCompact:!0,className:P(bd.headerRowsReversed,bd.compact),gridRef:t,style:s,rowData:e,grandTotalRow:"bottom",statusBar:l,columnDefs:r,defaultColDef:i,columnsState:a.state,onColumnsStateChanged:a.save,floatingFiltersHeight:56})}const is={actions:Oy,config:Us,sagas:R0,selectors:O0},$1=k("widget/wb-minus-phrase-modal"),k1={modelName:$1()},N1="_4cE5r0O",T1={loader:N1};function le(){return n.jsx("div",{className:T1.loader,children:n.jsx(As,{})})}function P1(){const e=Pt.selectors.useSelectedStems(),t=is.selectors.useFilteredData(e),{addSelected:s}=x(Pt.actions);return t?n.jsx(C1,{data:t,style:{flex:1,fontWeight:400},onWordClick:o=>{s(o)}}):null}function M1(){const e=Pt.selectors.useSelectedStems(),t=Pt.selectors.useFilteredData(e),{addSelected:s}=x(Pt.actions);return t?n.jsx(y1,{data:t,style:{flex:1,fontWeight:400},onWordClick:o=>{s(o)}}):null}function F1({onSelected:e,selected:t}){const s=Pt.selectors.useSelectedStems(),o=is.selectors.useFilteredData(s),a=Pt.selectors.useFilteredData(s),r=m.useMemo(()=>[{value:"phrases",label:"–ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã",badge:(o==null?void 0:o.length)||0},{value:"words",label:"–°–ª–æ–≤–∞",badge:(a==null?void 0:a.length)||0}],[o,a]);return n.jsx(an,{value:t,options:r,onChange:e})}const gp=e=>({value:JSON.stringify(e),label:`${e.word} (${e.count})`});function D1(){const e=m.useRef(null),t=Pt.selectors.useSelected(),s=Pt.selectors.useSelectedStems(),o=Pt.selectors.useFilteredData(s),{addSelected:a,removeSelected:r,reset:i}=x(Pt.actions),l=m.useCallback(h=>{const g=JSON.parse(h.value);g.stem&&a(g.stem)},[t]),c=m.useCallback(h=>{var y;const g=(y=t==null?void 0:t[h])==null?void 0:y.stem;g&&r(g)},[t]),d=m.useMemo(()=>t.map(gp),[t]),p=m.useMemo(()=>o.map(gp),[o]);return m.useEffect(()=>()=>{i()},[]),m.useEffect(()=>{e.current&&e.current.listBox.expand()},[e]),o?n.jsx(Mv,{ref:e,labelText:"–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ",selected:d,suggestions:p,onAdd:l,onDelete:c,noOptionsText:"–ù–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–µ",placeholderText:"–ò—Å–∫–ª—é—á–∏—Ç—å —Ñ—Ä–∞–∑—ã —Å —Å–ª–æ–≤–æ–º"}):null}function A1(){const[e,t]=m.useState("phrases"),s=Z.selectors.useError(is.config.loading.load),o=G.selectors.useLoader(is.config.loading.load),a=m.useMemo(()=>{switch(e){case"phrases":return n.jsx(P1,{});case"words":return n.jsx(M1,{})}},[e]);return o?n.jsx(le,{}):s?n.jsx(ee,{value:s}):n.jsxs(f,{type:"vertical",gap:"l",style:{height:"100%"},children:[n.jsxs(f,{justify:"space-between",type:"horizontal",gap:"s",display:"block",children:[n.jsx("div",{style:{flex:1},children:n.jsx(F1,{selected:e,onSelected:t})}),n.jsx("div",{style:{width:300}})]}),n.jsxs(f,{type:"horizontal",gap:"s",wrap:!1,style:{width:"100%",height:"100%"},children:[a,n.jsx("div",{style:{width:300},children:n.jsx(f,{type:"vertical",gap:"4xl",style:{height:"100%"},children:n.jsx(D1,{})})})]})]})}function L1({searchQuery:e}){const[t,s]=m.useState(e),{load:o}=x(is.actions),a=G.selectors.useLoader(is.config.loading.load),r=i=>{i.preventDefault(),t&&o(t)};return m.useEffect(()=>{e&&o(e)},[e]),n.jsxs(f,{type:"horizontal",gap:"s",wrap:!1,as:"form",onSubmit:r,children:[n.jsx(xe,{disabled:a,value:t,onChange:i=>s(i.target.value)}),n.jsx(A,{type:"purple",htmlType:"submit",disabled:(t==null?void 0:t.length)===0,isLoading:a,children:"–ü–æ–¥–æ–±—Ä–∞—Ç—å —Ñ—Ä–∞–∑—ã"})]})}function R1(){const e=ju.selectors.useQueryParams(),t=m.useMemo(()=>({search:fy(e.search)}),[e]);return n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(L1,{searchQuery:t.search}),n.jsx("div",{style:{height:"70vh"},children:n.jsx(A1,{})})]})}function E1(){const e=is.selectors.useShowModal(),{setShowModal:t}=x(is.actions);return m.useEffect(()=>{e&&Te.pageView(k1.modelName)},[e]),n.jsx(Ye,{open:e,onCloseClick:()=>t(!1),title:"–ü–æ–¥–±–æ—Ä –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑",style:{width:"90vw",maxWidth:1400},children:n.jsx(H,{children:n.jsx(R1,{})})})}const yp=k("widget/wb-warehouse-analyze-modal"),en={modelName:yp(),loading:{load:yp("load")},storage:{destinations:"widgets/wb-warehouse-analyze-modal/destinations"}},wp=Q(en.modelName),Xl={form:{nms:[],destinations:[],nmOur:void 0,queries:[],autoSubmit:!1}},ew=_({name:en.modelName,initialState:Xl,reducers:{setSearchParams:D("searchParams"),setShowModal:D("showModal"),setForm:Je("form"),resetForm:Le("form",Xl.form),setView:D("view"),resetResult:e=>({form:e.form}),reset:()=>Xl}}),_1=E.inject(ew),mo={...ew.actions,load:wp("load"),loadAbort:wp("load-abort")},ti=k("feature/wb-region-search-position-stats"),ks={modelName:ti(),loading:{load:ti("load")},analytic:{showModal:"showModal"},view:{grid:ti("view/grid"),chart:ti("view/chart")},productsLookLimit:1e3},Sp=Q(ks.modelName),si={loading:{},priorityWarehouseLoading:{}},tw=_({name:ks.modelName,initialState:si,reducers:{setSearchParams:D("searchParams"),setLoading:wt("loading"),setLoadingMany:D("loading"),resetLoading:Le("loading",si.loading),setPriorityWarehouseLoading:wt("priorityWarehouseLoading"),setPriorityWarehouseLoadingMany:D("priorityWarehouseLoading"),resetPriorityWarehouseLoading:Le("priorityWarehouseLoading",si.priorityWarehouseLoading),reset:()=>si}}),I1=E.inject(tw),yn={...tw.actions,load:Sp("load"),loadAbort:Sp("load-abort")},xp=k("entity/wb/search-position"),hl={modelName:xp(),view:{alertAndroid:xp("view/alert-android")}},Wn={keyword:{},catalog:{},query:{},region:{},recommendation:{}},sw=_({name:hl.modelName,initialState:Wn,reducers:{addKeyword:wt("keyword"),addQuery:wt("query"),addCatalog:wt("catalog"),addRegion:wt("region"),addRecommendation:wt("recommendation"),resetKeyword:Le("keyword",Wn.keyword),resetQuery:Le("query",Wn.query),resetCatalog:Le("catalog",Wn.catalog),resetRegion:Le("region",Wn.region),resetRecommendation:Le("recommendation",Wn.recommendation),reset:()=>Wn}}),O1=E.inject(sw),ba={...sw.actions},Lr=V(hl.modelName,O1),V1=Lr("keyword"),q1=Lr("query"),B1=Lr("catalog"),W1=Lr("region"),z1=Lr("recommendation"),G1={keyword:V1,query:q1,catalog:B1,region:W1,recommendation:z1};function va(e,t){const s=Math.floor(e/1e5),o=Math.floor(e/1e3),a=t.find(({vol_range_to:r,vol_range_from:i})=>s>=i&&s<=r);if(a)return`https://${a.host}/vol${s}/part${o}/${e}/images/tm/1.webp`}const Ba={organicPosition:"–û—Ä–≥ –ø–æ–∑",promoPosition:"–†–µ–∫ –ø–æ–∑",promoCpm:"CPM, ‚ÇΩ",promoType:"–¢–∏–ø –†–ö",ctr:"CTR, %"};function K1({query:e,dest:t,page:s,searchPosition:o,product:a}){var l,c,d;const r={nm:a.id,organicPosition:o,dest:t,page:s,query:e};return!!((l=a.log)!=null&&l.cpm)||!!a.logs?(r.promoType="unknown",r.promoPosition=o):r.organicPosition=o,(c=a==null?void 0:a.log)!=null&&c.position&&(r.organicPosition=a.log.position,r.promoPosition=a.log.promoPosition?a.log.promoPosition:void 0,r.promoCpm=a.log.cpm,r.promoType=(d=a==null?void 0:a.log)==null?void 0:d.tp),r}const ja={fromSearch:K1},Rr=e=>{switch(e){case"b":return"–ê–†–ö";case"c":return"–ê–£–ö–¶";case"unknown":return"—Ä–µ–∫–ª–∞–º–∞";default:return e}},H1="A9bEEN4",U1="x-3oNJ2",Q1="_4TDgV7n",Y1="ubvh6F7",ni={c:H1,b:U1,unknown:Q1,badge:Y1},fl=(e,t=!0)=>{const s={[ni.badge]:t};switch(e){case"b":return P(ni.b,s);case"c":return P(ni.c,s);case"unknown":return P(ni.unknown,s);default:return}};function gl({query:e,dest:t,nm:s}){return`query:${e}/dest:${t}/nm:${s}`}function ec(e){return e.filter(Boolean).join(" / ")}function Pu(e){if(!(e!=null&&e.result))return"‚Äî";const{organicPosition:t,promoPosition:s,promoCpm:o,promoCtr:a,outOfRangeValue:r,notFoundReason:i,promoType:l}=e.result;if(i)switch(i){case"outOfRange":return`>${r}`;case"error":return"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ–∑–∏—Ü–∏–∏";default:return"‚Äî"}return l&&l!=="unknown"?ec([`${t} ‚Üí ${s}`,o&&`CPM ${o||0}‚ÇΩ`,a&&`CTR ${a||0}%`,Rr(l)]):l?ec([`üîä ${s}`,a?`CTR ${a||0}%`:void 0]):t?ec([t,a?`CTR ${a||0}%`:void 0]):"‚Äî"}function*Er({pageFrom:e=1,nms:t,dest:s,query:o,productsLookLimit:a,putEffect:r,request:i,mapper:l,onPage:c}){var g;const d=new Set(t);let p=(e-1)*100,h=e;try{for(;p<a;){const y=yield ia(i,h);if(!((g=y.data)!=null&&g.products))break;c&&(yield u(c,{products:y.data.products,page:h,metadata:y.metadata,total:y.data.total}));for(const w of y.data.products)if(p+=1,d.delete(w.id)&&(yield r(l({product:w,searchPosition:p,dest:s,page:h,query:o}))),d.size===0)return;if(p>=y.data.total)break;h+=1}yield I(Array.from(d,y=>r({nm:y,dest:s,page:h,query:o,notFoundReason:"outOfRange",outOfRangeValue:a})))}catch{yield I(Array.from(d,y=>r({nm:y,dest:s,page:h,query:o,failedNms:[...d.values()],notFoundReason:"error",outOfRangeValue:a})))}}function*J1({keyword:e,dest:t,nms:s,pageFrom:o,productsLookLimit:a,onPage:r}){yield u(Er,{nms:s,dest:t,query:e,pageFrom:o,productsLookLimit:a,request:(i,l)=>Pr.search({query:e,page:i,dest:t},l),putEffect:i=>S(ba.addKeyword({key:e,value:i})),mapper:ja.fromSearch,onPage:r})}function*Z1({keyword:e,dest:t,nms:s,pageFrom:o,productsLookLimit:a}){yield u(Er,{nms:s,dest:t,query:e,pageFrom:o,productsLookLimit:a,request:(r,i)=>Pr.search({query:e,page:r,dest:t},i),putEffect:r=>S(ba.addQuery({key:e,value:r})),mapper:ja.fromSearch})}function*X1({query:e,shard:t,id:s,dest:o,nms:a,pageFrom:r,productsLookLimit:i}){yield u(Er,{nms:a,dest:o,query:e,pageFrom:r,productsLookLimit:i,request:(l,c)=>n$.search({shard:t,query:e,page:l,dest:o},c),putEffect:l=>S(ba.addCatalog({key:s,value:l})),mapper:ja.fromSearch})}function*eN({keyword:e,dest:t,nms:s,pageFrom:o,productsLookLimit:a,onPage:r,onSearchingFinally:i}){yield u(Er,{nms:s,dest:t,query:e,pageFrom:o,productsLookLimit:a,request:(l,c)=>Pr.search({query:e,page:l,dest:t},c),putEffect:l=>{const c=[S(ba.addRegion({key:gl({query:e,dest:t,nm:l.nm}),value:l}))];return i&&c.push(u(i,l.nm)),I(c)},mapper:ja.fromSearch,onPage:r})}function*tN({nms:e,nm:t,dest:s,pageFrom:o,productsLookLimit:a}){yield u(Er,{nms:e,dest:s,query:`–ø–æ—Ö–æ–∂–∏–µ ${t}`,pageFrom:o,productsLookLimit:a,request:(r,i)=>wy.search({query:`–ø–æ—Ö–æ–∂–∏–µ ${t}`,page:r,dest:s},i),putEffect:r=>S(ba.addRecommendation({key:t.toString(),value:r})),mapper:ja.fromSearch})}const sN={searchKeywordPosition:J1,searchQueryPosition:Z1,searchCatalogPosition:X1,searchRegionPosition:eN,searchRecommendationPosition:tN},nN="-iTMcFz",oN="_6aAhiCw",aN="kvz0VMK",rN="_7PCFtd-",iN="e2N5OJR",lN="E7OWQY5",cN="ZlUvSfi",dN="_3WuTH3N",uN="_2YDPqQW",_t={warningIcon:nN,promoIcon:oN,wrapper:aN,clickable:rN,organicPosition:iN,promoPosition:lN,promoType:cN,promoCtr:dN,position:uN};function Mu({position:e,onRepeatClick:t}){if(!e)return n.jsx(n.Fragment,{children:"?"});let s=null;e.promoCtr&&(s=n.jsx(Oe,{overlay:"CTR",placement:"top",children:n.jsx(be,{type:"gray",size:"small",className:_t.promoCtr,children:v.percent(e.promoCtr,{fraction:2})})}));let o=null;if(e.promoName&&(o=n.jsx(Oe,{overlay:e.promoName,placement:"top",children:n.jsx(z.Sale,{className:_t.promoIcon})})),e.notFoundReason)switch(e.notFoundReason){case"outOfRange":return n.jsxs("span",{className:P({[_t.clickable]:!!t}),onClick:()=>t&&t(),children:[">",e.outOfRangeValue]});case"error":return n.jsxs(f,{type:"horizontal",align:"center",wrap:!1,children:[n.jsx(Oe,{placement:"top",overlay:"–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–æ–∑–∏—Ü–∏—é",children:n.jsx(z.Warning,{className:_t.warningIcon})}),t&&n.jsx(A,{size:"small-grid",onClick:()=>t(),children:"–ø–æ–≤—Ç–æ—Ä–∏—Ç—å"})]});default:return n.jsx(n.Fragment,{children:"‚Äî"})}return e.promoType&&e.promoType!=="unknown"?n.jsxs(f,{type:"vertical",align:"start",justify:"center",display:"block",gap:0,className:P(_t.wrapper,{[_t.clickable]:!!t}),onClick:()=>t&&t(),children:[n.jsxs(f,{gap:"xs",align:"center",wrap:!1,className:_t.position,children:[n.jsx("span",{className:_t.organicPosition,children:v.numeric(e.organicPosition)}),"‚Üí",n.jsx("span",{className:_t.promoPosition,children:v.numeric(e.promoPosition)}),s]}),n.jsxs(f,{gap:"xs",align:"center",wrap:!1,children:[o,n.jsxs("span",{className:_t.promoType,children:[n.jsx("span",{children:v.numeric(e.promoCpm,{fraction:0})}),n.jsxs("span",{children:["¬†(",Rr(e.promoType),")"]})]})]})]}):e.promoType?n.jsxs(f,{gap:"s",align:"center",wrap:!1,className:P({[_t.clickable]:!!t}),onClick:()=>t&&t(),children:[o,n.jsx(Oe,{placement:"top",overlay:"–†–µ–∫–ª–∞–º–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è",children:n.jsx(z.Megaphone,{})}),n.jsx("span",{children:v.numeric(e.promoPosition)}),s]}):n.jsxs(f,{gap:"s",align:"center",wrap:!1,className:P(_t.wrapper,{[_t.clickable]:!!t}),onClick:()=>t&&t(),children:[o,n.jsx("span",{children:v.numeric(e.organicPosition)}),s]})}const mN="kPUz5p6",pN={alert:mN};function Ln({showLogo:e,className:t}){var d;const{host:s}=window.location,[o,a]=m.useState(!1),r=he(hl.view.alertAndroid,{withLoad:!0}),i=()=>a(!0),l=()=>{a(!1)},c=()=>{r.save({...r.state||{},[s]:!0}),a(!1)};return!r.isReady||(d=r.state)!=null&&d[s]?null:n.jsxs(n.Fragment,{children:[n.jsx(dt,{type:"warning",message:`–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π –ø–ª–∞–≥–∏–Ω –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–∏—Å–∫–æ–≤–æ–π –≤—ã–¥–∞—á–∏ ${W.wb.name} –¥–ª—è Android`,onCloseClick:i,className:P(pN.alert,t),showLogo:e}),n.jsx(Ye,{open:o,title:"–ü–æ–∑–∏—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤",onCloseClick:l,style:{width:370},children:n.jsxs(f,{type:"vertical",gap:"4xl",children:["–°–∫—Ä—ã—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ?",n.jsx(f,{type:"vertical",gap:"l",children:n.jsx(A,{type:"purple",onClick:c,children:"–°–∫—Ä—ã—Ç—å"})})]})})]})}const Ke={config:hl,actions:ba,selectors:G1,sagas:sN},hN=k("entity/wb/warehouse-stats"),Fu={modelName:hN()},oi={list:{},queries:{}},nw=_({name:Fu.modelName,initialState:oi,reducers:{setList:wt("list"),resetList:Le("list",oi.list),setQueries:wt("queries"),resetQueries:Le("queries",oi.queries),reset:()=>oi}}),fN=E.inject(nw),Du={...nw.actions},ow=V(Fu.modelName,fN),gN=ow("list"),yN=ow("queries"),wN={list:gN,queries:yN},SN=k("entity/wb/static-data"),ko={modelName:SN()},xN=[{name:"–ú–æ—Å–∫–≤–∞",id:1,points:[{dest:-364001,name:"–ú–æ—Å–∫–≤–∞ –¶–µ–Ω—Ç—Ä",address:"–ú–∏–ª—é—Ç–∏–Ω—Å–∫–∏–π –ø–µ—Ä–µ—É–ª–æ–∫",people:13104,seo:!0},{dest:-445285,name:"–ú–æ—Å–∫–≤–∞ –°–µ–≤–µ—Ä",address:"–î—É–±–Ω–∏–Ω—Å–∫–∞—è –£–ª–∏—Ü–∞",people:13104,seo:!1},{dest:12358265,name:"–ú–æ—Å–∫–≤–∞ –ó–∞–ø–∞–¥",address:"—É–ª–∏—Ü–∞ –ò–≤–∞–Ω–∞ –§—Ä–∞–Ω–∫–æ",people:13104,seo:!1},{dest:-950641,name:"–ú–æ—Å–∫–≤–∞ –Æ–≥",address:"—É–ª–∏—Ü–∞ –ë–µ—Ö—Ç–µ—Ä–µ–≤–∞",people:13104,seo:!1},{dest:-1298976,name:"–ú–æ—Å–∫–≤–∞ –í–æ—Å—Ç–æ–∫",address:"–°–≤–æ–±–æ–¥–Ω—ã–π –ü—Ä–æ—Å–ø–µ–∫—Ç",people:13104,seo:!1}]},{name:"–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",id:2,points:[{dest:123586150,name:"–ö–æ–ª–æ–º–Ω–∞",address:"—É–ª–∏—Ü–∞ 3-–≥–æ –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∞",people:133},{dest:123586181,name:"–û—Ä–µ—Ö–æ–≤–æ-–ó—É–µ–≤–æ",address:"–ú–∞–¥–æ–Ω—Å–∫–∞—è —É–ª–∏—Ü–∞",people:106},{dest:123586098,name:"–ë–∞–ª–∞—à–∏—Ö–∞",address:"–ü—Ä–æ—Å–ø–µ–∫—Ç –õ–µ–Ω–∏–Ω–∞",people:527,seo:!0},{dest:123586218,name:"–ü–æ–¥–æ–ª—å—Å–∫",address:"–ö–æ–º—Å–æ–º–æ–ª—å—Å–∫–∞—è –£–ª–∏—Ü–∞",people:312}]},{name:"–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –§–û",id:3,points:[{dest:-3339991,name:"–°–º–æ–ª–µ–Ω—Å–∫",address:"–£–ª–∏—Ü–∞ –ü—Ä–∂–µ–≤–∞–ª—å—Å–∫–æ–≥–æ",people:313,seo:!0},{dest:-1263279,name:"–¢–≤–µ—Ä—å",address:"–ü–æ–∂–∞—Ä–Ω–∞—è –ü–ª–æ—â–∞–¥—å",people:415,seo:!0},{dest:-5817685,name:"–†—è–∑–∞–Ω—å",address:"–£–ª–∏—Ü–∞ –ï—Å–µ–Ω–∏–Ω–∞",people:523,seo:!0},{dest:123586188,name:"–¢–∞–º–±–æ–≤",address:"–°–æ–≤–µ—Ç—Å–∫–∞—è –£–ª–∏—Ü–∞",people:259},{dest:12358385,name:"–í–æ—Ä–æ–Ω–µ–∂",address:"20-–õ–µ—Ç–∏—è –û–∫—Ç—è–±—Ä—è",people:1052,seo:!0},{dest:-4734876,name:"–õ–∏–ø–µ—Ü–∫",address:"–£–ª–∏—Ü–∞ –ó–µ–≥–µ–ª—è",people:490},{dest:-2307160,name:"–ö—É—Ä—Å–∫",address:"–£–ª–∏—Ü–∞ –†–∞–¥–∏—â–µ–≤–∞",people:435},{dest:-5663270,name:"–¢—É–ª–∞",address:"–£–ª–∏—Ü–∞ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏",people:467},{dest:-3351953,name:"–Ø—Ä–æ—Å–ª–∞–≤–ª—å",address:"—É–ª–∏—Ü–∞ –¢—Ä–µ—Ñ–æ–ª–µ–≤–∞",people:571,seo:!0},{dest:123585474,name:"–ë–µ–ª–≥–æ—Ä–æ–¥",address:"–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ –ø–æ–ª–∫–∞",people:334},{dest:-5518648,name:"–ë—Ä—è–Ω—Å–∫",address:"–ø—Ä–æ—Å–ø–µ–∫—Ç –õ–µ–Ω–∏–Ω–∞",people:376}]},{name:"–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –§–û",id:4,points:[{dest:123585979,name:"–í–æ–ª–æ–≥–¥–∞",address:"–ø—Ä–æ—Å–ø–µ–∫—Ç –ü–æ–±–µ–¥—ã",people:312},{dest:-1187265,name:"–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",address:"—É–ª–∏—Ü–∞ –ü–æ–±–µ–¥—ã",people:5600,seo:!0},{dest:-1197810,name:"–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ 2",address:"–î–∏–º–∏—Ç—Ä–æ–≤–∞",people:5600,seo:!1},{dest:-1965487,name:"–ú—É—Ä–º–∞–Ω—Å–∫",address:"–ê–∫–∞–¥–µ–º–∏–∫–∞ –ö–Ω–∏–ø–æ–≤–∏—á–∞",people:267},{dest:-331412,name:"–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥",address:"–°–µ–≤–∞—Å—Ç—å—è–Ω–æ–≤–∞",people:490}]},{name:"–ü—Ä–∏–≤–æ–ª–∂—Å–∫–∏–π –§–û",id:5,points:[{dest:-2448021,name:"–¢–æ–ª—å—è—Ç—Ç–∏",address:"–£–ª–∏—Ü–∞ –ú–∏—Ä–∞",people:675,seo:!0},{dest:12358461,name:"–°–∞—Ä–∞—Ç–æ–≤",address:"–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –£–ª–∏—Ü–∞",people:892,seo:!0},{dest:-412732,name:"–ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã",address:"17-–ô –ö–æ–º–ø–ª–µ–∫—Å",people:546},{dest:12358312,name:"–û—Ä–µ–Ω–±—É—Ä–≥",address:"–ü—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∞—è –¥. 17",people:539},{dest:-1257218,name:"–°–∞–º–∞—Ä–∞",address:"–õ—å–≤–∞ –¢–æ–ª—Å—Ç–æ–≥–æ 14",people:1164,seo:!0},{dest:12358495,name:"–£—Ñ–∞",address:"–†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–∞—è —É–ª–∏—Ü–∞",people:1158,seo:!0},{dest:-2133462,name:"–ö–∞–∑–∞–Ω—å",address:"—É–ª–∏—Ü–∞ –ü—É—à–∫–∏–Ω–∞",people:1315,seo:!0},{dest:-2689194,name:"–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫",address:"–ö–∏—Ä–æ–≤–∞",people:534,seo:!0},{dest:-3889738,name:"–ß–µ–±–æ–∫—Å–∞—Ä—ã",address:"–ë–∞–π–¥—É–ª–∞",people:496},{dest:12358535,name:"–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥",address:"–î–æ–±—Ä–æ–ª—é–±–æ–≤–∞",people:1213,seo:!0},{dest:-3155928,name:"–£–ª—å—è–Ω–æ–≤—Å–∫",address:"–ó–∞—Ä–µ—á–Ω–∞—è",people:613},{dest:-5892277,name:"–ü–µ–Ω–∑–∞",address:"–ú–∞–∫—Å–∏–º–∞ –ì–æ—Ä—å–∫–æ–≥–æ",people:492},{dest:-971646,name:"–ò–∂–µ–≤—Å–∫",address:"–ü—É—à–∫–∏–Ω—Å–∫–∞—è",people:621},{dest:12358361,name:"–ü–µ—Ä–º—å",address:"–ü–µ—Ä–º—Å–∫–∞—è",people:1027,seo:!0},{dest:-2361093,name:"–ö–∏—Ä–æ–≤",address:"–ú–æ—Å–∫–æ–≤—Å–∫–∞—è",people:472},{dest:123586028,name:"–°–∞—Ä–∞–Ω—Å–∫",address:"–ü—Ä–æ—Å–ø–µ–∫—Ç –õ–µ–Ω–∏–Ω–∞",people:472}]},{name:"–Æ–∂–Ω—ã–π –§–û",id:6,points:[{dest:-4039466,name:"–í–æ–ª–≥–æ–≥—Ä–∞–¥",address:"–ö–æ–º—Å–æ–º–æ–ª—å—Å–∫–∞—è –£–ª–∏—Ü–∞",people:1026,seo:!0},{dest:-2228364,name:"–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É",address:"–°—É–≤–æ—Ä–æ–≤–∞",people:1136,seo:!0},{dest:-10106464,name:"–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å",address:"–¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—É–ª–æ–∫",people:469},{dest:12358058,name:"–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä",address:"–†–∞—à–ø–∏–ª–µ–≤—Å–∫–∞—è –£–ª–∏—Ü–∞",people:1121,seo:!0},{dest:123585942,name:"–í–æ–ª–∂—Å–∫–∏–π",address:"–≠–Ω–≥–µ–ª—å—Å–∞",people:317},{dest:-1116490,name:"–°–æ—á–∏",address:"–ü–µ—Ä–µ—É–ª–æ–∫ –ì–æ—Ä—å–∫–æ–≥–æ",people:447}]},{name:"–°–µ–≤–µ—Ä–æ-–ö–∞–≤–∫–∞–∑—Å–∫–∏–π –§–û",id:7,points:[{dest:-5921133,name:"–ú–∞—Ö–∞—á–∫–∞–ª–∞",address:"–î–∞–Ω–∏—è–ª–æ–≤–∞",people:623,seo:!0},{dest:-5856841,name:"–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å",address:"–ó–æ–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ü–µ—Ä–µ—É–ª–æ–∫",people:550},{dest:-3888337,name:"–ì—Ä–æ–∑–Ω—ã–π",address:"–ú—É—Å–ª–∏–º–∞ –ì–∞–π—Ä–±–µ–∫–æ–≤–∞",people:331,seo:!0}]},{name:"–£—Ä–∞–ª—å—Å–∫–∏–π –§–û",id:8,points:[{dest:123585969,name:"–ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫",address:"–°—Ç—Ä–æ–∏—Ç–µ–ª–µ–π",people:409,seo:!0},{dest:-897988,name:"–¢—é–º–µ–Ω—å",address:"–ì–∞–∑–æ–≤–∏–∫–æ–≤",people:856,seo:!0},{dest:-1579833,name:"–ß–µ–ª—è–±–∏–Ω—Å–∫",address:"–°–æ–≤–µ—Ç—Å–∫–∞—è –£–ª–∏—Ü–∞",people:1183,seo:!0},{dest:-5803327,name:"–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",address:"–ú–∞—Ä—à–∞–ª–∞ –ñ—É–∫–æ–≤–∞",people:1539,seo:!0},{dest:123585853,name:"–°—É—Ä–≥—É—Ç",address:"–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–æ–≤",people:407}]},{name:"–°–∏–±–∏—Ä—Å–∫–∏–π –§–û",id:9,points:[{dest:-3902910,name:"–û–º—Å–∫",address:"–ì–µ—Ä—Ü–µ–Ω–∞",people:1111,seo:!0},{dest:-1172839,name:"–ö–µ–º–µ—Ä–æ–≤–æ",address:"–ù–∏–∫–æ–ª–∞—è –û—Å—Ç—Ä–æ–≤—Å–∫–æ–≥–æ",people:549},{dest:-364763,name:"–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫",address:"–°–æ–≤–µ—Ç—Å–∫–∞—è",people:1635,seo:!0},{dest:-4028307,name:"–ë–∞—Ä–Ω–∞—É–ª",address:"–ø—Ä–æ—Å–ø–µ–∫—Ç –õ–µ–Ω–∏–Ω–∞",people:623},{dest:12356481,name:"–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫",address:"–ö–∞—Ä–ª–∞ –ú–∞—Ä–∫—Å–∞",people:1197,seo:!0},{dest:-3224247,name:"–¢–æ–º—Å–∫",address:"–£—Å–æ–≤–∞",people:552},{dest:-5551586,name:"–ß–∏—Ç–∞",address:"–ê–Ω–æ—Ö–∏–Ω–∞",people:334}]},{name:"–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π –§–û",id:10,points:[{dest:123585755,name:"–Ø–∫—É—Ç—Å–∫",address:"–ø—Ä–æ—Å–ø–µ–∫—Ç –õ–µ–Ω–∏–Ω–∞",people:361},{dest:-1785058,name:"–•–∞–±–∞—Ä–æ–≤—Å–∫",address:"–ü—É—à–∫–∏–Ω–∞",people:617,seo:!0},{dest:123585533,name:"–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫",address:"–õ–µ–Ω–∏–Ω–∞",people:241},{dest:123586013,name:"–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫",address:"–°—Ç–∞–Ω—é–∫–æ–≤–∏—á–∞",people:597,seo:!0}]},{name:"–í–æ—Å—Ç–æ—á–Ω–æ-–°–∏–±–∏—Ä—Å–∫–∏–π –§–û",id:11,points:[{dest:-5827722,name:"–ò—Ä–∫—É—Ç—Å–∫",address:"–†–∞–±–æ—á–µ–≥–æ –®—Ç–∞–±–∞",people:611,seo:!0}]},{name:"–î—Ä—É–≥–∏–µ —Ä–µ–≥–∏–æ–Ω—ã –ï–ê–≠–°",id:12,points:[{dest:-59208,name:"–ë–µ–ª–∞—Ä—É—Å—å (–ú–∏–Ω—Å–∫)",address:"–ø—Ä–æ—Å–ø–µ–∫—Ç –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏",people:1993,seo:!0},{dest:85,name:"–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω (–ê—Å—Ç–∞–Ω–∞)",address:"–°–∞—Ä–∞–π—à—ã–∫",people:1392,seo:!0}]}],bp={pickupPoints:xN},aw=_({name:ko.modelName,initialState:bp,reducers:{setMainMenu:D("mainMenu"),setWarehouses:D("warehouses"),setSubjects:D("subjects"),setMediaRoutes:D("mediaRoutes"),reset:()=>bp}}),bN=E.inject(aw),_r={...aw.actions},Ir=V(ko.modelName,bN),rw=Ir("mainMenu"),vd=Ir("pickupPoints"),iw=Ir("warehouses"),lw=Ir("subjects"),cw=Ir("mediaRoutes"),vN=$(rw,e=>{if(!e)return;const t=(s,o)=>s.childs?s.childs.flatMap(a=>t(a,s)):[[s.id,{...s,namePath:o?`${o.name} / ${s.name}`:s.name}]];return new Map(e.flatMap(s=>t(s)))}),jN=$(lw,e=>{if(!e)return;const t=s=>s.childs?s.childs.flatMap(t):[[s.id,s]];return new Map(e.flatMap(t))}),CN=$(iw,e=>{if(!e)return;const t=new Map;return e.forEach(s=>{t.set(s.id,s)}),t}),jd=$(vd,e=>{if(!e)return;const t=new Map;return e.forEach(({points:s,...o})=>{s.forEach(a=>{t.set(a.dest,{...a,region:o})})}),t}),$N=$(jd,(e,t)=>t,(e,t)=>e==null?void 0:e.get(t)),kN=$(cw,(e,t)=>t,(e,t)=>{var s,o;return((o=(s=e==null?void 0:e[t])==null?void 0:s[0])==null?void 0:o.hosts)||[]}),Ca={mainMenu:rw,mainMenuFlat:vN,warehouses:iw,warehousesMap:CN,pickupPoints:vd,pickupPointsMap:jd,pickupPointByDest:$N,subjects:lw,subjectsFlat:jN,mediaRoutes:cw,useMediaRouteHostsByType:te(kN),usePickupPoints:b(vd),usePickupPointsMap:b(jd)};var dw=(e=>(e.WB="WB",e.FBS="FBS",e.Virtual="Virtual",e.SC="SC",e))(dw||{});const vp={WB:/(^|\s)WB(\s|$)/i,FBS:/—Å–∫–ª–∞–¥\s+–ø—Ä–æ–¥–∞–≤—Ü–∞/i,Virtual:/–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π|—Ç–µ—Å—Ç/i,SC:/(^|\s)–°–¶(\s|$)/i},NN=Object.keys(dw),TN=new Set(["FBS","Virtual","SC"]);function PN(e){let t=e.name,s=!0;const o=NN.reduce((r,i)=>(r[i]=vp[i].test(t),r[i]&&(t=t.replace(vp[i]," ").trim(),s=s&&!TN.has(i)),r),{});let a=Object.entries(o).map(([r,i])=>i&&r!=="WB"?r:void 0).filter(Tn);return a.length===0&&(a=void 0),{id:e.id,type:o,name:`${a?`[${a.toString()}] `:""}${t}`,isAvailable:s}}function*MN(){if(yield F(Ca.mainMenu))return;let t;try{t=yield u(Vm.get,{background:!0})}catch(s){Mn({error:s,name:ko.modelName}),t=yield u(Vm.get,{background:!1})}yield S(_r.setMainMenu(t))}function*FN(){if(yield F(Ca.warehouses))return;let t;try{t=yield u(qm.get,{background:!0})}catch(s){Mn({error:s,name:ko.modelName}),t=yield u(qm.get,{background:!1})}yield S(_r.setWarehouses(t.map(PN)))}function*DN(){if(yield F(Ca.subjects))return;let t;try{t=yield u(Bm.get,{background:!0})}catch(s){Mn({error:s,name:ko.modelName}),t=yield u(Bm.get,{background:!1})}yield S(_r.setSubjects(t))}function*AN(){if(yield F(Ca.mediaRoutes))return;let t;try{t=yield u(Wm.get,{background:!0})}catch(s){Mn({error:s,name:ko.modelName}),t=yield u(Wm.get,{background:!1})}yield S(_r.setMediaRoutes(t.origin))}const LN={loadMainMenu:MN,loadWarehouse:FN,loadSubjects:DN,loadMediaRoutes:AN},RN="AHQKEUg",EN="nGf76bT",_N="Tzas0R8",IN="juHLikE",ai={label:RN,wrapper:EN,input:_N,middle:IN},tc="@@@UNDEFINED@@@";function la({className:e,style:t,size:s,value:o,onChange:a,options:r,...i}){const l=m.useCallback(d=>{const p=d.target.value;a&&a(p===tc?void 0:JSON.parse(p))},[a]),c=m.useMemo(()=>r.map(d=>{var p;if("value"in d)return n.jsx("option",{value:d.value===void 0?tc:JSON.stringify(d.value),children:d.label},(p=d.value)==null?void 0:p.toString());if("children"in d&&d.children)return n.jsx("optgroup",{label:d.label,children:d.children.map(h=>{var g;return n.jsx("option",{value:h.value===void 0?tc:JSON.stringify(h.value),children:h.label},(g=h.value)==null?void 0:g.toString())})},d.label)}),[r]);return n.jsx("label",{className:P([e,ai.label],{[ai.middle]:s==="middle"}),style:t,children:n.jsx("div",{className:ai.wrapper,children:n.jsx("select",{className:ai.input,...i,value:JSON.stringify(o),onChange:l,children:c})})})}function ON({currentLocationOption:e,...t}){const s=Ca.usePickupPoints(),o=m.useMemo(()=>s?s.map(({name:r,points:i})=>({label:r,children:i.map(({name:l,dest:c})=>({label:l,value:c}))})):[],[s]),a=m.useMemo(()=>e?[{label:"–ú–æ—è –ª–æ–∫–∞—Ü–∏—è",children:[e]},...o]:o,[o,e]);return n.jsx(la,{disabled:!s,options:a,...t})}const ge={config:ko,actions:_r,selectors:Ca,sagas:LN},Ua={region:"–†–µ–≥–∏–æ–Ω",city:"–ì–æ—Ä–æ–¥",population:"–ù–∞—Å–µ–ª–µ–Ω–∏–µ",priorityWarehouse:"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π —Å–∫–ª–∞–¥"};function yl({query:e,dest:t}){return`query:${e}/dest:${t}`}function VN({product:e,warehouses:t}){const s=new Map;return e.sizes.forEach(({stocks:o})=>o.forEach(({qty:a,wh:r})=>{const i=t==null?void 0:t.get(r);if(!i||!i.isAvailable)return;let l=s.get(r);l||(l={warehouse:i,value:0},s.set(r,l)),l.value+=a})),{id:e.id,brand:e.brand,name:e.name,quantity:Array.from(s.values()),deliveryTime:e.time1+e.time2,warehouse:t==null?void 0:t.get(e.wh),subjectId:e.subjectId}}function uw({products:e,warehouses:t}){const s=new Map;return e.forEach(({wh:o,time1:a,time2:r})=>{const i=t==null?void 0:t.get(o);if(!i||!i.isAvailable)return;let l=s.get(o);l||(l={count:0,deliveryTime:a+r,warehouse:i},s.set(o,l)),l.count+=1}),Array.from(s.values()).sort((o,a)=>o.deliveryTime-a.deliveryTime)}function*qN(e){try{return yield il(3,2e3,zm.search,e)}catch(t){if(t instanceof ay)return yield u(zm.search,e,!1);throw t}}function*BN(e){var d,p;yield I([u(ge.sagas.loadWarehouse),u(ge.sagas.loadSubjects)]);const t=yield F(ge.selectors.warehousesMap);if(!t)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤");const s=yield F(ge.selectors.subjectsFlat);if(!s)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤");const o=yield ia(qN,e);if(!((d=o.data)!=null&&d.products))return;const a=o.data.products.reduce((h,g)=>(h[g.id]=VN({product:g,warehouses:t}),h),{}),r=a[e.nms[0]];if(!r)return;const i=s.get(r.subjectId);if(!i)return;const l=yield ia(Pr.search,{query:i.name,page:1,dest:e.dest});if(!((p=l.data)!=null&&p.products))return;const c=uw({products:l.data.products,warehouses:t});yield S(Du.setList({key:e.dest,value:{products:a,warehouseStats:c}}))}function*WN({query:e,dest:t,products:s}){yield u(ge.sagas.loadWarehouse);const o=yield F(ge.selectors.warehousesMap);if(!o)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤");const a=uw({products:s,warehouses:o});yield S(Du.setQueries({key:yl({query:e,dest:t}),value:a[0]}))}const zN={load:BN,setQueryPriority:WN},GN="BvOc4kB",KN={button:GN};function wl({onSearchClick:e,...t}){return n.jsx(A,{size:"small-grid",className:KN.button,onClick:()=>e(t),children:"–ø—Ä–æ–≤–µ—Ä–∏—Ç—å"})}const No={config:Fu,actions:Du,selectors:wN,sagas:zN};function*HN({query:e,dest:t,nms:s,pageFrom:o}){yield u(Ke.sagas.searchRegionPosition,{nms:s,dest:t,productsLookLimit:ks.productsLookLimit,keyword:e,pageFrom:o,onPage:function*({products:a,page:r}){if(r===1)try{yield u(No.sagas.setQueryPriority,{query:e,dest:t,products:a})}finally{yield S(yn.setPriorityWarehouseLoading({key:yl({query:e,dest:t}),value:!1}))}},onSearchingFinally:function*(a){yield S(yn.setLoading({key:gl({query:e,dest:t,nm:a}),value:!1}))}})}function*UN({queries:e,nms:t,destinations:s,pageFrom:o}){o||(yield S(yn.setSearchParams({queries:e,nms:t,destinations:s})));const a=[],r={},i={};e.forEach(l=>{s.forEach(c=>{t.forEach(d=>{r[gl({query:l,dest:c,nm:d})]=!0}),a.push(u(HN,{query:l,dest:c,nms:t,pageFrom:o})),i[yl({query:l,dest:c})]=!0})}),yield S(yn.setLoadingMany(r)),yield S(yn.setPriorityWarehouseLoadingMany(i)),yield ls([ne(yn.loadAbort),I(a)])}function*QN(){yield I([N(yn.load,T(UN,[M,vt([ks.view.grid]),O(ks.loading.load),L(ks.loading.load)]))])}K(ks.modelName,QN);const YN={};function mw({query:e,searchParams:t,loading:s,priorityWarehouse:o,priorityWarehouseLoading:a,searchPosition:r,pickupPoints:i}){return t.destinations.map(l=>{const c=yl({query:e,dest:l}),d={products:{},priorityWarehouse:{...(o==null?void 0:o[c])||{},loading:(a==null?void 0:a[c])||!1}},p=i==null?void 0:i.get(l);return p&&(d.city=p.name,d.region=p.region.name,d.population=p.people*1e3),r&&(d.products=t.nms.reduce((h,g)=>{const y=gl({nm:g,dest:l,query:e});return h[g]={position:r[y],loading:(s==null?void 0:s[y])||!1},h},{})),d})}const Au=V(ks.modelName,I1),Lu=Au("searchParams"),JN=Au("loading"),ZN=Au("priorityWarehouseLoading"),XN=$([Lu,JN,Ke.selectors.region,ge.selectors.pickupPointsMap,ZN,No.selectors.queries,(e,t)=>t],(e,t,s,o,a,r,i)=>e?mw({query:i,searchParams:e,loading:t,searchPosition:s,pickupPoints:o,priorityWarehouseLoading:a,priorityWarehouse:r}):wa.array),eT=$([Lu,Ke.selectors.region,ge.selectors.pickupPointsMap,(e,t)=>t],(e,t,s,o)=>e?mw({query:o,searchParams:e,searchPosition:t,pickupPoints:s}):wa.array),Ru={useSearchParams:b(Lu),useDataByQuery:te(XN),useChartDataByQuery:te(eT)},tT=k("entity/wb/product-stats"),Eu={modelName:tT()},zn={list:{}},pw=_({name:Eu.modelName,initialState:zn,reducers:{setList:Je("list"),resetList:Le("list",zn.list),setRecommendations:D("recommendations"),resetRecommendations:Le("recommendations",zn.recommendations),setRequestedRecommendations:fd("requestedRecommendations"),resetRequestedRecommendations:Le("requestedRecommendations",zn.requestedRecommendations),setRequestedQuery:fd("requestedQuery"),resetRequestedQuery:Le("requestedQuery",zn.requestedQuery),setDetails:Je("details"),resetDetails:Le("details",zn.details),reset:()=>zn}}),sT=E.inject(pw),or={...pw.actions},Or=V(Eu.modelName,sT),Cd=Or("list"),hw=Or("recommendations"),nT=Or("requestedQuery"),fw=Or("requestedRecommendations"),oT=$([Cd,(e,t)=>t],(e,t)=>!!(e!=null&&e[t])),aT=$([hw],e=>!!e),rT=$([fw,(e,t)=>t],(e,t)=>e===t),_u=Or("details"),iT=$(_u,(e,t)=>t,(e,t)=>e==null?void 0:e[t]),lT=$([_u],e=>Object.keys(e||{}).map(t=>parseInt(t))),ea={list:Cd,requestedQuery:nT,hasListPage:oT,details:_u,detailsNms:lT,recommendations:hw,requestedRecommendations:fw,hasRequestedRecommendations:rT,hasRecommendations:aT,detailsByNm:iT,useList:b(Cd)};function gw({product:e,warehousesInfo:t,index:s,page:o}){return{id:e.id,brand:e.brand,name:e.name,deliveryTime:e.time1+e.time2,promoTextCat:e.promoTextCat,warehouse:t==null?void 0:t.get(e.wh),position:ja.fromSearch({product:e,searchPosition:s}),isNew:!!e.isNew,index:s,page:o}}function cT({products:e,warehousesInfo:t,subjects:s}){const o={};return e.forEach(a=>{var l;let r=null;const i=a.sizes.reduce((c,{origName:d,name:p,stocks:h,price:g})=>{const y=d||p;let w=0;const C=h.map(j=>(w+=j.qty,{quantity:j.qty,deliveryTime:j.time1+j.time2,warehouse:t==null?void 0:t.get(j.wh)}));return w>0&&typeof(g==null?void 0:g.product)=="number"&&(r===null||g.product<r)&&(r=g.product),c[y]={name:p,origName:d,quantity:w,warehouses:C},c},{});o[a.id]={id:a.id,deliveryTime:a.time1+a.time2,warehouse:t==null?void 0:t.get(a.wh),totalQuantity:a.totalQuantity,subject:{id:a.subjectId,name:(l=s==null?void 0:s.get(a.subjectId))==null?void 0:l.name},sizes:i,brand:a.brand,colors:a.colors.map(({name:c})=>c),feedbacks:a.feedbacks,rating:a.reviewRating,price:r??0,name:a.name,isPromo:!!a.panelPromoId}}),o}function*dT({query:e,page:t,dest:s}){var i;if(yield F(l=>ea.hasListPage(l,t)))return;const a=yield F(ge.selectors.warehousesMap);if(!a)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤");return(i=(yield ia(Pr.search,{query:e,dest:s,page:t})).data)==null?void 0:i.products.map((l,c)=>gw({product:l,warehousesInfo:a,index:(t-1)*100+(c+1),page:t}))}function*uT({query:e,page:t,dest:s,pageLimit:o}){yield u(ge.sagas.loadWarehouse);const a=Array.from({length:o}).map((l,c)=>t+c),r=a.map(l=>u(dT,{query:e,page:l,dest:s})),i=yield I(r);i.length>0&&(yield S(or.setList(i.reduce((l,c,d)=>{const p=a[d];return c&&(l[p]=c),l},{}))))}function*mT({nm:e,dest:t}){var l;const s=yield F(c=>ea.hasRequestedRecommendations(c,e)),o=yield F(ea.hasRecommendations);if(s&&!o){for(;yield ls([ne(or.setRecommendations),fn(1e4)]),!(yield F(ea.hasRecommendations)););return}yield u(ge.sagas.loadWarehouse);const a=yield F(ge.selectors.warehousesMap);if(!a)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤");const i=(l=(yield ia(wy.search,{dest:t,query:`–ø–æ—Ö–æ–∂–∏–µ ${e}`,page:1,limit:300})).data)==null?void 0:l.products.map((c,d)=>gw({product:c,warehousesInfo:a,index:d,page:1}));i&&(yield S(or.setRecommendations(i)))}function*pT(e){try{return yield il(3,2e3,Gm.search,e)}catch(t){if(t instanceof ay)return yield u(Gm.search,e,!1);throw t}}function*hT({nms:e,dest:t}){const s=yield F(ea.detailsNms),o=new Set(s);if(e.filter(c=>!o.delete(c)).length===0)return;const{products:r}=yield I({products:u(pT,{nms:e,dest:t}),_wh:u(ge.sagas.loadWarehouse),_subject:u(ge.sagas.loadSubjects)}),i=yield F(ge.selectors.warehousesMap);if(!i)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤");const l=yield F(ge.selectors.subjectsFlat);r.products&&(yield S(or.setDetails(cT({products:r==null?void 0:r.products,warehousesInfo:i,subjects:l}))))}const fT={search:uT,loadDetails:hT,loadRecommendations:mT},gT="EPYSB3f",yT="S515so-",jp={flexBox:gT,ellipsis:yT};function jt({children:e,suffix:t,prefix:s,className:o,...a}){return n.jsxs("span",{className:P(jp.flexBox,o),...a,children:[s,n.jsx("span",{className:jp.ellipsis,children:e||n.jsx(n.Fragment,{children:"¬†"})}),t]})}const wT="_3N8crjv",ST={productImage:wT};function Iu({displayName:e}){const t=ge.selectors.useMediaRouteHostsByType("mediabasket_route_map");return e?n.jsx(jt,{prefix:n.jsx("img",{alt:e.toString(),src:va(parseInt(e),t),className:ST.productImage}),children:e}):null}const xT="E3Ph8X7",bT="gx3xMBK",vT="w3CRhjB",jT="uLriPh0",sc={productImage:xT,link:bT,button:vT,iconCopy:jT};function Vr({value:e}){const t=ge.selectors.useMediaRouteHostsByType("mediabasket_route_map");if(!e)return null;const s=async r=>{r.preventDefault(),await navigator.clipboard.writeText(e.toString())},o=Co(W.outRoute.marketPlaceProduct,{id:e}),a=`${W.wb.marketPlaceBaseUrl}${o}`;return n.jsx("a",{href:a,className:sc.link,children:n.jsx(jt,{prefix:n.jsx("img",{alt:e.toString(),src:va(e,t),className:sc.productImage}),suffix:n.jsx(Oe,{mouseEnterDelay:.4,overlay:"–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞",children:n.jsx("button",{className:sc.iconCopy,onClick:s,children:n.jsx(z.Copy,{})})}),children:e})})}function Sl({value:e}){return e?n.jsx(be,{className:fl(e),children:Rr(e)}):null}const CT="_6ybpvmj",$T="_3e8mZXA",kT="_4ExTJC7",NT="VdCVuwF",TT="XJ9doM7",PT="_43-SE2z",MT="yoZbryw",FT="-P0VTVZ",DT="H-v0yHB",AT="UJiWRu-",kt={productImage:CT,button:$T,wrapper:kT,link:NT,text:TT,details:PT,ellipsisFlex:MT,brandWrapper:FT,brand:DT,name:AT};function LT({value:e,data:t}){var i,l;const s=ge.selectors.useMediaRouteHostsByType("mediabasket_route_map");if(!e)return null;const o=async c=>{c.preventDefault(),await navigator.clipboard.writeText(e.toString())},a=Co(W.outRoute.marketPlaceProduct,{id:e}),r=`${W.wb.marketPlaceBaseUrl}${a}`;return n.jsxs(f,{as:"a",href:r,className:kt.wrapper,wrap:!1,display:"block",children:[n.jsx("img",{alt:e.toString(),src:va(e,s),className:kt.productImage}),n.jsxs(f,{type:"vertical",justify:"center",className:P(kt.details,kt.ellipsisFlex),wrap:!1,display:"block",children:[n.jsxs(f,{wrap:!1,children:[n.jsxs(f,{wrap:!1,className:P(kt.ellipsisFlex,kt.brandWrapper),children:[n.jsx("span",{className:P(kt.text,kt.brand),children:(i=t==null?void 0:t.details)==null?void 0:i.brand}),n.jsx("div",{className:kt.text,children:"‚Ä¢"})]}),n.jsxs(f,{wrap:!1,className:kt.link,children:[n.jsx("span",{className:kt.value,children:e}),n.jsx(Oe,{mouseEnterDelay:.4,overlay:"–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞",children:n.jsx("button",{className:kt.link,onClick:o,children:n.jsx(z.Copy,{})})})]})]}),n.jsx("div",{className:P(kt.text,kt.name),children:(l=t==null?void 0:t.details)==null?void 0:l.name})]})]})}const me={brand:"–ë—Ä–µ–Ω–¥",id:"–ê—Ä—Ç–∏–∫—É–ª",name:"–ù–∞–∑–≤–∞–Ω–∏–µ",deliveryTime:"–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏",deliveryTimeShort:"–î–æ—Å—Ç–∞–≤–∫–∞, —á.",promoName:"–ü—Ä–æ–º–æ",warehouse:"–°–∫–ª–∞–¥",position:Ba,totalQuantity:"–ù–∞ –≤—Å–µ—Ö —Å–∫–ª–∞–¥–∞—Ö",totalOrderQuantity:"–ó–∞–∫–∞–∑—ã",sizes:"–†–∞–∑–º–µ—Ä—ã"};function RT(){const e=new Map;return{process:({isNew:o})=>{let a=e.get(o);a||(a={count:0,value:o},e.set(o,a)),a.count+=1},result:()=>[...e.values()]}}function ET(e){const{length:t=5,positionMinCpm:s,positionMaxCpm:o}=e,a=new Map,r=s.promoCpm||0,l=((o.promoCpm||0)-r)/t,c=Array.from({length:t},(h,g)=>{const y=[r+l*g,r+l*(g+1)],w=`${y.map(C=>v.currency(C,{fraction:0})).join(" ‚Äî ")}`;return a.set(y,{count:0,value:w}),y});return{process:({position:h})=>{const g=c.find(([w,C])=>h.promoCpm!==void 0&&h.promoCpm>w&&h.promoCpm<=C);if(!g)return;const y=a.get(g);y&&(y.count+=1)},result:()=>[...a.values()]}}function _T(){const e=new Map;return{process:({promoTextCat:o})=>{let a=e.get(o);a||(a={count:0,value:o},e.set(o,a)),a.count+=1},result:()=>[...e.values()]}}function IT(){const e=new Map;return{process:({position:{promoType:o}})=>{let a=e.get(o);a||(a={count:0,value:o},e.set(o,a)),a.count+=1},result:()=>[...e.values()]}}const Wa={promoType:IT,promoCpm:ET,isNew:RT,promoName:_T},Pe={config:Eu,actions:or,selectors:ea,sagas:fT};function OT({value:e,data:t,node:s}){return s.group?null:t!=null&&t.priorityWarehouse.loading?n.jsx(As,{}):e}const VT=[{colId:"regionGroup",headerName:Ua.city,showRowGroup:"region",cellRenderer:"agGroupCellRenderer",valueGetter:({data:e})=>e==null?void 0:e.city},{field:"region",rowGroup:!0,hide:!0,suppressColumnsToolPanel:!0},{field:"priorityWarehouse.warehouse.name",headerName:Ua.priorityWarehouse,cellRenderer:OT}];function qT({onRepeat:e,...t}){var s,o;return t.node.group?null:(s=t.value)!=null&&s.loading?n.jsx(As,{}):n.jsx(Mu,{position:((o=t.value)==null?void 0:o.position)??void 0,onRepeatClick:()=>e(t)})}function BT({data:e,gridRef:t,style:s,onRepeatSearch:o}){const a=he(ks.view.grid),r=Ru.useSearchParams(),i=m.useMemo(()=>{const d=((r==null?void 0:r.nms)||[]).map(p=>({colId:`product-${p}`,valueGetter:h=>{var g,y;return(y=(g=h.data)==null?void 0:g.products)==null?void 0:y[p]},filter:!1,sortable:!1,headerName:p.toString(),headerComponent:Iu,cellRenderer:qT,cellRendererParams:{onRepeat:h=>{var y,w;const g=(w=(y=h.data)==null?void 0:y.products)==null?void 0:w[p];o&&o(g==null?void 0:g.position)}},suppressColumnsToolPanel:!0,suppressMovable:!0,minWidth:100}));return[...VT,...d]},[r==null?void 0:r.nms]),l=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),c=m.useCallback(d=>String(d.data.city),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:i,getRowId:c,defaultColDef:l,columnsState:a.state,onColumnsStateChanged:a.save,groupDisplayType:"custom",suppressAggFuncInHeader:!0,groupDefaultExpanded:-1})}const WT="_2YYtCIF",zT="E3lNyIB",GT="KPj3arg",KT="TSzKgBS",HT="_0KSwuRf",UT="x9NbYka",QT="_4Id64kD",YT="NUZGzFB",JT="rJqHh8i",gs={wrapper:WT,bar:zT,buttonPanel:GT,button:KT,selected:HT,panel:UT,panelWrapper:QT,panelItem:YT,colorSquare:JT};function ZT({def:e}){return n.jsx("div",{className:P([gs.panelItem,e.toolPanelClass]),children:n.jsx("div",{className:"ag-column-select-column ag-column-select-indent-0","aria-hidden":"true",children:n.jsx("span",{className:"ag-column-select-column-label",children:e.label})})})}function XT({def:e,value:t,onChange:s}){const o=P("ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper",{"ag-checked":!!t});return n.jsx("div",{className:P([gs.panelItem,e.toolPanelClass]),children:n.jsxs("div",{className:"ag-column-select-column ag-column-select-indent-0","aria-hidden":"true",onClick:()=>s&&s(!t),children:[n.jsx("div",{className:o,children:n.jsx("input",{className:"ag-input-field-input ag-checkbox-input",type:"checkbox",checked:t,onChange:()=>s&&s(!t)})}),n.jsx("div",{className:gs.colorSquare,style:{borderColor:e.borderColor},children:n.jsx("div",{style:{backgroundColor:e.backgroundColor}})}),n.jsx("span",{className:"ag-column-select-column-label",children:e.label})]})})}const Cp=(e,t,s,o)=>{const a=e.id||e.field;if(!a||s!=null&&s.includes(a))return null;const r=o==null?void 0:o.find(l=>a===l.lineId);let i=e.hide;return r&&(i=r.hide),n.jsx(XT,{def:e,value:!i,onChange:l=>t(a,l)},a)};function eP({linesState:e=[],lineDefs:t=[],onChange:s,emptyLines:o=[]}){const a=(r,i)=>{s&&s([...e.filter(l=>l.lineId&&l.lineId!==r),{lineId:r,hide:!i}])};return n.jsx("div",{className:gs.panel,children:n.jsx("div",{className:gs.panelWrapper,children:t==null?void 0:t.flatMap(r=>{var i;if("children"in r){const l=((i=r.children)==null?void 0:i.map(c=>Cp(c,a,o,e)))||[];return l.filter(c=>c!=null).length>0&&l.unshift(n.jsx(ZT,{def:r},r.label)),l}return Cp(r,a,o,e)})})})}function tP({open:e,...t}){const s=e!==void 0?e:!1,[o,a]=m.useState(s),r=P(gs.button,{[gs.selected]:o});return n.jsx("div",{className:gs.wrapper,children:n.jsxs("div",{className:gs.bar,children:[n.jsx("div",{className:gs.buttonPanel,children:n.jsxs("button",{className:r,onClick:()=>a(!o),children:[n.jsx("div",{className:"ag-side-button-icon-wrapper","aria-hidden":"true",children:n.jsx("span",{className:"ag-icon ag-icon-columns"})}),n.jsx("span",{className:"ag-side-button-label",children:"–°—Ç–æ–ª–±—Ü—ã"})]})}),o&&n.jsx(eP,{...t})]})})}const $p=["#8BC1F7","#519DE9","#06C","#004B95","#002F5D","#BDE2B9","#7CC674","#4CB140","#38812F","#23511E","#A2D9D9","#73C5C5","#009596","#005F60","#003737","#B2B0EA","#8481DD","#5752D1","#3C3D99","#2A265F","#F9E0A2","#F6D173","#F4C145","#F0AB00","#C58C00","#F4B678","#EF9234","#EC7A08","#C46100","#8F4700","#C9190B","#A30000","#7D1007","#470000","#2C0000","#F0F0F0","#D2D2D2","#B8BBBE","#8A8D90","#6A6E73"];function kp(e){const t=e%$p.length,{r:s,g:o,b:a}=Fv($p[t]);return{backgroundColor:`rgba(${s}, ${o}, ${a}, 0.5)`,borderColor:`rgba(${s}, ${o}, ${a}, 1)`}}function Rn(){let e=0;const t=new Map;return function(s){if(s){let a=t.get(s);return a||(a=kp(t.size),t.set(s,a)),a}const o=kp(e);return e+=1,o}}const nc={numeric:{valueFormatter:e=>v.numeric(e)},"numeric.0":{valueFormatter:e=>v.numeric(e,{fraction:0})},"numeric.1":{valueFormatter:e=>v.numeric(e,{fraction:1})},"numeric.2":{valueFormatter:e=>v.numeric(e,{fraction:2})},"percent.0":{valueFormatter:e=>v.percent(e,{fraction:0})},"percent.1":{valueFormatter:e=>v.percent(e,{fraction:1})},"percent.2":{valueFormatter:e=>v.percent(e,{fraction:2})},"currency.0":{valueFormatter:e=>v.currency(e,{fraction:0})},"currency.1":{valueFormatter:e=>v.currency(e,{fraction:1})},"currency.2":{valueFormatter:e=>v.currency(e,{fraction:2})}};function sP(e){var t;return e.valueFormatter?e.valueFormatter:(t=e.type)==null?void 0:t.reduce((s,o)=>("valueFormatter"in nc[o]&&(s=nc[o].valueFormatter),s),nc.numeric.valueFormatter)}const nP="sMPW9to",oP="o7pgH2a",aP="d3-nxsr",oc={chartWrapper:nP,chart:oP,compact:aP};ty.defaults.font.family='"WB Hauss VF", sans-serif';ty.register([Dv]);const rP={responsive:!0,interaction:{mode:"index",intersect:!1},maintainAspectRatio:!1,plugins:{legend:{display:!1},datalabels:{display:!1}}};function En({labelField:e,labelFormatter:t,lineData:s,lineDefs:o,linesState:a,onLinesStateChanged:r,style:i,className:l,classNames:c,isCompact:d,withDataLabels:p,showTooltip:h=!0,showAxios:g=!0,type:y="line",sidebar:w=!0,id:C}){const j=m.useRef(null),q=m.useMemo(()=>a==null?void 0:a.reduce((Y,ce)=>(ce.lineId&&Y.set(ce.lineId,ce),Y),new Map),[a]),B=m.useMemo(()=>o?o.flatMap(Y=>"children"in Y&&Array.isArray(Y.children)?Y.children:[Y]):[],[o]),{data:X,emptyLines:U}=m.useMemo(()=>{const Y=[],ce={labels:(s==null?void 0:s.map(se=>{const tt=se[e];return t?t(tt):tt}))||[],datasets:[]};return B.forEach(se=>{var Jr;const tt=se.field||se.id;if(!tt)return;const Ct={label:se.label||se.field||se.id,data:(s==null?void 0:s.map(Fo=>{const Zr=ll(Fo,tt);return se.valueGetter?se.valueGetter({value:Zr,data:Fo}):Zr}))||[],datalabels:{formatter:sP(se)},hidden:se.hide,borderColor:se.borderColor,backgroundColor:se.backgroundColor,fill:se.fill,pointBackgroundColor:se.pointBackgroundColor,pointBorderColor:se.pointBorderColor,pointRadius:se.pointRadius,pointHoverRadius:se.pointHoverRadius,borderDash:se.borderDash,borderJoinStyle:se.borderJoinStyle,yAxisID:g?((Jr=se.scale)==null?void 0:Jr.id)||tt:void 0,tension:se.tension,maxBarThickness:se==null?void 0:se.maxBarThickness},Vn=q==null?void 0:q.get(tt);Vn&&(Ct.hidden=Vn.hide),ce.datasets.push(Ct),Ct.data.filter(Fo=>Fo!==void 0).length===0&&Y.push(tt)}),{data:ce,emptyLines:Y}},[s,q,B,t,e]),fe=m.useMemo(()=>{const Y=Iv(rP);return Y.scales||(Y.scales={}),B.forEach(ce=>{var tt,Ct;const se=ce.field||ce.id;se&&Y.scales&&(Y.scales[((tt=ce.scale)==null?void 0:tt.id)||se]={...ce.scale,display:g?(Ct=ce.scale)==null?void 0:Ct.display:!1})}),g?Object.keys(Y.scales).length>0&&(Y.scales.y={display:!1}):(Y.scales.y={display:!1},Y.scales.x={display:!1}),Y.plugins&&(Y.plugins.tooltip={enabled:h,callbacks:{label(ce){var Ct,Vn;const{label:se}=ce.dataset;let tt=ce.raw;return(Ct=ce.dataset.datalabels)!=null&&Ct.formatter&&(tt=(Vn=ce.dataset.datalabels)==null?void 0:Vn.formatter(ce.raw,{active:!0,chart:ce.chart,dataIndex:ce.dataIndex,dataset:ce.dataset,datasetIndex:ce.datasetIndex})),`${se}: ${tt}`}}},p&&(Y.plugins.datalabels={formatter:(ce,se)=>{var tt,Ct;return(tt=se.dataset.datalabels)!=null&&tt.formatter?(Ct=se.dataset.datalabels)==null?void 0:Ct.formatter(ce,se):ce},align:"top",offset:2,color:function(ce){return ce.dataset.borderColor}},Y.layout={padding:{top:20}})),Y},[B,p,h]),$e=m.useMemo(()=>n.jsx("div",{className:P(c==null?void 0:c.chart,oc.chart),children:n.jsx(Av,{type:y,ref:j,options:fe,data:X})}),[X,fe,y]),ut=m.useMemo(()=>w?n.jsx(tP,{lineDefs:o,linesState:a,emptyLines:U,onChange:r,open:w==="open"}):null,[w,o,a,U]);return n.jsxs("div",{className:P(["ag-theme-quartz",c==null?void 0:c.wrapper,l,oc.chartWrapper],{[oc.compact]:d}),style:i,id:C,children:[$e,ut]})}const iP=Rn(),lP={type:"linear",position:"left",beginAtZero:!0,display:!1};function cP(){const e=Ru.useSearchParams();return m.useMemo(()=>((e==null?void 0:e.nms)||[]).map((t,s)=>({id:`product-${t}`,label:t.toString(),hide:s>0,scale:lP,valueGetter:({data:o})=>{var r,i;const a=(i=(r=o==null?void 0:o.products)==null?void 0:r[t])==null?void 0:i.position;return(a==null?void 0:a.promoPosition)||(a==null?void 0:a.organicPosition)},...iP(t)})),[])}function dP({style:e,className:t,data:s}){const o=cP();return n.jsx(En,{lineData:s,lineDefs:o,labelField:"city",type:"bar",style:e,className:t,isCompact:!0,withDataLabels:!0})}const po={actions:yn,config:ks,sagas:YN,selectors:Ru},_a=k("feature/wb-region-warehouse-stats"),pt={modelName:_a(),loading:{load:_a("load")},analytic:{showModal:"showModal"},view:{deliveryTimeGrid:_a("view/delivery-time-grid"),frequencyGrid:_a("view/frequency-grid"),productQuantityGrid:_a("view/product-quantity-grid")},frequencyCountLength:2},Np=Q(pt.modelName),Tp={loading:{}},yw=_({name:pt.modelName,initialState:Tp,reducers:{setSearchParams:D("searchParams"),setLoading:wt("loading"),setLoadingMany:D("loading"),resetLoading:Le("loading",{}),reset:()=>Tp}}),uP=E.inject(yw),ta={...yw.actions,load:Np("load"),loadAbort:Np("load-abort")};function*mP(e,t){try{yield u(No.sagas.load,{dest:e,nms:t})}finally{yield S(ta.setLoading({key:e,value:!1}))}}function*pP({nms:e,destinations:t}){yield S(ta.setSearchParams({nms:e,destinations:t}));const s=[],o={};t.forEach(a=>{s.push(u(mP,a,e)),o[a]=!0}),yield S(ta.setLoadingMany(o)),yield ls([ne(ta.loadAbort),I(s)])}function*hP(){yield I([N(ta.load,T(pP,[M,vt([pt.view.productQuantityGrid,pt.view.frequencyGrid,pt.view.frequencyGrid]),O(pt.loading.load),L(pt.loading.load)]))])}K(pt.modelName,hP);const fP={};function gP({searchParams:e,loading:t,warehouseStats:s,pickupPoints:o}){return e.destinations.map(a=>{var l,c;const r={loading:(t==null?void 0:t[a])||!1,products:{}},i=o==null?void 0:o.get(a);if(i&&(r.city=i.name,r.region=i.region.name,r.population=i.people*1e3),s!=null&&s[a]){const d=s[a];r.priorityWarehouse=(l=d.warehouseStats)==null?void 0:l[0];for(const p in d.products){const h=d.products[p];if(h){const g=typeof((c=r.priorityWarehouse)==null?void 0:c.deliveryTime)=="number"&&typeof h.deliveryTime=="number"?r.priorityWarehouse.deliveryTime-h.deliveryTime:void 0;let y=0;h.quantity.forEach(({warehouse:w,value:C})=>{w!=null&&w.isAvailable&&(y+=C)}),r.products[p]={...h,quantityTotal:y,deliveryTimeDiff:g}}}}return r})}function yP({list:e,searchParams:t,countLength:s}){var i,l;const o=t.nms[0],a=new Map;for(const c in e){const d=parseInt(c),p=e[d].warehouseStats,h=e[d].products[o];for(let g=0;g<s;g++){const y=p[g];if(y&&((i=y.warehouse)!=null&&i.id)&&((l=y.warehouse)!=null&&l.isAvailable)){let w=a.get(y.warehouse.id);w||(w={counts:Array.from({length:s},()=>0),name:y.warehouse.name,ourProductQuantity:0},a.set(y.warehouse.id,w)),w.counts[g]+=1;const C=h==null?void 0:h.quantity.find(({warehouse:j})=>{var q;return(j==null?void 0:j.id)===((q=y.warehouse)==null?void 0:q.id)});C&&(w.ourProductQuantity+=C.value)}}}const r=[];return a.forEach(({counts:c,name:d,ourProductQuantity:p})=>{r.push({name:d,ourProductQuantity:p,counts:c.map((h=>g=>h+=g)(0))})}),r}function wP({list:e,searchParams:t}){if(!e)return[];const s=new Map;return t.destinations.forEach(o=>{var r;const a=(r=e[o])==null?void 0:r.products;a&&Object.keys(a).forEach(i=>{const l=parseInt(i),c=a[l];c==null||c.quantity.forEach(({warehouse:d,value:p})=>{if(!d)return;let h=s.get(d.id);h||(h={...d,products:{}},s.set(d.id,h)),h&&(h.products[l]={id:l,count:p})})})}),[...s.values()]}const ww=V(pt.modelName,uP),xl=ww("searchParams"),Sw=ww("loading"),SP=$([xl,Sw,No.selectors.list,ge.selectors.pickupPointsMap],(e,t,s,o)=>e?gP({searchParams:e,loading:t,warehouseStats:s,pickupPoints:o}):wa.array),xP=$([Sw],e=>Object.values(e||{}).find(t=>t)||!1),bP=$([xl,No.selectors.list],(e,t)=>!t||!e?[]:yP({list:t,searchParams:e,countLength:pt.frequencyCountLength})),vP=$([xl,No.selectors.list],(e,t)=>!t||!e?[]:wP({list:t,searchParams:e})),bl={useSearchParams:b(xl),useData:b(SP),useLoading:b(xP),useQuantityData:b(vP),useFrequencyData:b(bP)};function xw({value:e,data:t}){var s;return t!=null&&t.loading?n.jsx(As,{}):e?n.jsx(jt,{suffix:n.jsxs(n.Fragment,{children:[!!e.deliveryTime&&n.jsx("span",{children:v.hours(e.deliveryTime)}),!!e.deliveryTimeDiff&&n.jsxs("span",{style:{fontSize:"80%"},children:["¬†",n.jsx(so,{formatter:v.hours,value:e.deliveryTimeDiff})]})]}),children:(s=e.warehouse)==null?void 0:s.name}):null}const Pp=[{colId:"regionGroup",headerName:Ua.city,showRowGroup:"region",cellRenderer:"agGroupCellRenderer",valueGetter:({data:e})=>e==null?void 0:e.city,width:250},{field:"region",rowGroup:!0,hide:!0,suppressColumnsToolPanel:!0},{field:"population",type:["numeric","rightAligned"],filter:"agTextColumnFilter",headerName:Ua.population,width:150},{field:"priorityWarehouse",filter:!1,sortable:!1,cellRenderer:xw,headerName:Ua.priorityWarehouse,minWidth:230}],jP="LwWUB-o",bw={warning:jP};function CP({data:e,gridRef:t,style:s}){const o=he(pt.view.deliveryTimeGrid),a=bl.useSearchParams(),r=m.useMemo(()=>{const d=((a==null?void 0:a.nms)||[]).map(p=>({colId:`product-${p}`,valueGetter:h=>{var g,y;return(y=(g=h.data)==null?void 0:g.products)==null?void 0:y[p]},filter:!1,sortable:!1,cellRenderer:xw,headerName:p.toString(),headerComponent:Iu,suppressColumnsToolPanel:!0,suppressMovable:!0,minWidth:200}));return Pp[3].colSpan=({data:p})=>p!=null&&p.loading?d.length+1:1,[...Pp,...d]},[a==null?void 0:a.nms]),i=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),l=m.useMemo(()=>({[bw.warning]:({data:d})=>{var g;const[p]=(a==null?void 0:a.nms)||[],h=(g=d==null?void 0:d.products)==null?void 0:g[p];return h!=null&&h.deliveryTimeDiff?(h==null?void 0:h.deliveryTimeDiff)<0:!1}}),[a==null?void 0:a.nms]),c=m.useCallback(d=>`${d.data.region}-${d.data.city}`,[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:r,defaultColDef:i,columnsState:o.state,onColumnsStateChanged:o.save,groupDisplayType:"custom",suppressAggFuncInHeader:!0,groupDefaultExpanded:-1,rowClassRules:l,getRowId:c})}const $P=[{field:"name",headerName:"–°–∫–ª–∞–¥"}];function kP({data:e,gridRef:t,style:s}){const o=he(pt.view.productQuantityGrid),a=bl.useSearchParams(),r=m.useMemo(()=>{const c=((a==null?void 0:a.nms)||[]).map(d=>({colId:`product-${d}`,valueGetter:p=>{var h,g,y;return(y=(g=(h=p.data)==null?void 0:h.products)==null?void 0:g[d])==null?void 0:y.count},type:["numeric","rightAligned"],filter:!1,sortable:!1,headerName:d.toString(),headerComponent:Iu,suppressColumnsToolPanel:!0,suppressMovable:!0,minWidth:180}));return[...$P,...c]},[a==null?void 0:a.nms]),i=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),l=m.useCallback(c=>c.data.id.toString(),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:r,defaultColDef:i,columnsState:o.state,onColumnsStateChanged:o.save,groupDisplayType:"custom",suppressAggFuncInHeader:!0,groupDefaultExpanded:-1,getRowId:l})}const NP=[{field:"name",headerName:"–°–∫–ª–∞–¥"},{field:"ourProductQuantity",type:["numeric","rightAligned"],filter:"agNumberColumnFilter",headerName:"–¢–æ–≤–∞—Ä, —à—Ç."}];function TP({data:e,gridRef:t,style:s}){const o=he(pt.view.frequencyGrid),a=bl.useSearchParams(),r=m.useMemo(()=>{const d=Array.from({length:pt.frequencyCountLength},(p,h)=>({colId:`counts-${h}`,valueGetter:g=>{var y;return(y=g.data)==null?void 0:y.counts[h]},headerName:`–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ${h+1}`,headerTooltip:`–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–≥–∏–æ–Ω–æ–≤ –≥–¥–µ –¥–∞–Ω–Ω—ã–π —Å–∫–ª–∞–¥ –≤ –¢–û–ü ${h+1} –ø–æ –≤—Ä–µ–º–µ–Ω–∏`}));return[...NP,...d]},[pt.frequencyCountLength]),i=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),l=m.useMemo(()=>({[bw.warning]:({data:d})=>!!d&&d.ourProductQuantity<=0}),[a==null?void 0:a.nms]),c=m.useCallback(d=>d.data.name,[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:r,defaultColDef:i,columnsState:o.state,onColumnsStateChanged:o.save,groupDisplayType:"custom",suppressAggFuncInHeader:!0,groupDefaultExpanded:-1,rowClassRules:l,getRowId:c})}const ho={actions:ta,config:pt,sagas:fP,selectors:bl};function*PP({queries:e,nms:t,destinations:s}){yield S(mo.setSearchParams({queries:e,nms:t,destinations:s})),yield I([S(ho.actions.load({nms:t,destinations:s})),S(po.actions.load({nms:t,destinations:s,queries:e}))])}function*MP(){yield I([S(ho.actions.loadAbort()),S(po.actions.loadAbort())])}function*FP(){yield I([N(mo.load,T(PP,[M,O(en.loading.load),L(en.loading.load)])),N(mo.loadAbort,MP)])}K(en.modelName,FP);const DP={},vl=V(en.modelName,_1),AP=vl("showModal"),Mp=vl("searchParams"),LP=vl("view"),RP=vl("form"),ar={searchParams:Mp,useSearchParams:b(Mp),useShowModal:b(AP),useView:b(LP),useForm:b(RP)},Ia=k("storage-common"),tn={modelName:Ia(),storageKey:`${W.appName}/${Ia()}`,loading:{load:Ia("load"),save:Ia("save")},event:{save:Ia("save")}},EP={storage:{}},vw=_({name:tn.modelName,initialState:EP,reducers:{setStorage:Je("storage"),setIsReady:D("isReady")}}),_P=E.inject(vw),Fp=Q(tn.modelName),$n={...vw.actions,save:Fp("save"),load:Fp("load")},jw=V(tn.modelName,_P),Cw=jw("storage"),Dp=jw("isReady"),IP=$([Cw,(e,t)=>t],(e,t)=>t?e==null?void 0:e[t]:void 0),rr={storage:Cw,isReady:Dp,useValue:te(IP),useIsReady:b(Dp)},$w=Ue(tn.storageKey,{type:Qe.Sync}),kw=Dn(tn.event.save);function*Nw(){if(yield F(rr.isReady))return;const t=yield u($w.get);t&&(yield S($n.setStorage(t))),yield S($n.setIsReady(!0))}function*OP({syncTabs:e,data:t}){yield S($n.setStorage(t));const s=yield F(rr.storage);s&&(yield u($w.set,s),e&&(yield u(kw.post,s)))}function*VP(){const t=yield u(()=>An(kw.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*qP(){const{channel:e,takeEvent:t}=yield u(VP);try{for(;;){const s=yield u(t);yield S($n.setStorage(s))}}finally{e.close()}}function*BP(){yield I([ey(300,$n.save,T(OP,[M,et(tn.loading.save)])),N($n.load,T(Nw,[M,et(tn.loading.load)]))])}K(tn.modelName,BP);const WP={load:Nw,watchSaveChannel:qP};function sa(e,t={}){const{syncTabs:s=!0}=t,o=rr.useValue(e),a=rr.useIsReady(),{save:r}=x($n),i=m.useCallback(l=>{o!==l&&r({data:{[e]:l},syncTabs:s})},[e,o,s]);return{isReady:a,value:o,save:i}}const Ap={config:tn,actions:$n,sagas:WP,selectors:rr},zP="_8JAcYwk",GP={checkbox:zP};function qr({className:e,indeterminate:t,checked:s,...o}){return n.jsx("input",{ref:a=>{a&&(a.indeterminate=s&&t||!1)},checked:s,type:"checkbox",className:P([GP.checkbox,e]),...o})}const KP="EU3UxdC",HP="qsQa-qn",UP="hs6fhDo",QP="S0gOGPP",ir={container:KP,wrapper:HP,label:UP,groupItems:QP};function YP({value:e,label:t,selected:s,onSelect:o}){const a=s.includes(e);return n.jsxs("label",{className:ir.label,children:[n.jsx(qr,{checked:a,onChange:r=>o([[e,!a]],r)}),n.jsx("div",{children:t})]})}function JP({options:e,label:t,onSelect:s,selected:o}){const a=e.filter(({value:c})=>o.includes(c)),r=a.length>0,i=a.length===e.length,l=c=>{s(e.map(({value:d})=>[d,!i]),c)};return n.jsxs("div",{children:[n.jsxs("label",{className:ir.label,children:[n.jsx(qr,{checked:r,indeterminate:!i,onChange:l}),n.jsx("div",{children:t})]}),n.jsx("ul",{className:ir.groupItems,children:e.map(c=>{let d=c.key;return(!d&&typeof c.label=="string"||typeof c.label=="number"||typeof c.label=="bigint")&&(d=c.label),n.jsx("li",{children:n.jsx(YP,{value:c.value,label:c.label,onSelect:s,selected:o})},d)})})]})}function ZP({options:e,value:t=[],onChange:s,style:o,className:a}){const r=(i,l)=>{if(!s)return;const c=new Set(t);i.forEach(([d,p])=>{p?c.add(d):c.delete(d)}),s([...c],l)};return n.jsx("div",{className:P(ir.container,[a]),style:o,children:n.jsx("div",{className:ir.wrapper,children:e.map(i=>{let l=i.key;return(!l&&typeof i.label=="string"||typeof i.label=="number"||typeof i.label=="bigint")&&(l=i.label),n.jsx(JP,{...i,selected:t,onSelect:r},l)})})})}const XP="b74imqU",eM="HjnUHlf",tM="lW3-YrB",sM="_9pLZRER",Oa={rightSide:XP,label:eM,button:tM,selector:sM},Lp=e=>e.split(/\n+/);function nM({onSubmit:e}){var j,q,B,X;const t=ar.useForm(),{load:s,setForm:o}=x(mo),a=ge.selectors.usePickupPoints(),r=!!parseInt(t.nmOur||"")&&Number((j=t.destinations)==null?void 0:j.length)>0&&Number((q=t.queries)==null?void 0:q.length)>0,{destinationDefault:i,destinationOptions:l,destinationAll:c}=m.useMemo(()=>{const U=[],fe=[],$e=(a||[]).map(ut=>({label:ut.name,options:ut.points.map(Y=>(Y.seo&&U.push(Y.dest),fe.push(Y.dest),{label:Y.name,value:Y.dest}))}));return{destinationAll:fe,destinationDefault:U,destinationOptions:$e}},[a]),d=U=>{o({...U,autoSubmit:!1,isReady:!1})},{save:p,isReady:h,value:g}=sa(en.storage.destinations,{syncTabs:!0}),y=U=>{p(U),d({destinations:U})},w=()=>{const U={destinations:t.destinations,nms:[t.nmOur||"",...t.nms].map(fe=>parseInt(fe.trim())).filter(Boolean),queries:t.queries.map(fe=>fe.trim()).filter(Boolean)};s(U),o({autoSubmit:!1,isReady:!1}),e()},C=()=>{o({nms:[],nmOur:"",queries:[],destinations:i})};return m.useEffect(()=>{var U;g?o({destinations:g,isReady:h}):((U=t.destinations)==null?void 0:U.length)===0&&o({destinations:i,isReady:!0})},[i]),m.useEffect(()=>{t.isReady&&t.autoSubmit&&w()},[t.isReady]),n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsxs(f,{type:"horizontal",gap:"l",display:"block",children:[n.jsxs(f,{type:"vertical",gap:"l",style:{flex:1},children:[n.jsx(ns,{title:"–í–∞—à —Ç–æ–≤–∞—Ä",children:n.jsx(xe,{placeholder:"–ê—Ä—Ç–∏–∫—É–ª –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞",type:"text",value:t.nmOur,onChange:U=>d({nmOur:U.target.value})})}),n.jsx(ns,{title:"–ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã",children:n.jsx(xe.Textarea,{placeholder:`–£–∫–∞–∂–∏—Ç–µ 2-3 —Ü–µ–ª–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∑–∏—Ü–∏–π
–∞—Ä—Ç–∏–∫—É–ª–æ–≤ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º`,value:(B=t.queries)==null?void 0:B.join(`
`),onChange:U=>d({queries:Lp(U.target.value)})})}),n.jsx(ns,{title:"–¢–æ–≤–∞—Ä—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è",children:n.jsx(xe.Textarea,{placeholder:"–£–∫–∞–∂–∏—Ç–µ –∞—Ä—Ç–∏–∫—É–ª—ã —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è",value:(X=t.nms)==null?void 0:X.join(`
`),onChange:U=>d({nms:Lp(U.target.value)})})})]}),n.jsx("div",{className:Oa.rightSide,children:n.jsxs(ns,{title:"–†–µ–≥–∏–æ–Ω –ø—Ä–æ–≤–µ—Ä–∫–∏",className:Oa.label,as:"div",children:[n.jsxs(f,{gap:8,children:[n.jsxs(A,{type:"blue",size:"small",className:Oa.button,onClick:()=>{y(c)},children:["–í—ã–±—Ä–∞—Ç—å –≤—Å—ë (",c.length,")"]}),n.jsxs(A,{type:"blue",size:"small",className:Oa.button,onClick:()=>{y(i)},children:["–í—ã–±—Ä–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ (",i.length,")"]})]}),n.jsx(ZP,{options:l,value:t.destinations,onChange:U=>{y(U)},className:Oa.selector})]})})]}),n.jsxs(f,{type:"horizontal",gap:"s",justify:"center",display:"block",children:[n.jsx(A,{type:"purple",onClick:w,disabled:!r,children:"–ó–∞–ø—É—Å—Ç–∏—Ç—å"}),n.jsx(A,{onClick:C,children:"–û—á–∏—Å—Ç–∏—Ç—å"}),W.isDev]})]})}function oM({query:e}){const t=po.selectors.useChartDataByQuery(e),s=po.selectors.useSearchParams(),o=m.useMemo(()=>{let a=0,r=0;return t.forEach(({products:i})=>{var d,p,h;if(!((d=s==null?void 0:s.nms)!=null&&d[0]))return;const l=i[s.nms[0]],c=((p=l.position)==null?void 0:p.promoPosition)||((h=l.position)==null?void 0:h.organicPosition);c&&((c>a||!a)&&(a=c),(c<r||!r)&&(r=c))}),{max:a,min:r}},[t,s]);return t?n.jsxs(f,{type:"vertical",align:"center",gap:"s",style:{height:250},children:[n.jsxs(f,{type:"horizontal",gap:"s",align:"center",children:[n.jsx("span",{children:"–ü–æ–∑–∏—Ü–∏—è:"}),n.jsxs("span",{children:["–ª—É—á—à–∞—è ",n.jsx(be,{type:"success",children:o.min||"‚Äî"})]}),n.jsxs("span",{children:["—Ö—É–¥—à–∞—è ",n.jsx(be,{type:"error",children:o.max||"‚Äî"})]})]}),n.jsx(dP,{data:t,style:{width:"100%",height:"100%"}})]}):null}const ac=k("feature/cmp-search-position"),aM=[20,50,100,200,500,1e3],$a={modelName:ac(),loading:{search:ac("search")},searchItemLimit:1e3,itemLimit:aM,defaultItemLimit:20,view:{formPrevious:ac("view/form-previous")}},Rp={loadingKeyword:{},loadingCatalog:{},loadingQuery:{},loadingRecommendation:{}},Tw=_({name:$a.modelName,initialState:Rp,reducers:{setLoadingKeyword:wt("loadingKeyword"),setLoadingCatalog:wt("loadingCatalog"),setLoadingQuery:wt("loadingQuery"),setLoadingRecommendation:wt("loadingRecommendation"),setLoadingKeywordMany:Je("loadingKeyword"),setLoadingCatalogMany:Je("loadingCatalog"),setLoadingQueryMany:Je("loadingQuery"),setLoadingRecommendationMany:Je("loadingRecommendation"),reset:()=>Rp}}),rM=E.inject(Tw),Rs=Q($a.modelName),Mt={...Tw.actions,searchAbort:Rs("search-abort"),searchAbortKeyword:Rs("search-abort-keyword"),searchAbortCatalog:Rs("search-abort-catalog"),searchAbortQuery:Rs("search-abort-query"),searchAbortRecommendation:Rs("search-abort-recommendation"),resetKeyword:Rs("reset-keyword"),resetCatalog:Rs("reset-catalog"),resetQuery:Rs("reset-query"),resetRecommendation:Rs("reset-recommendation")};function iM({item:e,type:t,productsLookLimit:s,dest:o,nm:a,pageFrom:r}){switch(t){case"keyword":return u(Ke.sagas.searchKeywordPosition,{...e,dest:o,nms:[a],pageFrom:r,productsLookLimit:s});case"query":return u(Ke.sagas.searchQueryPosition,{keyword:e.query,dest:o,nms:[a],pageFrom:r,productsLookLimit:s});case"catalog":return u(Ke.sagas.searchCatalogPosition,{...e,dest:o,nms:[a],pageFrom:r,productsLookLimit:s});case"recommendation":return u(Ke.sagas.searchRecommendationPosition,{...e,dest:o,nms:[a],pageFrom:r,productsLookLimit:s});default:throw new Error("–ü–æ–∏—Å–∫ –¥–ª—è —ç—Ç–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")}}function lM({item:e,type:t},s){switch(t){case"keyword":return Mt.setLoadingKeyword({key:e.keyword,value:s});case"query":return Mt.setLoadingQuery({key:e.query,value:s});case"catalog":return Mt.setLoadingCatalog({key:e.id,value:s});case"recommendation":return Mt.setLoadingRecommendation({key:e.nm,value:s})}}function cM({items:e,type:t},s){switch(t){case"keyword":return Mt.setLoadingKeywordMany(ri(e,"keyword",s));case"query":return Mt.setLoadingQueryMany(ri(e,"query",s));case"catalog":return Mt.setLoadingCatalogMany(ri(e,"id",s));case"recommendation":return Mt.setLoadingRecommendationMany(ri(e,"nm",s))}}function*dM(e){try{yield iM(e)}finally{yield S(lM(e,!1))}}const Pw={keyword:{actionSearchAbort:Mt.searchAbortKeyword,actionReset:Ke.actions.resetKeyword},query:{actionSearchAbort:Mt.searchAbortQuery,actionReset:Ke.actions.resetQuery},catalog:{actionSearchAbort:Mt.searchAbortCatalog,actionReset:Ke.actions.resetCatalog},recommendation:{actionSearchAbort:Mt.searchAbortRecommendation,actionReset:Ke.actions.resetRecommendation}};function*uM(e){const{items:t,type:s,...o}=e,{actionSearchAbort:a}=Pw[s],r=a||Mt.searchAbort;yield S(cM(e,!0));const i=t.map(l=>u(dM,{item:l,type:s,...o}));yield ls([ne(r),I(i)])}function*mM({type:e,cleanResults:t=!0}){const{actionSearchAbort:s,actionReset:o}=Pw[e];yield S(s()),t&&(yield S(o()))}const pM={search:uM,reset:mM},hM=k("entity/wb/advert"),Ou={modelName:hM()},Ep={},Mw=_({name:Ou.modelName,initialState:Ep,reducers:{setCard:D("card"),setList:D("list"),resetCard:e=>{e.card=void 0},resetList:e=>{e.list=void 0},reset:()=>Ep}}),fM=E.inject(Mw),Br={...Mw.actions},Fw=V(Ou.modelName,fM),Bi=Fw("list"),$d=Fw("card"),gM=$(Bi,e=>(e==null?void 0:e.flatMap(t=>t.products.map(s=>s.nm)))??[]),_p=$(Bi,(e,t)=>t,(e,t)=>e==null?void 0:e.find(({id:s})=>s===t)),yM=$($d,e=>e==null?void 0:e.products.map(({nm:t})=>t)),wM={list:Bi,card:$d,advertById:_p,useList:b(Bi),useCard:b($d),useCardNms:b(yM),useAdvertById:te(_p),useListNms:b(gM)};function Dw(e){const t=[];return"subjects"in e&&e.subjects.map(({nms:s})=>{s==null||s.forEach(({nm:o,name:a})=>t.push({nm:o,name:a}))}),"nms"in e&&e.nms.map(({nm:s,name:o})=>t.push({nm:s,name:o})),t}function Aw(e){var s,o,a;let t;switch(e.type){case Dt.Auto:{t=(o=(s=e.autoParams)==null?void 0:s.nms)==null?void 0:o.map(r=>({nm:r}));break}case Dt.SearchCatalog:{t=(a=e.unitedParams)==null?void 0:a.reduce((r,i)=>(i.nms.forEach(l=>{r.push({nm:l})}),r),[]);break}default:t=e.params.reduce((r,i)=>(i.nms.forEach(({active:l,nm:c})=>{l&&r.push({nm:c})}),r),[])}return{name:e.name,type:e.type,id:e.advertId,createTime:new Date(e.createTime),statusId:e.status,products:t||[]}}function SM(e,t){const s=Aw(e);return s.products=Dw(t),s}function xM(e){return{name:e.campaign_name,type:e.type,id:e.id,createTime:new Date(e.create_date),statusId:e.status_id,products:[]}}function bM(e){return{name:e.campaignName,type:e.type,id:e.id,createTime:new Date(e.createDate),statusId:e.statusId,products:e.products.map(({nm:t,name:s})=>({nm:t,name:s}))}}function vM(e,t){return{name:e.campaign_name,type:e.type,id:e.id,createTime:new Date(e.create_date),statusId:e.status_id,products:Dw(t)}}const lr={fromApi:Aw,fromCmp:xM,fromCmpOld:bM,fromApiWithPlacement:SM,fromCmpWithPlacement:vM},Lw=()=>new ly("wb",404,{message:"–ö–∞–º–ø–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",handled:!0});function*jM(e){try{const t=yield u(SC.getInfo,e.id),s=yield u(lo.getPlacement,t.type,t.id);yield S(Br.setCard(lr.fromCmpWithPlacement(t,s)))}catch(t){throw t instanceof ly&&["–ø–æ –¥–∞–Ω–Ω–æ–º—É –ø–æ—Å—Ç–∞–≤—â–∏–∫—É –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∫–∞–º–ø–∞–Ω–∏–π","–ö–æ–º–ø–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"].find(s=>t.message.toLowerCase().includes(s.toLowerCase()))?Lw():t}}function*CM(e){const t=yield u(yy.getAdverts,{ids:[e.id]});if(t.length===0)throw Lw();let s=lr.fromApi(t[0]);if(s.products.length===0){const o=yield u(lo.getPlacement,s.type,s.id);s=lr.fromApiWithPlacement(t[0],o)}yield S(Br.setCard(s))}function*$M(e){try{yield u(CM,e)}catch(t){if(t instanceof ds){yield u(jM,e);return}throw t}}function*kM(e){const{content:t}=yield u(gC.getList,e);yield S(Br.setList(t.map(lr.fromCmp)))}function*NM(e){const t=yield u(yy.getAdverts,{ids:e});yield S(Br.setList(t.map(lr.fromApi)))}function*TM(e){try{yield u(NM,e.ids)}catch(t){if(t instanceof ds){yield u(kM,e.cmpListParams);return}throw t}}const PM={load:$M,loadList:TM},pe={config:Ou,actions:Br,selectors:wM,sagas:PM},rc=k("entity/wb/marketplace-user-geo"),sn={modelName:rc(),storageKey:`${W.appName}/${rc("storage-key")}`,lsKey:"geo-data-v1",lsBasketKeys:["wbx___basketMgrt","wb___basketMgrt"],event:{save:rc("save")}},Ip={},Rw=_({name:sn.modelName,initialState:Ip,reducers:{setData:D("data"),reset:()=>Ip}}),MM=E.inject(Rw),jl={...Rw.actions},FM=V(sn.modelName,MM),kd=FM("data"),Nd=$(kd,e=>{if(!e)return;let t=e.address,s=e.destinations[e.destinations.length-1];return t||(e.latitude&&e.longitude?t=`${e.latitude}, ${e.longitude}`:t=s.toString()),{address:t,value:s}}),DM=$([Nd,ge.selectors.pickupPoints],(e,t)=>(e==null?void 0:e.value)||(t==null?void 0:t[0].points[0].dest)||-364001),Ew={data:kd,destination:Nd,destinationValue:DM,useData:b(kd),useDestination:b(Nd)},Td=Ue(sn.storageKey,{type:Qe.Local}),Pd=new RegExp(`${sn.lsKey}-\\w{5,}`,"i");function AM(){try{let e="0";for(const a of sn.lsBasketKeys){const r=localStorage.getItem(a);if(r){e=r;break}}let t=localStorage.getItem(`${sn.lsKey}-${e}`)||void 0;if(t)return JSON.parse(t);const o=Object.keys({...localStorage}).find(a=>a&&Pd.test(a));return o&&(t=localStorage.getItem(o)||void 0),JSON.parse(t)}catch(e){const t=Object.keys({...localStorage}),s=t.filter(a=>a&&Pd.test(a)),o={keys:t,availableValues:s.reduce((a,r)=>(a[r]=localStorage.getItem(r),a),{})};throw new Sa("–í localStorage –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–ª—é—á–µ–π",{cause:e,extras:o})}}const LM=du({key:e=>Pd.test(e),parser:JSON.parse}),_w=Dn(sn.event.save);function*RM(){const e=yield u(Td.get);e&&(yield S(jl.setData(e)))}function*EM(){const{data:e}=yield u(AM);if(!Array.isArray(e.destinations)||e.destinations.length===0)throw new Error("–í –∑–Ω–∞—á–µ–Ω–∏–∏ –∏–∑ localStorage –Ω–µ—Ç destinations");yield S(jl.setData(e))}function*_M(){const e=yield u(V$.get);yield S(jl.setData(e))}function*IM(){const[e,t]=yield I([u(Td.get),F(Ew.data)]);t&&e!==t&&(yield u(Td.set,t),yield u(_w.post,t))}function*OM(){const t=yield u(()=>Cu(LM));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*VM(){const t=yield u(()=>An(_w.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*qM(){try{try{yield u(EM)}catch{yield u(_M)}}catch(e){Mn({error:e,name:`${sn.modelName}/load`})}}const BM={load:RM,save:IM,loadLocalStorageOrApi:qM,setGeoChannel:OM,saveChannel:VM},Ve={config:sn,actions:jl,selectors:Ew,sagas:BM},Cl=V($a.modelName,rM),Iw=Cl("loadingCatalog"),Ow=Cl("loadingKeyword"),Vw=Cl("loadingQuery"),qw=Cl("loadingRecommendation"),Op=$([pe.selectors.card,Ve.selectors.destinationValue],(e,t)=>{var o;return e?{dest:t,nm:(o=e==null?void 0:e.products[0])==null?void 0:o.nm,itemLimit:$a.itemLimit[0]}:void 0}),$l=e=>$([e],t=>t?Object.values(t).filter(s=>s).length:0),WM=$l(Iw),zM=$l(Ow),GM=$l(Vw),KM=$l(qw),HM={loadingCatalog:Iw,loadingKeyword:Ow,loadingQuery:Vw,loadingRecommendation:qw,defaultSearchParams:Op,useDefaultSearchParams:b(Op),useCountLoadingCatalog:b(WM),useCountLoadingKeyword:b(zM),useCountLoadingQuery:b(GM),useCountLoadingRecommendation:b(KM)};function ka(e,t){const s=[];return e.forEachNodeAfterFilterAndSort(o=>{var a;t&&s.length>=t||o.level===0&&(o.data&&s.push(o.data),(a=o.childrenAfterFilter)!=null&&a[0].data&&s.push(o.childrenAfterFilter[0].data))}),s}const ri=(e,t,s)=>e.reduce((o,a)=>(o[a[t]]=s,o),{});function Wr(e){var t,s,o,a;return((s=(t=e.position)==null?void 0:t.result)==null?void 0:s.notFoundReason)!=="outOfRange"?(a=(o=e.position)==null?void 0:o.result)==null?void 0:a.page:void 0}const UM="o4orAcI",QM="bn8YeAg",YM="gZDZOb7",JM="KwwPuWT",ZM="UCoXs9y",Xt={formSection:UM,regionSelector:QM,label:YM,labelText:JM,buttonLabel:ZM},XM=$a.itemLimit.map(e=>({label:e.toString(),value:e}));function kl({form:e,countLoadingPosition:t=0,nms:s=[],onFormChange:o,onSearchClick:a,onResetSearchClick:r,buttonLabel:i="–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤",buttonStopLabel:l="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å",itemLimitLabel:c="–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–ª—é—á–µ–π"}){const d=Ve.selectors.useDestination(),p=m.useMemo(()=>{if(d)return{label:d.address,value:d.value}},[d]),h=C=>{o({...e,...C})},g=!(e!=null&&e.nm)||!e.dest||!e.itemLimit,y=t>0,w=m.useMemo(()=>s.map(C=>({label:C.toString(),value:C})),[s]);return n.jsxs(f,{gap:"s",className:Xt.formSection,children:[n.jsx("div",{className:Xt.label,children:y?n.jsx(A,{type:"grey",prefix:n.jsx(z.StopCircle,{}),onClick:()=>r(),disabled:g,size:"middle",children:n.jsxs(f,{type:"horizontal",align:"center",wrap:!1,className:Xt.buttonLabel,children:[n.jsx("span",{children:l}),n.jsx("span",{children:"/"}),n.jsxs(f,{type:"horizontal",align:"center",justify:"center",wrap:!1,style:{flex:1},children:[n.jsx(As,{})," –û—Å—Ç–∞–ª–æ—Å—å: ",t]})]})}):n.jsx(A,{type:"purple",prefix:n.jsx(z.Play,{}),onClick:()=>a(e||{}),disabled:g,size:"middle",children:n.jsx(f,{type:"horizontal",align:"center",justify:"center",display:"block",className:Xt.buttonLabel,children:n.jsx("span",{children:i})})})}),n.jsx(ns,{title:c,className:Xt.label,labelClassName:Xt.labelText,children:n.jsx(la,{size:"middle",value:e==null?void 0:e.itemLimit,onChange:C=>h({itemLimit:C}),options:XM})}),n.jsx(ns,{title:"–†–µ–≥–∏–æ–Ω –ø—Ä–æ–≤–µ—Ä–∫–∏",className:Xt.label,labelClassName:Xt.labelText,children:n.jsx(ON,{size:"middle",value:e==null?void 0:e.dest,onChange:C=>h({dest:C}),currentLocationOption:p,className:Xt.regionSelector})}),s&&s.length>1&&n.jsx(ns,{title:"–ê—Ä—Ç–∏–∫—É–ª",className:Xt.label,labelClassName:Xt.labelText,children:n.jsx(la,{size:"middle",value:e==null?void 0:e.nm,onChange:C=>h({nm:C}),options:w})})]})}function Nl({onSearchClick:e,...t}){const{value:s}=t;return s?s!=null&&s.loading?n.jsx(As,{}):s!=null&&s.result?n.jsx(Mu,{position:s.result??void 0,onRepeatClick:()=>e(t)}):n.jsx(A,{prefix:n.jsx(z.Play,{}),size:"small-grid",onClick:()=>e(t),children:"–ø—Ä–æ–≤–µ—Ä–∏—Ç—å"}):null}const je={actions:Mt,config:$a,sagas:pM,selectors:HM};function eF({query:e}){const t=po.selectors.useDataByQuery(e),{load:s}=x(po.actions),o=m.useCallback(a=>{a!=null&&a.failedNms&&a.dest&&a.query&&s({pageFrom:Wr({position:{result:a}}),nms:a.failedNms,destinations:[a.dest],queries:[a.query]})},[]);return t?n.jsx(BT,{data:t,style:{flex:1},onRepeatSearch:o}):null}const tF="gSqVAQV",sF={label:tF};function nF(){const e=po.selectors.useSearchParams(),[t,s]=m.useState(e==null?void 0:e.queries[0]),o=m.useMemo(()=>((e==null?void 0:e.queries)||[]).map(a=>({value:a,label:a})),[e==null?void 0:e.queries]);return n.jsxs(f,{type:"vertical",gap:"4xl",style:{height:"75vh",minHeight:800},children:[n.jsx(ns,{title:"–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π –∑–∞–ø—Ä–æ—Å",className:sF.label,children:n.jsx(la,{value:t,options:o,onChange:s})}),t&&n.jsxs(n.Fragment,{children:[n.jsx(oM,{query:t}),n.jsx(eF,{query:t})]})]})}function oF(){const e=ho.selectors.useData();return e?n.jsx(CP,{data:e,style:{height:"75vh"}}):null}function aF(){const e=ho.selectors.useFrequencyData(),t=ho.selectors.useLoading();return e.length===0&&t?n.jsx(le,{}):n.jsx(TP,{data:e,style:{height:"75vh"}})}function rF(){const e=ho.selectors.useQuantityData(),t=ho.selectors.useLoading();return e.length===0&&t?n.jsx(le,{}):n.jsx(kP,{data:e,style:{height:"75vh"}})}const iF=[{value:"search-position",label:"–ü–æ–∑–∏—Ü–∏–∏ –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö"},{value:"warehouse-delivery",label:"–°–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏"},{value:"warehouse-quantity",label:"–û—Å—Ç–∞—Ç–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤"},{value:"warehouse-frequency",label:"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Å–∫–ª–∞–¥—ã"}];function lF(){const{setView:e}=x(mo),{reset:t}=x(No.actions),{resetRegion:s}=x(Ke.actions),o=ar.useView(),a=m.useCallback(()=>{e(void 0),t(),s()},[]);if(m.useEffect(()=>a,[]),!o)return n.jsx(nM,{onSubmit:()=>e("search-position")});let r;switch(o){case"search-position":r=n.jsx(nF,{});break;case"warehouse-delivery":r=n.jsx(oF,{});break;case"warehouse-quantity":r=n.jsx(rF,{});break;case"warehouse-frequency":r=n.jsx(aF,{});break}return n.jsxs(f,{type:"vertical",gap:"4xl",children:[n.jsxs(f,{type:"horizontal",gap:"s",children:[n.jsx("div",{style:{flex:1},children:n.jsx(an,{options:iF,value:o,onChange:e})}),n.jsx(A,{type:"grey",onClick:a,children:"–ù–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑"})]}),n.jsx(H,{children:n.jsx("div",{style:{minHeight:"75vh"},children:r})})]})}function cF(){const e=ar.useShowModal(),t=ar.useView(),{resetResult:s,loadAbort:o}=x(mo);return m.useEffect(()=>{e&&Te.pageView(en.modelName)},[e]),m.useEffect(()=>{t||o()},[t]),n.jsx(Ye,{open:e,onCloseClick:()=>s(),title:"–ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–π –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏ —Å–∫–ª–∞–¥–æ–≤",style:{maxWidth:t?"90vw":1100},children:n.jsx(H,{children:n.jsx(lF,{})})})}const Tl={actions:mo,config:en,sagas:DP,selectors:ar},ic=k("process/main"),Na={modelName:ic(),loading:{info:ic("info"),init:ic("init")}},Vp={isReady:!1},Bw=_({name:Na.modelName,initialState:Vp,reducers:{setIsReady:D("isReady"),reset:()=>Vp}}),dF=E.inject(Bw),uF=Q(Na.modelName),Vu={...Bw.actions,initApp:uF("initApp")},lc=k("entity/wb/supplier"),_n={modelName:lc(),analytics:{clickSave:"clickSave"},cookie:{id:"x-supplier-id-external"},storageKey:`${W.appName}/${lc("storage-key")}`,subscriptions:{jam:[1001,1002,1003]},localStorage:{accessToken:"access-token"},event:{saveList:lc("save-list")}},qp={},Ww=_({name:_n.modelName,initialState:qp,reducers:{setSupplier:D("supplier"),setSupplierUuid:D("supplierUuid"),setList:D("list"),reset:()=>qp}}),mF=E.inject(Ww),ca={...Ww.actions},qu=V(_n.modelName,mF),Md=qu("supplier"),Fd=qu("supplierUuid"),Wi=qu("list"),pF=$([Wi,(e,t)=>t],(e,t)=>e==null?void 0:e.find(s=>s.id===t)),hF=$([Wi,Fd],(e,t)=>e==null?void 0:e.find(s=>s.id===t)),Bp=$(Md,e=>{var t,s;return(s=(t=e==null?void 0:e.contract)==null?void 0:t[0])==null?void 0:s.supplier_id}),Bu={supplier:Md,useSupplier:b(Md),supplierId:Bp,useSupplierId:b(Bp),supplierById:pF,useSupplierCurrent:b(hF),list:Wi,useList:b(Wi),supplierUuid:Fd,useSupplierUuid:b(Fd)},Dd=Ue(_n.storageKey,{type:Qe.Local});function fF(e){return{id:e.id,oldId:e.oldID,name:e.name,inn:e.inn,ogrnip:e.ogrnip,hasJam:!!e.subscriptions.find(({id:t,active:s})=>_n.subscriptions.jam.includes(Number(t))&&s===!0)}}function*gF(){const e=cu.get(_n.cookie.id);yield S(ca.setSupplierUuid(e))}function*yF(){let e;try{e=yield il(10,500,()=>{const t=localStorage.getItem(_n.localStorage.accessToken);if(t)return t;throw Error("Can't read access-token in localStorage")})}catch{const t=yield u(Km.getToken);if(t.result!==0||!t.payload||(yield u(Km.confirmToken,t.payload.sticker)).result!==0)return;e=t.payload.access_token}e&&cy(e)}function*wF({intercepted:e}={}){if(e){yield S(ca.setSupplier(e));return}const t=yield F(Bu.supplierUuid),s=yield u(iu.getInfo,t);yield S(ca.setSupplier(s))}function*SF(){const t=yield u(()=>Ar(iu.getInfoInterceptor));function*s(){const o=yield ne(t),r=new Headers(o.request.headers).get("Authorizev3");return r&&cy(r),o}return{channel:t,takeEvent:s}}const zw=Dn(_n.event.saveList);function*xF(){const[e,t]=yield I([u(Dd.get),F(Bu.list)]),s=!Ov(e,t);t&&s&&(yield u(Dd.set,t)),t&&(yield u(zw.post,{value:t,isUpdated:s}))}function*bF(){const e=yield u(k$.getUserSuppliers),t=e==null?void 0:e.suppliers.map(fF);yield S(ca.setList(t))}function*vF(){const e=yield u(Dd.get);yield S(ca.setList(e))}function*jF(){const t=yield u(()=>An(zw.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}const CF={auth:yF,load:wF,loadList:vF,loadListApi:bF,saveList:xF,saveListChannel:jF,readUuid:gF,loadChannel:SF},$F={oldId:"ID",name:"–ù–∞–∑–≤–∞–Ω–∏–µ"},ie={config:_n,actions:ca,selectors:Bu,sagas:CF},Wp=k("feature/apply-error-rules"),Pl={modelName:Wp(),storageKey:`${W.appName}/${Wp("storage-key")}`,loadAfter:[6,"hour"]},kF=[{name:"RequestAdapterContextLostError",allow:!1},{name:"HandledError",allow:!1}],cc=k("entity/evirma/error-rules"),Ta={modelName:cc(),storageKey:`${W.appName}/${cc("storage-key")}`,event:{load:cc("load")},defaultRules:kF},zp={},Gw=_({name:Ta.modelName,initialState:zp,reducers:{setList:D("list"),reset:()=>zp}}),NF=E.inject(Gw),Kw={...Gw.actions},TF=V(Ta.modelName,NF),PF=TF("list"),Hw={list:PF},Gp=Ue(Ta.storageKey,{type:Qe.Local}),Uw=Dn(Ta.event.load);function*MF({force:e}){let t;e?(t=yield u(dC.list),yield u(Gp.set,t),yield u(Uw.post,t)):t=yield u(Gp.get),yield S(Kw.setList(t))}function*FF(){const e=yield F(Hw.list);e&&Aj([...Ta.defaultRules,...e])}function*DF(){const t=yield u(()=>An(Uw.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}const AF={load:MF,applyRules:FF,loadChannel:DF},Qa={config:Ta,actions:Kw,selectors:Hw,sagas:AF},Kp=Ue(Pl.storageKey,{type:Qe.Local});function*Qw(){let e=!1;const t=yield u(Kp.get),s=R();(!t||s>R(t))&&(yield u(Kp.set,s.add(...Pl.loadAfter).toJSON()),e=!0),yield u(Qa.sagas.load,{force:e}),yield u(Qa.sagas.applyRules)}function*LF(){yield u(Qw);const{channel:e,takeEvent:t}=yield u(Qa.sagas.loadChannel);try{for(;;){const s=yield u(t);yield S(Qa.actions.setList(s)),yield u(Qa.sagas.applyRules)}}finally{e.close()}}function*RF(){}K(Pl.modelName,RF);const EF={load:Qw,watchLoadChannel:LF},Hp={config:Pl,sagas:EF},Up=k("feature/cmp-advert-keywords-stats-log"),fo={modelName:Up(),loading:{load:Up("load")},viewThreshold:100},Qp={},Yw=_({name:fo.modelName,initialState:Qp,reducers:{reset:()=>Qp}});E.inject(Yw);const _F=Q(fo.modelName),Jw={...Yw.actions,save:_F("save")},dc=k("entity/evirma/keyword-stats-log"),zr={modelName:dc(),storageKey:`${W.appName}/${dc("storage-key")}`,event:{saveLastSend:dc("save-last-send")}},Yp={},Zw=_({name:zr.modelName,initialState:Yp,reducers:{setLastSend:Je("lastSend"),reset:()=>Yp}}),IF=E.inject(Zw),Wu={...Zw.actions},OF=V(zr.modelName,IF),Xw=OF("lastSend"),VF=$([Xw,(e,t)=>t],(e,t)=>e==null?void 0:e[t]),zu={lastSend:Xw,lastSendByNm:VF},eS=Ue(zr.storageKey,{type:Qe.Local});function qF(e){return Object.entries(e||{}).reduce((t,[s,o])=>(t[Number(s)]=new Date(o),t),{})}const tS=Dn(zr.event.saveLastSend);function*sS(){if(yield F(zu.lastSend))return;const t=yield u(eS.get);yield S(Wu.setLastSend(qF(t)))}function*BF({nm:e}){yield u(sS);const t={[e]:R().startOf("day").toDate()};yield S(Wu.setLastSend(t));const s=yield F(zu.lastSend);s&&(yield u(eS.set,s)),yield u(tS.post,t)}function*WF(){const t=yield u(()=>An(tS.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*zF({nm:e,data:t}){const s=t.map(({date:o,...a})=>({article:e,date:R(o).format("YYYY-MM-DD"),...a}));yield u(Lt.sendKeywordsCtrData,s)}const GF={loadLastSend:sS,saveLastSend:BF,saveLastSendChannel:WF,save:zF},na={config:zr,actions:Wu,selectors:zu,sagas:GF},KF=k("entity/wb/advert-keywords-stats"),Xn={modelName:KF(),columnParams:{rowViewsThreshold:100,totalRowCtrLowMultiplier:.6,totalRowCtrHighMultiplier:1.75}},Jp={},nS=_({name:Xn.modelName,initialState:Jp,reducers:{setStats:D("stats"),reset:()=>Jp}}),HF=E.inject(nS),oS={...nS.actions},UF=V(Xn.modelName,HF),Zp=UF("stats"),QF={stats:Zp,useStats:b(Zp)},De={clicks:"–ö–ª–∏–∫–∏",cpc:"CPC",cpm:"CPM",ctr:"CTR",sum:"–ó–∞—Ç—Ä–∞—Ç—ã",views:"–ü–æ–∫–∞–∑—ã",date:"–î–∞—Ç–∞",id:"ID",keyword:"–ö–ª—é—á–µ–≤–∞—è —Ñ—Ä–∞–∑–∞",days:"–î–∞—Ç—ã"};function YF(e,t){var a;const s=e.data.message,o=s!=null&&s.includes(t)?parseInt(((a=s.match(/(\d+)\s+(–¥–Ω–µ–π|—Å—É—Ç–æ–∫)/))==null?void 0:a[1])||"0")-1:0;if(o<=0)throw e;return o}const JF=["sum","clicks","views"],Xp=new WeakMap;function Ao(e){let t=Xp.get(e);if(!t){const s=e.reduce((o,{data:a,aggData:r})=>(JF.forEach(i=>{var c;const l=r?r[`stats.${i}`]:(c=a==null?void 0:a.stats)==null?void 0:c[i];o[i]=(o[i]||0)+(l||0)}),o),{});if(s){const o=Ad(s);t={...s,...o},Xp.set(e,t)}}return t}function Qn(e,t){if(e.level===-1){const s=t.getSelectedNodes();return s.length?s:e.childrenAfterFilter||[]}return e.childrenAfterFilter||[]}function ii(e,t){var s,o,a;return((o=(s=e.data)==null?void 0:s.stats)==null?void 0:o[t])??((a=e.node.aggData)==null?void 0:a[`stats.${t}`])}function ZF(e){var o;const t=e.api.getDisplayedRowCount()-1,s=e.api.getDisplayedRowAtIndex(t);return(o=s==null?void 0:s.aggData)==null?void 0:o["stats.ctr"]}function aS({onClick:e,...t}){return n.jsx(Nu,{onClick:()=>e(t),children:n.jsx(Oe,{placement:"top",overlay:"–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª—é—á. —Ñ—Ä–∞–∑—ã –ø–æ –¥–Ω—è–º",mouseEnterDelay:.5,children:n.jsx(jt,{prefix:n.jsx(z.Calendar,{style:{fontSize:"120%"}}),children:"–ø–æ –¥–Ω—è–º"})})})}const XF="ExpNL4e",eD="XnED8cf",tD={wrapper:XF,chart:eD},sD=Rn(),nD={id:"shared",type:"linear",position:"left",beginAtZero:!0,display:!0},oD={pointRadius:0,pointHoverRadius:0,id:"value",fill:"start",tension:.4,borderJoinStyle:"round",scale:nD,maxBarThickness:2,...sD()},eh=({value:e,labelField:t})=>{const s=Ae.useMemo(()=>[{...oD,id:t}],[t]);return!Array.isArray(e)||!e.length?null:n.jsx(En,{lineData:e,isCompact:!0,labelField:t,lineDefs:s,type:"bar",classNames:tD,showTooltip:!1,sidebar:!1,showAxios:!1})},aD="G7URUZR",rD="gEm-HGk",iD="WvYPE4n",lD="NkeD4B-",cD="t9V5P4W",dD="JS5YdxK",us={badHighlight:aD,minorHighlight:rD,goodHighlight:iD,headerColumn:lD,headerColumnChart:cD,cellColumnChart:dD},Gu=({onDailyShowClick:e})=>[{headerName:"–ü–æ–∫–∞–∑ –≥—Ä–∞—Ñ.",colId:"stats.days.views",headerClass:us.headerColumnChart,cellClass:us.cellColumnChart,width:50,filter:!1,floatingFilter:!1,aggFunc:({rowNode:t})=>{var o;if(t.level===-1)return null;const s=wn(t);return(o=s==null?void 0:s.stats)==null?void 0:o.days},onCellClicked:({node:t})=>{const s=wn(t);!s||!e||e(s)},cellRendererSelector:()=>({component:eh,params:{labelField:"views"}})},{field:"stats.views",cellClass:us.cellForColumnChart,type:["numeric","zeroValue"],filter:"agNumberColumnFilter",floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,headerName:De.views,sort:"desc",width:90,filterValueGetter:Tt,aggFunc:({rowNode:t,api:s})=>{var a;const o=Qn(t,s);if(o.length>0)return(a=Ao(o))==null?void 0:a.views}},{field:"stats.clicks",type:["numeric","zeroValue"],filter:"agNumberColumnFilter",floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,headerName:De.clicks,width:82,filterValueGetter:Tt,aggFunc:({rowNode:t,api:s})=>{var a;const o=Qn(t,s);if(o.length>0)return(a=Ao(o))==null?void 0:a.clicks}},{colId:"stats.days.ctr",headerClass:us.headerColumnChart,headerName:"CTR –≥—Ä–∞—Ñ.",cellClass:us.cellColumnChart,width:50,filter:!1,floatingFilter:!1,aggFunc:({rowNode:t})=>{var o;if(t.level===-1)return null;const s=wn(t);return(o=s==null?void 0:s.stats)==null?void 0:o.days},onCellClicked:({node:t})=>{const s=wn(t);!s||!e||e(s)},cellRendererSelector:()=>({component:eh,params:{labelField:"ctr"}})},{field:"stats.ctr",type:["percent.2","zeroValue"],filter:"agNumberColumnFilter",floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,headerName:De.ctr,headerTooltip:"–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∫–ª–∏–∫–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∫–∞–∑–æ–≤",width:80,filterValueGetter:Tt,cellClass:t=>{const s=ii(t,"ctr"),o=ii(t,"views"),a=ZF(t);if(!s||!o)return us.minorHighlight;if(o>=Xn.columnParams.rowViewsThreshold){if(s<a*Xn.columnParams.totalRowCtrLowMultiplier)return us.badHighlight;if(s>a*Xn.columnParams.totalRowCtrHighMultiplier)return us.goodHighlight}else return us.minorHighlight;return""},aggFunc:({rowNode:t,api:s})=>{var a;const o=Qn(t,s);if(o.length>0)return(a=Ao(o))==null?void 0:a.ctr}},{field:"stats.cpc",type:["currency.2","zeroValue"],filter:"agNumberColumnFilter",floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,headerName:De.cpc,headerTooltip:"–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–∫–∞",width:80,filterValueGetter:Tt,cellClass:t=>{const s=ii(t,"ctr"),o=ii(t,"views");return!s||!o||o<Xn.columnParams.rowViewsThreshold?us.minorHighlight:""},aggFunc:({rowNode:t,api:s})=>{var a;const o=Qn(t,s);if(o.length>0)return(a=Ao(o))==null?void 0:a.cpc}},{field:"stats.cpm",type:["currency.0","zeroValue"],filter:"agNumberColumnFilter",floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,headerName:De.cpm,headerTooltip:"–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–π —Ç—ã—Å—è—á–∏ –ø–æ–∫–∞–∑–æ–≤ —Ä–µ–∫–ª–∞–º—ã",width:75,filterValueGetter:Tt,aggFunc:({rowNode:t,api:s})=>{var a;const o=Qn(t,s);if(o.length>0)return(a=Ao(o))==null?void 0:a.cpm}},{field:"stats.sum",type:["currency.0","zeroValue"],filter:"agNumberColumnFilter",floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,headerName:De.sum,width:95,filterValueGetter:Tt,aggFunc:({rowNode:t,api:s})=>{var a;const o=Qn(t,s);if(o.length>0)return(a=Ao(o))==null?void 0:a.sum}}],th=new WeakMap;function wn(e){var s,o;if(!e.childrenAfterGroup)return e.data;let t=th.get(e.childrenAfterGroup);if(!t){const a=(s=e.childrenAfterGroup)==null?void 0:s.sort((r,i)=>{var l,c;return(((l=i.data)==null?void 0:l.freq)||0)-(((c=r.data)==null?void 0:c.freq)||0)});t=(o=a==null?void 0:a[0])==null?void 0:o.data,th.set(e.childrenAfterGroup,t)}return t}function Ad(e){const{sum:t,clicks:s,views:o}=e,a=s&&o?ze(s/o*100,2):void 0,r=t&&s?ze(t/s,2):void 0,i=t&&o?ze(t*1e3/o,2):void 0;return{ctr:a,cpc:r,cpm:i}}function uD(e,t,s){return Array.from(e,([,o])=>{const a=s.get(o[t]);return{...o,...Ad(o),days:a?Array.from(a,([,r])=>({...r,...Ad(r)})).sort((r,i)=>r.date.valueOf()-i.date.valueOf()):[]}})}function sh(e,t,s){const o=new Map,a=new Map;return e?(Yo.sheet_to_json(e).forEach(i=>{const l=new Date(i.–î–∞—Ç–∞),c={views:i.–ü—Ä–æ—Å–º–æ—Ç—Ä—ã||0,clicks:i.–ö–ª–∏–∫–∏||0,sum:i.–ó–∞—Ç—Ä–∞—Ç—ã||0},d=t(i),p=d[s];let h=o.get(p);h||(h={...d,sum:0,clicks:0,views:0,days:[]},o.set(p,h)),h.views+=c.views,h.clicks+=c.clicks,h.sum=ze(h.sum+c.sum,2);let g=a.get(p);g||(g=new Map,a.set(p,g));let y=g.get(l.valueOf());y||(y={date:l,sum:0,clicks:0,views:0},g.set(l.valueOf(),y)),y.views+=c.views,y.clicks+=c.clicks,y.sum=ze(y.sum+c.sum,2)}),uD(o,s,a)):[]}function mD(e){const t=Pj(e,{type:"binary"}),s=sh(t.Sheets["–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º"],a=>({keyword:a["–ö–ª—é—á–µ–≤–∞—è —Ñ—Ä–∞–∑–∞"]}),"keyword"),o=sh(t.Sheets["–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É"],a=>({id:a["–ö–∞—Ç–∞–ª–æ–≥ ID"]}),"id");return{keywords:s,catalogs:o}}const pD={fromCmp:mD};function*nh({id:e,range:t}){const s=yield u($C.getStats,{id:e,interval:{begin:R(t.begin).utc(!0).toJSON(),end:R(t.end).utc(!0).toJSON()},appType:0});yield S(oS.setStats(pD.fromCmp(s)))}function*hD(e){try{yield u(nh,e)}catch(t){if(t instanceof ra){const s=YF(t,"–∑–∞ –ø–µ—Ä–∏–æ–¥ –Ω–µ –±–æ–ª–µ–µ");yield u(nh,{...e,range:{...e.range,begin:R(e.range.end).utc(!0).subtract(s-1,"day").startOf("day").toDate()}});return}throw t}}function*fD(e){var t;try{yield u(hD,e)}catch(s){throw s instanceof ra&&((t=s.data.message)!=null&&t.includes("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–æ–ª—É—á–µ–Ω–∏—è"))?new ra(s.service,s.status,{...s.data,message:"–°–µ—Ä–≤–∏—Å –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É —á–µ—Ä–µ–∑ 3 –º–∏–Ω—É—Ç—ã",handled:!0}):s}}const gD={load:fD},To={config:Xn,actions:oS,selectors:QF,sagas:gD};function*yD({card:e}){var l;const t=(l=e.products[0])==null?void 0:l.nm;if(!t)return;const s=yield F(To.selectors.stats);if(!s)return;const o=yield F(c=>na.selectors.lastSendByNm(c,t)),a=new Date,r=new Date(o||0),i=[];s.keywords.forEach(c=>{c.views>=fo.viewThreshold&&(c.days.forEach(d=>{d.views>=fo.viewThreshold&&R(d.date).isBetween(a,r,"day","[]")&&i.push({keyword:c.keyword,date:d.date,views:d.views,ctr:d.ctr})}),i.push({keyword:c.keyword,date:a,views:c.views,ctr:c.ctr}))}),yield u(na.sagas.save,{nm:t,data:i}),yield u(na.sagas.saveLastSend,{nm:t})}function*wD(){yield u(na.sagas.loadLastSend);const{channel:e,takeEvent:t}=yield u(na.sagas.saveLastSendChannel);try{for(;;){const s=yield u(t);yield S(na.actions.setLastSend(s))}}finally{e.close()}}function*SD(){yield I([N(Jw.save,T(yD,[M,et(fo.loading.load)]))])}K(fo.modelName,SD);const xD={watchSaveLastSendChannel:wD},rS={actions:Jw,config:fo,sagas:xD},ms=k("feature/job-execution"),de={modelName:ms(),loading:{run:ms("run"),load:ms("load"),transferFamousKeywords:ms("transfer-famous-keywords"),transferFunnelData:ms("transfer-funnel-data"),transferDiscountData:ms("transfer-discounts-data"),transferWbApiToken:ms("transfer-wb-api-token"),transferFunnelSeasonalityData:ms("transfer-funnel-seasonality-data"),transferFunnelComparisonsData:ms("transfer-funnel-comparisons-data")},storageKey:`${W.appName}/${ms("storage-key")}`},oh={list:[]},iS=_({name:de.modelName,initialState:oh,reducers:{setShowModal:D("showModal"),setList:D("list"),setResult:(e,{payload:t})=>{let s=!1;const o=e.list.map(a=>a.job===t.job&&a.supplierUuid===t.supplierUuid?(s=!0,{...a,...t,isCanRun:void 0}):a);s||o.push({...t,isCanRun:void 0}),e.list=o},reset:()=>oh}}),bD=E.inject(iS),ps=Q(de.modelName),we={...iS.actions,load:ps("load"),run:ps("run"),unlock:ps("unlock"),clear:ps("clear"),transferFamousKeywords:ps("transfer-famous-keywords"),transferFunnelData:ps("transfer-funnel-data-saga"),transferDiscountData:ps("transfer-discounts-data"),transferFunnelSeasonalityData:ps("transfer-funnel-seasonality-data"),transferFunnelComparisonsData:ps("transfer-funnel-comparisons-data"),transferWbApiToken:ps("transfer-wb-api-token")},vD=k("entity/evirma/jobs"),jD={modelName:vD()};function*CD(e){const t=yield u(Lt.checkUploadFamousKeywords,{debug:!1});let s;if(t.m?s="month":t.w&&(s="week"),e&&(s="week"),!s)return!1;const o=yield u(D$.getFamousKeywords,{period:s});if(!(o instanceof Blob))return!1;const a=new FormData;return a.append(s,o,s),yield u(Lt.uploadFamousKeywords,a),!0}function*$D(e){const t=yield u(Lt.checkFunnelData,{supplier:e});if(t.nothing_to_do)return!1;const s=t.to_data?R(t.to_data):R().startOf("day").add(-5,"days"),o=t.start_date?R(t.start_date):s.add(-30,"days"),{data:a}=yield u(ya.reportDetails,{currentPeriod:{start:o.format("YYYY-MM-DD"),end:s.format("YYYY-MM-DD")},nms:[],orderBy:{field:"addToCart",mode:"desc"},skipDeletedNm:!0,limit:100,offset:0});return a&&(yield u(Lt.uploadFunnelData,{supplier:e,dateStart:o.format("YYYY-MM-DD"),dateEnd:s.format("YYYY-MM-DD"),data:a})),!0}function*kD(e){var a;const{data:t}=yield u(E$.list,{limit:1e3,offset:0});if(!((a=t==null?void 0:t.listGoods)!=null&&a.length))return;const s=new Set,o=[];t.listGoods.forEach(({nmID:r,discountOnSite:i,subject:l,discountedPrices:c})=>{i&&c.forEach(d=>{const p=`${l}-${d}`;s.has(p)||(s.add(p),o.push({article:r,price:d,spp:i}))})}),yield u(Lt.uploadDiscountData,{supplier:e,data:o})}function*ND({force:e=!1,token:t,supplierUUID:s}){!e&&(yield u(Lt.checkWbApiToken,{supplier:s})).status==="ok"||(yield u(Lt.sendWbApiToken,{supplier:s,token:t}))}function*TD(e,t){var l;const o=(l=(yield u(xy.subjects,{},e)).data)==null?void 0:l.subjects.map(({id:c})=>c);if(!o||o.length===0)return!1;const a=yield u(Lt.checkFunnelSeasonalityData,{subjectIds:o,debug:t});if(!Array.isArray(a)||a.length===0)return!1;const[r]=a,i=yield u(ya.seasonality,{subjectId:r});return i.data&&(yield u(Lt.sendFunnelSeasonalityData,{subjectId:r,data:i.data})),!0}function*PD(e,t){var l;const o=(l=(yield u(xy.subjects,{},e)).data)==null?void 0:l.subjects.map(({id:c})=>c);if(!o||o.length===0)return!1;const a=yield u(Lt.checkFunnelComparisonsData,{supplier:e,subjectIds:o,debug:t});if(!Array.isArray(a)||a.length===0)return!1;const[r]=a,i=yield u(ya.comparisons,{subjectId:r.subject,start:r.start_date,end:r.end_date});return yield u(Lt.sendFunnelComparisonsData,{supplier:e,subjectId:r.subject,data:i.data}),!0}function*MD({supplierUUID:e,turnover:t}){yield u(Lt.sendTurnoverData,{supplier:e,value:t})}const FD={transferFamousKeywords:CD,transferFunnelData:$D,transferDiscountData:kD,transferWbApiToken:ND,transferFunnelSeasonalityData:TD,transferFunnelComparisonsData:PD,transferTurnoverData:MD},Po={config:jD,sagas:FD},uc=k("entity/wb/token"),Gr={modelName:uc(),storageKey:`${W.appName}/${uc("storage-key-v2")}`,storageKeyOld:`${W.appName}/${uc("storage-key")}`},ah={},lS=_({name:Gr.modelName,initialState:ah,reducers:{setList:D("list"),reset:()=>ah}}),DD=E.inject(lS),Ku={...lS.actions};var ve=(e=>(e.TestContour="testContour",e.Content="content",e.Analytics="Analytics",e.PricesDiscounts="PricesDiscounts",e.Marketplace="Marketplace",e.Statistics="Statistics",e.Promotion="Promotion",e.QuestionsFeedbacks="QuestionsFeedbacks",e.Recommendations="Recommendations",e.Chat="Chat",e.Supplies="Supplies",e.Returns="Returns",e.TokenReadOnly="TokenReadOnly",e.TokenReadWrite="TokenReadWrite",e))(ve||{});function AD({s:e}){const t=[];return e==0&&t.push("testContour"),(e>>1)%2!=0&&t.push("content"),(e>>2)%2!=0&&t.push("Analytics"),(e>>3)%2!=0&&t.push("PricesDiscounts"),(e>>4)%2!=0&&t.push("Marketplace"),(e>>5)%2!=0&&t.push("Statistics"),(e>>6)%2!=0&&t.push("Promotion"),(e>>7)%2!=0&&t.push("QuestionsFeedbacks"),(e>>8)%2!=0&&t.push("Recommendations"),(e>>9)%2!=0&&t.push("Chat"),(e>>10)%2!=0&&t.push("Supplies"),(e>>11)%2!=0&&t.push("Returns"),t.length==0||((e>>30)%2!=0?t.push("TokenReadOnly"):t.push("TokenReadWrite")),t}function Hu(e){try{return JSON.parse(atob(e.split(".")[1]))}catch{throw new Error("Can't parse JWT token")}}function Uu(e){try{const t=Hu(e);if(!t)return;const s=new Date(t.exp*1e3);return{payload:t,expiredAt:s,isExpired:new Date>s,scopes:AD(t)}}catch{return}}const LD={[ve.TestContour]:"–¢–µ—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç—É—Ä",[ve.Content]:"–ö–æ–Ω—Ç–µ–Ω—Ç",[ve.Analytics]:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞",[ve.PricesDiscounts]:"–¶–µ–Ω—ã –∏ —Å–∫–∏–¥–∫–∏",[ve.Marketplace]:"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å",[ve.Statistics]:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",[ve.Promotion]:"–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ",[ve.QuestionsFeedbacks]:"–í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–∑—ã–≤—ã",[ve.Chat]:"–ß–∞—Ç —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏",[ve.Supplies]:"–ü–æ—Å—Ç–∞–≤–∫–∏",[ve.Returns]:"–í–æ–∑–≤—Ä–∞—Ç—ã",[ve.Recommendations]:"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",[ve.TokenReadOnly]:"–¢–æ–∫–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ",[ve.TokenReadWrite]:"–¢–æ–∫–µ–Ω –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å"};function Ei(e){return LD[e]||e.toString()}const RD=V(Gr.modelName,DD),cS=RD("list"),dS=$([cS,(e,t)=>t],(e,t)=>t?e==null?void 0:e[t]:void 0),ED=$([cS,(e,t)=>t],(e,t)=>{if(e)for(const s in e){const o=e[s],a=Uu(o);if((a==null?void 0:a.payload.sid)===t)return o}}),rh=$(dS,e=>e?Uu(e):void 0),_D={tokenBySid:ED,parsedTokenByUuid:rh,useToken:te(dS),useParsedToken:te(rh)},da=Ue(Gr.storageKey,{type:Qe.Sync}),ID=Ue(Gr.storageKeyOld,{type:Qe.Sync});function*OD(){yield u(VD);const e=yield u(da.get);e&&(yield S(Ku.setList(e)))}function*VD(){const e=yield u(da.get),t=yield u(ID.get);if(Object.keys(e||{}).length>0||Object.keys(t||{}).length===0)return;const s=yield u(iu.getSuppliers),o=s==null?void 0:s.result.suppliers.reduce((a,{id:r,oldID:i})=>(t&&t[i]&&(a[r]=t[i]),a),{});yield u(da.set,o)}function*qD(e,t){const o={...(yield u(da.get))||{},[e]:t};yield u(da.set,o),yield S(Ku.setList(o))}function*BD(e){const t=yield u(da.get);t&&kC(t[e])}const WD={load:OD,add:qD,setRequestApiToken:BD},Ms={config:Gr,actions:Ku,selectors:_D,sagas:WD},uS=V(de.modelName,bD),zD=uS("showModal"),Ld=uS("list"),GD=$([Ld,(e,t)=>t],(e,t)=>{const s=e==null?void 0:e.find(o=>o.job===t.job&&o.supplierUuid===t.supplierUuid);return{...s||t,canRun:s!=null&&s.runAfter?new Date(s.runAfter)<new Date:!0}}),Ml={list:Ld,jobResult:GD,useList:b(Ld),useShowModal:b(zD)},Qu=Ue(de.storageKey,{type:Qe.Local}),Lo=e=>function*(...s){let o;try{o=yield u(e,...s)}finally{yield S(we.unlock())}return o};function*Pa({jobName:e,force:t,checkJam:s}){const o=yield F(ie.selectors.supplierUuid);if(!o)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –ø—Ä–æ–¥–∞–≤—Ü–∞");if(s){const i=yield F(ie.selectors.supplierById,o);if(!(i!=null&&i.hasJam))return}const a=yield F(Ml.jobResult,{supplierUuid:o,job:e});if(!t&&!a.canRun)return;const r={...a,status:"in-progress"};return{supplierUuid:o,lock:i=>(r.runAfter=R(i).toJSON(),S(we.setResult(r))),complete:(i=!0)=>S(we.setResult({...r,status:i?"success":"skip"})),error:i=>S(we.setResult({...r,runAfter:R(i||r.runAfter).toJSON(),status:"error"}))}}function*KD({debug:e}){const t=yield u(Pa,{jobName:de.loading.transferFamousKeywords});if(t){yield t.lock(R().add(10,"hour"));try{const s=yield u(Po.sagas.transferFamousKeywords,e);yield t.complete(s)}catch(s){throw yield t.error(),s}}}function*HD(){const e=yield u(Pa,{jobName:de.loading.transferFunnelData});if(e){yield e.lock(R().add(300,"minutes"));try{const t=yield u(Po.sagas.transferFunnelData,e.supplierUuid);yield e.complete(t)}catch(t){throw yield e.error(),t}}}function*UD(){const e=yield u(Pa,{jobName:de.loading.transferDiscountData});if(e){yield e.lock(R().add(100,"minutes"));try{yield u(Po.sagas.transferDiscountData,e.supplierUuid),yield e.complete()}catch(t){const s=t instanceof lu&&t.service==="wb";throw yield e.error(s?R().add(1,"day"):void 0),t}}}function*QD({force:e}){const t=yield u(Pa,{jobName:de.loading.transferWbApiToken,force:e});if(!t)return;const s=yield F(o=>Ms.selectors.tokenBySid(o,t.supplierUuid));if(s){yield t.lock(R().add(1,"hour"));try{yield u(Po.sagas.transferWbApiToken,{supplierUUID:t.supplierUuid,token:s,force:!0}),yield t.complete()}catch(o){throw yield t.error(),o}}}function*YD({debug:e}){const t=yield u(Pa,{jobName:de.loading.transferFunnelSeasonalityData,checkJam:!0});if(t){yield t.lock(R().add(30,"minutes"));try{const s=yield u(Po.sagas.transferFunnelSeasonalityData,t.supplierUuid,e);yield t.complete(s)}catch(s){throw yield t.error(R().add(10,"minutes")),s}}}function*JD({debug:e}){const t=yield u(Pa,{jobName:de.loading.transferFunnelComparisonsData,checkJam:!0});if(t){yield t.lock(R().add(30,"minutes"));try{const s=yield u(Po.sagas.transferFunnelComparisonsData,t.supplierUuid,e);yield t.complete(s)}catch(s){throw yield t.error(R().add(10,"minutes")),s}}}function*mS(){const e=yield u(Qu.get);yield S(we.setList(e||[]))}function*ZD(){yield u(mS);const e=yield F(Ml.list);e!=null&&e.find(({status:t,runAfter:s})=>t==="in-progress"&&new Date(s)>new Date)||(yield fn(2e3),yield S(we.transferWbApiToken({force:!1})),yield ne(we.unlock),yield fn(2e3),yield S(we.transferFamousKeywords({debug:!1})),yield ne(we.unlock),yield fn(2e3),yield S(we.transferFunnelData()),yield ne(we.unlock),yield fn(2e3),yield S(we.transferDiscountData()),yield ne(we.unlock),yield fn(2e3),yield S(we.transferFunnelSeasonalityData({debug:!1})),yield ne(we.unlock),yield fn(2e3),yield S(we.transferFunnelComparisonsData({debug:!1})),yield ne(we.unlock))}function*XD(e){const t=yield F(Ml.list);t&&(yield u(Qu.set,t))}function*eA(){yield S(we.setList([])),yield u(Qu.set,[])}function*tA(){yield I([N(we.load,T(mS,[M,O(de.loading.load),L(de.loading.load)])),N(we.run,T(ZD,[M,O(de.loading.run),L(de.loading.run)])),N(we.clear,T(eA,[M,O(de.loading.run),L(de.loading.run)])),N(we.setResult,T(XD,[M,O(de.loading.run),L(de.loading.run)])),N(we.transferFamousKeywords,T(KD,[M,Lo,O(de.loading.transferFamousKeywords),L(de.loading.transferFamousKeywords)])),N(we.transferFunnelData,T(HD,[M,Lo,O(de.loading.transferFunnelData),L(de.loading.transferFunnelData)])),N(we.transferDiscountData,T(UD,[M,Lo,O(de.loading.transferDiscountData),L(de.loading.transferDiscountData)])),N(we.transferWbApiToken,T(QD,[M,Lo,O(de.loading.transferWbApiToken),L(de.loading.transferWbApiToken)])),N(we.transferFunnelSeasonalityData,T(YD,[M,Lo,O(de.loading.transferFunnelSeasonalityData),L(de.loading.transferFunnelSeasonalityData)])),N(we.transferFunnelComparisonsData,T(JD,[M,Lo,O(de.loading.transferFunnelComparisonsData),L(de.loading.transferFunnelComparisonsData)]))])}K(de.modelName,tA);const sA={},nA=({onShowErrorClick:e})=>[{field:"job",valueFormatter:({value:t})=>(t==null?void 0:t.split("/").pop())||"",flex:1,minWidth:200,filter:"agSetColumnFilter"},{field:"supplierUuid",width:320,filter:"agSetColumnFilter"},{field:"runAfter",valueFormatter:({value:t})=>t?new Date(t).toLocaleString():"",width:180},{field:"status",width:100,filter:"agSetColumnFilter",cellRendererSelector:({value:t,data:s})=>{if(t==="error")return{component:()=>n.jsx(A,{size:"small-grid",onClick:()=>e&&e(s),children:t})}}}];function oA({gridRef:e,data:t,style:s,maxRowsOnScreen:o,onShowErrorClick:a}){const r=m.useMemo(()=>nA({onShowErrorClick:a}),[a]),i=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]);return n.jsx(Ce,{gridRef:e,style:s,rowData:t,columnDefs:r,defaultColDef:i,maxRowsOnScreen:o,isCompact:!0})}const gt={actions:we,config:de,sagas:sA,selectors:Ml},aA=k("feature/seller-user-auth"),pS={modelName:aA()},mc=k("entity/wb/seller-user"),Ma={modelName:mc(),storageKey:`${W.appName}/${mc("storage-key")}`,localStorageKey:"wb-eu-passport-v2.access-token",event:{save:mc("save")}},ih={},hS=_({name:Ma.modelName,initialState:ih,reducers:{setToken:D("token"),reset:()=>ih}}),rA=E.inject(hS),Yu={...hS.actions};function iA(e){try{const t=Hu(e);if(!t)return;const s=t.iat||0;return{payload:t,isExpired:Date.now()>=1e3*(s+172800)}}catch{return}}function lA(){try{return localStorage.getItem(Ma.localStorageKey)||void 0}catch(e){const s={keys:Object.keys({...localStorage})};throw new Sa("–í localStorage –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–ª—é—á–µ–π",{cause:e,extras:s})}}const pc=k("entity/wb/marketplace-user"),In={modelName:pc(),storageKey:`${W.appName}/${pc("storage-key")}`,localStorageKey:"wbx__tokenData",event:{save:pc("save")}},cA=du({key:In.localStorageKey,parser:JSON.parse}),dA=V(Ma.modelName,rA),Rd=dA("token"),lh=$(Rd,e=>e?iA(e):void 0),Ju={token:Rd,parsedToken:lh,useToken:te(Rd),useParsedToken:te(lh)},Ed=Ue(Ma.storageKey,{type:Qe.Local}),fS=Dn(Ma.event.save);function*uA(){const e=yield u(Ed.get);yield S(Yu.setToken(e))}function*mA(){const e=yield u(lA);yield S(Yu.setToken(e))}function*pA(){const[e,t]=yield I([u(Ed.get),F(Ju.token)]);t&&e!==t&&(yield u(Ed.set,t),yield u(fS.post,t))}function*hA(){const e=yield F(Ju.token);e&&mj(e)}function*fA(){const t=yield u(()=>Cu(cA));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*gA(){const t=yield u(()=>An(fS.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}const yA={load:uA,save:pA,loadLocalStorage:mA,setRequestApiToken:hA,setTokenChannel:fA,saveChannel:gA},Ns={config:Ma,actions:Yu,selectors:Ju,sagas:yA};function*gS(){yield u(Ns.sagas.loadLocalStorage),yield u(Ns.sagas.setRequestApiToken),yield u(Ns.sagas.save)}function*wA(){const{channel:e,takeEvent:t}=yield u(Ns.sagas.setTokenChannel);try{for(;;)(yield u(t))&&(yield u(gS))}finally{e.close()}}function*SA(){yield u(Ns.sagas.load),yield u(Ns.sagas.setRequestApiToken)}function*xA(){const{channel:e,takeEvent:t}=yield u(Ns.sagas.saveChannel);try{for(;;){const s=yield u(t);s&&(yield S(Ns.actions.setToken(s)),yield u(Ns.sagas.setRequestApiToken))}}finally{e.close()}}function*bA(e){e?(yield u(gS),yield ro(wA)):(yield u(SA),yield ro(xA))}function*vA(){}K(pS.modelName,vA);const jA={init:bA},CA=$(Ns.selectors.parsedToken,e=>{var t;return(t=e==null?void 0:e.payload)==null?void 0:t.iat}),$A={useTokenIssueAt:b(CA)},kA="v5MaNDU",NA={list:kA};function TA({message:e="–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:"}){return n.jsx(dt,{type:"warning",message:n.jsxs("div",{children:[e,n.jsxs("ol",{className:NA.list,children:[n.jsxs("li",{children:["–ø–µ—Ä–µ–π—Ç–∏ –Ω–∞"," ",n.jsx(A,{onClick:()=>window.open(W.wb.sellerServiceBaseUrl,"_blank","noreferrer"),size:"middle",type:"link",children:"—Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–µ—Ä–≤–∏—Å–∞ WB Partners"})]}),n.jsx("li",{children:"–≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å"})]})]})})}const yS={config:pS,sagas:jA,selectors:$A},PA=k("feature/update-notification"),Fa={modelName:PA()},ch={},wS=_({name:Fa.modelName,initialState:ch,reducers:{setShowModal:D("showModal"),setReloadOnVisible:D("reloadOnVisible"),reset:()=>ch}}),MA=E.inject(wS),FA=Q(Fa.modelName),go={...wS.actions,reload:FA("reload")};function*DA(){const e=yield u(AA);for(;;)(yield ne(e))&&(yield u(Z$),yield S(go.setShowModal(!0)))}function AA(){return fa(e=>{const t=()=>e(!0),s=setInterval(async()=>{if(document.visibilityState!=="hidden")try{await chrome.runtime.sendMessage({source:io.ContentScript,action:Ws.Ping})}catch{clearInterval(s),t()}},1e3);return()=>{clearInterval(s)}})}const _d=new BroadcastChannel(Fa.modelName);function LA(){return fa(e=>{const t=()=>e(!0);return _d.addEventListener("message",t),()=>{_d.removeEventListener("message",t)}})}function*RA(){const e=yield u(LA);for(;;)(yield ne(e))&&(yield S(go.setShowModal(!1)),yield S(go.setReloadOnVisible(!0)))}function*EA(){yield u(()=>_d.postMessage(!0)),yield S(go.setShowModal(!1)),yield S(go.setReloadOnVisible(!0))}function*_A(){yield I([N(go.reload,EA)])}K(Fa.modelName,_A);const IA={watchExtensionUpdatePingEvent:DA,watchExtensionUpdateEvent:RA},SS=V(Fa.modelName,MA),OA=SS("showModal"),VA=SS("reloadOnVisible"),qA={useShowModal:b(OA),useReloadOnVisibleSelector:b(VA)},BA="yJ0nHPQ",WA="y-lGz77",dh={alert:BA,logoName:WA};function zA({onCancel:e,onConfirm:t}){return n.jsx(dt,{type:"default",logo:n.jsx(ml,{classNames:{name:dh.logoName}}),title:"–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å",message:n.jsx("div",{children:"–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"}),buttons:n.jsx(A,{type:"blue",size:"small",onClick:t,children:"–æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"}),onCloseClick:e,className:dh.alert})}const Ya={actions:go,config:Fa,selectors:qA,sagas:IA},hc=k("feature/wb-api-token-info"),kn={modelName:hc(),loading:{info:hc()},analytics:{save:hc("save")}},GA=Q(kn.modelName),uh={},xS=_({name:kn.modelName,initialState:uh,reducers:{setShowModal:D("showModal"),reset:()=>uh}}),KA=E.inject(xS),Zu={...xS.actions,save:GA("save")};function*HA({supplierUuid:e,apiToken:t}){yield u(Ms.sagas.add,e,t),yield u(Ms.sagas.setRequestApiToken,e)}function*UA(){yield I([N(Zu.save,T(HA,[M,et(kn.loading.info),L(kn.loading.info),zt]))])}K(kn.modelName,UA);const QA={},YA=V(kn.modelName,KA),JA=YA("showModal"),ZA={useShowModal:b(JA)},XA="-E-i7og",eL={button:XA};function mh({className:e,...t}){const s=P([eL.button,e]);return n.jsx("button",{...t,className:s})}const tL="/assets/BUN1lErP.png",sL=chrome.runtime.getURL(tL);function bS(){const[e,t]=m.useState(!1),s=()=>{window.open("https://seller.wildberries.ru/supplier-settings/access-to-api","_blank")};return n.jsxs("div",{style:{textAlign:"right"},children:[n.jsx(mh,{onClick:()=>t(!0),children:"–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á?"}),n.jsxs(Ye,{open:e,onCloseClick:()=>t(!1),title:"–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á",children:["–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª"," ",n.jsx(mh,{onClick:s,children:"¬´–î–æ—Å—Ç—É–ø –∫ API¬ª"})," –Ω–∞ –ø–æ—Ä—Ç–∞–ª–µ WB Partners",n.jsx("img",{src:sL,style:{width:"100%"},alt:"how-to-get-manual"})]})]})}function nL(){const e=ie.selectors.useSupplierUuid(),t=Ms.selectors.useParsedToken(e),{exp:s,scopes:o,isReadOnly:a}=m.useMemo(()=>{if(!t)return{scopes:[],isReadOnly:!0};const r=t.scopes.includes(ve.TokenReadOnly);return{exp:R(t.expiredAt).format("L LT"),scopes:t.scopes.filter(i=>![ve.TokenReadOnly,ve.TokenReadWrite].includes(i)),isReadOnly:r}},[t]);return n.jsxs(f,{type:"vertical",gap:"l",children:[s&&n.jsxs(f,{type:"vertical",children:[n.jsx("span",{children:"–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ:"}),n.jsx("div",{children:n.jsx(be,{type:t!=null&&t.isExpired?"error":"success",children:s})})]},"expired"),n.jsxs(f,{type:"vertical",children:[n.jsx("span",{children:"–ü—Ä–∞–≤–∞ –Ω–∞ –º–µ—Ç–æ–¥—ã:"}),n.jsx(f,{gap:"s",children:o.map(r=>n.jsx(be,{type:"info",children:Ei(r)},r))})]},"scopes"),n.jsxs(f,{type:"vertical",children:[n.jsx("span",{children:"–ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å:"}),n.jsx("div",{children:n.jsx(be,{type:a?"info":"success",children:Ei(a?ve.TokenReadOnly:ve.TokenReadWrite)})})]},"readOnly"),n.jsx(bS,{})]})}const oL=[ve.Analytics,ve.PricesDiscounts,ve.Statistics,ve.Promotion,ve.QuestionsFeedbacks];function aL({onCancel:e,onSubmit:t}){var h;const s=ie.selectors.useSupplier(),o=ie.selectors.useSupplierUuid(),a=Ms.selectors.useToken(o),[r,i]=m.useState(a||""),{save:l}=x(Zu),c=()=>{o&&(Te.click(kn.analytics.save),l({supplierUuid:o,apiToken:r,callback:t}),r&&e())},d=Uu(r),p=[];if(r){d||p.push(["parsed",n.jsx(n.Fragment,{children:"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–æ–∫–µ–Ω"})]),d!=null&&d.isExpired&&p.push(["isExpired",n.jsxs(n.Fragment,{children:["–¢–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ"," ",n.jsx(be,{type:d!=null&&d.isExpired?"error":"success",children:R(d==null?void 0:d.payload.exp).format("L LT")})]})]),(d==null?void 0:d.payload.sid)!==o&&p.push(["supplierUuid",n.jsxs(n.Fragment,{children:["–¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å ",s==null?void 0:s.name," ",n.jsxs("span",{children:["(",(h=s==null?void 0:s.contract)==null?void 0:h[0].supplier_id,")"]})]})]);const g=Vv(oL,(d==null?void 0:d.scopes)||[]);g.length>0&&p.push(["scopes",n.jsxs(f,{type:"vertical",children:[n.jsx("p",{children:"–í —Ç–æ–∫–µ–Ω–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –º–µ—Ç–æ–¥—ã:"}),n.jsx(f,{gap:"s",children:g.map(y=>n.jsx(be,{type:"error",children:Ei(y)},y))})]})])}return n.jsxs(f,{gap:"l",type:"vertical",children:[!a&&n.jsxs("p",{children:["–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–ª–∞–≥–∏–Ω–∞, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ª–∏—á–Ω—ã–º –∫–∞–±–∏–Ω–µ—Ç–æ–º, —Ç–∞–∫–∏—Ö –∫–∞–∫ –ø–æ–ª—É—á–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞ –∫–∞–º–ø–∞–Ω–∏–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –¥—Ä—É–≥–∏—Ö,"," ",n.jsx("b",{children:"—Ç—Ä–µ–±—É—é—Ç—Å—è¬†API¬†–∫–ª—é—á–∏"})," –∫–∞–±–∏–Ω–µ—Ç–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞"]}),n.jsx("div",{children:n.jsx(xe.Textarea,{value:r,onChange:g=>i(g.target.value)})}),p.map(([g,y])=>n.jsx("div",{children:y},g)),n.jsx(bS,{}),n.jsx(A,{onClick:c,disabled:a===r||p.length>0,type:"purple",children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})]})}const cr={actions:Zu,config:kn,sagas:QA,selectors:ZA},li=k("feature/wb-supplier-list"),ws={modelName:li(),loading:{load:li("load"),update:li("update")},view:{grid:li("view/grid")}},ph={},vS=_({name:ws.modelName,initialState:ph,reducers:{setShowModal:D("showModal"),reset:()=>ph}}),rL=E.inject(vS),fc=Q(ws.modelName),dr={...vS.actions,load:fc("load"),update:fc("update"),watcherEvent:fc("watcher-event")},hh=k("entity/wb/supplier-product"),Fl={modelName:hh(),storageKey:`${W.appName}/${hh("storage-key")}`,productsLookLimit:1e3},fh={list:{}},jS=_({name:Fl.modelName,initialState:fh,reducers:{setList:wt("list"),setListAll:D("list"),reset:()=>fh}}),iL=E.inject(jS),Xu={...jS.actions},lL=V(Fl.modelName,iL),CS=lL("list"),cL=$([CS],e=>Object.assign({},...Object.values(e||{}))),dL={list:CS,products:cL},Id=Ue(Fl.storageKey,{type:Qe.Local});function uL(e,t){return{id:e.id,brand:e.brand,brandId:e.brandId,name:e.name,supplierId:t}}function*mL({supplierId:e,dest:t,productsLookLimit:s}){var l;let o=0,a=1;const r={};for(;o<s;){const c=yield ia(r$.search,{supplier:e,dest:t,page:a});if(!((l=c.data)!=null&&l.products))break;a+=1;for(const d of c.data.products)o+=1,r[d.id]=uL(d,e);if(o>=c.data.total)break}const i=yield u(Id.get);yield u(Id.set,{...i||{},[e]:r}),yield S(Xu.setList({key:e,value:r}))}function*pL({supplierId:e}){const t=yield u(Id.get);t!=null&&t[e]&&(yield S(Xu.setList({key:e,value:t[e]})))}function*hL({cached:e,...t}){if(e)return yield u(pL,t);yield u(mL,t)}const fL={loadList:hL},yo={config:Fl,actions:Xu,selectors:dL,sagas:fL};function*$S({cached:e}){const t=yield F(Ve.selectors.destinationValue),s=yield F(ie.selectors.list);s&&(yield I(s.map(({oldId:o})=>u(yo.sagas.loadList,{supplierId:o,dest:t,productsLookLimit:yo.config.productsLookLimit,cached:e}))))}function*gL(){yield u($S,{cached:!0})}function*yL(){yield u($S,{cached:!1})}function*wL(){yield u(ie.sagas.loadListApi),yield u(ie.sagas.saveList)}function*SL(){yield u(ie.sagas.loadList)}function*xL(){yield u(gL)}function*bL(){const e=()=>chrome.runtime.sendMessage({source:io.ContentScript,action:Ws.OpenTab,data:{url:W.wb.sellerServiceBaseUrl}}),t=a=>chrome.runtime.sendMessage({source:io.ContentScript,action:Ws.CloseTab,data:{tabId:a}}),{data:s}=yield u(e);if(!s)return;const{event:o}=yield ls({_:fn(60*1e3),event:ne(dr.watcherEvent)});if(yield u(t,s.tabId),!o)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤")}function*vL(){const{channel:e,takeEvent:t}=yield u(ie.sagas.saveListChannel);try{for(;;){const{value:s,isUpdated:o}=yield u(t);o&&(yield S(ie.actions.setList(s)),yield u(yL)),yield S(dr.watcherEvent())}}finally{e.close()}}function*jL(e){e?yield u(wL):(yield u(SL),yield ro(vL))}function*CL(){yield I([N(dr.load,T(xL,[M,O(ws.loading.load),L(ws.loading.load)])),N(dr.update,T(bL,[M,O(ws.loading.update),L(ws.loading.update)]))])}K(ws.modelName,CL);const $L={init:jL};function kL({suppliers:e,supplierProducts:t}){return e?e.map(s=>({...s,productCounter:Object.keys((t==null?void 0:t[s.oldId])||{}).length})):[]}const NL=V(ws.modelName,rL),TL=NL("showModal"),PL=$([ie.selectors.list,yo.selectors.list],(e,t)=>kL({suppliers:e,supplierProducts:t})),ML={useData:b(PL),useShowModal:b(TL)},St={actions:dr,config:ws,sagas:$L,selectors:ML},FL=k("feature/wb-user-auth"),kS={modelName:FL()},gh={},NS=_({name:In.modelName,initialState:gh,reducers:{setToken:D("token"),reset:()=>gh}}),DL=E.inject(NS),em={...NS.actions};function AL(e){try{const t=Hu(e);if(!t)return;const s=t.iat||0;return{payload:t,isExpired:Date.now()>=1e3*(s+172800)}}catch{return}}function LL(){try{let e=localStorage.getItem(In.localStorageKey)||void 0;if(e)return JSON.parse(e).token}catch(e){const s={keys:Object.keys({...localStorage})};throw new Sa("–í localStorage –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–ª—é—á–µ–π",{cause:e,extras:s})}}const RL=du({key:In.localStorageKey,parser:JSON.parse}),EL=V(In.modelName,DL),Od=EL("token"),yh=$(Od,e=>e?AL(e):void 0),tm={token:Od,parsedToken:yh,useToken:te(Od),useParsedToken:te(yh)},Vd=Ue(In.storageKey,{type:Qe.Local}),TS=Dn(In.event.save);function*_L(){const e=yield u(Vd.get);yield S(em.setToken(e))}function*IL(){const e=yield u(LL);yield S(em.setToken(e))}function*OL(){const[e,t]=yield I([u(Vd.get),F(tm.token)]);t&&e!==t&&(yield u(Vd.set,t),yield u(TS.post,t))}function*VL(){const e=yield F(tm.token);e&&KC(e)}function*qL(){const t=yield u(()=>Cu(RL));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*BL(){const t=yield u(()=>An(TS.subscribe));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}const WL={load:_L,save:OL,loadLocalStorage:IL,setRequestApiToken:VL,setTokenChannel:qL,saveChannel:BL},os={config:In,actions:em,selectors:tm,sagas:WL};function*PS(){yield u(os.sagas.loadLocalStorage),yield u(os.sagas.setRequestApiToken),yield u(os.sagas.save)}function*zL(){const{channel:e,takeEvent:t}=yield u(os.sagas.setTokenChannel);try{for(;;)(yield u(t))&&(yield u(PS))}finally{e.close()}}function*GL(){yield u(os.sagas.load),yield u(os.sagas.setRequestApiToken)}function*KL(){const{channel:e,takeEvent:t}=yield u(os.sagas.saveChannel);try{for(;;){const s=yield u(t);s&&(yield S(os.actions.setToken(s)),yield u(os.sagas.setRequestApiToken))}}finally{e.close()}}function*HL(e){e?(yield u(PS),yield ro(zL)):(yield u(GL),yield ro(KL))}function*UL(){}K(kS.modelName,UL);const QL={init:HL},YL=$(os.selectors.parsedToken,e=>e&&!e.isExpired),JL={useIsTokenValid:b(YL)},ZL={config:kS,sagas:QL,selectors:JL},XL=k("feature/wb-user-geo-load"),MS={modelName:XL()};function*FS(){yield u(Ve.sagas.loadLocalStorageOrApi),yield u(Ve.sagas.save)}function*eR(){const{channel:e,takeEvent:t}=yield u(Ve.sagas.setGeoChannel);try{for(;;)(yield u(t))&&(yield u(FS))}finally{e.close()}}function*tR(){yield u(Ve.sagas.load)}function*sR(){const{channel:e,takeEvent:t}=yield u(Ve.sagas.saveChannel);try{for(;;){const s=yield u(t);s&&(yield S(Ve.actions.setData(s)))}}finally{e.close()}}function*nR(e){e?(yield u(FS),yield ro(eR)):(yield u(tR),yield ro(sR))}function*oR(){}K(MS.modelName,oR);const aR={init:nR},rR=$(os.selectors.parsedToken,e=>e&&!e.isExpired),iR={useIsTokenValid:b(rR)},lR={config:MS,sagas:aR,selectors:iR};function*cR({origin:e}){yield u(ie.sagas.readUuid),yield u(Hp.sagas.load),yield rn(Hp.sagas.watchLoadChannel);const t=e===W.wb.marketPlaceBaseUrl,s=e===W.wb.sellerServiceBaseUrl,o=e===W.wb.cmpServiceBaseUrl;yield u(ZL.sagas.init,t),yield u(lR.sagas.init,t),yield u(yS.sagas.init,s),o||(yield u(St.sagas.init,s)),yield rn(ge.sagas.loadMediaRoutes),yield rn(Ya.sagas.watchExtensionUpdatePingEvent),yield rn(Ya.sagas.watchExtensionUpdateEvent),yield rn(dR),yield rn(b0.sagas.watchSaveChannelSaga),yield u(Ap.sagas.load),yield rn(Ap.sagas.watchSaveChannel),yield rn(rS.sagas.watchSaveLastSendChannel),yield S(Vu.setIsReady(!0))}function*dR(){const e=yield u(uR);for(;;){const t=yield ne(e);switch(t.source){case io.PopUp:switch(t.action){case Ws.WbApiTokenModalShow:yield S(cr.actions.setShowModal(!0));break;case Ws.WbMinusPhraseModalShow:yield S(is.actions.setShowModal(!0));break;case Ws.WbWarehouseAnalyzeModalShow:yield S(Tl.actions.setShowModal(!0));break;case Ws.SellerJobExecutionModalShow:yield S(gt.actions.setShowModal(!0));break}break;case io.Background:break}}}function uR(){return fa(e=>{const t=s=>e(s);return chrome.runtime.onMessage.addListener(t),()=>{chrome.runtime.onMessage.removeListener(t)}})}function*mR(){yield I([Lv(Vu.initApp,T(cR,[M,et(Na.loading.init)]))])}K(Na.modelName,mR);const pR={},hR=V(Na.modelName,dF),fR=hR("isReady"),gR={useIsReady:b(fR)},wh={actions:Vu,config:Na,sagas:pR,selectors:gR},gc=k("feature/wb-supplier-info"),zs={modelName:gc(),loading:{load:gc("load"),auth:gc("auth")}},ci=Q(zs.modelName),Sh={},DS=_({name:zs.modelName,initialState:Sh,reducers:{setIsReady:D("isReady"),setError:D("error"),reset:()=>Sh}}),yR=E.inject(DS),Qs={...DS.actions,auth:ci("auth"),load:ci("load"),watcherStart:ci("watcher-start"),watcherStop:ci("watcher-stop")};function*AS(){const e=yield F(ie.selectors.supplierUuid);e&&(yield u(Ms.sagas.load),yield u(Ms.sagas.setRequestApiToken,e))}function*wR(){try{yield u(ie.sagas.auth),yield u(AS)}catch(e){if(e instanceof Error){const t=Qs.auth.type,s=Mn({error:e,name:t});yield S(Qs.setError({id:s,error:e,name:t,args:[]}))}}finally{yield S(Qs.setIsReady(!0))}}function*SR(){yield u(ie.sagas.load)}function*xR(){const{channel:e,takeEvent:t}=yield u(ie.sagas.loadChannel);try{for(;;){const{event:s}=yield ls({event:u(t),canceled:ne(Qs.watcherStop)});if(!s)break;const{response:o}=s;yield u(ie.sagas.load,{intercepted:o.data}),yield u(AS),yield S(Qs.setIsReady(!0))}}finally{e.close()}}function*bR(){yield I([N(Qs.watcherStart,T(xR,[M,O(zs.loading.load),L(zs.loading.load)])),N(Qs.load,T(SR,[M,L(zs.loading.load)])),N(Qs.auth,T(wR,[M,L(zs.loading.auth)]))])}K(zs.modelName,bR);const vR={},LS=V(zs.modelName,yR),jR=LS("isReady"),CR=LS("error"),$R={useIsReady:b(jR),useError:b(CR)},Gs={actions:Qs,config:zs,sagas:vR,selectors:$R},kR="w2TJ-R2",NR="UB8S1pD",TR="_4mWHQNE",PR="xsoqqow",ln={fixed:kR,icon:NR,button:TR,logo:PR};function zi(){const{setShowModal:e}=x(bu.actions),t=()=>{var o;(o=window.open(W.evirma.supportGroup,"_blank"))==null||o.focus()},s=()=>{var o;(o=window.open(W.evirma.site,"_blank"))==null||o.focus()};return n.jsx("div",{className:ln.fixed,children:n.jsxs(f,{type:"vertical",gap:"xs",align:"center",children:[n.jsx("button",{className:P(ln.button,ln.logo),onClick:s,children:n.jsx(bt,{className:ln.icon})}),n.jsx(Oe,{placement:"left",overlay:"Telegram-–≥—Ä—É–ø–ø–∞ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º —Ä–∞–±–æ—Ç—ã –ø–ª–∞–≥–∏–Ω–∞",children:n.jsx("button",{className:ln.button,onClick:t,children:n.jsx(z.Telegram,{className:ln.icon})})}),n.jsx(Oe,{placement:"left",overlay:"–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ",children:n.jsx("button",{className:ln.button,onClick:()=>e({}),children:n.jsx(z.Message,{className:ln.icon})})})]})})}const MR="GzGwKtP",FR={wrapper:MR};function Gi(){const e=Ya.selectors.useShowModal(),t=Ya.selectors.useReloadOnVisibleSelector(),{setShowModal:s,reload:o}=x(Ya.actions),a=()=>s(!1),r=()=>o();return m.useEffect(()=>{const i=()=>{t&&document.visibilityState==="visible"&&(document.body.innerHTML="",window.location.reload())};return i(),document.addEventListener("visibilitychange",i),()=>{document.removeEventListener("visibilitychange",i)}},[t]),e?n.jsx("div",{className:P(FR.wrapper,Fr.fixFonts),children:n.jsx(zA,{onConfirm:r,onCancel:a})}):null}const DR="lQciYfO",AR="IHtQx1g",LR={skeleton:DR,shimmer:AR};function at({width:e="fill",style:t,className:s}){let o;switch(e){case"fill":{o="100%";break}case"random":{o=`${Math.floor(Math.random()*91+10)}%`;break}default:{o=e;break}}return n.jsx("span",{className:P(LR.skeleton,s),style:{width:o,...t},children:"¬†"})}function RR(){const{load:e}=x(Gs.actions),{transferWbApiToken:t}=x(gt.actions),s=ie.selectors.useSupplier(),o=ie.selectors.useSupplierUuid(),a=Ms.selectors.useParsedToken(o),r=Z.selectors.useError(Gs.config.loading.load),i=G.selectors.useLoader(Gs.config.loading.load),[l,c]=m.useState(!1);return m.useEffect(()=>{a||c(!0)},[a]),m.useEffect(()=>{s||e()},[s]),r?n.jsx(ee,{value:r,onRetry:()=>e()}):i?n.jsx(le,{}):n.jsx(f,{gap:"l",type:"vertical",children:l?n.jsx(aL,{onCancel:()=>c(!1),onSubmit:()=>t({force:!0})}):n.jsxs(n.Fragment,{children:[n.jsx(nL,{}),n.jsx(A,{onClick:()=>c(!0),children:"–ò–∑–º–µ–Ω–∏—Ç—å"})]})})}const ER=k("widget/wb-api-token-modal"),_R={modelName:ER()};function IR(){const e=ie.selectors.useSupplier(),t=cr.selectors.useShowModal(),s=G.selectors.useLoader(Gs.config.loading.load),{setShowModal:o}=x(cr.actions),a=m.useCallback(()=>{o(!1);const r=new URL(window.location.href);r.searchParams.delete("showApiTokenModal"),window.history.pushState({},"",r)},[]);return m.useEffect(()=>{t&&Te.pageView(_R.modelName)},[t]),n.jsx(Ye,{open:t,onCloseClick:a,title:n.jsxs(n.Fragment,{children:["API –∫–ª—é—á ",s?n.jsx(at,{width:200}):(e==null?void 0:e.name)||""]}),children:n.jsx(H,{children:n.jsx(RR,{})})})}const OR="mHGA-vE",xh={injector:OR},bh=k("feature/cmp-advert-list-item-products"),ur={modelName:bh(),loading:{load:bh()},productsLimit:2},VR=Q(ur.modelName),RS={load:VR("load")};function*qR(e){yield u(pe.sagas.loadList,e)}function*BR(){yield I([N(RS.load,T(qR,[M,et(ur.loading.load),L(ur.loading.load)]))])}K(ur.modelName,BR);const WR={};te(Pe.selectors.detailsByNm);const Ja={actions:RS,config:ur,sagas:WR},vh=k("feature/wb-search-product-details"),mr={modelName:vh(),loading:{load:vh("load")}},zR=Q(mr.modelName),ES={load:zR("load")};function*GR({nms:e}){const t=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.loadDetails,{nms:e,dest:t})}function*KR(){yield I([N(ES.load,T(GR,[M,O(mr.loading.load),L(mr.loading.load)]))])}K(mr.modelName,KR);const HR={},_S=Pe.selectors.detailsByNm,UR=$(Pe.selectors.details,e=>e?Object.values(e):void 0,{memoize:Ts,argsMemoize:Ts}),QR=$(_S,e=>{const t=new Map;return Object.values((e==null?void 0:e.sizes)||{}).forEach(s=>{s.warehouses.forEach(o=>{var r;if(!((r=o.warehouse)!=null&&r.id))return;let a=t.get(o.warehouse.id);a||(a={warehouse:o.warehouse,deliveryTime:o.deliveryTime,sizes:[],quantity:0},t.set(o.warehouse.id,a)),a.quantity+=o.quantity,a.sizes.push({name:s.name,origName:s.origName,quantity:o.quantity})})}),[...t.values()].sort((s,o)=>(s.deliveryTime||Number.MIN_SAFE_INTEGER)-(o.deliveryTime||Number.MAX_SAFE_INTEGER))},{memoize:Ts,argsMemoize:Ts}),sm={useDataList:b(UR),useData:te(_S),useDataQuantity:te(QR)},YR="MW8r21Z",JR="mCjASMG",ZR="_4Bws7MC",yc={info:YR,logo:JR,listLabel:ZR};function XR({nm:e}){var o,a;const t=sm.useData(e);if(!t)return null;const s=[{label:me.id,value:t.id.toString()},{label:me.warehouse,value:(o=t.warehouse)==null?void 0:o.name},{label:me.deliveryTime,value:v.hours(t.deliveryTime)},{label:me.totalQuantity,value:v.quantity(t.totalQuantity)},{label:me.sizes,value:(a=Object.values(t.sizes).filter(({quantity:r})=>r>0).map(({name:r})=>r))==null?void 0:a.join(", ")}].filter(({value:r})=>!!r);return n.jsxs(f,{type:"vertical",gap:"s",className:yc.info,children:[n.jsxs(f,{type:"horizontal",align:"center",children:[n.jsx(bt,{className:yc.logo}),n.jsx(ga,{})]}),n.jsx(f,{type:"vertical",children:s.map(({label:r,value:i},l)=>n.jsxs(f,{type:"horizontal",children:[n.jsxs("span",{className:yc.listLabel,children:[r,":"]}),n.jsx("span",{children:i})]},l))})]})}const eE="qyQxj1F",tE="udbXDr2",sE="ubeiZ2E",nE="jCcgwJf",oE="GVZcM9d",aE="t35mGqO",rE="PoaLE4n",Es={nm:eE,zero:tE,details:sE,num:nE,price:oE,badgeInactive:aE,sizeInactive:rE};function iE({data:e}){const t=e.isPromo,s=Object.values(e.sizes||{}),o=s.length,a=s.filter(g=>g.quantity===0),r=s.filter(g=>g.quantity>0&&g.quantity<5),i=a.length===o,l=g=>g.map(y=>`${y.origName}`).join(", "),c=g=>g.map(y=>`${y.origName}: ${y.quantity} —à—Ç.`).join(", "),d=Co(W.outRoute.marketPlaceProduct,{id:e.id}),p=`${W.wb.marketPlaceBaseUrl}${d}`,h=g=>{g.preventDefault(),window.open(p,"_blank")};return n.jsxs(f,{type:"vertical",children:[n.jsx("div",{className:Es.nm,children:n.jsx("a",{href:p,target:"_blank",rel:"noreferrer",onClick:h,children:e.id})}),n.jsxs(f,{type:"vertical",className:Es.details,gap:"xs",children:[n.jsxs(f,{gap:"m",align:"center",children:[n.jsxs("div",{children:["–¶–µ–Ω–∞:"," ",n.jsx("span",{className:Es.price,children:v.currency(e.price/100,{fraction:0})})]}),n.jsx(be,{size:"small",type:"success",className:t?void 0:Es.badgeInactive,children:n.jsxs(f,{gap:"xs",align:"center",children:[n.jsx(z.Sale,{}),n.jsx("span",{children:t?"–í –∞–∫—Ü–∏–∏":"–ù–µ –≤ –∞–∫—Ü–∏–∏"})]})})]}),n.jsxs(f,{type:"horizontal",align:"center",gap:"m",children:[i?n.jsx(be,{size:"small",type:"error",children:n.jsxs(f,{gap:"xs",align:"center",children:[n.jsx(z.CircleInfoFill,{}),n.jsx(z.WarehouseCart,{}),v.quantity(e.totalQuantity)]})}):n.jsxs(f,{gap:"xs",children:[n.jsx(z.WarehouseCart,{}),v.quantity(e.totalQuantity)]}),i?n.jsx(be,{size:"small",type:"error",children:n.jsxs(f,{gap:"xs",align:"center",children:[n.jsx(z.CircleInfoFill,{}),n.jsxs("span",{children:["–í—ã–ø–∞–ª–∏ —Ä-—Ä—ã:"," ",n.jsx("span",{className:Es.num,children:a.length})," —à—Ç."]})]})}):n.jsxs(f,{gap:"s",wrap:!0,children:[a.length>0&&n.jsx(Oe,{overlay:n.jsx("span",{className:Es.zero,children:l(a)}),placement:"bottom",mouseEnterDelay:.4,children:n.jsx(be,{type:"error",size:"small",children:n.jsxs(f,{gap:"xs",align:"center",children:[n.jsx(z.CircleInfoFill,{}),n.jsxs("span",{children:["–í—ã–ø–∞–ª–∏ —Ä-—Ä—ã:"," ",n.jsx("span",{className:Es.num,children:a.length})," —à—Ç."]})]})})}),r.length>0&&n.jsx(Oe,{overlay:c(r),placement:"bottom",mouseEnterDelay:.4,children:n.jsxs(f,{className:Es.sizeInactive,align:"center",children:[n.jsx("span",{children:"–°–∫–æ—Ä–æ –∑–∞–∫–æ–Ω—á–∞—Ç—Å—è —Ä-—Ä—ã:"}),n.jsxs("span",{className:Es.num,children:[r.length," —à—Ç."]})]})})]})]})]})]})}const lE="V38l4vT",cE={image:lE};function dE({nm:e}){const t=ge.selectors.useMediaRouteHostsByType("mediabasket_route_map");return n.jsx("img",{alt:e.toString(),src:va(e,t),className:cE.image})}const uE="_0vA-Occ",mE="_4OsYl6k",pE="ATgBn-1",jh={logo:uE,skeleton:mE,skeletonImage:pE};function qd({nm:e,isLoading:t}){const s=sm.useData(e);return!s&&t?n.jsxs(f,{gap:"2xl",align:"center",wrap:!1,children:[n.jsx(at,{width:38,className:jh.skeletonImage}),n.jsxs(f,{type:"vertical",className:jh.skeleton,children:[n.jsx(at,{width:"fill"}),n.jsxs(f,{type:"vertical",gap:"xs",children:[n.jsxs(f,{gap:"m",align:"center",children:[n.jsx(at,{width:75}),n.jsx(at,{width:75})]}),n.jsxs(f,{gap:"m",align:"center",children:[n.jsx(at,{width:75}),n.jsx(at,{width:150}),n.jsx(at,{width:200})]})]})]})]}):s?n.jsxs(f,{gap:"2xl",align:"center",wrap:!1,children:[n.jsx(dE,{nm:e}),n.jsx(iE,{data:s})]}):null}const ct={actions:ES,config:mr,sagas:HR,selectors:sm},hE="QRu7-lK",fE={title:hE};function gE({count:e}){return!e||e<0?null:n.jsxs("span",{className:fE.title,children:["–µ—â–µ ",e," ",Zs(e,["—Ç–æ–≤–∞—Ä","—Ç–æ–≤–∞—Ä–∞","—Ç–æ–≤–∞—Ä–æ–≤"])]})}function yE({advertId:e}){const t=pe.selectors.useAdvertById(e),s=G.selectors.useSomeLoader([ct.config.loading.load,Ja.config.loading.load]),o=Z.selectors.useError(ct.config.loading.load);return s?n.jsxs(f,{gap:"2xl",align:"center",wrap:!1,children:[n.jsx(bt,{style:{fontSize:24}}),n.jsx(qd,{nm:-1,isLoading:s})]}):o||!t?null:n.jsxs(f,{gap:"s",type:"vertical",children:[t.products.slice(0,Ja.config.productsLimit).map(a=>n.jsxs(f,{gap:"2xl",align:"center",wrap:!1,children:[n.jsx(bt,{style:{fontSize:24}}),n.jsx(qd,{nm:a.nm,isLoading:s})]},a.nm)),n.jsx(gE,{count:t.products.length-Ja.config.productsLimit})]})}function wE({advertId:e,target:t}){return n.jsx(Ps,{targetElement:t,children:n.jsx(H,{children:n.jsx(yE,{advertId:e})})})}const SE=()=>{const e=document.querySelector(".Lpldtnoh");return e||document.querySelector(".hTAnMv")},xE=e=>{const t=e.querySelectorAll(".on3syjz7");return t.length>0?t:e.querySelectorAll(".etlQXe")};function bE(){const[e,t]=m.useState([]),s=Fn(SE),o=a=>{const r=[];a&&(xE(a).forEach(i=>{var c,d;const l=parseInt(((d=(c=i.getAttribute("href"))==null?void 0:c.match(/\d+$/i))==null?void 0:d[0])||"");r.push({el:i,data:{id:l}})}),t(r))};return m.useEffect(()=>{o(s);const a=new MutationObserver(()=>{o(s)});return s&&a.observe(s,{childList:!0}),()=>{a.disconnect()}},[s]),e}const vE="ghu1MxV",jE={errorInjector:vE};function CE(){const e=bE(),{load:t}=x(Ja.actions),{load:s}=x(ct.actions),o=pe.selectors.useListNms(),a=Z.selectors.useSomeError([Ja.config.loading.load,ct.config.loading.load]);return m.useEffect(()=>{if(e.length>0){const r=new URL(window.location.toString()),i=Object.fromEntries(r.searchParams.entries()),l=e.map(({data:c})=>c.id);t({cmpListParams:i,ids:l})}},[e]),Ae.useEffect(()=>{o.length>0&&s({nms:o})},[o]),n.jsxs(n.Fragment,{children:[e.map(({el:r,data:i})=>n.jsx(wE,{advertId:i.id,target:r},i.id)),a&&n.jsx(J,{selector:".pgiUhvUl",append:"before",className:jE.errorInjector,children:n.jsx(ee,{value:a})})]})}const Ch=k("feature/cmp-advert-card-info"),pr={modelName:Ch(),loading:{load:Ch("load")}},$E=Q(pr.modelName),IS={load:$E("load")};function*kE(e){yield u(pe.sagas.load,{id:e})}function*NE(){yield I([N(IS.load,T(kE,[M,et(pr.loading.load),L(pr.loading.load)]))])}K(pr.modelName,NE);const TE={},Fs={actions:IS,config:pr,sagas:TE},wc=k("feature/cmp-advert-keywords-frequency"),eo={modelName:wc(),loading:{list:wc("list"),customList:wc("customList")}},$h=Q(eo.modelName),Bd={load:$h("load"),loadCustom:$h("load-custom")},PE=k("entity/evirma/keyword"),Dl={modelName:PE(),listChunkSize:4e3},kh={},OS=_({name:Dl.modelName,initialState:kh,reducers:{setList:D("list"),setCardWithFreqHistory:my(["card","freqHistoryWeekly"]),reset:()=>kh}}),ME=E.inject(OS),nm={...OS.actions},om=V(Dl.modelName,ME),Nh=om("list"),Th=om("card"),Ph=om("freqHistoryWeekly"),FE={list:Nh,card:Th,freqHistoryWeekly:Ph,useList:b(Nh),useCard:b(Th),useFreqHistoryWeekly:b(Ph)},DE=e=>[...e].sort((t,s)=>new Date(t[1]).getTime()-new Date(s[1]).getTime()).map(([,t,s],o,a)=>({date:t,value:s,growth:o===a.length-1?s:null,isForecast:!1})),AE=(e,t)=>{if(e.length<26||!t)return[];const s=e[e.length-1],o=R(s.date).add(7,"day"),a=[];for(let r=0;r<26;r++){const i=o.add(r*7,"day"),l=i.subtract(1,"year"),c=e.reduce((d,p)=>{const h=R(p.date),g=Math.abs(h.diff(l,"day")),y=d?Math.abs(R(d.date).diff(l,"day")):1/0;return g<y?p:d},null);a.push({date:i.format("YYYY-MM-DD"),value:null,growth:c!=null&&c.value?c.value*t:null,isForecast:!0})}return a};function*VS({keywords:e,trusted:t}){const s={keywords:e,an:t};try{return yield il(3,2e3,gd.getList,s)}catch{return yield u(gd.getList,s,!1)}}function*LE({keywords:e,trusted:t}){const s=Dl.listChunkSize,o=qv(e,s),a=yield I(o.map(r=>u(VS,{keywords:r,trusted:t})));yield S(nm.setList(Object.assign({},...a.map(r=>(r==null?void 0:r.keywords)||{}))))}function*RE(e){const t=yield u(VS,{keywords:[e]}),s=Object.values((t==null?void 0:t.keywords)||{})[0],o=DE((s==null?void 0:s.freq_history_weekly)||[]);yield S(nm.setCardWithFreqHistory({card:s,freqHistoryWeekly:[...o,...AE(o,s==null?void 0:s.growth_rate)]}))}const EE={loadList:LE,load:RE},_E={freq:"–ß–∞—Å—Ç–æ—Ç–∞"},Rt={config:Dl,actions:nm,selectors:FE,sagas:EE},IE=k("entity/wb/advert-keyword"),am={modelName:IE()},Mh={},qS=_({name:am.modelName,initialState:Mh,reducers:{setKeywords:D("keywords"),setFixedEnable:D("fixedEnable"),setKeywordsWithFixed:my(["keywords","fixedEnable"]),setKeywordsType:(e,{payload:t})=>{const s=new Set(t.list),o=Object.values(e.keywords||{}).reduce((a,r)=>{let i=r.type;return s.delete(r.keyword)?i=t.type:r.type===t.type&&(i="common"),i!==r.type?(a[r.keyword]={...r,type:i},a):(a[r.keyword]=r,a)},{});s.forEach(a=>{o[a]={keyword:a,type:t.type,words:Ft(a)}}),e.keywords=o},reset:()=>Mh}}),OE=E.inject(qS),nn={...qS.actions},BS=V(am.modelName,OE),Fh=BS("keywords"),Dh=BS("fixedEnable"),WS={keywords:Fh,fixedEnable:Dh,useKeywords:b(Fh),useFixedEnabled:b(Dh)};function VE(e){var s,o,a,r,i,l;const t={};return(o=(s=e==null?void 0:e.words)==null?void 0:s.keywords)==null||o.forEach(({keyword:c})=>{t[c]={keyword:c,words:Ft(c),type:"common"}}),(r=(a=e==null?void 0:e.words)==null?void 0:a.pluse)==null||r.forEach(c=>{t[c]={keyword:c,words:Ft(c),type:"fixed"}}),(l=(i=e==null?void 0:e.words)==null?void 0:i.excluded)==null||l.forEach(c=>{t[c]={keyword:c,words:Ft(c),type:"excluded"}}),delete t[""],t}function qE(e){var s,o,a,r,i,l;const t={};return(o=(s=e==null?void 0:e.words)==null?void 0:s.keywords)==null||o.forEach(({keyword:c})=>{t[c]={keyword:c,words:Ft(c),type:"common"}}),(r=(a=e==null?void 0:e.words)==null?void 0:a.pluse)==null||r.forEach(c=>{t[c]={keyword:c,words:Ft(c),type:"fixed"}}),(l=(i=e==null?void 0:e.words)==null?void 0:i.excluded)==null||l.forEach(c=>{t[c]={keyword:c,words:Ft(c),type:"excluded"}}),delete t[""],t}function BE(e){var s,o;const t={};return(s=e==null?void 0:e.clusters)==null||s.forEach(({cluster:a})=>{t[a]={keyword:a,words:Ft(a),type:"common"}}),(o=e==null?void 0:e.excluded)==null||o.forEach(a=>{t[a]={keyword:a,words:Ft(a),type:"excluded"}}),delete t[""],t}const Wd={fromCmp:VE,fromApiV1:qE,fromApiV2:BE};function*WE(e){var s;const t=yield u(lo.getStatWords,e.type,e.id);yield S(nn.setKeywordsWithFixed({keywords:Wd.fromCmp(t),fixedEnable:(s=t==null?void 0:t.words)==null?void 0:s.fixed}))}function*zE(e){var t;switch(e.type){case Dt.Auto:{const s=yield u(VC.getStatWords,e.id);yield S(nn.setKeywords(Wd.fromApiV2(s)));break}case Dt.SearchCatalog:{const s=yield u(FC.getWords,e.id);yield S(nn.setKeywordsWithFixed({keywords:Wd.fromApiV1(s),fixedEnable:(t=s==null?void 0:s.words)==null?void 0:t.fixed}));break}default:throw new $o("–¢–∏–ø –†–ö –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è")}}function*Ah(e){yield u(lo.setExcluded,e.type,e.id,e.excluded),yield S(nn.setKeywordsType({list:e.excluded,type:"excluded"}))}function*GE(e){switch(e.type){case Dt.Auto:{yield u(LC.setExcluded,e.id,e.excluded);break}case Dt.Search:case Dt.SearchCatalog:{yield u(gu.setExcluded,e.id,e.excluded);break}default:throw new $o("–¢–∏–ø –†–ö –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è")}yield S(nn.setKeywordsType({list:e.excluded,type:"excluded"}))}function*KE(e,t){if(!t){yield u(Ah,e);return}try{yield u(GE,e)}catch(s){if(s instanceof ds){yield u(Ah,e);return}throw s}}function*Lh({fixed:e,id:t}){yield u(pC.setPlus,t,e,e.length>0),yield S(nn.setKeywordsType({list:e,type:"fixed"}))}function*HE(e,t){if((yield F(WS.fixedEnable))!==e.enable){if(t)try{yield u(lo.enablePlus,e.type,e.id,e.enable)}catch(o){if(o instanceof ds){yield u(gu.enablePlus,e.id,e.enable);return}throw o}else yield u(lo.enablePlus,e.type,e.id,e.enable);yield S(nn.setFixedEnable(e.enable))}}function*UE(){const t=yield u(()=>Ar(lo.enablePlusInterceptor));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}function*QE(e){switch(e.type){case Dt.Search:case Dt.SearchCatalog:{yield u(gu.setPlus,e.id,e.fixed);break}default:throw new $o("–¢–∏–ø –†–ö –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è")}yield S(nn.setKeywordsType({list:e.fixed,type:"fixed"}))}function*YE(e,t){if(!t){yield u(Lh,e);return}try{yield u(QE,e)}catch(s){if(s instanceof ds){yield u(Lh,e);return}throw s}}function*JE(e){try{return yield u(WE,e)}catch(t){if(t instanceof ru||t instanceof nr)try{return yield u(zE,e)}catch(s){throw s instanceof ds?t:s}throw t}}const ZE={load:JE,saveExcluded:KE,saveFixed:YE,setFixedEnabled:HE,setFixedChannel:UE},rm={keyword:"–ö–ª—é—á–µ–≤–∞—è —Ñ—Ä–∞–∑–∞",words:"–°–ª–æ–≤–∞",type:"–¢–∏–ø"},XE="fLeuEMd",e2="oemM03l",Ki={excluded:XE,fixed:e2};function t2({type:e}){let t;switch(e){case"excluded":t=n.jsx(z.CircleClose,{className:Ki.excluded});break;case"fixed":t=n.jsx(z.CircleCheck,{className:Ki.fixed});break}return t}function zS({keyword:e,type:t,style:s,className:o}){const a=P(o,{[Ki.excluded]:t==="excluded",[Ki.fixed]:t==="fixed"});return n.jsx(jt,{className:a,style:s,prefix:t?n.jsx(t2,{type:t}):void 0,children:e})}const Ze={config:am,actions:nn,selectors:WS,sagas:ZE};function*s2(){const e=yield F(Ze.selectors.keywords);e&&(yield u(Rt.sagas.loadList,{keywords:Object.keys(e),trusted:!0}))}function*n2(e){const t=yield F(Rt.selectors.list);e.find(s=>!(t!=null&&t[s]))&&(yield u(Rt.sagas.loadList,{keywords:e,trusted:!1}))}function*o2(){yield I([N(Bd.load,T(s2,[M,O(eo.loading.list),L(eo.loading.list)])),N(Bd.loadCustom,T(n2,[M,et(eo.loading.customList),L(eo.loading.customList)]))])}K(eo.modelName,o2);const a2={},r2=$(Rt.selectors.list,(e,t)=>t,(e,t)=>e==null?void 0:e[t]),i2={useFrequencyByKeyword:te(r2)},l2="v3vtt66",c2="Q16Mtmq",d2="kmM0Sim",Sc={wrapper:l2,freq:c2,freqNum:d2},u2=new Intl.NumberFormat;function GS({keyword:e,className:t}){var o;const s=i2.useFrequencyByKeyword(e);return(o=s==null?void 0:s.cluster)!=null&&o.freq_syn.monthly?n.jsxs(f,{type:"horizontal",gap:"xs",align:"center",wrap:!1,className:P(t,Sc.wrapper),children:[n.jsx(bt,{}),n.jsxs("span",{className:P(Sc.freq,"freq"),children:["–ß–∞—Å—Ç–æ—Ç–∞:"," ",n.jsx("span",{className:P(Sc.freqNum,"freqNum"),children:u2.format(s.cluster.freq_syn.monthly)})]})]}):null}const wo={actions:Bd,config:eo,sagas:a2},xc=k("feature/cmp-advert-keywords-list"),So={modelName:xc(),loading:{list:xc("list"),customList:xc("customList")},analytic:{showModal:"showModal"}},Rh={},KS=_({name:So.modelName,initialState:Rh,reducers:{setShowModal:D("showModal"),reset:()=>Rh}}),m2=E.inject(KS),p2=Q(So.modelName),HS={...KS.actions,load:p2("load")};function*h2(e){yield u(Ze.sagas.load,e)}function*f2(){yield I([N(HS.load,T(h2,[M,O(So.loading.list),L(So.loading.list),zt]))])}K(So.modelName,f2);const g2={},y2=V(So.modelName,m2),w2=y2("showModal"),S2=$(Ze.selectors.keywords,e=>{if(!e)return;const t={excluded:[],fixed:[],common:[]};return Object.keys(e).forEach(s=>{const o=e[s];t[o.type].push(o.keyword)}),t}),x2={useList:b(S2),useShowModal:b(w2)};function b2({list:e,value:t,onChange:s}){const o=m.useMemo(()=>[{label:"–û–±—â–∏–µ",value:"common",badge:e.common.length},{icon:n.jsx(z.CircleCheck,{}),label:"–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ",value:"fixed",badge:e.fixed.length},{icon:n.jsx(z.CircleClose,{}),label:"–ò—Å–∫–ª—é—á–µ–Ω–∏—è",value:"excluded",badge:e.excluded.length}],[e]);return n.jsx(an,{options:o,value:t,onChange:s})}const Ys={actions:HS,config:So,sagas:g2,selectors:x2},cn=k("feature/cmp-advert-keywords-actions"),Ge={modelName:cn(),loading:{change:cn("change"),addCustom:cn("add-custom"),fixEnable:cn("fix-enable")},view:{alert:cn("view/alert")},analytic:{addExcluded:cn("add-excluded"),addCommon:cn("add-common"),addFixed:cn("add-fixed")}},Eh={},US=_({name:Ge.modelName,initialState:Eh,reducers:{setList:D("list"),setShowModal:D("showModal"),setShowAlertModal:D("showAlertModal"),reset:()=>Eh}}),v2=E.inject(US),Gn=Q(Ge.modelName),hs={...US.actions,addExcluded:Gn("add-excluded"),addFixed:Gn("add-fixed"),addCommon:Gn("add-common"),addCustom:Gn("add-custom"),fixKeywordsEnable:Gn("fix-keywords-enable"),watcherStart:Gn("watcher-keywords-start"),watcherStop:Gn("watcher-keywords-stop")},im=V(Ge.modelName,v2),Hi=im("list"),j2=im("showModal"),C2=im("showAlertModal"),_h=$(Hi,e=>!e||e.length===0),Ih=$(Hi,(e,t)=>t,(e,t)=>e?e.length>=t:!1),Al={list:Hi,isEmpty:_h,isMoreThen:Ih,useList:b(Hi),useIsEmpty:b(_h),useIsMoreThen:te(Ih),useShowModal:b(j2),useShowAlertModal:b(C2)};function*Kr(){const e=yield F(ie.selectors.supplierUuid),t=yield F(s=>Ms.selectors.parsedTokenByUuid(s,e));return t==null?void 0:t.scopes.includes(ve.TokenReadWrite)}function*Ui(e,t){const s=yield F(Al.list),o=yield F(Ze.selectors.keywords);if(!(!s||!o)){if(t==="add"){const a=[...s];for(const r in o)o[r].type===e&&!a.includes(r)&&a.push(r);return a}if(t==="remove"){const a=[];for(const r in o)o[r].type===e&&!s.includes(r)&&a.push(r);return a}}}function*$2(e){const t=yield u(Ui,"excluded","add");if(!t)return;const s=yield u(Kr);yield u(Ze.sagas.saveExcluded,{...e,excluded:t},s)}function*k2(e){const t=yield u(Ui,"excluded","remove"),s=yield u(Ui,"fixed","remove"),o=yield u(Kr);t&&(yield u(Ze.sagas.saveExcluded,{...e,excluded:t},o)),s&&(yield u(Ze.sagas.saveFixed,{...e,fixed:s},o))}function*N2(e){const t=yield u(Ui,"fixed","add");if(!t)return;const s=yield u(Kr);yield u(Ze.sagas.saveFixed,{...e,fixed:t},s),yield u(Ze.sagas.setFixedEnabled,{...e,enable:!0},s)}function*T2(e){const t=yield u(Kr);yield u(Ze.sagas.setFixedEnabled,{...e,enable:e.enable},t)}function*P2(){var s;const{channel:e,takeEvent:t}=yield u(Ze.sagas.setFixedChannel);try{for(;;){const{event:o}=yield ls({event:u(t),canceled:ne(hs.watcherStop)});if(!o)break;const a=new URL((s=o.request)==null?void 0:s.url,window.location.origin),r=a.searchParams.has("fixed")?a.searchParams.get("fixed")==="true":null;r!==null&&(yield S(Ze.actions.setFixedEnable(r)))}}finally{e.close()}}function*M2(e){const t=yield F(Ze.selectors.keywords),s=e.keywords.type,o=[...e.keywords.items];for(const r in t)t[r].type===s&&!o.includes(r)&&o.push(r);const a=yield u(Kr);s==="fixed"&&(yield u(Ze.sagas.saveFixed,{...e,fixed:o},a),yield u(Ze.sagas.setFixedEnabled,{...e,enable:e.keywords.fixedEnable},a)),s==="excluded"&&(yield u(Ze.sagas.saveExcluded,{...e,excluded:o},a))}function*F2(){yield I([N(hs.addExcluded,T($2,[M,O(Ge.loading.change),L(Ge.loading.change),zt])),N(hs.addCommon,T(k2,[M,O(Ge.loading.change),L(Ge.loading.change),zt])),N(hs.addFixed,T(N2,[M,O(Ge.loading.change),L(Ge.loading.change),zt])),N(hs.addCustom,T(M2,[M,O(Ge.loading.addCustom),L(Ge.loading.addCustom),zt])),N(hs.fixKeywordsEnable,T(T2,[M,O(Ge.loading.fixEnable),L(Ge.loading.fixEnable),zt])),N(hs.watcherStart,T(P2,[M]))])}K(Ge.modelName,F2);const D2={};function QS({advert:e,gridRef:t,gridExportButton:s}){const{addExcluded:o,addCommon:a,addFixed:r,setShowModal:i}=x(hs),l=Al.useIsEmpty(),c=(e==null?void 0:e.type)===Dt.SearchCatalog||(e==null?void 0:e.type)===Dt.Search,d=G.selectors.useLoader(Ge.loading.change),p=Z.selectors.useError(Ge.loading.change),h=()=>{var C,j;(C=t==null?void 0:t.current)==null||C.api.deselectAll(),(j=t==null?void 0:t.current)==null||j.api.redrawRows()},g=()=>{e&&(Te.click(Ge.analytic.addExcluded),o({id:e.id,type:e.type,callback:h}))},y=()=>{e&&(Te.click(Ge.analytic.addCommon),a({id:e.id,type:e.type,callback:h}))},w=()=>{e&&(Te.click(Ge.analytic.addFixed),r({id:e.id,type:e.type,callback:h}))};return n.jsxs(f,{gap:"l",type:"vertical",children:[p&&n.jsx(ee,{value:p}),n.jsxs(f,{type:"horizontal",justify:"start",children:[s,n.jsx(A,{onClick:g,disabled:l||d,isLoading:d,type:"grey",prefix:n.jsx(z.CircleClose,{}),children:"–ò—Å–∫–ª—é—á–∏—Ç—å"}),c&&n.jsx(A,{onClick:w,disabled:l||d,isLoading:d,type:"grey",prefix:n.jsx(z.CircleCheck,{}),children:"–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å"}),n.jsx(A,{onClick:y,disabled:l||d,isLoading:d,type:"purple",children:"–í–µ—Ä–Ω—É—Ç—å –≤ –æ–±—â–∏–µ"}),n.jsx(A,{onClick:()=>i({type:"excluded",suppressAlertModal:!0}),disabled:d,isLoading:d,type:"grey",children:"–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è"}),c&&n.jsx(A,{onClick:()=>i({type:"fixed",suppressAlertModal:!0}),disabled:d,isLoading:d,type:"grey",children:"–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ"})]})]})}function A2(){var l;const{setShowAlertModal:e}=x(hs),t=Al.useShowAlertModal(),[s,o]=m.useState(!1),a=he(Ge.view.alert,{withLoad:!0}),r=()=>{a.save({dontRemind:s}),e(!1)},i=()=>{a.save({dontRemind:s}),e(!1),window.location.reload()};return!a.isReady||(l=a.state)!=null&&l.dontRemind?null:n.jsx(Ye,{open:t,title:"–ü–æ–∑–∏—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤",onCloseClick:()=>e(!1),style:{width:370},children:n.jsxs(f,{type:"vertical",gap:"4xl",children:[n.jsx("p",{children:"–ù–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–∏–ª–∏—Å—å –∏ –æ—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è –≤ –†–ö –≤ —Ç–µ—á–µ–Ω–∏–µ 1‚Äì2 –º–∏–Ω—É—Ç."}),n.jsx("p",{children:"–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è."}),n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsxs(f,{as:"label",type:"horizontal",children:[n.jsx(qr,{checked:s,onChange:()=>o(!s)}),n.jsx("span",{children:"–ë–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"})]}),n.jsx(A,{type:"purple",onClick:i,children:"–û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å"}),n.jsx(A,{onClick:r,children:"–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"})]})]})})}const as={actions:hs,config:Ge,selectors:Al,sagas:D2},L2=k("widget/cmp-advert-keywords-add-custom-modal"),R2={modelName:L2()},E2=e=>e.split(/\n+/);function _2({type:e,suppressAlertModal:t}){const{setShowModal:s,setShowAlertModal:o,addCustom:a}=x(as.actions),r=pe.selectors.useCard(),i=Ze.selectors.useFixedEnabled(),l=G.selectors.useSomeLoader([Ys.config.loading.list,Fs.config.loading.load]),c=Z.selectors.useSomeError([Ys.config.loading.list,Fs.config.loading.load]),d=G.selectors.useLoader(as.config.loading.addCustom),p=Z.selectors.useError(as.config.loading.addCustom),[h,g]=m.useState([]),[y,w]=m.useState(!0),C=()=>{if(!r||!e)return;const q=h.map(B=>B.trim()).filter(Boolean);a({id:r.id,type:r.type,keywords:{items:q,type:e,fixedEnable:y},callback:()=>{s(void 0),t||o(!0)}})};if(m.useEffect(()=>{i!==void 0&&w(i)},[i]),l)return n.jsx(le,{});if(c)return n.jsx(ee,{value:c});if(!r)return null;const j=h.map(q=>q.trim()).filter(Boolean).length>0;return n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(xe.Textarea,{value:h.join(`
`),onChange:q=>g(E2(q.target.value)),style:{"--input-field-height":"25vh"}}),e==="fixed"&&n.jsxs(f,{as:"label",type:"horizontal",children:[n.jsx(qr,{checked:y,onChange:()=>w(!y)}),n.jsx("span",{children:"–í–∫–ª—é—á–∏—Ç—å –ø–æ–∫–∞–∑ –†–ö —Ç–æ–ª—å–∫–æ –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—Ä–∞–∑–∞–º"})]}),p&&n.jsx(ee,{value:p}),n.jsx("div",{children:n.jsx(A,{type:"purple",onClick:C,disabled:!j,isLoading:d,children:"–î–æ–±–∞–≤–∏—Ç—å"})})]})}function I2(){const e=as.selectors.useShowModal(),{setShowModal:t}=x(as.actions);let s;switch(e==null?void 0:e.type){case"fixed":{s="–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã";break}case"excluded":{s="–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è";break}}m.useEffect(()=>{e&&Te.pageView(R2.modelName)},[e]);const o=m.useCallback(()=>{t(void 0)},[]);return n.jsxs(n.Fragment,{children:[n.jsx(Ye,{open:!!e,onCloseClick:o,title:s,style:{maxWidth:"800px"},children:n.jsx(H,{children:e&&n.jsx(_2,{type:e.type,suppressAlertModal:e.suppressAlertModal})})}),!(e!=null&&e.suppressAlertModal)&&n.jsx(A2,{})]})}const O2=k("widget/cmp-advert-keywords-modal"),V2={modelName:O2()};function q2({defaultType:e="common"}){const[t,s]=m.useState(e),o=Ys.selectors.useList(),a=G.selectors.useLoader(Ys.config.loading.list),r=Z.selectors.useError(Ys.config.loading.list);return a?n.jsx(le,{}):r?n.jsx(ee,{value:r}):o?n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(b2,{list:o,onChange:s,value:t}),n.jsx(xe.Textarea,{value:o[t].join(`
`),readOnly:!0,style:{"--input-field-height":"40vh"}})]}):null}function B2(){const e=Ys.selectors.useShowModal(),{setShowModal:t}=x(Ys.actions);return m.useEffect(()=>{e&&Te.pageView(V2.modelName)},[e]),n.jsx(Ye,{open:!!e,onCloseClick:()=>t(void 0),title:"–°–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑",style:{maxWidth:"800px"},children:n.jsx(H,{children:n.jsx(q2,{defaultType:e})})})}const bc=k("feature/cmp-search-position-log-day"),Nn={modelName:bc(),loading:{load:bc("load")},view:{grid:bc("view/grid")}},Oh={},YS=_({name:Nn.modelName,initialState:Oh,reducers:{setShowModal:D("showModal"),resetShowModal:Le("showModal",void 0),reset:()=>Oh}}),W2=E.inject(YS),z2=Q(Nn.modelName),JS={...YS.actions,load:z2("load")},G2=k("entity/evirma/search-position-log"),lm={modelName:G2()},Ro={},ZS=_({name:lm.modelName,initialState:Ro,reducers:{addKeyword:Je("keyword"),addQuery:Je("query"),addCatalog:Je("catalog"),addRecommendation:Je("recommendation"),resetKeyword:Le("keyword",Ro.keyword),resetQuery:Le("query",Ro.query),resetCatalog:Le("catalog",Ro.catalog),resetRecommendation:Le("recommendation",Ro.recommendation),setDayList:D("dayList"),reset:()=>Ro}}),K2=E.inject(ZS),Zo={...ZS.actions},Hr=V(lm.modelName,K2),H2=Hr("keyword"),U2=Hr("query"),Q2=Hr("recommendation"),Y2=Hr("catalog"),Vh=Hr("dayList"),J2={keyword:H2,query:U2,recommendations:Q2,catalog:Y2,dayList:Vh,useDayList:b(Vh)};function Z2(e){if(!e)return{};const t=new Set,s=e.map(({keyword:a,dates:r})=>{const i=new Map;return r.forEach(l=>{var d;const c=new Date(`${l.date} 00:00:00.000Z`);t.add(c.valueOf()),i.set(c.valueOf(),{date:c,organicPosition:{last:l.organic_pos,median:l.organic_pos_median,avg:l.organic_pos_avg},promoPosition:{last:l.promo_pos,median:l.promo_pos_median,avg:l.promo_pos_avg},cpm:{last:l.cpm,median:l.cpm_median,avg:l.cpm_avg},ctr:{last:l.ctr,median:l.ctr_median,avg:l.ctr_avg},promoType:(d=l.adv_type)==null?void 0:d[0],promoName:l.promo,price:l.price!==0?l.price:void 0,isNew:l.is_new})}),{keyword:a,datesMap:i}}),o=[...t].sort((a,r)=>r-a);return s.reduce((a,r)=>(a[r.keyword]=o.map(i=>r.datesMap.get(i)||{date:new Date(i),organicPosition:{},promoPosition:{},cpm:{},ctr:{}}),a),{})}function X2(e){return e?e.dates.map(t=>({date:new Date(t.date),organicPosition:t.organic_pos,promoPosition:t.promo_pos,promoType:t.adv_type,cpm:t.cpm,ctr:t.ctr,promoName:t.promo,price:t.price!==0?t.price:void 0,isNew:t.is_new})):[]}const hr={keyword:{type:"search",putAddEffect:e=>S(Zo.addKeyword(e))},catalog:{type:"catalog",putAddEffect:e=>S(Zo.addCatalog(e))},query:{type:"search",putAddEffect:e=>S(Zo.addQuery(e))},recommendation:{type:"recommendation",putAddEffect:e=>S(Zo.addRecommendation(e))}};function*e_({type:e,nm:t,region:s,keys:o}){const a=yield u(mu.get,{region:s,type:hr[e].type,article:t,keywords:o});if(!a)return;const{putAddEffect:r}=hr[e];yield r(Z2(a.keywords))}function*t_({type:e,nm:t,region:s,key:o,date:a}){const r=yield u(mu.getDay,{region:s,type:hr[e].type,article:t,keywords:[o],date:a.toJSON()});yield S(Zo.setDayList(X2(r.keywords[0])))}function*s_({region:e,type:t,nm:s,items:o}){yield u(mu.save,{type:hr[t].type,items:o.map(({key:a,promoPos:r,organicPos:i,promoCpm:l,promoType:c,ctr:d})=>({type:hr[t].type,region:e,article:s,kw:a,organic_pos:i,promo_pos:r,cpm:l,ctr:d,adv_type:c}))})}const n_={load:e_,loadDay:t_,save:s_};function XS({value:e}){if(e)return n.jsx(be,{type:"red",children:"New"})}const Ds={config:lm,actions:Zo,selectors:J2,sagas:n_};function*o_({type:e,dest:t,nm:s,key:o,date:a}){const r=yield F(i=>ge.selectors.pickupPointByDest(i,t));yield u(Ds.sagas.loadDay,{date:a,key:o,nm:s,region:r==null?void 0:r.region.id,type:e})}function*a_(){yield I([N(JS.load,T(o_,[M,O(Nn.loading.load),L(Nn.loading.load)]))])}K(Nn.modelName,a_);const r_={},i_=V(Nn.modelName,W2),qh=i_("showModal"),l_={showModal:qh,useShowModal:b(qh)},c_=[{field:"date",headerName:"–í—Ä–µ–º—è",valueFormatter:e=>R(e.value).format("HH:mm"),width:90,suppressAutoSize:!0,filter:!1,sortable:!1},{field:"organicPosition",type:["numeric","rightAligned"],headerName:Ba.organicPosition,width:90,filter:!1,sortable:!1},{field:"promoPosition",type:["numeric","rightAligned"],headerName:Ba.promoPosition,width:90,filter:!1,sortable:!1},{field:"cpm",type:["currency","rightAligned"],headerName:Ba.promoCpm,width:90,filter:!1,sortable:!1},{field:"ctr",type:["percent","rightAligned"],headerName:Ba.ctr,width:90,filter:!1,sortable:!1},{field:"promoType",headerName:me.position.promoType,cellRenderer:Sl,width:90,filter:!1,sortable:!1},{field:"promoName",headerName:"–ü—Ä–æ–º–æ",width:120,filter:!1,sortable:!1},{field:"price",headerName:"–¶–µ–Ω–∞",type:["currency.2"],width:120,filter:!1,sortable:!1},{field:"isNew",headerName:"–ù–æ–≤—ã–π",cellRenderer:XS,width:100,filter:!1,sortable:!1}],d_="MfDSvoR",u_={promotionCell:d_};function m_({gridRef:e,data:t,style:s,extendedColumnDefs:o=[]}){const a=he(Nn.view.grid),r=m.useMemo(()=>[...c_,...o],[o]),i=m.useMemo(()=>({filter:!1,floatingFilter:!1,cellClassRules:{[u_.promotionCell]:l=>{var c;return!!((c=l.data)!=null&&c.promoPosition)}}}),[]);return n.jsx(Ce,{gridRef:e,style:s,rowData:t,columnDefs:r,defaultColDef:i,columnsState:a.state,onColumnsStateChanged:a.save})}const Ss={actions:JS,config:Nn,sagas:r_,selectors:l_};function p_(){const{load:e}=x(Ss.actions),t=Ss.selectors.useShowModal(),s=Ds.selectors.useDayList(),o=Z.selectors.useError(Ss.config.loading.load),a=G.selectors.useLoader(Ss.config.loading.load);return m.useEffect(()=>{t&&e(t)},[t]),a?n.jsx(le,{}):o?n.jsx(ee,{value:o}):s?n.jsx(m_,{data:s,style:{height:"30vh",fontWeight:400}}):null}const h_="BfuCw-w",f_={keyBlock:h_};function g_(){const e=Ss.selectors.useShowModal(),{resetShowModal:t}=x(Ss.actions);return m.useEffect(()=>()=>{t()},[]),n.jsx(Ye,{open:!!e,onCloseClick:t,title:`–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫ ${v.dateShort(e==null?void 0:e.date)}`,children:n.jsx(H,{children:n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx("div",{className:f_.keyBlock,children:e==null?void 0:e.key}),n.jsx(p_,{})]})})})}const y_="poDxd-C",w_="CqONI4j",S_={menu:y_,menuItem:w_};function Bh({items:e,className:t}){return n.jsx(f,{type:"horizontal",gap:"l",className:t,align:"center",justify:"flex-start",style:{width:"100%"},children:e.map(({label:s,url:o,icon:a},r)=>n.jsxs(f,{as:"a",href:o,className:S_.menuItem,align:"center",children:[a,n.jsx("span",{children:s})]},r))})}const x_="WFlmICD",b_={auto:x_},Wh=[{label:"–ö–∞–∫–æ–π –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π CPM –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –†–ö?",url:"https://t.me/maxprowb/629",icon:n.jsx(z.CircleInfoFill,{})},{label:"–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞—Å—á–µ—Ç–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ CPM",url:"https://t.me/maxprowb/639",icon:n.jsx(z.Calculator,{})}];function v_(){return n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:"._2rg88yCM .BrrrqeLs",append:"before",children:n.jsx(Bh,{items:Wh,className:b_.auto})}),n.jsx(J,{selector:".w7d9rx7r .glldTYjn",append:"after",children:n.jsx(Bh,{items:Wh})})]})}const j_="AWueNu6",zh={wrapper:j_};function C_(){const{setShowModal:e}=x(Ys.actions),{setShowModal:t}=x(as.actions),s=pe.selectors.useCard();return n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:".Ud2r9IOe .pk6zjKqh p",append:"after",className:zh.wrapper,children:n.jsxs(f,{gap:"s",type:"horizontal",align:"center",justify:"flex-end",style:{width:"100%"},children:[n.jsx(bt,{style:{fontSize:"120%"}}),n.jsx(A,{size:"middle",type:"grey",onClick:()=>e("common"),children:"–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–∫–æ–º"}),(s==null?void 0:s.type)!==Dt.Auto&&n.jsx(A,{size:"middle",type:"grey",onClick:()=>t({type:"fixed",suppressAlertModal:!1}),children:"–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ"})]})}),n.jsx(J,{selector:".Ud2r9IOe + .Ud2r9IOe .pk6zjKqh p",append:"after",className:zh.wrapper,children:n.jsxs(f,{gap:"s",type:"horizontal",align:"center",justify:"flex-end",style:{width:"100%"},children:[n.jsx(bt,{style:{fontSize:"120%"}}),n.jsx(A,{size:"middle",type:"grey",onClick:()=>e("excluded"),children:"–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–∫–æ–º"}),n.jsx(A,{size:"middle",type:"grey",onClick:()=>t({type:"excluded",suppressAlertModal:!1}),children:"–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è"})]})})]})}function $_(){const[e,t]=m.useState([]),s=Fn([".j5QfhgdB .rc-virtual-list-holder-inner",".j5QfhgdB .GDNtuYNu"]),o=a=>{const r=[];a==null||a.querySelectorAll(".DLd9voM2").forEach(i=>{const l=i.querySelector(".JsOxZJhs"),c=l==null?void 0:l.textContent;c&&(i.style.gridTemplateColumns="min-content 1fr min-content min-content 20px",r.push({el:l,data:{keyword:c}}))}),t(r)};return m.useEffect(()=>{o(s);const a=new MutationObserver(()=>{o(s)});return s&&a.observe(s,{childList:!0}),()=>{a.disconnect()}},[s]),e}function k_(){const e=$_();return pe.selectors.useCard()?n.jsx(n.Fragment,{children:e.map(({el:s,data:o})=>n.jsx(Ps,{targetElement:s,append:"after",className:"NV7zrVNk",children:n.jsx(GS,{keyword:o.keyword})},o.keyword))}):null}const N_="W-xjoyJ",T_="cTNDnfv",P_="-WnX-TA",M_="_2daIHwR",F_="KdTf0T1",D_="k5BHYTE",A_="WyJtmVD",un={sectionWrapper:N_,section:T_,title:P_,logo:M_,titleSecondary:F_,titleClosable:D_,content:A_};function ex({isOpen:e}){return e?"–ö–ª–∏–∫–Ω–∏—Ç–µ —á—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å –±–ª–æ–∫":"–ö–ª–∏–∫–Ω–∏—Ç–µ —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –±–ª–æ–∫"}const xt=m.forwardRef(function({id:t,title:s,subTitle:o,children:a,style:r,className:i,defaultClose:l=!1,onClose:c,suppressAnalyticEvent:d,...p},h){const g=!!t,{save:y,isReady:w,value:C}=sa(`${t}/section`,{syncTabs:!0}),j=C===void 0?!l:C,q=()=>{y(!j),c&&c(!j)};return m.useEffect(()=>{j&&t&&!d&&Te.pageView(t)},[j]),w?n.jsx("div",{ref:h,className:P([un.sectionWrapper,i]),style:r,...p,children:n.jsxs(f,{type:"vertical",gap:"xl",className:un.section,children:[n.jsx(Oe,{overlay:n.jsx(ex,{isOpen:j}),placement:"top",mouseEnterDelay:.5,children:n.jsxs(f,{as:"h3",gap:"s",align:"center",className:P(un.title,{[un.titleClosable]:g}),onClick:q,children:[n.jsx(bt,{className:un.logo}),n.jsxs(f,{gap:"l",align:"center",style:{flex:1},children:[s,!j&&o&&n.jsx("span",{className:un.titleSecondary,children:o})]}),g&&n.jsx(A,{type:"link",size:"small",onClick:q,suffix:n.jsx(z.Arrow,{rotate:j?180:0,style:{fontSize:"130%"}}),children:j?"—Å–∫—Ä—ã—Ç—å –±–ª–æ–∫":"–ø–æ–∫–∞–∑–∞—Ç—å –±–ª–æ–∫"})]})}),j&&n.jsx("div",{className:un.content,children:a})]})}):null});function cm({title:e,id:t,children:s,buttonSize:o,buttonType:a,buttonClassName:r,defaultClose:i=!1,className:l}){const{save:c,isReady:d,value:p}=sa(`${t}/collapsible-section`,{syncTabs:!0}),h=p===void 0?!i:p,g=()=>{c(!h)};return d?n.jsxs(f,{type:"vertical",gap:"l",className:l,children:[n.jsx("div",{children:n.jsx(Oe,{overlay:n.jsx(ex,{isOpen:h}),placement:"top",mouseEnterDelay:.3,children:n.jsx(A,{type:a,size:o,suffix:n.jsx(z.Chevron,{rotate:h?-90:0}),className:r,onClick:g,children:e})})}),h&&s]}):null}function L_({children:e}){return n.jsx("div",{className:un.subTitle,children:e})}const R_="HbAblKi",E_={main:R_};function fr({title:e,className:t,...s}){return n.jsx(xt,{title:e||n.jsx(ga,{}),className:P(t,E_.main),...s})}const vc=k("feature/third-party-advert-view"),__={url:"https://tochka.com/rko/seller/?utm_source=evirma&utm_medium=main&utm_campaign=ek-prognozpostavok",erid:"LjN8KEVD8",id:"f9cac2b8-ip",turnoverMin:1e6,cooldown:[7,"days"],shows:8},I_={url:"",erid:"LjN8KEVD8",id:"f9cac2b8-ul",turnoverMin:1e6,cooldown:[7,"days"],shows:8},Xe={modelName:vc(),loading:{load:vc("load"),registerView:vc("registerView")},turnoverMin:1e6,showWideOptionsIP:__,showWideOptionsUL:I_},Gh={},tx=_({name:Xe.modelName,initialState:Gh,reducers:{setCanShowWide:D("canShowWide"),reset:()=>Gh}}),O_=E.inject(tx),Kh=Q(Xe.modelName),gr={...tx.actions,checkWideCooldown:Kh("check-wide-cooldown"),registerView:Kh("register-view")},V_="/assets/YRx4n-RL.png",q_="/assets/TPIDh2g0.webp",B_="/assets/C95gnN93.webp",W_="/assets/DcVkk224.webp",z_="/assets/ByoOIsZg.webp",G_="/assets/DFcdl7jw.png",K_="/assets/B6cZQOO3.webp",H_="/assets/Bk05T288.webp",U_="/assets/rtVEMJHF.webp",Q_="/assets/akN4SCnl.webp",Y_="/assets/Ms5gQyEv.png",J_="/assets/DGyU1Tir.png",Z_="/assets/C7M0MaSK.webp",X_="/assets/DMe1lnPR.webp",eI="/assets/CNlWiaEh.png",qe={audit2:B_,audit:W_,avtootvet:z_,konkurent:K_,marzhinalnost:H_,nalog:U_,obnovitOstatki:Q_,prognozPostavok:Z_,sborkaZakazov:X_,schetDlyaSellerov:eI,ai24:q_,ai24AllGoods:V_,financeOrder:G_,productsChinaCar:Y_,productsChinaSneakers:J_},tI={audit:{url:"https://reklama.tochka.com/app/landing/add/marketplace?auto_sign_with_tochka=true&utm_source=ib&utm_medium=banner&utm_campaign=auditevirma&utm_content=audit&utm_term=auditevirma",img:qe.audit,erid:"2W5zFH69h4c",badgePosition:"topRight"},"audit-2":{url:"https://reklama.tochka.com/audit/mp?utm_source=ib&utm_medium=banner&utm_campaign=auditevirmab&utm_content=audit&utm_term=auditevirmab",img:qe.audit2,erid:"2W5zFH69h4c"},"audit-analytics":{url:"https://reklama.tochka.com/app/landing/add/marketplace?auto_sign_with_tochka=true&utm_source=ib&utm_medium=banner&utm_campaign=auditevirma&utm_content=audit&utm_term=auditevirma",img:qe.audit2,erid:""},"schet-dlya-sellerov":{url:"https://tochka.com/rko/seller/?utm_source=evirma&utm_medium=rko&utm_campaign=main&utm_content=19122024",img:qe.schetDlyaSellerov,erid:"2W5zFHUPWHn"},konkurent:{url:"https://reklama.tochka.com/app/service/wb_competitors_recurring?utm_source=ib&utm_medium=banner&utm_campaign=competitevirma&utm_content=audit&utm_term=competitevirma&auto_sign_with_tochka=true",img:qe.konkurent,erid:"2W5zFJGM82U",imgWidth:400,badgePosition:"topRight"},avtootvet:{url:"https://tochka.com/rko/marketplace_cabinet/generator-avtootvetov-na-otzyvy/?utm_source=evirma&utm_medium=rko&utm_campaign=30112024",img:qe.avtootvet,erid:"2W5zFJSj2zt"},"obnovit-ostatki":{url:"https://tochka.com/rko/marketplace_cabinet/upravlenie-ostatkami-na-marketpleah/?utm_source=evirma&utm_medium=rko&utm_campaign=30112024",img:qe.obnovitOstatki,erid:"2W5zFJXAzqv"},"schet-dlya-bisnesa":{url:"https://tochka.com/rko/seller/?utm_source=evirma&utm_medium=rko&utm_campaign=30112024",img:qe.schetDlyaSellerov,erid:"2W5zFHUPWHn"},marzhinalnost:{url:"https://tochka.com/rko/marketplace-cabinet/analitika-prodazh-na-marketplejsah/?utm_source=evirma&utm_medium=mp&utm_campaign=price&utm_content=19122024",img:qe.marzhinalnost,erid:"2W5zFJhYupL"},"sborka-zakazov":{url:"https://tochka.com/rko/marketplace_cabinet/rabota-po-fbs/?utm_source=evirma&utm_medium=rko&utm_campaign=30112024",img:qe.sborkaZakazov,erid:"2W5zFJuQp56"},"sborka-zakazov-fbs":{url:"https://tochka.com/rko/marketplace-cabinet/rabota-po-fbs/?utm_source=evirma&utm_medium=svoisklad&utm_campaign=ek-fbs",img:qe.sborkaZakazov,erid:"2W5zFJuQp56"},"prognoz-postavok-region":{url:"https://tochka.com/rko/marketplace-cabinet/planirovanie-postavok/?utm_source=evirma&utm_medium=%D0%B7ostavkiregioni&utm_campaign=ek-prognozpostavok",img:qe.prognozPostavok,erid:"2W5zFJyrmv8"},"prognoz-postavok":{url:"https://tochka.com/rko/marketplace_cabinet/planirovanie-postavok/?utm_source=evirma&utm_medium=rko&utm_campaign=30112024",img:qe.prognozPostavok,erid:"2W5zFJyrmv8"},nalog:{url:"https://tochka.com/rko/accounting-marketplaces/?utm_source=evirma&utm_medium=rko&utm_campaign=30112024",img:qe.nalog,erid:"2W5zFK4JjmA"},ai24:{url:"https://24ai.tech/ru/?utm_source=evirma&utm_medium=cartochkatovara&utm_campaign=3022025",img:qe.ai24,erid:"2W5zFK8khcC"},"ai24-all-goods":{url:"https://24ai.tech/ru/?utm_source=evirma&utm_medium=kartocka-tovara&utm_campaign=24ai",img:qe.ai24,erid:"2W5zFK8khcC"},"ai24-a-b":{url:"https://24ai.tech/ru/?utm_source=evirma&utm_medium=abtest&utm_campaign=24ai",img:qe.ai24AllGoods,erid:"2W5zFK8khcC"},"finance-order":{url:"https://tochka.com/rko/marketplace-cabinet/analitika-prodazh-na-marketplejsah/?utm_source=evirma&utm_medium=main&utm_campaign=ek-finsvodka",img:qe.financeOrder,erid:"2W5zFJhYupL"},"finance-order-jam":{url:"https://tochka.com/rko/marketplace-cabinet/analitika-prodazh-na-marketplejsah/?utm_source=evirma&utm_medium=jam&utm_campaign=ek-finsvodka",img:qe.financeOrder,erid:"2W5zFJhYupL"},"products-china-car":{url:"https://tochka.com/rko/zakupki_china/?utm_source=evirma&utm_medium=istoria-ostatkov&utm_campaign=import&utm_content=banner1",img:qe.productsChinaCar,erid:""},"products-china-sneakers":{url:"https://tochka.com/rko/zakupki_china/?utm_source=evirma&utm_medium=index-cen&utm_campaign=import&utm_content=banner2",img:qe.productsChinaSneakers,erid:""}},sI={tochka:tI},Hh=k("entity/evirma/third-party-adverts"),Ll={modelName:Hh(),storageKey:`${W.appName}/${Hh("storage-key")}`},Uh={stats:{}},sx=_({name:Ll.modelName,initialState:Uh,reducers:{setStats:Je("stats"),reset:()=>Uh}}),nI=E.inject(sx),dm={...sx.actions},oI=V(Ll.modelName,nI),nx=oI("stats"),aI=$([nx,(e,t)=>t],(e,t)=>e==null?void 0:e[t]),rI={stats:nx,statById:aI},zd=Ue(Ll.storageKey,{type:Qe.Sync});function*iI(){const e=yield u(zd.get);e&&(yield S(dm.setStats(e)))}function*lI(e){const t=yield u(zd.get),s={[e.id]:e},o={...t||{},...s};yield u(zd.set,o),yield S(dm.setStats(s))}const cI={load:iI,save:lI};function ox({erid:e}){return n.jsxs(n.Fragment,{children:[n.jsx("div",{children:'–ê–û "–¢–æ—á–∫–∞" –û–û–û "–ë–∞–Ω–∫ –¢–æ—á–∫–∞"'}),n.jsx("div",{children:"–ò–ù–ù: 9705120864"}),n.jsx("div",{children:"–ª–∏—Ü.‚Ññ 3545 –æ—Ç 03.02.2023"}),n.jsxs("div",{children:["ERID: ",e]})]})}function ax(e){return n.jsx("svg",{width:"116",height:"22",viewBox:"0 0 116 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:n.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M107.976 7.189c-.162-1.033-.908-1.613-1.861-1.955-1.636-.588-3.329-.62-5.04-.481-1.581.128-3.11.442-4.584 1.202a5018.34 5018.34 0 0 0-.802-4.34C96.986.983 98.288.63 99.626.394c2.862-.505 5.73-.584 8.566.119 2.991.742 5.091 2.436 5.671 5.552C114.006 6.835 114 8 114 8v7c0 .304.038.954.057 1.257.106 1.618.254 1.776 1.943 2.02v3.332c-1.667.412-3.379.629-5.074-.153-.953-.44-1.392-1.252-1.601-2.212a3.388 3.388 0 0 1-.056-.41l-.001-.003c-.008-.08-.016-.168-.028-.265-2.046 2.879-4.974 3.586-8.192 3.409-3.606-.198-6.374-2.568-6.884-5.364-.83-4.55 1.516-7.95 6.196-8.635 2.959-.434 3.807-.25 7.632 1.024 0-.193.007-.385.015-.576.016-.42.032-.833-.031-1.235Zm-.101 5.786c-.982-.661-2.098-1.008-3.265-1.153-1.213-.151-2.41-.072-3.439.706-.944.714-1.301 1.848-.955 3.017.265.899 1.201 1.603 2.304 1.705a6.357 6.357 0 0 0 3.076-.467c1.762-.735 2.452-1.895 2.279-3.808ZM33.601 22c-3.06.018-5.81-.853-8.094-2.826-2.532-2.188-3.532-5.036-3.507-8.264.022-2.678.758-5.114 2.603-7.172 1.655-1.845 3.761-2.943 6.22-3.442 3.086-.627 6.057-.275 8.791 1.233 3.448 1.903 5.151 4.884 5.361 8.679.185 3.338-.64 6.345-3.2 8.744-2.27 2.129-5.056 3.016-8.174 3.048Zm.074-16.603c-2.592.062-4.41 1.409-5.106 3.627-.427 1.367-.4 2.723.026 4.09.62 1.985 1.99 3.204 4.078 3.522 2.115.32 3.932-.358 5.088-2.152 1.315-2.043 1.34-4.225.291-6.386-.898-1.851-2.498-2.68-4.377-2.701ZM77 13h3l.49.11.704 1.25c1.441 2.563 2.882 5.123 4.299 7.64H92c-.069-.167-.127-.324-.182-.473-.11-.297-.208-.56-.346-.799-1.114-1.916-2.234-3.826-3.355-5.736l-.008-.013-.005-.008c-.612-1.045-1.225-2.089-1.836-3.134-.107-.18-.202-.366-.305-.568l-.002-.004-.146-.283C90.04 8.502 90.918 4.52 90.795 0H85c0 1.773-.293 2.816-.637 4.042l-.133.481c-.453 1.657-1.58 2.764-3.188 3.325-.892.31-1.844.255-2.82.198A19.493 19.493 0 0 0 77 8V0h-6v21.981l6 .02v-9ZM61.064 0H67v22h-5.994v-7.055c-.354.082-.698.17-1.036.257-.717.184-1.408.361-2.11.456-2.72.368-5.312.033-7.53-1.844-1.717-1.452-2.722-3.399-3.026-5.608-.206-1.498-.224-3.465-.241-5.441-.008-.934-.017-1.87-.045-2.759L53 0v6c0 2.355 2.075 4.213 4.334 4.246 1.395.02 2.21-.32 3.66-1.24L61.063 0ZM7 22h6V6h7V0H0v6h7v16Z",fill:"currentColor"})})}function dI(e){return n.jsxs("svg",{width:"1em",height:"1em",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[n.jsxs("g",{clipPath:"url(#clip0_1_29)",children:[n.jsx("rect",{width:"32",height:"32",fill:"#7F42E1"}),n.jsx("path",{d:"M22 10H10V14H14V23.3333H18V14H22V10Z",fill:"white"})]}),n.jsx("defs",{children:n.jsx("clipPath",{id:"clip0_1_29",children:n.jsx("rect",{width:"32",height:"32",fill:"white"})})})]})}const yr={config:Ll,actions:dm,selectors:rI,sagas:cI,banners:sI},Qh=k("entity/wb/supplier-stats"),um={modelName:Qh(),loading:{load:Qh("load")}},Yh={},rx=_({name:um.modelName,initialState:Yh,reducers:{setStats:D("stats"),reset:()=>Yh}}),uI=E.inject(rx),mm={...rx.actions},mI=V(um.modelName,uI),Jh=mI("stats"),pI={stats:Jh,useStats:b(Jh)};function ix(e){var s;return{turnover:((s=e.result.stat)==null?void 0:s.fourWeeksAgg.orderedData.itemsSum)??0}}function*hI(){const t=yield u(()=>Ar(dy.getStatsInterceptor));function*s(){const o=yield ne(t),a=ix(o.response.data);return yield S(mm.setStats(a)),a}return{channel:t,takeEvent:s}}function*fI(){const e=yield u(dy.getStats),t=ix(e);yield S(mm.setStats(t))}const gI={getStatsChannel:hI,load:fI},wr={config:um,actions:mm,selectors:pI,sagas:gI};function*yI({id:e}){let t=yield F(a=>yr.selectors.statById(a,e));t||(t={id:e,views:0,showAfter:new Date().toJSON()});const s=e===Xe.showWideOptionsIP.id?Xe.showWideOptionsIP:Xe.showWideOptionsUL,o={...t,views:t.views+1};o.views>=s.shows&&(o.showAfter=R().add(...s.cooldown).toJSON(),o.views=0),yield u(yr.sagas.save,o)}function*wI({payload:e}){const{id:t}=e,s=yield F(wr.selectors.stats),o=t===Xe.showWideOptionsIP.id?Xe.showWideOptionsIP:Xe.showWideOptionsUL;if(!((s==null?void 0:s.turnover)&&s.turnover>=o.turnoverMin))return;yield u(yr.sagas.load);const r=yield F(l=>yr.selectors.statById(l,t)),i=r!=null&&r.showAfter?new Date<new Date(r.showAfter):!1;yield S(gr.setCanShowWide(!i))}function*SI(){yield I([N(gr.checkWideCooldown.type,T(wI,[M,et(Xe.loading.load),L(Xe.loading.load)])),N(gr.registerView,T(yI,[M,et(Xe.loading.registerView),L(Xe.loading.registerView)]))])}K(Xe.modelName,SI);const xI={},bI=V(Xe.modelName,O_),vI=bI("canShowWide"),jI=$([wr.selectors.stats],e=>typeof(e==null?void 0:e.turnover)=="number"&&e.turnover>=Xe.turnoverMin),CI={useCanShowWide:b(vI),useIsPassTurnoverThreshold:b(jI)},$I="HsJTg6w",kI="wTqxdra",NI="DM-rnAE",TI="nI-kBSV",di={icon:$I,wrapper:kI,block:NI,logo:TI};function PI({onClick:e,children:t,display:s,showAppLogo:o}){return n.jsxs("div",{className:di.wrapper,children:[o&&n.jsx(f,{justify:"center",display:"block",className:di.logo,children:n.jsx(ml,{})}),n.jsx(A,{onClick:e,prefix:n.jsx(dI,{className:di.icon}),className:P({[di.block]:s==="block"}),children:t})]})}const MI="UIlbQJR",FI="u-sq92e",DI="_9FxpOxJ",AI="dlVVapb",LI="W-EgTVd",RI="HGtRdsi",Va={dialog:MI,container:FI,image:DI,badge:AI,bottomLeft:LI,topRight:RI};function EI({open:e,onCloseClick:t,bannerId:s}){const o=`${Xe.modelName}/${s}`,a=yr.banners.tochka[s],r=i=>{i.stopPropagation(),Te.advClick(o),t()};return m.useEffect(()=>{e&&Te.advView(o)},[e]),n.jsxs(Ye,{open:e,onCloseClick:t,classNames:Va,style:{maxWidth:a.imgWidth||600},maskClosable:!0,children:[n.jsx("a",{href:a.url,target:"_blank",rel:"noreferrer",onClick:r,children:n.jsx(H,{children:n.jsx("img",{alt:a.erid,src:chrome.runtime.getURL(a.img),className:Va.image})})}),n.jsx(Oe,{overlay:n.jsx(ox,{erid:a.erid}),children:n.jsx(be,{type:"default",className:P(Va.badge,{[Va.bottomLeft]:a.badgePosition==="bottomLeft"||!a.badgePosition,[Va.topRight]:a.badgePosition==="topRight"}),children:"—Ä–µ–∫–ª–∞–º–∞"})})]})}function We({bannerId:e,children:t,display:s,showAppLogo:o=!0}){const[a,r]=m.useState(!1);return n.jsxs(n.Fragment,{children:[n.jsx(PI,{display:s,onClick:i=>{i.stopPropagation(),r(!0)},showAppLogo:o,children:t}),n.jsx(EI,{open:a,onCloseClick:()=>r(!1),bannerId:e})]})}const _I="HeqXUEy",II="qgH-m55",OI="y-6OaJa",jc={wrapper:_I,logo:II,title:OI},Cc=Xe.showWideOptionsIP;function VI(){const e=`${Xe.modelName}/wide-entrepreneur`,t=o=>{o.stopPropagation(),Te.advClick(e),window.open(Cc.url,"blank")},{registerView:s}=x(gr);return m.useEffect(()=>{s({id:Cc.id}),Te.advView(e)},[]),n.jsxs(f,{type:"vertical",gap:"s",align:"center",className:jc.wrapper,children:[n.jsxs(f,{type:"horizontal",gap:"s",align:"center",className:jc.logo,children:[n.jsx(ml,{}),n.jsx("span",{children:"‚Ä¢"}),n.jsx(Oe,{overlay:n.jsx(ox,{erid:Cc.erid}),children:n.jsx("span",{children:"—Ä–µ–∫–ª–∞–º–∞"})})]}),n.jsxs(f,{type:"horizontal",align:"center",gap:"4xl",children:[n.jsx(ax,{width:170,height:40}),n.jsxs(f,{type:"vertical",gap:"s",children:[n.jsx("div",{className:jc.title,children:"–°—á—ë—Ç –ò–ü –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö –∑–∞ 0 ‚ÇΩ"}),n.jsx("div",{children:"–ü–µ—Ä–µ–≤–æ–¥ –¥–æ—Ö–æ–¥–æ–≤ –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏"})]}),n.jsx("div",{children:n.jsx(A,{onClick:t,children:"–ü–æ–¥–∫–ª—é—á–∏—Ç—å"})})]})]})}const qI="yujW32O",BI={wrapper:qI};function pm(){const e=`${Xe.modelName}/support`,t=s=>{s.stopPropagation(),Te.advClick(e)};return n.jsxs(f,{type:"horizontal",gap:"s",align:"center",className:BI.wrapper,as:"a",href:"https://tochka.com/rko/marketplace-products/?utm_source=evirma&utm_medium=main_block&utm_campaign=freeevirma",target:"_blank",rel:"noreferrer",onClick:t,children:[n.jsx("span",{children:"–ø—Ä–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –±–∞–Ω–∫–∞"}),n.jsx(ax,{width:74,height:14})]})}const lx={actions:gr,config:Xe,sagas:xI,selectors:CI},WI="_3DPqINu",zI="uJgujUc",GI="M4BMFla",KI="PUCzfjS",HI="kSrbQr7",qa={wrapper:WI,tab:zI,tabWrapper:GI,selected:KI,hiddenContent:HI};function cx({options:e,value:t,onChange:s,className:o,style:a,renderOnFirstShow:r=!0}){const[i,l]=m.useState(new Set);return m.useEffect(()=>{r&&l(c=>c.has(t)?c:new Set(c).add(t))},[t,r]),n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx("div",{className:P(o,qa.wrapper),style:a,children:n.jsx(f,{type:"horizontal",align:"flex-end",gap:0,children:e.map((c,d)=>n.jsx("button",{disabled:t===c.value,onClick:p=>s(c.value,p),className:P(qa.tab,{[qa.selected]:t===c.value}),children:n.jsxs(f,{type:"horizontal",gap:"xs",wrap:!1,align:"center",className:P(qa.tabWrapper),children:[c.icon,n.jsx("span",{children:c.label}),c.suffix]})},c.value||d.toString()))})}),e.map((c,d)=>{const p=c.value===t;return c.destroyOnHide&&!p||r&&!i.has(c.value)?null:n.jsx("div",{className:P({[qa.hiddenContent]:!p}),hidden:!p,children:c.children},c.value||d.toString())})]})}const ui=k("feature/cmp-advert-catalog-daily-stats"),Ur={modelName:ui(),loading:{load:ui("load")},view:{grid:ui("view/grid"),chart:ui("view/chart")}},Zh={},dx=_({name:Ur.modelName,initialState:Zh,reducers:{setShowModal:D("showModal"),reset:()=>Zh}}),UI=E.inject(dx),QI={...dx.actions};function YI({id:e,stats:t,positionsLog:s}){var r;if(!(t!=null&&t.catalogs))return[];const o=t.catalogs.find(i=>i.id===e);if(!o)return[];const a=new Map;return(r=s==null?void 0:s[e])==null||r.forEach(i=>{a.set(i.date.valueOf(),i)}),o.days.map(i=>({...i,position:a.get(i.date.valueOf())}))}const JI=V(Ur.modelName,UI),ZI=JI("showModal"),Xh=$([To.selectors.stats,Ds.selectors.catalog,(e,t)=>t],(e,t,s)=>{if(s)return YI({stats:e,positionsLog:t,id:s})}),XI={data:Xh,useData:te(Xh),useShowModal:b(ZI)},e3=({extendedColumnDefs:e})=>[{field:"date",type:["date"],headerName:De.date,width:200},{field:"views",type:["numeric"],headerName:De.views,width:125},{field:"clicks",type:["numeric"],headerName:De.clicks,width:125},{field:"ctr",type:["percent"],headerName:De.ctr,headerTooltip:"–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∫–ª–∏–∫–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∫–∞–∑–æ–≤",width:125},{field:"cpc",type:["currency"],headerName:De.cpc,headerTooltip:"–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–∫–∞",width:125},{field:"cpm",type:["currency.0"],headerName:De.cpm,headerTooltip:"–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–π —Ç—ã—Å—è—á–∏ –ø–æ–∫–∞–∑–æ–≤ —Ä–µ–∫–ª–∞–º—ã",width:125},{field:"sum",type:["currency"],headerName:De.sum,width:125},e==null?void 0:e.position];function t3({style:e,className:t,data:s,onGridReady:o,extendedColumnDefs:a}){const r=he(Ur.view.grid,{withLoad:!0}),i=m.useMemo(()=>e3({extendedColumnDefs:a}),[a]),l=m.useMemo(()=>s==null?void 0:s.sort((c,d)=>d.date.valueOf()-c.date.valueOf()),[s]);return n.jsx(Ce,{style:e,className:t,rowData:l,columnDefs:i,onGridReady:o,columnsState:r.state,onColumnsStateChanged:r.save,isCompact:!0})}const Eo=Rn(),_o={type:"linear",beginAtZero:!0,display:!1},s3=[{field:"views",label:De.views,scale:_o,...Eo()},{field:"clicks",label:De.clicks,scale:_o,hide:!0,...Eo()},{field:"ctr",label:De.ctr,scale:_o,...Eo()},{field:"cpc",label:De.cpc,scale:_o,hide:!0,...Eo()},{field:"cpm",label:De.cpm,scale:_o,hide:!0,...Eo()},{field:"sum",label:De.sum,scale:_o,hide:!0,...Eo()}];function n3({style:e,className:t,data:s}){const o=he(Ur.view.chart,{withLoad:!0});return n.jsx(En,{linesState:o.state,onLinesStateChanged:o.save,lineData:s,lineDefs:s3,labelField:"date",labelFormatter:v.dateShort,style:e,className:t,isCompact:!0,withDataLabels:!0,sidebar:"open"})}const Qi={config:Ur,selectors:XI,actions:QI},$c=k("feature/cmp-search-position-log"),Ks={modelName:$c(),loading:{load:$c("load"),save:$c("save")}},ef={},ux=_({name:Ks.modelName,initialState:ef,reducers:{setLoadedParams:D("loadedParams"),reset:()=>ef}}),o3=E.inject(ux),tf=Q(Ks.modelName),Gd={...ux.actions,load:tf("load"),save:tf("save")};function*mx({type:e,nm:t,dest:s,keys:o}){const a=yield F(r=>ge.selectors.pickupPointByDest(r,s));o.length!==0&&(yield u(Ds.sagas.load,{type:e,nm:t,region:a==null?void 0:a.region.id,keys:o}))}const a3={keyword:Ke.selectors.keyword,catalog:Ke.selectors.catalog,query:Ke.selectors.query,recommendation:Ke.selectors.recommendation};function*r3({region:e,nm:t,items:s,type:o}){const a=a3[o],r=yield F(a);if(!r)return;const i=s.reduce((l,c)=>{const d=r[c.key];return!d||d.notFoundReason==="error"||l.push({key:c.key,ctr:c.ctr,organicPos:d==null?void 0:d.organicPosition,promoPos:d==null?void 0:d.promoPosition,promoCpm:d==null?void 0:d.promoCpm,promoType:d==null?void 0:d.promoType}),l},[]);yield u(Ds.sagas.save,{nm:t,region:e,items:i,type:o}),yield u(Ds.sagas.load,{nm:t,region:e,keys:s.map(({key:l})=>l),type:o})}function*i3({nm:e,dest:t,type:s,items:o}){const a=yield F(r=>ge.selectors.pickupPointByDest(r,t));yield u(r3,{nm:e,region:a==null?void 0:a.region.id,items:o,type:s})}function*l3(){yield I([N(Gd.load,T(mx,[M,et(Ks.loading.load),L(Ks.loading.load)])),N(Gd.save,T(i3,[M,et(Ks.loading.save),L(Ks.loading.save)]))])}K(Ks.modelName,l3);const c3={load:mx},d3=V(Ks.modelName,o3),sf=d3("loadedParams"),u3={loadedParams:sf,useLoadedParams:b(sf)},m3="tDbMoke",p3={icon:m3};function px(e){return{nm:-1,promoType:e.promoType,organicPosition:e.organicPosition.median,promoCpm:e.cpm.last,promoCtr:e.ctr.last,promoPosition:e.promoPosition.median,outOfRangeValue:1e3,promoName:e.promoName}}function Rl({onShowDetailsClick:e,...t}){const{value:s}=t,o=m.useMemo(()=>s?px(s):void 0,[s]);if(!o)return null;const a=n.jsx(Mu,{position:o});return o.promoPosition||o.organicPosition?n.jsx(jt,{prefix:n.jsx(z.Clock,{onClick:()=>e(t),className:p3.icon}),children:a}):a}const hx=e=>{var r,i,l;const{column:t,node:s,value:o}=e,a=t.getColDef();if(a.field==="details")return v.currency(((i=(r=s==null?void 0:s.data)==null?void 0:r.details)==null?void 0:i.price)/100,{fraction:0});if((l=a.colId)!=null&&l.startsWith("positionLog-")){const c=o;return Pu({result:c?px(c):void 0})}},On={actions:Gd,config:Ks,sagas:c3,selectors:u3},kc=k("feature/cmp-advert-catalog-stats"),Js={modelName:kc(),loading:{load:kc("load")},view:{grid:kc("view/grid")},loadIntervalDays:14,measurementError:50},h3=Q(Js.modelName),fx={loadDefault:h3("load-default")};function*f3({id:e}){yield u(ge.sagas.loadMainMenu)}function*g3(){yield I([N(fx.loadDefault,T(f3,[M,vt([Js.view.grid]),O(Js.loading.load),L(Js.loading.load)]))])}K(Js.modelName,g3);const y3={};function w3(e,t){const s=[];return e==null||e.forEach(o=>{o.views<Js.measurementError||s.push({id:o.id,stats:o,info:t==null?void 0:t.get(o.id)})}),s}const nf=$([To.selectors.stats,ge.selectors.mainMenuFlat],(e,t)=>w3(e==null?void 0:e.catalogs,t)),S3={data:nf,useData:b(nf)},x3="a5PM831",b3="q9s0yZX",v3="tY4j8Xr",Yi={headerRowsReversed:x3,compact:b3,positionCell:v3};function j3({value:e}){const t=n.jsx("span",{children:e==null?void 0:e.namePath});if(e!=null&&e.url){let s=`${W.wb.marketPlaceBaseUrl}${e==null?void 0:e.url}`;return e!=null&&e.query&&(s+=`?${e==null?void 0:e.query}`),n.jsx(jt,{suffix:n.jsx("a",{href:s,target:"_blank",rel:"noreferrer",className:Yi.link,children:n.jsx(z.Link,{})}),children:t})}return t}const of={...rm,stats:De,id:De.id,info:"–ü—É—Ç—å"},af=e=>{var a,r,i;const{column:t,node:s}=e;switch(t.getColDef().field){case"position":return Pu((a=s==null?void 0:s.data)==null?void 0:a.position);case"info":return((i=(r=s==null?void 0:s.data)==null?void 0:r.info)==null?void 0:i.namePath)||"‚Äî";default:return Cn(e)}},C3=({onPositionSearchClick:e,onDailyShowClick:t,positionCellComponent:s})=>[{colId:"expand",cellRendererSelector:({node:o})=>{if(o.level===0)return{component:aS,params:{onClick:({data:a})=>{a&&t(a)}}}},headerName:"",suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,suppressMovable:!0,suppressSizeToFit:!0,filter:!1,floatingFilter:!1,width:120,maxWidth:120,minWidth:65,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,pinned:"left",checkboxSelection:({node:o})=>o.level!==-1},{field:"id",filter:"agTextColumnFilter",headerName:of.id,pinned:"left",width:95},{field:"info",filter:"agTextColumnFilter",cellRendererSelector:({node:o})=>o.level===-1?{component:Tu,params:{getItemNoun:a=>Zs(a,["–∫–∞—Ç–∞–ª–æ–≥","–∫–∞—Ç–∞–ª–æ–≥–∞","–∫–∞—Ç–∞–ª–æ–≥–æ–≤"])}}:{component:j3},headerName:of.info,pinned:"left",width:300,flex:1,filterValueGetter:({data:o})=>{var a;return(a=o==null?void 0:o.info)==null?void 0:a.namePath}},{field:"position",cellRendererSelector:({node:o})=>o.level===0&&typeof s=="function"?{component:s,params:{onSearchClick:({data:a})=>{a&&e(a)}}}:{component:()=>null},cellClass:Yi.positionCell,headerName:"–ü–æ–∑–∏—Ü–∏—è",filter:!1,sortable:!1,width:160,aggFunc:({rowNode:o,data:a})=>{var r,i,l;return o!=null&&o.childrenAfterGroup?(l=(i=(r=o==null?void 0:o.childrenAfterGroup)==null?void 0:r.find(({data:c})=>c==null?void 0:c.position))==null?void 0:i.data)==null?void 0:l.position:a}}];function $3({data:e,gridRef:t,style:s,onFirstRender:o,onPositionSearchClick:a,positionCellComponent:r,onDailyShowClick:i,campaignId:l}){const c=he(Js.view.grid),d=m.useMemo(()=>[...C3({positionCellComponent:r,onPositionSearchClick:a,onDailyShowClick:i}),...Gu({})],[r,a,i]),p=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),h=m.useCallback(y=>String(y.data.id),[]),g=m.useMemo(()=>({fileName:`${l}_${Js.modelName}`,processCellCallback:af}),[l]);return n.jsx(Ce,{className:P(Yi.headerRowsReversed,Yi.compact),gridRef:t,grandTotalRow:"bottom",style:s,rowData:e,columnDefs:d,getRowId:h,defaultColDef:p,columnsState:c.state,onColumnsStateChanged:c.save,onFirstDataRendered:o,floatingFiltersHeight:56,isCompact:!0,suppressAggFuncInHeader:!0,suppressRowClickSelection:!0,rowSelection:"multiple",maxRowsOnScreen:12,animateRows:!1,defaultExcelExportParams:g,processCellForClipboard:af})}const xs={actions:fx,config:Js,sagas:y3,selectors:S3},mi=k("widget/cmp-advert-catalog-stats-view"),Vt={modelName:mi(),loading:{load:mi("load")},view:{formPrevious:mi("view/form-previous")},analytic:{search:mi("search")},productsLookLimit:1e3},Nc=Q(Vt.modelName),rf={},gx=_({name:Vt.modelName,initialState:rf,reducers:{setSearchParams:D("searchParams"),reset:()=>rf}}),k3=E.inject(gx),Za={...gx.actions,search:Nc("search"),searchOnce:Nc("searchOnce"),stopSearch:Nc("stopSearch")},N3=V(Vt.modelName,k3),lf=N3("searchParams"),T3=$([xs.selectors.data,Ke.selectors.catalog,je.selectors.loadingCatalog],(e,t,s)=>e.map(o=>{const a=t==null?void 0:t[o.id];return{...o,position:{result:a,loading:(s==null?void 0:s[o.id])||!1}}})),P3=$([xs.selectors.data],e=>(e==null?void 0:e.length)>0),Sr={searchParams:lf,useSearchParams:b(lf),useData:b(T3),useHasData:b(P3)};function M3(e){var t,s;if(!(!((t=e.info)!=null&&t.query)||!((s=e.info)!=null&&s.shard)))return{id:e.id,query:e.info.query,shard:e.info.shard}}function*yx(e,t){const s=yield F(Sr.searchParams);if(!s.nm||!s.dest||!s.itemLimit)throw new $o("–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —Ñ–æ—Ä–º–∞");yield u(je.sagas.search,{nm:s.nm,dest:s.dest,type:"catalog",productsLookLimit:Vt.productsLookLimit,pageFrom:t,items:e.map(M3).filter(Tn)}),yield S(On.actions.save({dest:s.dest,nm:s.nm,type:"catalog",items:e.map(({id:o,stats:a})=>({key:o.toString(),ctr:a.ctr}))}))}function*F3(){yield u(je.sagas.reset,{type:"catalog",cleanResults:!1})}function*D3({items:e}){yield u(je.sagas.reset,{type:"catalog",cleanResults:!0}),yield u(yx,e)}function*A3({item:e}){yield u(yx,[e],Wr(e))}function*L3(){yield I([N(Za.search,T(D3,[M,O(Vt.loading.load),L(Vt.loading.load)])),N(Za.searchOnce,T(A3,[M,O(Vt.loading.load),L(Vt.loading.load)])),N(Za.stopSearch,T(F3,[M,O(Vt.loading.load),L(Vt.loading.load)]))])}K(Vt.modelName,L3);function R3({id:e}){const t=Qi.selectors.useData(e),s=Sr.useSearchParams(),{load:o}=x(On.actions),{setShowModal:a}=x(Ss.actions),r=m.useMemo(()=>({position:{field:"position",cellRenderer:Rl,cellRendererParams:{onShowDetailsClick:({value:l})=>{l!=null&&l.date&&e&&s&&a({type:"catalog",dest:s.dest,nm:s.nm,key:e.toString(),date:l.date})}},headerName:"–ü–æ–∑–∏—Ü–∏—è",width:140}}),[]);return m.useEffect(()=>{e&&s&&o({type:"catalog",dest:s.dest,nm:s.nm,keys:[e.toString()]})},[e]),t?n.jsxs(f,{gap:"s",type:"vertical",style:{height:"75vh",minHeight:800},children:[n.jsx(t3,{data:t,style:{flex:"0 0 calc(70% - 8px)"},extendedColumnDefs:r}),n.jsx(n3,{data:t,style:{flex:"0 0 30%"}})]}):null}function E3(){const e=Qi.selectors.useShowModal(),{setShowModal:t}=x(Qi.actions);return n.jsx(Ye,{open:!!e,onCloseClick:()=>t(void 0),title:n.jsxs(n.Fragment,{children:["–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ ",n.jsxs("span",{children:['"',e==null?void 0:e.pathName,'"']})]}),style:{maxWidth:"70vw"},children:n.jsx(H,{children:n.jsx(R3,{id:e==null?void 0:e.id})})})}const pi=k("feature/cmp-advert-keywords-stats"),lt={modelName:pi(),loading:{load:pi("load"),loadDefault:pi("load-default")},view:{grid:pi("view/grid")},loadIntervalDays:14,checkEmptyClustersLimit:50,timePeriods:[{label:"4 –Ω–µ–¥–µ–ª–∏",period:28},{label:"2 –Ω–µ–¥–µ–ª–∏",period:14},{label:"1 –Ω–µ–¥–µ–ª—è",period:7},{label:"2 –¥–Ω—è",period:2},{label:"–í—á–µ—Ä–∞",period:"yesterday"},{label:"–°–µ–≥–æ–¥–Ω—è",period:"today"}],analytic:{clickShow:"clickShow"}},cf={},wx=_({name:lt.modelName,initialState:cf,reducers:{setReportRange:D("reportRange"),setIsEmptyClustersChecked:D("isEmptyClustersChecked"),reset:()=>cf}}),_3=E.inject(wx),hi=Q(lt.modelName),bs={...wx.actions,load:hi("load"),loadDefault:hi("load-default"),checkEmptyClusters:hi("check-empty-clusters"),checkEmptyClustersAbort:hi("check-empty-clusters-abort")},Tc=k("entity/evrima/keyword-metadata"),xo={removeDataAfterDays:2,sendingIntervalMinutes:5,modelName:Tc(),storageKey:{data:`${W.appName}/${Tc("data")}`,wasSendAt:`${W.appName}/${Tc("was-send-at")}`}},df={},Sx=_({name:xo.modelName,initialState:df,reducers:{setKewordMetadataMap:D("keywordMetadataMap"),reset:()=>df}}),I3=E.inject(Sx),hm={...Sx.actions},O3=V(xo.modelName,I3),xx=O3("keywordMetadataMap"),V3=$([xx],e=>Object.entries(e??{}).reduce((t,[s,{metadata:o}])=>(t[s.toString()]=o.catalog_value,t),{})),bx={keywordMetadataMap:xx,catalogValues:V3},xr={data:Ue(xo.storageKey.data,{type:Qe.Local}),sendAfter:Ue(xo.storageKey.wasSendAt,{type:Qe.Local})};function*q3(){const e=yield u(xr.data.get);yield S(hm.setKewordMetadataMap(e||{}))}function*vx(e){const t=yield u(xr.data.get),o={...Object.entries(t??{}).reduce((a,[r,i])=>(i.removeAfter&&R()>=R(i.removeAfter)||(a[r]=i),a),{}),...e};yield S(hm.setKewordMetadataMap(o)),yield u(xr.data.set,o)}function*B3(){const e=yield F(bx.keywordMetadataMap),t=yield u(xr.sendAfter.get);if(!(!t||R()>=R(t))||!e)return;const o=R().add(xo.removeDataAfterDays,"days").toDate(),a=[],r={};Object.entries(e).forEach(([i,{metadata:l,total:c,wasSent:d}])=>{d||(a.push({keyword:i,metadata:l,product_count:c}),r[i]={metadata:l,total:c,wasSent:!0,removeAfter:o})}),a.length&&(yield u(Lt.sendKeywordMetadataMap,a),yield u(xr.sendAfter.set,R().add(xo.sendingIntervalMinutes,"minute").toDate())),r&&(yield u(vx,r))}const W3={load:q3,save:vx,send:B3},za={config:xo,actions:hm,selectors:bx,sagas:W3},Pc=k("feature/cmp-advert-keywords-minus-phrase"),Hs={modelName:Pc(),loading:{load:Pc("load"),save:Pc("save")},analytic:{showModal:"showModal"}},uf={showModal:!1,appliedFilter:null},jx=_({name:Hs.modelName,initialState:uf,reducers:{setShowModal:D("showModal"),setAppliedFilter:D("appliedFilter"),reset:()=>uf}}),z3=E.inject(jx),mf=Q(Hs.modelName),Kd={...jx.actions,loadFilters:mf("loadFilters"),saveFilters:mf("saveFilters")},Mc=k("entity/evirma/keywords-minus-phrase"),El={modelName:Mc(),storageKey:`${W.appName}/${Mc("storage-key")}`,localStorageKey:"wbx__tokenData",event:{save:Mc("save")}},pf={},Cx=_({name:El.modelName,initialState:pf,reducers:{setFilter:D("filter"),reset:()=>pf}}),G3=E.inject(Cx),fm={...Cx.actions},K3=V(El.modelName,G3),hf=K3("filter"),H3={filter:hf,useFilter:b(hf)},Hd=Ue(El.storageKey,{type:Qe.Local});function*U3(e){const t=yield u(Hd.get),s=t==null?void 0:t[e];yield S(fm.setFilter(s))}function*Q3({id:e,filter:t}){let s=yield u(Hd.get);s||(s={}),Bv(t)?s[e]&&delete s[e]:s[e]=t,yield u(Hd.set,s);const o=s[e]||{};yield S(fm.setFilter(o))}const Y3={load:U3,save:Q3},Ji={actions:fm,config:El,sagas:Y3,selectors:H3};function*J3(e){yield u(Ji.sagas.load,e.id)}function*Z3(e){if(e.id){const s={...yield F(Ji.selectors.filter),[e.filter.type]:e.filter.value};yield u(Ji.sagas.save,{id:e.id,filter:s})}}function*X3(){yield I([N(Kd.loadFilters,T(J3,[M,O(Hs.loading.load),L(Hs.loading.load),zt])),N(Kd.saveFilters,T(Z3,[M,O(Hs.loading.save),L(Hs.loading.save),zt]))])}K(Hs.modelName,X3);const eO={},$x=V(Hs.modelName,z3),tO=$x("showModal"),ff=$x("appliedFilter"),sO={appliedFilter:ff,useShowModal:b(tO),useAppliedFilter:b(ff)},Ut={actions:Kd,config:Hs,sagas:eO,selectors:sO};R.extend(Rv);function nO({keywords:e,stats:t,keywordsFreq:s,catalogValues:o}){if(!e)return[];const a=new Map(t==null?void 0:t.keywords.map(i=>[i.keyword,i])),r=new Map;return Object.keys(e).map(i=>{var y,w,C;const l=e[i],c=(w=(y=s==null?void 0:s[i])==null?void 0:y.cluster)==null?void 0:w.freq_syn.monthly,d=((C=s==null?void 0:s[i])==null?void 0:C.catalog_value)||o[i],p=a.get(i);if(d){let j=r.get(d);j||(j={current:"common"},r.set(d,j)),l.type!=="common"&&(j.current=l.type)}let h={current:l.type};d&&(h=r.get(d)||{current:l.type});let g;if(p&&typeof c=="number"){const j=p.views,q=p.days.filter(B=>B.views>0).length;q&&(g=j/(q*(c/30))*100,g=Math.min(100,g))}return{...l,stats:p,freq:c,clusterId:d,shardType:h,trafficShare:g}})}const kx=V(lt.modelName,_3),gf=kx("reportRange"),yf=kx("isEmptyClustersChecked"),wf=$([To.selectors.stats,Rt.selectors.list,Ze.selectors.keywords,za.selectors.catalogValues],(e,t,s,o)=>nO({stats:e,keywordsFreq:t,keywords:s,catalogValues:o})),Sf=$([Ut.selectors.appliedFilter],e=>{if(e)return{[e.type]:e.value}}),gm={reportRange:gf,useReportRange:b(gf),data:wf,useData:b(wf),filters:Sf,useFilters:b(Sf),isEmptyClustersChecked:yf,useIsEmptyClustersChecked:b(yf)},xf={...rm,stats:De,freq:"–ß–∞—Å—Ç–æ—Ç–∞",keywordCluster:"–ö–ª–∞—Å—Ç–µ—Ä—ã"};async function ym(e,t){let s=[];switch(t){case"fixed":case"excluded":s=[t];break;case"common":s=["common"];break;case"active":s=["common","fixed"];break;case"all":s=["excluded","fixed","common"];break}await e.setColumnFilterModel("type",s.length?{filterType:"set",values:s}:null),e.onFilterChanged(),e.deselectAll()}const oO=e=>!e.node.aggData,Zi=e=>{const{column:t,value:s}=e,o=t.getColDef();return o.colId==="stems"?null:o.field==="position"?Pu(s):Cn(e)},aO=e=>{const t=[];return t.push({sheetName:"–ü–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º",shouldRowBeSkipped:s=>!s.node.aggData,processCellCallback:Zi}),t.push({sheetName:"–î–µ—Ç–∞–ª—å–Ω–æ",shouldRowBeSkipped:s=>{var o,a,r;return((o=s.node)==null?void 0:o.childIndex)===0&&((a=s.node)==null?void 0:a.firstChild)&&((r=s.node)==null?void 0:r.lastChild)},processCellCallback:Zi}),{fileName:`${e}_${lt.modelName}_${R().format("YYYY-MM-DD_HH-mm")}.xlsx`,sheetsConfig:t}},rO=e=>t=>{const s=t.api;return[...Yy(t.defaultItems,["export"]),{name:"–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel",action:()=>{s&&Qy(s,e)}}]};function iO(e){return m.useCallback(()=>!!(e&&Object.keys(e).length>0),[e])}function lO(e){return m.useCallback(t=>{var a,r;if(!e||Object.keys(e).length===0)return!0;const s=t.data;if(!(s!=null&&s.words))return!0;const o=s.words.map(i=>i.stem).filter(Boolean);return!((a=e.wordPlus)!=null&&a.length&&!e.wordPlus.flatMap(c=>Ft(c).map(d=>d.stem).filter(Boolean)).every(c=>o.includes(c))||(r=e.wordMinus)!=null&&r.length&&e.wordMinus.flatMap(c=>Ft(c).map(d=>d.stem).filter(Boolean)).some(c=>o.includes(c)))},[e])}function cO(e){var i;const t=e.getDisplayedRowCount()-1,s=e.getDisplayedRowAtIndex(t),o=((i=s==null?void 0:s.aggData)==null?void 0:i["stats.sum"])||0,a=new Map;let r=0;return e.forEachNodeAfterFilterAndSort(l=>{var c;if(l.group){let d=0;(c=l.childrenAfterSort)==null||c.forEach(p=>{var g,y;const h=(((y=(g=p.data)==null?void 0:g.stats)==null?void 0:y.sum)||0)/o*100;d+=h,a.set(p,{percent:h,cumulative:d})}),r+=d,a.set(l,{cumulative:r})}}),a}function dO({period:e,createTime:t}){const s=R();let o,a;switch(e){case"today":o=s.clone().startOf("day"),a=s.clone().endOf("day");break;case"yesterday":o=s.clone().subtract(1,"day").startOf("day"),a=s.clone().subtract(1,"day").endOf("day");break;default:o=s.clone().subtract(e,"day").startOf("day"),a=s.clone().endOf("day");break}if(t){const r=R(t);o=R(Math.max(o.valueOf(),r.valueOf()))}return{begin:o,end:a}}function*uO({card:e,period:t}){const s=t??lt.loadIntervalDays,o=dO({period:s,createTime:e.createTime});yield S(bs.setReportRange(o)),yield u(Nx,{card:e,range:{begin:R(o.begin).startOf("day"),end:R(o.end).endOf("hour")}})}function*Nx({card:e,range:t}){yield u(To.sagas.load,{id:e.id,range:{begin:R(t.begin).startOf("day"),end:R(t.end).endOf("hour")}})}function*mO(){yield S(bs.setIsEmptyClustersChecked(!1)),(yield F(za.selectors.keywordMetadataMap))||(yield u(za.sagas.load));try{const t={},s=yield F(Ve.selectors.destinationValue),r=(yield F(gm.data)).filter(i=>!i.clusterId).sort((i,l)=>{var c,d;return Number((c=l.stats)==null?void 0:c.views)-Number((d=i.stats)==null?void 0:d.views)}).slice(0,lt.checkEmptyClustersLimit).map(({keyword:i})=>u(Ke.sagas.searchKeywordPosition,{keyword:i,dest:s,nms:[1],productsLookLimit:1,onPage:function*({total:l,metadata:c}){yield t[i]={metadata:c,total:l}}}));yield ls([ne(bs.checkEmptyClustersAbort),I(r)]),yield u(za.sagas.save,t),yield u(za.sagas.send)}finally{yield S(bs.setIsEmptyClustersChecked(!0))}}function*pO(){yield S(bs.setIsEmptyClustersChecked(!1))}function*hO(){yield I([N(bs.checkEmptyClustersAbort,pO),N(bs.checkEmptyClusters,mO),N(bs.load,T(Nx,[M,O(lt.loading.load),L(lt.loading.load)])),N(bs.loadDefault,T(uO,[M,vt([lt.view.grid]),O(lt.loading.loadDefault),L(lt.loading.loadDefault),zt]))])}K(lt.modelName,hO);const fO={},gO="_7BBGi4o",yO="_0KuJu63",wO="x9Uu8rf",fi={link:gO,childrenOfGroup:yO,unclustered:wO};function SO({value:e,data:t,node:s}){var p,h;const o=m.useCallback(g=>{const y=window.getSelection();if(y!=null&&y.toString()){g.preventDefault();return}s.setExpanded(!s.expanded)},[s]),[a,r]=m.useState(s.expanded);m.useEffect(()=>{const g=y=>r(y.node.expanded);return s.addEventListener("expandedChanged",g),()=>{s.removeEventListener("expandedChanged",g)}},[]);const i=s.childrenAfterGroup&&s.childrenAfterGroup.length>1;if(!e)return;const l=Co(W.outRoute.marketPlaceSearch,{search:e}),c=`${W.wb.marketPlaceBaseUrl}${l}`,d=!!(s.key||(p=s.parent)!=null&&p.key);return n.jsx(jt,{onClick:i?o:void 0,prefix:n.jsx(z.Chevron,{rotate:a?-90:0,style:{visibility:i?"visible":"hidden"}}),suffix:n.jsxs(n.Fragment,{children:[i&&n.jsxs("span",{children:["(",(h=s.childrenAfterFilter)==null?void 0:h.length,")"]}),!d&&n.jsx(Oe,{placement:"top",overlay:"–ö–ª–∞—Å—Ç–µ—Ä –∫–ª—é—á–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ –∏—Å–∫–ª—é—á–∞—Ç—å –¥–∞–Ω–Ω—ã–π –∫–ª—é—á, –ø–æ–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä –Ω–µ –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω.",children:n.jsx(z.QuestionCircle,{className:fi.unclustered})}),n.jsx("a",{href:c,target:"_blank",rel:"noreferrer",className:fi.link,children:n.jsx(z.Link,{})})]}),children:n.jsx(zS,{keyword:e,type:(t==null?void 0:t.type)||s.aggData.type,className:P({[fi.childrenOfGroup]:s.level>0,[fi.unclustered]:!d})})})}const xO="F4vHsby",bO="_7ncJI2U",vO="lcUD1PP",Ud={headerRowsReversed:xO,compact:bO,positionCell:vO},jO=({onPositionSearchClick:e,onDailyShowClick:t,positionCellComponent:s,exportOptions:o,filters:a})=>[{colId:"hasViewsToday",headerName:"–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å",filter:"agSetColumnFilter",hide:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,valueGetter:({data:r})=>{var c,d;const i=R().startOf("day");return((d=(c=r==null?void 0:r.stats)==null?void 0:c.days)==null?void 0:d.some(p=>R(p.date).startOf("day").isSame(i,"day")&&p.views>0))?"yes":"no"}},{colId:"firstDate",headerName:"–î–∞—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è",filter:"agDateColumnFilter",hide:!0,valueGetter:({data:r})=>{var i;return((i=r==null?void 0:r.stats)==null?void 0:i.days)??null},valueFormatter:({value:r})=>!Array.isArray(r)||!r.length?"-":R(r[0].date).format("DD.MM.YYYY"),filterParams:{comparator:(r,i)=>{if(!(i!=null&&i.length))return-1;const l=R(i[0].date).startOf("day"),c=R(r).startOf("day");return l.isBefore(c)?-1:l.isAfter(c)?1:0}}},{field:"clusterId",rowGroup:!0,hide:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0},{colId:"expand",cellRendererSelector:({node:r,api:i})=>{if(r.level===0)return{component:aS,params:{onClick:()=>{const l=wn(r);l&&t(l)}}};if(r.level===-1)return{component:xa,params:{api:i,exportOptions:o,size:"small-grid"}}},headerName:"–í—ã–±—Ä–∞—Ç—å –≤—Å–µ",suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,suppressMovable:!0,suppressSizeToFit:!0,filter:!1,floatingFilter:!1,width:129,maxWidth:129,minWidth:65,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,checkboxSelection:({node:r})=>r.level!==-1,pinned:"left"},{colId:"stems",hide:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,filter:"agTextColumnFilter",floatingFilterComponent:s1,floatingFilterComponentParams:{filters:a},sortable:!1,valueGetter:({data:r})=>r!=null&&r.words?r.words.map(i=>i.stem).filter(Boolean):[],aggFunc:({rowNode:r})=>{const i=wn(r);return i!=null&&i.words?i.words.map(l=>l.stem).filter(Boolean):[]}},{field:"keyword",filter:"agTextColumnFilter",cellRendererSelector:({node:r})=>r.level===-1?{component:Tu,params:{getItemNoun:i=>Zs(i,["–∫–ª—é—á","–∫–ª—é—á–∞","–∫–ª—é—á–µ–π"]),countOnlyMainNodes:!0}}:{component:SO},headerName:xf.keywordCluster,pinned:"left",width:330,flex:1,aggFunc:({rowNode:r})=>{var l,c,d,p;if(r.level===-1)return(l=r.childrenAfterFilter)==null?void 0:l.length;const i=(c=r.childrenAfterGroup)==null?void 0:c.sort((h,g)=>{var y,w;return(((y=g.data)==null?void 0:y.freq)||0)-(((w=h.data)==null?void 0:w.freq)||0)});return(p=(d=i==null?void 0:i[0])==null?void 0:d.data)==null?void 0:p.keyword}},{field:"freq",type:["numeric"],filter:"agNumberColumnFilter",headerName:xf.freq,floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt,aggFunc:({rowNode:r,api:i})=>{if(r.level===-1)return Qn(r,i).reduce((d,p)=>{var g;const h=(g=p.aggData)==null?void 0:g.freq;return d+(h||0)},0);const l=wn(r);return l==null?void 0:l.freq},width:90},{field:"position",cellRendererSelector:({node:r})=>r.level===0&&typeof s=="function"?{component:s,params:{onSearchClick:()=>{const i=wn(r);i&&e(i)}}}:{component:()=>null},cellClass:Ud.positionCell,headerName:"–ü–æ–∑–∏—Ü–∏—è",filter:!1,sortable:!1,width:120,aggFunc:({rowNode:r,data:i})=>{var l,c,d;return r!=null&&r.childrenAfterGroup?(d=(c=(l=r==null?void 0:r.childrenAfterGroup)==null?void 0:l.find(({data:p})=>p==null?void 0:p.position))==null?void 0:c.data)==null?void 0:d.position:i}},{field:"type",filter:"agSetColumnFilter",hide:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,valueGetter:({data:r})=>r==null?void 0:r.shardType.current,aggFunc:({rowNode:r})=>{var l,c;const i=(l=r.childrenAfterGroup)==null?void 0:l.find(({data:d})=>(d==null?void 0:d.type)!=="common");return(c=i==null?void 0:i.data)!=null&&c.type?i.data.type:"common"}},{field:"trafficShare",filter:!1,sortable:!1,floatingFilter:!1,headerName:"–í—ã–∫—É–ø. —Ç—Ä–∞—Ñ.",headerTooltip:`% –≤—ã–∫—É–ø–ª–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ - –ø–æ–¥—Ä–æ–±–Ω–µ–µ <a href="${W.evirma.channels.maxProWB.url}" target="_blank">${W.evirma.channels.maxProWB.name}</a>`,type:["percent.0"],width:70,aggFunc:({rowNode:r,values:i})=>{if(r&&r.level!==-1)return ny(i)}}],CO=({expenseData:e})=>[{headerName:"–î–æ–ª—è –∑–∞—Ç—Ä–∞—Ç",colId:"expense.percent",type:["percent.2"],filter:!1,sortable:!1,floatingFilter:!1,width:80,valueGetter:({node:t})=>{var s;if(t)return(s=e==null?void 0:e.get(t))==null?void 0:s.percent},aggFunc:({rowNode:t,values:s})=>{if(t)return t.level===-1?100:ny(s)}},{headerName:"–î–æ–ª—è –Ω–∞–∫–æ–ø.",headerTooltip:"–î–æ–ª—è –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è",colId:"expense.cumulative",type:["percent.2"],filter:!1,sortable:!1,floatingFilter:!1,width:80,valueGetter:({node:t})=>{var s;if(t)return(s=e==null?void 0:e.get(t))==null?void 0:s.cumulative},aggFunc:({rowNode:t})=>{var s;if(t)return t.level===-1?100:(s=e==null?void 0:e.get(t))==null?void 0:s.cumulative}}];function $O(){const[e,t]=Ae.useState();return{calculateExpenseFromGridData:m.useCallback(o=>{t(cO(o.api))},[]),expenseData:e}}function kO({gridRef:e,data:t,style:s,onSelected:o,onFirstRender:a,positionCellComponent:r,onPositionSearchClick:i,onDailyShowClick:l,campaignId:c}){const d=he(lt.view.grid),p=m.useMemo(()=>aO(c),[c]),h=gm.useFilters(),g=Ut.selectors.useAppliedFilter();m.useEffect(()=>{var ce;const Y=(ce=e==null?void 0:e.current)==null?void 0:ce.api;Y&&(Y.deselectAll(),g&&Y.forEachNodeAfterFilter(se=>{se.data&&se.setSelected(!0)}))},[g,e]);const y=iO(h),w=lO(h),{calculateExpenseFromGridData:C,expenseData:j}=$O(),q=m.useMemo(()=>[...jO({positionCellComponent:r,onPositionSearchClick:i,onDailyShowClick:l,exportOptions:p,filters:h}),...Gu({onDailyShowClick:l}),...CO({expenseData:j})],[r,i,l,j,h]),B=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),X=m.useCallback(Y=>{o&&o(Y.api.getSelectedRows())},[o]),U=m.useCallback(Y=>{C(Y)},[C]),fe=m.useCallback(Y=>{C(Y)},[C]),$e=m.useCallback(Y=>String(Y.data.keyword),[]),ut=m.useMemo(()=>({fileName:`${c}_${lt.modelName}`,shouldRowBeSkipped:oO,processCellCallback:Zi}),[c]);return n.jsx(Ce,{tooltipInteraction:!0,isCompact:!0,className:P(Ud.headerRowsReversed,Ud.compact),gridRef:e,grandTotalRow:"bottom",style:s,rowData:t,columnDefs:q,getRowId:$e,defaultColDef:B,columnsState:d.state,onColumnsStateChanged:d.save,floatingFiltersHeight:56,rowSelection:"multiple",suppressRowClickSelection:!0,onSelectionChanged:X,onFirstDataRendered:a,onFilterChanged:U,onSortChanged:fe,maxRowsOnScreen:12,groupSelectsChildren:!0,groupDisplayType:"custom",groupAllowUnbalanced:!0,suppressAggFuncInHeader:!0,animateRows:!1,defaultExcelExportParams:ut,getContextMenuItems:rO(p),processCellForClipboard:Zi,isExternalFilterPresent:y,doesExternalFilterPass:w})}const Ie={actions:bs,config:lt,sagas:fO,selectors:gm};function NO({gridRef:e,campaignId:t,shouldStartSearch:s}){const o=Sr.useData(),a=Sr.useSearchParams(),{setShowModal:r}=x(Qi.actions),{searchOnce:i,search:l}=x(Za),c=m.useCallback(p=>{const h=ka(p,je.config.defaultItemLimit);l({items:h})},[]),d=m.useCallback(p=>{s&&c(p.api)},[]);return m.useEffect(()=>{var p;s&&((p=e==null?void 0:e.current)!=null&&p.api)&&c(e.current.api)},[s]),a?n.jsx($3,{gridRef:e,data:o,onFirstRender:d,positionCellComponent:Nl,onPositionSearchClick:p=>i({item:p}),onDailyShowClick:({id:p,info:h})=>r({id:p,pathName:h==null?void 0:h.namePath}),campaignId:t}):n.jsx(le,{})}function TO({gridRef:e}){const t=pe.selectors.useCardNms(),s=je.selectors.useCountLoadingCatalog(),{search:o,setSearchParams:a,stopSearch:r}=x(Za),i=he(Vt.view.formPrevious,{withLoad:!0}),l=je.selectors.useDefaultSearchParams(),c=Ve.selectors.useDestination(),[d,p]=m.useState(),h=m.useCallback(()=>{var g;if(Te.click(Vt.analytic.search),!(!(d!=null&&d.itemLimit)||!(d!=null&&d.nm)||!(d!=null&&d.dest))&&(g=e==null?void 0:e.current)!=null&&g.api){const y={itemLimit:d.itemLimit};d.dest!==(c==null?void 0:c.value)&&(y.dest=d.dest),i.save(y),a(d);const w=ka(e.current.api,d==null?void 0:d.itemLimit);o({items:w})}},[d]);return m.useEffect(()=>{if(!l||!i.isReady)return;const g={...l||{},...i.state||{}};p(g),a(g)},[l,i.isReady]),n.jsx(kl,{nms:t,form:d,onFormChange:p,onSearchClick:h,countLoadingPosition:s,onResetSearchClick:r})}function PO(){const e=m.useRef(null),t=Sr.useHasData(),{loadDefault:s}=x(xs.actions),o=G.selectors.useSomeLoader([Fs.config.loading.load,Ie.config.loading.load,Ie.config.loading.loadDefault,xs.config.loading.load,wo.config.loading.list,...Object.values(xs.config.view)]),a=Z.selectors.useSomeError([xs.config.loading.load,Ie.config.loading.load,Ie.config.loading.loadDefault]),r=pe.selectors.useCard();return m.useEffect(()=>{r&&s({id:r.id})},[r]),a?n.jsx(ee,{value:a}):o?n.jsx(le,{}):t?n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx(TO,{gridRef:e}),n.jsx(NO,{gridRef:e,campaignId:r==null?void 0:r.id,shouldStartSearch:!0}),n.jsx(f,{align:"center",children:n.jsx(xa,{gridRef:e})})]}):n.jsx(dt,{type:"warning",message:"–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥–∞—Ö WB –Ω–µ –±—ã–ª–æ –ø–æ–∫–∞–∑–æ–≤ –≤–∞—à–µ–π –†–ö"})}const gi=k("feature/cmp-advert-keywords-daily-stats"),Qr={modelName:gi(),loading:{load:gi("load")},view:{chart:gi("view/chart"),grid:gi("view/grid")},analytic:{clickShow:"clickShow"}},bf={},Tx=_({name:Qr.modelName,initialState:bf,reducers:{setShowModal:D("showModal"),reset:()=>bf}}),MO=E.inject(Tx),FO={...Tx.actions};function DO({keyword:e,stats:t,keywordsFreq:s,positionsLog:o}){var l,c,d;if(!(t!=null&&t.keywords))return[];const a=t.keywords.find(p=>p.keyword===e);if(!a)return[];const r=(c=(l=s==null?void 0:s[e])==null?void 0:l.cluster)==null?void 0:c.freq_syn.weekly,i=new Map;return(d=o==null?void 0:o[e])==null||d.forEach(p=>{i.set(p.date.valueOf(),p)}),a.days.map(({views:p,...h})=>({...h,views:p,position:i.get(h.date.valueOf()),boughtTraffic:r&&p?ze(p/(r/7)*100,2):void 0}))}const AO=V(Qr.modelName,MO),LO=AO("showModal"),vf=$([To.selectors.stats,Rt.selectors.list,Ds.selectors.keyword,(e,t)=>t],(e,t,s,o)=>{if(o)return DO({keyword:o,stats:e,keywordsFreq:t,positionsLog:s})}),RO={data:vf,useData:te(vf),useShowModal:b(LO)},yt={...De,boughtTraffic:"–ö—É–ø–ª–µ–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫, %",position:"–ü–æ–∑–∏—Ü–∏—è"},EO=({extendedColumnDefs:e})=>[{field:"date",type:["date"],headerName:yt.date,width:140},{field:"views",type:["numeric"],headerName:yt.views,width:100},{field:"clicks",type:["numeric"],headerName:yt.clicks,width:100},{field:"ctr",type:["percent.2"],headerName:yt.ctr,headerTooltip:"–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∫–ª–∏–∫–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∫–∞–∑–æ–≤",width:100},{field:"cpc",type:["currency.1"],headerName:yt.cpc,headerTooltip:"–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–∫–∞",width:100},{field:"cpm",type:["currency.0"],headerName:yt.cpm,headerTooltip:"–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–π —Ç—ã—Å—è—á–∏ –ø–æ–∫–∞–∑–æ–≤ —Ä–µ–∫–ª–∞–º—ã",width:100},{field:"sum",type:["currency"],headerName:yt.sum,width:100},{field:"boughtTraffic",type:["percent"],headerName:yt.boughtTraffic,width:150},e==null?void 0:e.position,e==null?void 0:e.price,e==null?void 0:e.isNew],_O="c0Fcsee",IO={headerRowsRegular:_O};function OO({style:e,className:t,data:s,onGridReady:o,extendedColumnDefs:a}){const r=he(Qr.view.grid,{withLoad:!0}),i=m.useMemo(()=>EO({extendedColumnDefs:a}),[a]),l=m.useMemo(()=>s==null?void 0:s.sort((c,d)=>d.date.valueOf()-c.date.valueOf()),[s]);return n.jsx(Ce,{style:e,className:P(t,IO.headerRowsRegular),rowData:l,columnDefs:i,onGridReady:o,columnsState:r.state,onColumnsStateChanged:r.save,isCompact:!0})}const mn=Rn(),pn={type:"linear",position:"right",beginAtZero:!0,display:!1},VO=[{field:"views",label:yt.views,scale:pn,...mn()},{field:"clicks",label:yt.clicks,scale:pn,hide:!0,...mn()},{field:"ctr",label:yt.ctr,scale:pn,...mn()},{field:"cpc",label:yt.cpc,scale:pn,hide:!0,...mn()},{field:"cpm",label:yt.cpm,scale:pn,hide:!0,...mn()},{field:"sum",label:yt.sum,scale:pn,hide:!0,...mn()},{field:"boughtTraffic",label:yt.boughtTraffic,scale:pn,hide:!0,...mn()}];function qO(e){return[...VO,...e.map(t=>({scale:pn,...mn(),...t}))]}function BO({style:e,className:t,data:s,additionLineDefs:o}){const a=he(Qr.view.chart,{withLoad:!0}),r=Ae.useMemo(()=>qO(o),[o]);return n.jsx(En,{linesState:a.state,onLinesStateChanged:a.save,lineData:s,lineDefs:r,labelField:"date",labelFormatter:v.dateShort,style:e,className:t,isCompact:!0,withDataLabels:!0,sidebar:"open"})}const Xi={config:Qr,selectors:RO,actions:FO},WO=[{id:"position",label:"–ü–æ–∑–∏—Ü–∏—è",valueGetter:({data:e})=>{var t,s,o,a;return((s=(t=e.position)==null?void 0:t.promoPosition)==null?void 0:s.median)??((a=(o=e.position)==null?void 0:o.organicPosition)==null?void 0:a.median)},hide:!0},{field:"position.organicPosition.median",label:"–ü–æ–∑–∏—Ü–∏—è –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è",hide:!0},{field:"position.promoPosition.median",label:"–ü–æ–∑–∏—Ü–∏—è —Ä–µ–∫–ª–∞–º–Ω–∞—è",hide:!0}],yi=k("widget/cmp-advert-keywords-stats-view"),mt={modelName:yi(),loading:{load:yi("load")},view:{formPrevious:yi("view/form-previous")},analytic:{search:yi("search")},productsLookLimit:1e3,storage:{showTodayOnly:"widgets/cmp-advert-keywords-stats-view/showTodayOnly",onlyActual:"widgets/cmp-advert-keywords-stats-view/onlyActual",showOnly:"widgets/cmp-advert-keywords-stats-view/showOnly"}},Fc=Q(mt.modelName),jf={},Px=_({name:mt.modelName,initialState:jf,reducers:{setSearchParams:D("searchParams"),reset:()=>jf}}),zO=E.inject(Px),Xa={...Px.actions,search:Fc("search"),searchOnce:Fc("searchOnce"),searchStop:Fc("searchStop")},GO=V(mt.modelName,zO),Cf=GO("searchParams"),KO=$([Ie.selectors.data,Ke.selectors.keyword,je.selectors.loadingKeyword,Ds.selectors.keyword],(e,t,s,o)=>e.map(a=>{var c;const r=t==null?void 0:t[a.keyword],i=(c=o==null?void 0:o[a.keyword])==null?void 0:c[0],l=r&&i?{...r,promoName:i.promoName,price:i.price,isNew:i.isNew}:r;return{...a,position:{result:l,loading:(s==null?void 0:s[a.keyword])||!1}}})),br={searchParams:Cf,useSearchParams:b(Cf),useData:b(KO)};function HO(e){if(e.keyword)return{keyword:e.keyword}}function*Mx(e,t){const s=yield F(br.searchParams);if(!s.nm||!s.dest||!s.itemLimit)throw new $o("–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —Ñ–æ—Ä–º–∞");yield u(je.sagas.search,{nm:s.nm,dest:s.dest,type:"keyword",productsLookLimit:mt.productsLookLimit,pageFrom:t,items:e.map(HO).filter(Tn)});const o=R(new Date);yield S(On.actions.save({dest:s.dest,nm:s.nm,type:"keyword",items:e.map(({keyword:a,stats:r})=>{const i=r==null?void 0:r.days.find(({date:l})=>o.isSame(R(l),"day"));return{key:a,ctr:i==null?void 0:i.ctr}})}))}function*UO(){yield u(je.sagas.reset,{type:"keyword",cleanResults:!1})}function*QO({items:e}){yield u(je.sagas.reset,{type:"keyword",cleanResults:!0}),yield u(Mx,e)}function*YO({item:e}){yield u(Mx,[e],Wr(e))}function*JO(){yield I([N(Xa.search,T(QO,[M,O(mt.loading.load),L(mt.loading.load)])),N(Xa.searchOnce,T(YO,[M,O(mt.loading.load),L(mt.loading.load)])),N(Xa.searchStop,T(UO,[M,O(mt.loading.load),L(mt.loading.load)]))])}K(mt.modelName,JO);function ZO({keyword:e}){const t=Xi.selectors.useData(e),s=br.useSearchParams(),{load:o}=x(On.actions),{setShowModal:a}=x(Ss.actions),r=m.useMemo(()=>t==null?void 0:t.sort((l,c)=>l.date.valueOf()-c.date.valueOf()),[t]),i=m.useMemo(()=>({position:{field:"position",cellRenderer:Rl,cellRendererParams:{onShowDetailsClick:({value:c})=>{c!=null&&c.date&&e&&s&&a({type:"keyword",dest:s.dest,nm:s.nm,key:e,date:c.date})}},headerName:"–ü–æ–∑–∏—Ü–∏—è",width:180},price:{field:"position.price",headerName:"–¶–µ–Ω–∞",type:["currency.2"],width:120},isNew:{field:"position.isNew",headerName:"–ù–æ–≤—ã–π",cellRenderer:XS,width:100,sortable:!1,filter:!1}}),[]);return m.useEffect(()=>{e&&s&&o({type:"keyword",dest:s.dest,nm:s.nm,keys:[e]})},[e]),t?n.jsxs(f,{gap:"s",type:"vertical",style:{height:"75vh",minHeight:800},children:[n.jsx(OO,{data:t,style:{flex:"0 0 calc(70% - 8px)"},extendedColumnDefs:i}),n.jsx(BO,{data:r,style:{flex:"0 0 30%"},additionLineDefs:WO})]}):null}function XO(){const e=Xi.selectors.useShowModal(),{setShowModal:t}=x(Xi.actions);return n.jsx(Ye,{open:!!e,onCloseClick:()=>t(void 0),title:n.jsxs(n.Fragment,{children:["–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª—é—á–∞ ",n.jsxs("span",{children:['"',e==null?void 0:e.keyword,'"']})]}),style:{maxWidth:"70vw"},children:n.jsx(H,{children:n.jsx(ZO,{keyword:e==null?void 0:e.keyword})})})}const e5=k("widget/cmp-advert-keywords-minus-phrase-modal"),t5={modelName:e5()},s5="SBdLSX4",n5={textarea:s5};function o5({campaignId:e,gridRef:t}){const s=Ji.selectors.useFilter(),o=Ut.selectors.useAppliedFilter(),{saveFilters:a,setShowModal:r,loadFilters:i,setAppliedFilter:l}=x(Ut.actions),c=G.selectors.useLoader(Ut.config.loading.load),d=G.selectors.useLoader(Ut.config.loading.save),p=Z.selectors.useError(Ut.config.loading.load),h=Z.selectors.useError(Ut.config.loading.save),g=p||h,[y,w]=m.useState("wordPlus"),[C,j]=m.useState("");m.useEffect(()=>{e&&i({id:e})},[e,i]),m.useEffect(()=>{o&&o.type===y?j(o.value.join(`
`)):s&&s[y]?j(s[y].join(`
`)):j("")},[s,o,y]);const q=$e=>{w($e)},B=$e=>{j($e.target.value)},X=()=>{var Y;const $e=C.split(`
`).filter(Boolean),ut=(Y=t==null?void 0:t.current)==null?void 0:Y.api;ut&&(l({type:y,value:$e,campaignId:e}),a({id:e,filter:{type:y,value:$e}}),ut.onFilterChanged(),r(!1))},U=m.useMemo(()=>[{label:"–ü–ª—é—Å-—Å–ª–æ–≤–∞",value:"wordPlus",icon:n.jsx(z.CircleCheck,{})},{label:"–ú–∏–Ω—É—Å-—Å–ª–æ–≤–∞",value:"wordMinus",icon:n.jsx(z.CircleClose,{})}],[]),fe=$e=>{switch($e){case"wordPlus":return`–í–≤–µ–¥–∏—Ç–µ –ø–ª—é—Å-—Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏
–ø—Ä–∏–º–µ—Ä:
—Å–ª–æ–≤–æ1
—Å–ª–æ–≤–æ2`;case"wordMinus":return`–í–≤–µ–¥–∏—Ç–µ –º–∏–Ω—É—Å-—Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏
–ø—Ä–∏–º–µ—Ä:
—Å–ª–æ–≤–æ1
—Å–ª–æ–≤–æ2`;default:return""}};return c?n.jsx(le,{}):g?n.jsx(ee,{value:g}):n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(an,{options:U,value:y,onChange:q}),n.jsx(Ry,{value:C,onChange:B,placeholder:fe(y),className:n5.textarea}),n.jsxs(f,{type:"horizontal",gap:"m",justify:"flex-end",children:[n.jsx(A,{type:"default",onClick:()=>r(!1),children:"–û—Ç–º–µ–Ω–∞"}),n.jsx(A,{type:"blue",onClick:X,isLoading:d,children:"–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä"})]})]})}function a5({campaignId:e,gridRef:t}){const s=Ut.selectors.useShowModal(),{setShowModal:o}=x(Ut.actions);return m.useEffect(()=>{s&&Te.pageView(t5.modelName)},[s]),n.jsx(Ye,{open:s,onCloseClick:()=>o(!1),title:"–§–∏–ª—å—Ç—Ä—ã –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤",style:{maxWidth:"800px"},children:n.jsx(H,{children:n.jsx(o5,{campaignId:e,gridRef:t})})})}function r5({children:e}){const{checkEmptyClusters:t,checkEmptyClustersAbort:s}=x(Ie.actions),o=Ie.selectors.useIsEmptyClustersChecked();return Ae.useEffect(()=>(t(),()=>{s()}),[]),o?e:n.jsx(le,{})}function i5({gridRef:e,campaignId:t,shouldStartSearch:s}){const o=br.useData(),a=br.useSearchParams(),{setShowModal:r}=x(Xi.actions),{setList:i}=x(as.actions),{searchOnce:l,search:c}=x(Xa),d=m.useCallback(g=>{i(g.map(({keyword:y})=>y))},[]),p=m.useCallback(g=>{const y=ka(g,je.config.defaultItemLimit);c({items:y})},[]),h=m.useCallback(async g=>{await ym(g.api,"all"),s&&p(g.api)},[]);return m.useEffect(()=>{var g,y;s&&((g=e==null?void 0:e.current)!=null&&g.api)&&p((y=e==null?void 0:e.current)==null?void 0:y.api)},[s]),a?n.jsx(kO,{gridRef:e,data:o,onSelected:d,onFirstRender:h,onPositionSearchClick:g=>l({item:g}),positionCellComponent:Nl,onDailyShowClick:r,campaignId:t}):null}const l5="Nlu3ouD",c5="oRlgFdy",d5="bzdHmyW",u5="rtX5SjM",m5="s9uD-7N",p5="ieC0V26",h5="cBDrvtr",_s={wrapper:l5,label:c5,toggle:d5,thumb:u5,disabled:m5,input:p5,track:h5},_i=({label:e,labelOff:t,labelOn:s,innerOff:o,innerOn:a,valueLeft:r,valueRight:i,labelAs:l="label",loading:c,checked:d,onChange:p,disabled:h,...g})=>{const y=d?s||e:t||e,w=d?a:o;return n.jsxs(l,{className:_s.wrapper,children:[r&&n.jsx("span",{className:_s.label,children:r}),n.jsxs("div",{className:P(_s.toggle,{[_s.disabled]:h||c}),children:[n.jsx("input",{type:"checkbox",className:_s.input,checked:d,onChange:p,disabled:h||c,...g}),n.jsx("div",{className:_s.track,children:n.jsx("div",{className:_s.thumb,children:w})})]}),i&&n.jsx("span",{className:_s.label,children:i}),!r&&!i&&y&&n.jsx("span",{className:_s.label,children:y})]})};function f5({isAuction:e,gridRef:t}){const[s,o]=m.useState("all"),{save:a,value:r}=sa(mt.storage.showTodayOnly,{syncTabs:!0}),{save:i,value:l}=sa(mt.storage.onlyActual,{syncTabs:!0}),{save:c,value:d}=sa(mt.storage.showOnly,{syncTabs:!0}),p=br.useData(),h=Ut.selectors.useAppliedFilter(),{setShowModal:g,setAppliedFilter:y}=x(Ut.actions),w=m.useMemo(()=>e?p:Wv(p,"clusterId"),[p,e]),C=m.useMemo(()=>{const B=[{label:"–í—Å–µ",badge:w.length,value:"all"}];return B.push({label:"–ê–∫—Ç–∏–≤–Ω—ã–µ",badge:w.length-w.filter(({type:X})=>X==="excluded").length,value:"active"},{label:"–ò—Å–∫–ª—é—á–µ–Ω–∏—è",badge:w.filter(({type:X})=>X==="excluded").length,value:"excluded",icon:n.jsx(z.CircleClose,{})}),e&&(B.push({label:"–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ",badge:w.filter(({type:X})=>X==="fixed").length,value:"fixed",icon:n.jsx(z.CircleCheck,{})}),B.push({label:"–ù–µ —Ñ–∏–∫—Å.",badge:w.filter(({type:X})=>X==="common").length,value:"common"})),B},[w,e]);m.useEffect(()=>{(async()=>t!=null&&t.current&&(t!=null&&t.current.api)&&await ym(t.current.api,s))()},[s]),m.useEffect(()=>{var fe;const B=(fe=t==null?void 0:t.current)==null?void 0:fe.api;if(!B)return;const X=B.getFilterModel();let U=null;if(r)U={filterType:"date",type:"greaterThan",dateFrom:(d?R().subtract(2,"day"):R().subtract(1,"day")).startOf("day").format("YYYY-MM-DD")},B.setFilterModel({...X,firstDate:U});else{const{firstDate:$e,...ut}=X;B.setFilterModel(ut)}},[r,d]),m.useEffect(()=>{var U;const B=(U=t==null?void 0:t.current)==null?void 0:U.api;if(!B)return;const X=B.getFilterModel();if(l)B.setFilterModel({...X,hasViewsToday:{filterType:"set",values:["yes"]}});else{const{hasViewsToday:fe,...$e}=X;B.setFilterModel($e)}},[l]);const j=()=>{g(!0)},q=()=>{y(null)};return n.jsxs(f,{align:"center",gap:"m",children:[n.jsx(an,{options:C,value:s,onChange:o}),n.jsx(Oe,{placement:"top",mouseEnterDelay:.4,overlay:n.jsx(_i,{valueLeft:"–¢–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è",valueRight:"–°–æ –≤—á–µ—Ä–∞",checked:!!d,onChange:B=>c(B.target.checked)}),children:n.jsx("span",{children:n.jsx(_i,{label:"–ù–æ–≤—ã–µ",checked:!!r,onChange:B=>a(B.target.checked)})})}),n.jsx(_i,{label:"–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ",checked:!!l,onChange:B=>i(B.target.checked)}),n.jsx(A,{type:"purple",size:"small",onClick:j,children:"+/- —Å–ª–æ–≤–∞"}),h&&n.jsx(A,{type:"default",size:"small",onClick:q,children:"–û—á–∏—Å—Ç–∏—Ç—å"})]})}const g5=()=>{const e=pe.selectors.useCard(),{watcherStart:t,watcherStop:s,fixKeywordsEnable:o}=x(as.actions),a=G.selectors.useLoader(as.config.loading.fixEnable),r=Z.selectors.useError(as.config.loading.fixEnable),i=Ze.selectors.useFixedEnabled();Ae.useEffect(()=>(e!=null&&e.id&&t(),()=>{s()}),[e==null?void 0:e.id]);const l=c=>{const d=c.target.checked;e&&o({...e,enable:d})};return n.jsxs(n.Fragment,{children:[r&&n.jsx(ee,{value:r}),n.jsx(Oe,{overlay:"–í–∫–ª—é—á–∏—Ç—å\\–≤—ã–∫–ª—é—á–∏—Ç—å –ø–æ–∫–∞–∑ —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—Ä–∞–∑–∞–º",placement:"topLeft",mouseEnterDelay:.3,children:n.jsx(_i,{label:"–í–∫–ª—é—á–∏—Ç—å –ø–æ–∫–∞–∑ –†–ö —Ç–æ–ª—å–∫–æ –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—Ä–∞–∑–∞–º",checked:i,loading:a,onChange:l})})]})};function y5({gridRef:e}){const t=pe.selectors.useCardNms(),s=je.selectors.useCountLoadingKeyword(),{search:o,setSearchParams:a,searchStop:r}=x(Xa),i=he(mt.view.formPrevious,{withLoad:!0}),l=je.selectors.useDefaultSearchParams(),c=Ve.selectors.useDestination(),[d,p]=m.useState(),h=m.useCallback(()=>{var g;if(Te.click(mt.analytic.search),!(!(d!=null&&d.itemLimit)||!(d!=null&&d.nm)||!(d!=null&&d.dest))&&(g=e==null?void 0:e.current)!=null&&g.api){const y={itemLimit:d.itemLimit};d.dest!==(c==null?void 0:c.value)&&(y.dest=d.dest),i.save(y),a(d);const w=ka(e.current.api,d==null?void 0:d.itemLimit);o({items:w})}},[d]);return m.useEffect(()=>{if(!l||!i.isReady)return;const g={...l||{},...i.state||{}};p(g),a(g)},[l,i.isReady]),n.jsx(kl,{nms:t,form:d,countLoadingPosition:s,onFormChange:p,onSearchClick:h,onResetSearchClick:r})}function w5(){const e=m.useRef(null),t=pe.selectors.useCard(),s=(t==null?void 0:t.type)===Dt.SearchCatalog,o=G.selectors.useSomeLoader([Fs.config.loading.load,Ie.config.loading.load,Ie.config.loading.loadDefault,xs.config.loading.load,wo.config.loading.list,...Object.values(Ie.config.view),...Object.values(xs.config.view)]),a=Z.selectors.useSomeError([Ie.config.loading.load,Ie.config.loading.loadDefault]),r=Z.selectors.useError(wo.config.loading.list);return o?n.jsx(le,{}):a?n.jsx(ee,{value:a}):n.jsx(r5,{children:n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx(y5,{gridRef:e}),s&&n.jsx(g5,{}),r&&n.jsx(ee,{value:r}),n.jsx(f5,{isAuction:s,gridRef:e}),n.jsx(i5,{gridRef:e,campaignId:t==null?void 0:t.id,shouldStartSearch:!0}),n.jsx(QS,{advert:t,gridRef:e}),n.jsx(a5,{campaignId:t==null?void 0:t.id,gridRef:e})]})})}const $f=k("feature/cmp-advert-words-stats"),Qd={modelName:$f(),view:{grid:$f("view/grid")}};function S5({stats:e,keywordsFreq:t,keywords:s}){if(!s)return[];const o=new Map,a=new Map(e==null?void 0:e.keywords.map(r=>[r.keyword,r]));return Object.keys(s).forEach(r=>{var p,h;const i=a.get(r),l=s==null?void 0:s[r],c=l==null?void 0:l.words,d=(h=(p=t==null?void 0:t[r])==null?void 0:p.cluster)==null?void 0:h.freq_syn.monthly;!c||!l||c.forEach(g=>{if(!g.stem)return;const y={...l,stats:i,word:g,freq:d};o.set(`${g.stem}-${r}`,y)})}),[...o.values()].sort((r,i)=>{var l,c;return(((l=r.stats)==null?void 0:l.views)||0)-(((c=i.stats)==null?void 0:c.views)||0)})}const kf=$([To.selectors.stats,Rt.selectors.list,Ze.selectors.keywords],(e,t,s)=>S5({stats:e,keywordsFreq:t,keywords:s})),x5={data:kf,useData:b(kf)};function Nf({data:e}){return e?n.jsx(zS,{keyword:e==null?void 0:e.keyword,type:e==null?void 0:e.type,style:{paddingLeft:20}}):null}const b5="BsJHZcs",v5={button:b5};function j5({node:e}){var a;const t=m.useCallback(()=>e.setExpanded(!e.expanded),[e]),[s,o]=m.useState(e.expanded);return m.useEffect(()=>{const r=i=>o(i.node.expanded);return e.addEventListener("expandedChanged",r),()=>{e.removeEventListener("expandedChanged",r)}},[]),n.jsx(Nu,{onClick:t,className:v5.button,children:n.jsxs(jt,{prefix:n.jsx(z.Cloud,{style:{fontSize:"120%"}}),suffix:n.jsx(z.Chevron,{rotate:s?-90:0,style:{fontSize:"120%"}}),children:["–ø–æ–∫–∞–∑–∞—Ç—å —Ñ—Ä–∞–∑—ã (",(a=e.childrenAfterFilter)==null?void 0:a.length,")"]})})}const Dc={...rm,stats:De,word:"–ö–æ—Ä–µ–Ω—å",freq:"–ß–∞—Å—Ç–æ—Ç–∞"},C5=()=>[{field:"word.stem",rowGroup:!0,hide:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0},{field:"word.stem",filter:"agTextColumnFilter",cellRendererSelector:({node:e,value:t})=>e.level===0?{component:()=>t}:e.level===-1?{component:Tu,params:{getItemNoun:(s,o)=>Zs(s,o?["–∫–ª—é—á","–∫–ª—é—á–∞","–∫–ª—é—á–µ–π"]:["–±–ª–æ–∫","–±–ª–æ–∫–∞","–±–ª–æ–∫–æ–≤"])}}:{component:Nf},headerName:Dc.word,pinned:"left",width:200,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,suppressMovable:!0,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,lockPinned:!0,lockPosition:"left",colSpan:({node:e})=>(e==null?void 0:e.level)===0?1:2,checkboxSelection:({node:e})=>e.level!==-1,aggFunc:({rowNode:e})=>{var t,s,o,a;return e.level===-1?(t=e.childrenAfterFilter)==null?void 0:t.length:(a=(o=(s=e.childrenAfterFilter)==null?void 0:s[0])==null?void 0:o.data)==null?void 0:a.word.stem}},{field:"keyword",filter:"agTextColumnFilter",cellRendererSelector:({node:e})=>e.level===0?{component:j5}:{component:Nf},headerName:Dc.keyword,pinned:"left",lockPosition:"left",aggFunc:"count",lockPinned:!0,width:300,minWidth:114},{colId:"emptyDivider",headerName:"",suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,suppressSizeToFit:!0,resizable:!1,filter:!1,sortable:!1,floatingFilter:!1,width:1,pinned:"left",lockPosition:"left",cellStyle:{padding:0}},{field:"type",filter:"agSetColumnFilter",hide:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0},{field:"freq",type:["numeric"],filter:"agNumberColumnFilter",headerName:Dc.freq,floatingFilterComponent:Nt,suppressFloatingFilterButton:!0,suppressHeaderFilterButton:!0,filterValueGetter:Tt,aggFunc:"sum",width:100}],$5="edux2wR",k5="_442S2s-",Tf={headerRowsReversed:$5,compact:k5};function N5({gridRef:e,data:t,style:s,onSelected:o,campaignId:a}){const r=he(Qd.view.grid),i=m.useMemo(()=>[...C5(),...Gu({})],[]),l=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),c=m.useCallback(h=>{o&&o(h.api.getSelectedRows())},[o]),d=m.useCallback(h=>`${h.data.word.stem}-${h.data.keyword}`,[]),p=m.useMemo(()=>({fileName:`${a}_${Qd.modelName}`}),[a]);return n.jsx(Ce,{className:P(Tf.headerRowsReversed,Tf.compact),gridRef:e,grandTotalRow:"bottom",style:s,rowData:t,columnDefs:i,getRowId:d,defaultColDef:l,columnsState:r.state,onColumnsStateChanged:r.save,groupDisplayType:"custom",onSelectionChanged:c,floatingFiltersHeight:56,groupSelectsChildren:!0,isCompact:!0,suppressAggFuncInHeader:!0,suppressRowClickSelection:!0,rowSelection:"multiple",maxRowsOnScreen:12,animateRows:!1,defaultExcelExportParams:p})}const T5={config:Qd,selectors:x5};function P5({gridRef:e,campaignId:t}){const s=T5.selectors.useData(),{setList:o}=x(as.actions),a=m.useCallback(r=>{o(r.map(({keyword:i})=>i))},[]);return n.jsx(N5,{gridRef:e,data:s,onSelected:a,campaignId:t})}function M5({gridRef:e,showFixed:t}){const[s,o]=m.useState("all"),a=m.useMemo(()=>{const r=[{label:"–í—Å–µ",value:"all"},{label:"–ò—Å–∫–ª—é—á–µ–Ω–∏—è",value:"excluded",icon:n.jsx(z.CircleClose,{})}];return t&&r.push({label:"–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ",value:"fixed",icon:n.jsx(z.CircleCheck,{})}),r},[t]);return m.useEffect(()=>{(async()=>e!=null&&e.current&&(e!=null&&e.current.api)&&await ym(e.current.api,s))()},[s]),n.jsx(an,{options:a,value:s,onChange:o})}function F5(){const e=m.useRef(null),t=pe.selectors.useCard(),s=(t==null?void 0:t.type)===Dt.SearchCatalog,o=G.selectors.useSomeLoader([Fs.config.loading.load,Ie.config.loading.load,Ie.config.loading.loadDefault,xs.config.loading.load,wo.config.loading.list,...Object.values(Ie.config.view),...Object.values(xs.config.view)]),a=Z.selectors.useSomeError([Ie.config.loading.load,Ie.config.loading.loadDefault]);return a?n.jsx(ee,{value:a}):o?n.jsx(le,{}):n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx(M5,{showFixed:s,gridRef:e}),n.jsx(P5,{gridRef:e,campaignId:t==null?void 0:t.id}),n.jsx(QS,{advert:t,gridRef:e,gridExportButton:n.jsx(xa,{gridRef:e})})]})}const er="YYYY-MM-DD",Pf=({min:e,max:t})=>({min:e==null?void 0:e.format(er),max:t==null?void 0:t.format(er)});function D5({value:e,max:t,min:s,onChange:o,disabled:a}){var g,y;const r=m.useMemo(()=>({begin:e!=null&&e.begin?R(e.begin):void 0,end:e!=null&&e.end?R(e.end):void 0}),[e]),i=m.useMemo(()=>{const w=s?R(s):void 0,C=t?R(t):void 0;return{min:w,max:C}},[s,t]),l=m.useMemo(()=>{const w={...i};return(r.end&&!w.max||r.end&&w.max&&w.max>r.end)&&(w.max=r.end),Pf(w)},[i,r]),c=m.useMemo(()=>{const w={...i};return(r.begin&&!w.min||r.begin&&w.min&&w.min<r.begin)&&(w.min=r.begin),Pf(w)},[i,r]),d=(g=r.begin)==null?void 0:g.format(er),p=(y=r.end)==null?void 0:y.format(er),h=m.useCallback((w,C)=>{const j=R(w.target.value,er,!0);o&&j.isValid()&&o({...r,[C]:j})},[r,o]);return n.jsxs(f,{children:[n.jsx(xe,{type:"date",value:d,...l,style:{width:150},onChange:w=>h(w,"begin"),disabled:a},"begin"),n.jsx(xe,{type:"date",value:p,...c,style:{width:150},onChange:w=>h(w,"end"),disabled:a},"end")]})}function Fx({isLoading:e,onSubmit:t,value:s}){const o=pe.selectors.useCard(),[a,r]=m.useState(s||{}),i=m.useCallback(()=>{a.end&&a.begin&&t(a)},[a]),l=m.useMemo(()=>({min:o!=null&&o.createTime?R(o==null?void 0:o.createTime):void 0,max:R()}),[o]),c=!(a!=null&&a.begin)||!(a!=null&&a.end)||!o;return m.useEffect(()=>{r(s||{})},[s]),n.jsxs(f,{gap:"s",children:[n.jsx(D5,{value:a,...l,onChange:r,disabled:e}),n.jsx(A,{onClick:i,isLoading:e,disabled:e||c,children:"–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"})]})}function A5(){const{load:e}=x(Ie.actions),t=G.selectors.useSomeLoader([Ie.config.loading.load,Ie.config.loading.loadDefault,wo.config.loading.list]),s=pe.selectors.useCard(),o=Ie.selectors.useReportRange(),a=m.useCallback(r=>{s&&e({card:s,range:r})},[s]);return n.jsx(Fx,{isLoading:t,onSubmit:a,value:o})}const L5=[{value:"keyword",label:"–ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã",children:n.jsxs(H,{children:[n.jsx(w5,{}),n.jsx(XO,{})]})},{value:"catalog",label:"–†–∞–∑–¥–µ–ª—ã –∫–∞—Ç–∞–ª–æ–≥–∞",children:n.jsxs(H,{children:[n.jsx(PO,{}),n.jsx(E3,{})]})},{value:"words",label:"–°–º—ã—Å–ª–æ–≤—ã–µ –±–ª–æ–∫–∏",children:n.jsx(H,{children:n.jsx(F5,{})})}];function R5(){const[e,t]=m.useState("keyword");return n.jsxs(f,{gap:"3xl",type:"vertical",children:[n.jsx(A5,{}),n.jsx(cx,{options:L5,value:e,onChange:t}),n.jsx(Ln,{})]})}const E5="AIYLUgk",_5="_7T7BN8v",I5="UJA4zck",Ac={wrapper:E5,content:_5,image:I5};function Dx({id:e,backgroundImg:t,buttonContent:s,children:o,onButtonClick:a}){const[r,i]=m.useState(!0),l=m.useCallback(()=>{a&&a(),i(!1)},[]);return m.useEffect(()=>{r&&e&&Te.pageView(e)},[r]),r?n.jsxs("div",{className:Ac.wrapper,children:[n.jsx("img",{alt:"widget-stub",className:Ac.image,src:t}),n.jsx("div",{className:Ac.content,children:m.isValidElement(s)?m.cloneElement(s,{onButtonClick:l}):n.jsx(A,{type:"purple",onClick:l,children:s})})]}):o}const O5="/assets/BaSDdwae.png",V5=chrome.runtime.getURL(O5);function q5({onPeriodSelect:e,onButtonClick:t}){const s=a=>{e(a),t&&t()},o=a=>n.jsx(f,{type:"horizontal",align:"center",wrap:!1,gap:"s",children:a.map(r=>n.jsx(A,{type:"purple",onClick:()=>s(r.period),style:{width:"100%"},children:r.label},r.label))});return n.jsxs(f,{type:"vertical",align:"stretch",gap:"s",children:[o(lt.timePeriods.slice(0,3)),o(lt.timePeriods.slice(3))]})}function B5({children:e,id:t}){const{loadDefault:s}=x(Ie.actions),o=pe.selectors.useCard(),{save:a}=x(rS.actions),r=m.useCallback(i=>{o&&s({card:o,period:i,callback:()=>a({card:o})})},[o,s,a]);return n.jsx(Dx,{id:t,backgroundImg:V5,buttonContent:n.jsx(q5,{onPeriodSelect:r}),children:e})}const W5="wdG2Z2y",z5="IaOMzt4",G5="cO6FyKh",K5="_5XMRHML",wi={card:W5,withLabel:z5,cardTitle:G5,cardBody:K5};function Da({label:e,footer:t,children:s,className:o,style:a}){return n.jsxs(f,{type:"vertical",gap:"s",className:P(wi.card,o,{[wi.withLabel]:!!e}),style:a,children:[e&&n.jsx("div",{className:wi.cardTitle,children:e}),s&&n.jsx("div",{className:wi.cardBody,children:s}),t&&n.jsx(f,{type:"horizontal",justify:"space-around",children:t})]})}function H5(){const{load:e}=x(ct.actions),t=G.selectors.useLoader(ct.config.loading.load),s=Z.selectors.useError(ct.config.loading.load),o=pe.selectors.useCardNms();return Ae.useEffect(()=>{o!=null&&o.length&&e({nms:o})},[o]),s?n.jsx(ee,{value:s}):o?n.jsx(f,{type:"vertical",gap:"m",children:o.map(a=>n.jsx(Da,{children:n.jsx(qd,{nm:a,isLoading:t})},a))}):null}const U5=k("entity/wb/advert-stats"),_l={modelName:U5(),loadIntervalDaysChunk:14},Mf={},Ax=_({name:_l.modelName,initialState:Mf,reducers:{setStats:Je("stats"),reset:()=>Mf}}),Q5=E.inject(Ax),Lx={...Ax.actions},Y5=V(_l.modelName,Q5),Yd=Y5("stats"),J5=$(Yd,e=>Object.values(e||{}).map(({date:t})=>t)),Z5={stats:Yd,statsDays:J5,useStats:b(Yd)},ue={atbs:"–ö–æ—Ä–∑–∏–Ω",atbsCost:"CPL",atbsConversion:"CR –≤ –∫–æ—Ä–∑.",avgPosition:"–°—Ä. –ø–æ–∑–∏—Ü–∏—è",clicks:"–ü–µ—Ä–µ—Ö–æ–¥—ã",cpc:"CPC",cpm:"CPM",cpo:"CPO",cr:"CRO",ctr:"CTR",orderCost:"CPO",orderConversion:"CR –≤ –∑–∞–∫–∞–∑",orders:"–ó–∞–∫–∞–∑—ã",placementType:"–ó–æ–Ω–∞",shks:"–¢–æ–≤–∞—Ä—ã",sum:"–ó–∞—Ç—Ä–∞—Ç—ã",sum_price:"–ó–∞–∫–∞–∑—ã",views:"–ü–æ–∫–∞–∑—ã",viewsPercent:"–ü–æ–∫–∞–∑—ã",date:"–î–∞—Ç–∞",drrRK:"–î–†–† –†–ö"};var oe=(e=>(e[e.all=0]="all",e[e.search=1]="search",e[e.catalog=2]="catalog",e[e.recommendation=3]="recommendation",e))(oe||{});function wm(e){switch(e){case oe.all:return"–≤—Å–µ";case oe.catalog:return"–∫–∞—Ç–∞–ª–æ–≥";case oe.recommendation:return"–ø–æ–ª–∫–∏";case oe.search:return"–ø–æ–∏—Å–∫";default:return e||""}}function X5(e,t){const s=[];let o=e.end,a=o;for(;a.isAfter(e.begin);)a=o.subtract(t-1,"day").startOf("day"),s.unshift({begin:a,end:o}),o=a.subtract(1,"day").endOf("day");return s[0]&&s[0].begin!==e.begin&&(s[0].begin=e.begin),s}const e4=["sum","views","clicks"];function t4(e){const t=e.placementTypes[oe.search],s=e.placementTypes[oe.catalog],o=e.placementTypes[oe.recommendation];if(!t&&!s&&!o)return null;const a={};return e4.forEach(r=>{const i=(t==null?void 0:t[r])||0,l=(s==null?void 0:s[r])||0,c=(o==null?void 0:o[r])||0;a[r]=i+l+c}),a}function Jd(e,t){const{atbs:s,sum:o,clicks:a,views:r,orders:i,shks:l,sum_price:c}=e,d=s&&o?ze(o/s,2):void 0,p=s&&a?ze(s/a*100,2):void 0,h=o&&a?ze(o/a,2):void 0,g=o&&r?ze(o*1e3/r,2):void 0,y=i&&a?ze(i/a*100,2):void 0,w=o&&i?ze(o/i,2):void 0,C=i&&s?ze(i/s*100,2):void 0,j=a&&r?ze(a/r*100,2):void 0,q=o&&l?ze(o/l,2):void 0,B=o&&c?ze(o/c*100,2):void 0,X=r&&(t!=null&&t.views)?Math.round(r/t.views*100):void 0;return{atbsCost:d,atbsConversion:p,cpc:h,cpm:g,ctr:j,cpo:q,cr:y,orderCost:w,orderConversion:C,viewsPercent:X,drrRK:B}}function Rx(e){const t={};return e.forEach(({placementType:s,data:o})=>{if(!o)return;const{days:a,boosterStats:r}=o;a.forEach(({date:i,...l})=>{const c=new Date(i),d=c.toJSON();let p=t[d];p||(p={date:c,placementTypes:{}},t[d]=p),p.placementTypes[s]={placementType:s,...l,...Jd(l,p.placementTypes[oe.all])}}),s===oe.all&&(r==null||r.forEach(({date:i,avg_position:l})=>{const c=new Date(i).toJSON(),d=t[c],p=d==null?void 0:d.placementTypes[s];p&&(p.avgPosition=l)}))}),Object.values(t).forEach(s=>{const o={...s.placementTypes[oe.all],...t4(s)};s.placementTypes[oe.all]={...o,...Jd(o)}}),t}function s4(e){return Rx(e)}function n4(e){return Rx(e)}const Ex={fromApi:s4,fromCmp:n4};function*o4({id:e,range:t}){const s=yield u(WC.getStats,{id:e,interval:{begin:t.begin.utc(!0).format("YYYY-MM-DD"),end:t.end.utc(!0).format("YYYY-MM-DD")}});return Ex.fromApi([{placementType:oe.all,data:s[0]}])}function*Ff(e,t=!0){try{const{content:s}=yield u(vC.getStats,e);return{placementType:e.placementType,data:s}}catch(s){if(t)throw s}return{placementType:e.placementType,data:void 0}}function*a4({id:e,range:t}){const s={id:e,interval:{begin:t.begin.utc(!0).toJSON(),end:t.end.utc(!0).toJSON()},appType:0},o=yield u(Ff,{...s,placementType:oe.all}),a=yield I([oe.search,oe.catalog,oe.recommendation].map(r=>u(Ff,{...s,placementType:r},!1)));return Ex.fromCmp([o,...a])}function*r4(e){try{return yield u(a4,e)}catch(t){if(t instanceof ru||t instanceof nr)try{return yield u(o4,e)}catch(s){throw s instanceof ds?t:s}throw t}}function*i4(e){const t=X5(e.range,_l.loadIntervalDaysChunk),s=yield I(t.map(i=>h0(r4,{id:e.id,range:i})));let o,a=!1;const r=s.reduce((i,l)=>(l instanceof Error?o=l:(Object.assign(i,l),a=!0),i),{});if(o&&!a)throw o;yield S(Lx.setStats(r))}const l4={load:i4},Il={config:_l,actions:Lx,selectors:Z5,sagas:l4},Is=k("feature/cmp-advert-stats"),Ne={modelName:Is(),loading:{load:Is("load"),loadDefault:Is("load-default"),loadAnalytics:Is("load-analytics"),loadDefaultAnalytics:Is("load-default-analytics")},view:{grid:Is("view/grid"),chart:Is("view/chart")},storageKey:`${W.appName}/${Is("storage-key")}`,loadIntervalDays:14,analytic:{clickShow:"clickShow"},rowHeight:{childInGroup:23,lastChildInGroup:30,default:30,firstChildInGroup:0},chartId:Is("chart").replace("/","_")},Df={},_x=_({name:Ne.modelName,initialState:Df,reducers:{setReportRange:D("reportRange"),reset:()=>Df}}),c4=E.inject(_x),Si=Q(Ne.modelName),Sn={..._x.actions,loadDefault:Si("load-default"),loadDefaultAnalytics:Si("load-default-analytics"),load:Si("load"),loadAnalytics:Si("load-analytics")},d4=k("entity/wb/analytics-report"),Sm={modelName:d4(),sellerServicePageUrl:`${W.wb.sellerServiceBaseUrl}/content-analytics/interactive-report/main`},Af={},Ix=_({name:Sm.modelName,initialState:Af,reducers:{setList:D("list"),resetList:e=>{e.list=void 0},reset:()=>Af}}),u4=E.inject(Ix),Ox={...Ix.actions},m4=V(Sm.modelName,u4),Zd=m4("list"),p4=$(Zd,e=>{const t=new Map;return e&&e.forEach(s=>{t.set(s.date.valueOf(),s)}),t}),h4={list:Zd,dayMap:p4,useList:b(Zd)},fs={openCardCount:"–ü–µ—Ä–µ—Ö–æ–¥—ã",addToCartCount:"–ö–æ—Ä–∑–∏–Ω",orderCount:"–ó–∞–∫–∞–∑–æ–≤",orderSum:"–í –∑–∞–∫–∞–∑–∞—Ö",openToCartConversion:"–ö–æ–Ω–≤. –≤ –∫–æ—Ä–∑–∏–Ω—É",cartToOrderConversion:"–ö–æ–Ω–≤. –≤ –∑–∞–∫–∞–∑"};function f4(e){var o,a,r;const t=(a=(o=e.data.additional)==null?void 0:o.find(({field:i})=>i.includes("period.begin")))==null?void 0:a.description,s=(r=t==null?void 0:t.match(/no earlier than (\d{4}-\d{2}-\d{2})/))==null?void 0:r[1];if(!s)throw e;return s}function g4(e){return{date:new Date(e.date),orderCount:e.orderCount,orderSum:e.orderSum,addToCartCount:e.addToCartCount,cartToOrderConversion:e.cartToOrderConversion,openToCartConversion:e.openToCartConversion,openCardCount:e.openCardCount,buyoutPercent:e.buyoutPercent}}function y4(e){return{date:new Date(e.dt),orderCount:e.ordersCount,orderSum:e.ordersSumRub,addToCartCount:e.addToCartCount,cartToOrderConversion:e.cartToOrderConversion,openToCartConversion:e.addToCartConversion,openCardCount:e.openCardCount,buyoutPercent:e.buyoutPercent}}const w4={fromNotApi:g4,fromApi:y4};function*Lf({nm:e,range:t}){var o;const{data:s}=yield u(S$.detail,{period:{begin:R(t.begin).utc(!0).format("YYYY-MM-DD"),end:R(t.end).utc(!0).format("YYYY-MM-DD")},nmIDs:[e]});yield S(Ox.setList((((o=s[0])==null?void 0:o.history)||[]).map(w4.fromApi)))}function*S4(e){try{yield u(Lf,e)}catch(t){if(t instanceof ra&&t.data.message){const s=f4(t);yield u(Lf,{...e,range:{...e.range,begin:R(s)}});return}throw t}}function*x4(e){yield u(S4,e)}const b4={load:x4},xm={config:Sm,actions:Ox,selectors:h4,sagas:b4};function*Vx({card:e,range:t},s){yield S(Sn.setReportRange(t)),yield I([u(Il.sagas.load,{id:e.id,range:t}),S(s?Sn.loadDefaultAnalytics({card:e,range:t}):Sn.loadAnalytics({card:e,range:t}))])}function*v4({card:e}){const t=R.utc();let s=t.subtract(Ne.loadIntervalDays,"day");const o=t.clone();e.createTime&&(s=R.utc(Math.max(s.valueOf(),e.createTime.valueOf())));const a={begin:R(s).startOf("day"),end:R(o).endOf("hour")};yield u(Vx,{card:e,range:a},!0)}function*Rf({card:e,range:t}){const s=e.products[0].nm;yield u(xm.sagas.load,{nm:s,range:t})}function*j4(){yield I([N(Sn.loadDefault,T(v4,[M,vt([Ne.view.grid,Ne.view.chart]),O(Ne.loading.loadDefault),L(Ne.loading.loadDefault)])),N(Sn.loadAnalytics,T(Rf,[M,O(Ne.loading.loadAnalytics),L(Ne.loading.loadAnalytics)])),N(Sn.loadDefaultAnalytics,T(Rf,[M,O(Ne.loading.loadAnalytics),L(Ne.loading.loadDefaultAnalytics)])),N(Sn.load,T(Vx,[M,O(Ne.loading.load),L(Ne.loading.load)]))])}K(Ne.modelName,j4);const C4={},oa={drrP:"–î–†–†–ø",drrZ:"–î–†–†–∑",cps:"CPS"},At={byDays:"–ü–æ –¥–Ω—è–º",byPeriod:"–ó–∞ –ø–µ—Ä–∏–æ–¥",byCharts:"–ì—Ä–∞—Ñ–∏–∫–∏"},$4="_5uAsRhu",k4="CpbYNgN",N4="_3r-yIiI",Ef={wrapper:$4,container:k4,chart:N4},T4=Rn(),P4={id:"shared",type:"linear",position:"left",beginAtZero:!0,display:!0},M4={pointRadius:0,pointHoverRadius:0,id:"value",fill:"start",tension:.4,borderJoinStyle:"round",scale:P4,maxBarThickness:2,...T4()},_f={views:["numeric.0"],clicks:["numeric.0"],ctr:["percent.2"],cpc:["currency.2"],cpm:["currency.0"],sum:["currency.0"],atbs:["numeric.0"],atbsCost:["numeric.0"],orders:["numeric.0"],orderCost:["numeric.0"],cr:["percent.2"],shks:["numeric.0"],sum_price:["currency.0"],avgPosition:["numeric.0"],drrRK:["percent.2"],openCardCount:["numeric.0"],addToCartCount:["numeric.0"],orderCount:["numeric.0"],openToCartConversion:["percent.2"],cartToOrderConversion:["percent.2"],orderSum:["currency.0"],drrZ:["percent.2"],drrP:["percent.2"],cps:["currency.2"],cpo:["numeric.0"]},F4=({node:e,colDef:t})=>{var i;const s=bm.useChartData(),o=((i=e==null?void 0:e.data)==null?void 0:i.placementType)??0,a=Ae.useMemo(()=>!(t!=null&&t.field)||!((t==null?void 0:t.field)in _f)?[]:[{...M4,type:_f[t==null?void 0:t.field],id:`placementTypes[${o}].${t==null?void 0:t.field}`}],[o]),r=Ae.useCallback(()=>{const l=document.getElementById(Ne.chartId);l==null||l.scrollIntoView({behavior:"smooth"})},[o,t==null?void 0:t.field]);return n.jsx("div",{onClick:r,className:Ef.container,children:n.jsx(En,{lineData:s,isCompact:!0,labelField:"date",lineDefs:a,type:"bar",classNames:Ef,showTooltip:!1,sidebar:!1,showAxios:!1})})},ot=({colDef:e,node:t})=>{if((t==null?void 0:t.key)===At.byCharts)return{component:F4};if((t==null?void 0:t.key)===At.byDays)return{component:()=>e==null?void 0:e.headerName}},D4="qMgHbei",A4={conversation:D4};function L4({conversionValueGetter:e,...t}){return n.jsxs(n.Fragment,{children:[n.jsx("span",{children:v.numeric(t.value,{fraction:0})}),"¬†",n.jsx("sup",{className:A4.conversation,children:v.percent(e(t),{fraction:0})})]})}const xi=e=>t=>{const s=ot(t);return s||{component:L4,params:{conversionValueGetter:o=>{var r;const a=o.data||((r=o.node.allLeafChildren)==null?void 0:r[0].data);return e(a)}}}};function Ii(e,t){const{sum:s,analytics:o}=e;if(!o)return{};const{orderSum:a,orderCount:r}=o,i=s&&a&&a>0?ze(s/a*100,2):void 0,l=s&&r&&r>0&&t?ze(s/(r*t)*100,2):void 0,c=s&&a&&t?ze(s/(a*(t/100))*100,2):void 0;return{drrZ:i,drrP:c,cps:l}}function qx(e){if(!e||e.size===0)return;const s=R().startOf("day").subtract(3,"day"),o=[];if(e.forEach(a=>{R(a.date).isBefore(s)&&a.buyoutPercent&&o.push(a.buyoutPercent)}),o.length!==0)return o.reduce((a,r)=>a+r,0)/o.length}const If=e=>{var a,r,i;const{column:t,node:s}=e,o=t.getColDef();if((s==null?void 0:s.key)===At.byDays&&o.headerName!==ue.date)return o.headerName;if(o.headerName===ue.date&&((a=s==null?void 0:s.data)!=null&&a.placementType)){const l=wm((r=s==null?void 0:s.data)==null?void 0:r.placementType),c=v.percent(((i=s==null?void 0:s.data)==null?void 0:i.viewsPercent)||0,{fraction:0,zero:!0});return` --- ${l} | ${c}`}return Cn(e)},Of=new WeakMap,Be=e=>{const s=e.column.getColDef().field,{childrenAfterGroup:o}=e.rowNode;if(!o)return;let a=Of.get(o);return a||(a=o.find(({data:r})=>(r==null?void 0:r.placementType)===oe.all),Of.set(o,a)),ll(a==null?void 0:a.data,s,0)},Vf=e=>{var s,o;const t=(s=e.node.data)==null?void 0:s.dateFormatted;return!e.node.group&&e.node.childIndex===0&&((o=e.node.data)==null?void 0:o.placementType)===oe.all||t===At.byDays||t===At.byCharts},qf=[oe.all,oe.search,oe.catalog,oe.recommendation],R4=["views","clicks","ctr","cpc","sum","atbs","orders","cr","shks","sum_price"],E4=["addToCartCount","openCardCount","orderCount","orderSum","cartToOrderConversion","openToCartConversion"],_4=["cartToOrderConversion","openToCartConversion"];function I4({range:e,stats:t,analytics:s}){if(!e||!t)return;const o=qx(s),a=[],r=new Map,i=Object.keys(t).sort((l,c)=>R(c).valueOf()-R(l).valueOf()).filter(l=>R(l).isBetween(e.begin,e.end,"day","[]"));return i.forEach((l,c)=>{const{date:d,placementTypes:p}=t[l];qf.forEach((h,g)=>{const y=p[h];if(!y&&h!==oe.all)return;let w=r.get(h);w||(w={index:10+g,date:new Date(0),dateFormatted:At.byPeriod,analytics:{},placementType:h},r.set(h,w));const C={index:(c+2)*100+g,date:d,dateFormatted:v.date(d),analytics:h===oe.all?s==null?void 0:s.get(d.valueOf()):void 0,...y||{},placementType:h};C.analytics&&(C.analytics={...C.analytics,...Ii(C,o)}),Object.keys(C).filter(j=>R4.includes(j)).forEach(j=>{w&&(w[j]||(w[j]=0),w[j]+=C[j]||0)}),h===oe.all&&(C.analytics||(w.analytics=void 0),Object.keys(C.analytics||{}).filter(j=>E4.includes(j)).forEach(j=>{var q;w.analytics&&(w.analytics[j]||(w.analytics[j]=0),w.analytics[j]+=((q=C.analytics)==null?void 0:q[j])||0)}),w.analytics&&(w.analytics={...w.analytics,...Ii(w,o)})),a.push(C)})}),a.length>0&&a.unshift({index:100,date:new Date(1),dateFormatted:At.byDays,analytics:{}}),[...qf].reverse().forEach(l=>{const c=r.get(l);if(!c)return;const d={...c,...Jd(c,r.get(oe.all))};d.analytics&&(_4.forEach(p=>{var h;(h=d.analytics)!=null&&h[p]&&(d.analytics[p]=ze(d.analytics[p]/i.length,2))}),d.analytics={...d.analytics,...Ii(d,o)}),a.unshift(d)}),a.length>0&&a.unshift({index:0,date:new Date(1),dateFormatted:At.byCharts,analytics:{}}),a}function O4({range:e,stats:t,analytics:s}){if(!t||!e)return;const o=qx(s),a=[];return Object.values(t).forEach(({date:r,placementTypes:i})=>{if(!R(r).isBetween(e.begin,e.end,"day","[]"))return;const l=s==null?void 0:s.get(r.valueOf()),c={...i[oe.all]},d=l?{analytics:{...l,...Ii({...c,analytics:l},o)}}:{};a.push({date:r,placementTypes:{...i,[oe.all]:{...c,...d}}})}),a.sort((r,i)=>r.date.valueOf()-i.date.valueOf())}const V4=V(Ne.modelName,c4),el=V4("reportRange"),q4=$([el,Il.selectors.stats,xm.selectors.dayMap],(e,t,s)=>I4({stats:t,analytics:s,range:e})),B4=$([el,Il.selectors.stats,xm.selectors.dayMap],(e,t,s)=>O4({range:e,stats:t,analytics:s})),bm={reportRange:el,useReportRange:b(el),useGridData:b(q4),useChartData:b(B4)},W4="C97Z82R",z4="Xhh6e0E",G4="Xm4-LLH",K4="x91JwmK",H4="iKWWm2q",U4="UOT2iT5",Q4="QVBCSWN",Y4="L79Xm48",J4="hZBzTzk",ke={firstCellHeader:W4,firstCell:z4,groupRow:G4,total:K4,groupSubRow:H4,divider:U4,lastInGroup:Q4,groupHeader:Y4,rightAlign:J4},Z4="_4P3nUks",X4={button:Z4};function eV({api:e}){const[t,s]=m.useState(!0),o=()=>{e.forEachNode(a=>{a.group&&a.key!==At.byDays&&a.key!==At.byCharts&&a.setExpanded(!t)}),s(!t)};return n.jsxs(Nu,{onClick:o,className:X4.button,children:[n.jsx(z.Chevron,{rotate:t?-90:0}),t?"–°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ":"–†–∞–∑–≤–µ—Ä–Ω. –≤—Å–µ"]})}const tV="jAoRWzP",sV="GMekvSD",Lc={label:tV,percent:sV};function nV({data:e}){return n.jsxs(f,{type:"horizontal",align:"flex-end",className:Lc.percentCell,children:[n.jsxs("span",{className:Lc.label,children:[wm(e==null?void 0:e.placementType)," |"]}),n.jsx("span",{className:Lc.percent,children:v.percent((e==null?void 0:e.viewsPercent)||0,{fraction:0,zero:!0})})]})}const oV="cT8zObl",aV="anEYZ2J",re={analytics:oV,analyticsHeader:aV};function rV(){return m.useMemo(()=>[{headerGroupComponent:eV,children:[{headerName:ue.date,showRowGroup:"dateFormatted",cellRendererSelector:({node:t,data:s,value:o})=>t.group&&t.key!==At.byDays&&t.key!==At.byCharts?{component:"agGroupCellRenderer",params:{suppressCount:!0}}:s!=null&&s.placementType?{component:nV}:{component:()=>o},cellClass:[ke.firstCell],headerClass:[ke.firstCellHeader],width:125,pinned:!0}]},{field:"index",sort:"asc",sortable:!0,hide:!0,suppressColumnsToolPanel:!0},{field:"dateFormatted",rowGroup:!0,hide:!0,suppressColumnsToolPanel:!0},{headerName:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –†–ö",headerClass:ke.groupHeader,children:[{field:"views",type:["numeric","rightAligned"],headerName:ue.views,aggFunc:Be,width:80,cellRendererSelector:ot},{field:"cpm",type:["currency.0","rightAligned"],headerName:ue.cpm,aggFunc:Be,width:60,cellRendererSelector:ot},{field:"clicks",type:["numeric","rightAligned"],headerName:ue.clicks,aggFunc:Be,width:70,cellRendererSelector:ot},{field:"ctr",type:["percent.2","rightAligned"],headerName:ue.ctr,headerTooltip:"–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∫–ª–∏–∫–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∫–∞–∑–æ–≤",aggFunc:Be,width:67,cellRendererSelector:ot},{field:"cpc",type:["currency.1","rightAligned"],headerName:ue.cpc,headerTooltip:"–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–∫–∞",aggFunc:Be,width:67,cellRendererSelector:ot},{field:"sum",type:["currency.0","rightAligned"],headerName:ue.sum,aggFunc:Be,width:85,cellRendererSelector:ot}]},{headerName:"–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –†–ö (—Ç–æ–≤–∞—Ä + –∞—Å—Å–æ—Ü.–∫–æ–Ω–≤–µ—Ä)",headerClass:ke.groupHeader,children:[{field:"atbs",type:["numeric","rightAligned"],headerName:ue.atbs,headerTooltip:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É (–≤–º–µ—Å—Ç–µ —Å –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏)",cellRendererSelector:xi(t=>t==null?void 0:t.atbsConversion),aggFunc:Be,width:86},{field:"atbsCost",type:["currency.0","rightAligned"],headerName:ue.atbsCost,headerTooltip:"–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É (–≤–º–µ—Å—Ç–µ —Å –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏)",aggFunc:Be,width:55,cellRendererSelector:ot},{field:"orders",type:["numeric","rightAligned"],headerName:ue.orders,headerTooltip:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ (–≤–º–µ—Å—Ç–µ —Å –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏)",cellRendererSelector:xi(t=>t==null?void 0:t.orderConversion),aggFunc:Be,width:80},{field:"orderCost",type:["currency.0","rightAligned"],headerName:ue.orderCost,headerTooltip:"–°—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞",aggFunc:Be,width:60,cellRendererSelector:ot},{field:"sum_price",type:["currency.0","rightAligned"],headerName:ue.sum_price,headerTooltip:"–ó–∞–∫–∞–∑–æ–≤ –æ—Ç –†–ö –Ω–∞ —Å—É–º–º—É (–≤–º–µ—Å—Ç–µ —Å –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏)",aggFunc:Be,width:93,cellRendererSelector:ot},{field:"cr",type:["percent.2","rightAligned"],headerName:ue.cr,headerTooltip:"CRO (conversion rate order) ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤",aggFunc:Be,width:67,cellRendererSelector:ot},{field:"shks",type:["numeric","rightAligned"],headerName:ue.shks,headerTooltip:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (–≤–º–µ—Å—Ç–µ —Å –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏)",aggFunc:Be,hide:!0,width:95,cellRendererSelector:ot},{field:"drrRK",type:["percent","rightAligned"],headerName:ue.drrRK,headerTooltip:"–î–æ–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤ –≤—ã—Ä—É—á–∫–µ —Å –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –†–ï–ö–õ–ê–ú–´ (–≤–º–µ—Å—Ç–µ —Å –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏)",aggFunc:Be,width:70,cellRendererSelector:ot}]},{headerName:"–í—Å–µ–≥–æ –ø–æ —Ç–æ–≤–∞—Ä—É (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",headerClass:[re.analyticsHeader,ke.groupHeader,ke.rightAlign],toolPanelClass:re.analyticsHeader,children:[{field:"analytics.openCardCount",headerName:fs.openCardCount,headerTooltip:"–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –±—ã–ª–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤ –∫–∞—Ä—Ç–æ—á–∫—É (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",type:["numeric.0","rightAligned"],aggFunc:Be,headerClass:[re.analyticsHeader,ke.rightAlign],cellClass:[re.analytics,ke.rightAlign],toolPanelClass:re.analytics,width:85,cellRendererSelector:ot},{field:"analytics.addToCartCount",headerName:fs.addToCartCount,aggFunc:Be,type:["numeric","rightAligned"],headerClass:[re.analyticsHeader,ke.rightAlign],headerTooltip:"–ö–æ—Ä–∑–∏–Ω —Ç–æ–≤–∞—Ä–∞ –≤—Å–µ–≥–æ (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",cellClass:[re.analytics,ke.rightAlign],toolPanelClass:re.analytics,width:85,cellRendererSelector:xi(t=>{var s;return(s=t==null?void 0:t.analytics)==null?void 0:s.openToCartConversion})},{field:"analytics.orderCount",headerName:fs.orderCount,aggFunc:Be,type:["numeric","rightAligned"],headerClass:[re.analyticsHeader,ke.rightAlign],headerTooltip:"–ó–∞–∫–∞–∑–æ–≤ —Ç–æ–≤–∞—Ä–∞ –≤—Å–µ–≥–æ (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",cellClass:[re.analytics,ke.rightAlign],toolPanelClass:re.analytics,width:80,cellRendererSelector:xi(t=>{var s;return(s=t==null?void 0:t.analytics)==null?void 0:s.cartToOrderConversion})},{field:"analytics.orderSum",headerName:fs.orderSum,type:["currency.0","rightAligned"],aggFunc:Be,headerClass:[re.analyticsHeader,ke.rightAlign],headerTooltip:"–í—ã—Ä—É—á–∫–∞ (–∑–∞–∫–∞–∑—ã) –ø–æ —Ç–æ–≤–∞—Ä—É –≤—Å–µ–≥–æ (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",cellClass:[re.analytics,ke.rightAlign],toolPanelClass:re.analytics,width:90,cellRendererSelector:ot},{field:"analytics.drrZ",headerName:oa.drrZ,type:["percent","rightAligned"],aggFunc:Be,headerClass:[re.analyticsHeader,ke.rightAlign],headerTooltip:"–î–æ–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤ –≤—ã—Ä—É—á–∫–µ —Å–æ –≤—Å–µ—Ö –ó–ê–ö–ê–ó–û–í –ø–æ —Ç–æ–≤–∞—Ä—É (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",cellClass:[re.analytics,ke.rightAlign],toolPanelClass:re.analytics,width:67,cellRendererSelector:ot},{field:"analytics.drrP",headerName:oa.drrP,type:["percent","rightAligned"],aggFunc:Be,headerClass:[re.analyticsHeader,ke.rightAlign],headerTooltip:"–î–æ–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤ –≤—ã—Ä—É—á–∫–µ —Å–æ –≤—Å–µ—Ö –ü–†–û–î–ê–ñ –ø–æ —Ç–æ–≤–∞—Ä—É (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",cellClass:[re.analytics,ke.rightAlign],toolPanelClass:re.analytics,width:67,cellRendererSelector:ot},{field:"analytics.cps",headerName:oa.cps,type:["currency.0","rightAligned"],aggFunc:Be,headerClass:[re.analyticsHeader,ke.rightAlign],headerTooltip:"COST PER SALE - –†–∞—Å—Ö–æ–¥ –Ω–∞ —Ä–µ–∫–ª–∞–º—É –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ 1 –ü–†–û–î–ê–ñ–ò —Ç–æ–≤–∞—Ä–∞ (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)",cellClass:[re.analytics,ke.rightAlign],toolPanelClass:re.analytics,width:60,cellRendererSelector:ot}]}],[])}const iV="-Cf4-RW",Bx={custom:iV};function lV({gridRef:e,data:t,style:s,campaignId:o}){const a=he(Ne.view.grid),r=rV(),i=m.useMemo(()=>({sortable:!1}),[]),l=m.useMemo(()=>{const p=C=>C.node.key===At.byDays,h=()=>!0,g=C=>{var j,q;return!((q=(j=C.node)==null?void 0:j.groupData)!=null&&q[1])},y=C=>C.node.key===At.byPeriod,w=C=>!C.node.group&&C.node.lastChild;return{[ke.divider]:p,[ke.groupRow]:h,[ke.groupSubRow]:g,[ke.total]:y,[ke.lastInGroup]:w}},[]),c=m.useCallback(p=>p.node.group?Ne.rowHeight.default:Vf(p)?Ne.rowHeight.firstChildInGroup:p.node.lastChild?Ne.rowHeight.lastChildInGroup:Ne.rowHeight.childInGroup,[]),d=m.useMemo(()=>({fileName:`${o}_${Ne.modelName}`,processCellCallback:If,shouldRowBeSkipped:p=>Vf(p)}),[o]);return n.jsx(Ce,{className:Bx.custom,style:s,gridRef:e,rowData:t,defaultColDef:i,columnDefs:r,columnsState:a.state,onColumnsStateChanged:a.save,groupDisplayType:"custom",suppressAggFuncInHeader:!0,groupDefaultExpanded:-1,rowClassRules:l,isCompact:!0,getRowHeight:c,defaultExcelExportParams:d,animateRows:!1,processCellForClipboard:If})}const Me=Rn(),ft=(e,t)=>`placementTypes[${e}].${t}`,Os=(e,t)=>`placementTypes[${e}].analytics.${t}`,Fe={type:"linear",position:"right",beginAtZero:!0,display:!1},vm=[oe.all,oe.search,oe.catalog,oe.recommendation].map(e=>({label:`–ó–æ–Ω–∞: ${wm(e)}`,children:[{field:ft(e,"views"),label:ue.views,type:["numeric.0"],scale:Fe,hide:!0,...Me()},{field:ft(e,"clicks"),label:ue.clicks,type:["numeric.0"],scale:Fe,hide:!0,...Me()},{field:ft(e,"ctr"),label:ue.ctr,type:["percent.2"],scale:Fe,hide:!0,...Me(),tooltip:"–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∫–ª–∏–∫–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∫–∞–∑–æ–≤"},{field:ft(e,"cpc"),label:ue.cpc,type:["currency.2"],scale:Fe,hide:!0,...Me(),tooltip:"–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–∫–∞"},{field:ft(e,"cpm"),label:ue.cpm,type:["currency.0"],scale:Fe,hide:!0,...Me()},{field:ft(e,"sum"),label:ue.sum,type:["currency.0"],scale:Fe,hide:!0,...Me()},{field:ft(e,"atbs"),label:ue.atbs,type:["numeric.0"],scale:Fe,hide:!0,...Me(),tooltip:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É"},{field:ft(e,"atbsCost"),label:ue.atbsCost,type:["numeric.0"],scale:Fe,hide:!0,...Me(),tooltip:"–¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ –∫–æ—Ä–∑–∏–Ω—É"},{field:ft(e,"orders"),label:ue.orders,type:["numeric.0"],scale:Fe,hide:!0,...Me(),tooltip:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤"},{field:ft(e,"orderCost"),label:ue.orderCost,type:["numeric.0"],scale:Fe,hide:!0,...Me(),tooltip:"–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞"},{field:ft(e,"cr"),label:ue.cr,type:["percent.2"],scale:Fe,hide:!0,...Me(),tooltip:"CRO (conversion rate order) ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤"},{field:ft(e,"shks"),label:ue.shks,type:["numeric.0"],scale:Fe,hide:!0,...Me(),tooltip:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤"},{field:ft(e,"sum_price"),label:ue.sum_price,type:["currency.0"],scale:Fe,hide:!0,...Me(),tooltip:"–ó–∞–∫–∞–∑–æ–≤ –Ω–∞ —Å—É–º–º—É"},{field:ft(e,"avgPosition"),label:ue.avgPosition,type:["numeric.0"],scale:Fe,hide:!0,...Me()},{field:ft(e,"drrRK"),label:ue.drrRK,type:["percent.2"],scale:Fe,hide:!0,...Me()}]})),Vs=oe.all;vm.push({label:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞",toolPanelClass:re.analytics,children:[{field:Os(Vs,"openCardCount"),label:fs.openCardCount,type:["numeric.0"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"addToCartCount"),label:fs.addToCartCount,type:["numeric.0"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"orderCount"),label:fs.orderCount,type:["numeric.0"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"openToCartConversion"),label:fs.openToCartConversion,type:["percent.2"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"cartToOrderConversion"),label:fs.cartToOrderConversion,type:["percent.2"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"orderSum"),label:fs.orderSum,type:["currency.0"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"drrZ"),label:oa.drrZ,type:["percent.2"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"drrP"),label:oa.drrP,type:["percent.2"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()},{field:Os(Vs,"cps"),label:oa.cps,type:["currency.2"],scale:Fe,toolPanelClass:re.analytics,hide:!0,...Me()}]});var Zg;for(let e=0;e<3;e++){const t=(Zg=vm[oe.all].children)==null?void 0:Zg[e];t&&"hide"in t&&(t.hide=!1)}function cV({data:e,style:t}){const s=he(Ne.view.chart);return n.jsx(En,{sidebar:"open",lineData:e,lineDefs:vm,linesState:s.state,labelField:"date",labelFormatter:v.dateShort,onLinesStateChanged:s.save,style:t,className:Bx.custom,withDataLabels:!0,id:Ne.chartId,isCompact:!0})}const it={actions:Sn,config:Ne,sagas:C4,selectors:bm};function dV(){const e=bm.useChartData();return G.selectors.useSomeLoader([Fs.config.loading.load,it.config.loading.loadDefault,it.config.loading.loadDefaultAnalytics,it.config.view.chart])||!e?null:n.jsx(cV,{data:e,style:{height:300}})}function uV({gridRef:e}){const{load:t}=x(it.actions),s=G.selectors.useSomeLoader([it.config.loading.load,it.config.loading.loadAnalytics,it.config.loading.loadDefault,it.config.loading.loadDefaultAnalytics]),o=pe.selectors.useCard(),a=it.selectors.useReportRange(),r=m.useCallback(i=>{o&&t({card:o,range:i})},[o]);return n.jsxs(f,{type:"horizontal",align:"center",children:[n.jsx(Fx,{isLoading:s,onSubmit:r,value:a}),n.jsx(xa,{gridRef:e,disabled:s})]})}function mV({gridRef:e,campaignId:t}){const{setShowModal:s}=x(cr.actions),o=it.selectors.useGridData(),a=G.selectors.useSomeLoader([Fs.config.loading.load,it.config.loading.loadDefault,it.config.loading.loadDefaultAnalytics,it.config.view.grid]),r=Z.selectors.useSomeError([it.config.loading.load,it.config.loading.loadDefault]),i=Z.selectors.useError(it.config.loading.loadAnalytics),l=m.useMemo(()=>i?i.error instanceof lu||i.error instanceof ds?n.jsx(dt,{type:"warning",title:"–í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂",message:n.jsxs("div",{children:["–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–µ–∫—Ü–∏–∏"," ",n.jsx("strong",{children:"¬´–í—Å–µ–≥–æ –ø–æ —Ç–æ–≤–∞—Ä—É (—Ä–µ–∫–ª–∞–º–∞ + –æ—Ä–≥–∞–Ω–∏–∫–∞)¬ª"}),"–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ"," ",n.jsx(A,{onClick:()=>s(!0),size:"middle",type:"link",children:"–¥–æ–±–∞–≤–∏—Ç—å API –∫–ª—é—á"})]})}):n.jsx(ee,{value:i}):null,[i]);return a?n.jsx(le,{}):r?n.jsx(ee,{value:r}):o?n.jsxs(n.Fragment,{children:[l,n.jsx(lV,{gridRef:e,data:o,style:{height:730},campaignId:t})]}):null}function pV(){const e=m.useRef(null),{reset:t}=x(Il.actions),{loadDefault:s}=x(it.actions),o=pe.selectors.useCard();return m.useEffect(()=>(o&&s({card:o}),()=>{t()}),[o]),n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(uV,{gridRef:e}),n.jsx(mV,{gridRef:e,campaignId:o==null?void 0:o.id}),n.jsx(dV,{})]})}const hV="/assets/Bt9wdfL1.png",fV=chrome.runtime.getURL(hV);function gV({children:e,id:t}){return n.jsx(Dx,{id:t,backgroundImg:fV,buttonContent:"–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –¥–Ω—è–º",children:e})}const bi=k("feature/cmp-search-query-stats"),xn={modelName:bi(),loading:{load:bi("load"),search:bi("search")},view:{grid:bi("view/grid")}},yV=Q(xn.modelName),Wx={loadQueries:yV("load-queries")},Bf=k("entity/wb/search-query"),Yr={modelName:Bf(),storageKey:`${W.appName}/${Bf("storage-key")}`,oldStorageKey:`${W.appName}/${k("entity/wb/search-token")("storage-key")}`},Wf={},zx=_({name:Yr.modelName,initialState:Wf,reducers:{setQueries:D("queries"),reset:()=>Wf}}),wV=E.inject(zx),jm={...zx.actions},SV=V(Yr.modelName,wV),Gx=SV("queries"),xV=$([Gx,(e,t)=>t],(e,t)=>t?e==null?void 0:e[t]:void 0),bV={queries:Gx,queriesById:xV},tl=Ue(Yr.storageKey,{type:Qe.Local}),zf=Ue(Yr.oldStorageKey,{type:Qe.Local});function*vV(){const e=yield u(zf.get);e!=null&&e.advert&&(yield u(tl.set,e.advert),yield u(zf.remove))}function*jV(){yield u(vV);const e=yield u(tl.get);yield S(jm.setQueries(e))}function*CV({id:e,list:t}){let s=yield u(tl.get);s||(s={}),s[e]=oy(t),s[e].length===0&&delete s[e],yield u(tl.set,s),yield S(jm.setQueries(s))}const $V={load:jV,save:CV},ua={config:Yr,actions:jm,selectors:bV,sagas:$V};function*kV(){yield u(ua.sagas.load)}function*NV(){yield I([N(Wx.loadQueries,T(kV,[M,vt([xn.view.grid]),O(xn.loading.load),L(xn.loading.load)]))])}K(xn.modelName,NV);const TV={};function PV(e,t){return e.map(s=>{var a,r;const o=(r=(a=t==null?void 0:t[s])==null?void 0:a.cluster)==null?void 0:r.freq_syn.monthly;return{query:s,freq:o}})}const Gf=$([ua.selectors.queriesById,Rt.selectors.list],(e,t)=>e?PV(e,t):wa.array),MV={data:Gf,useData:te(Gf)},FV="y4wiZsK",DV="wIopqL5",Kx={link:FV,keyword:DV};function AV({value:e}){const t=Co(W.outRoute.marketPlaceSearch,{search:e}),s=`${W.wb.marketPlaceBaseUrl}${t}`;return n.jsx(jt,{suffix:n.jsx("a",{href:s,target:"_blank",rel:"noreferrer",className:Kx.link,children:n.jsx(z.Link,{})}),children:n.jsx("span",{children:e})})}const Kf={..._E,query:"–ó–∞–ø—Ä–æ—Å"},LV=[{field:"query",filter:"agTextColumnFilter",cellRenderer:AV,headerName:Kf.query,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,suppressMovable:!0,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,checkboxSelection:!0,width:400,cellClass:Kx.keyword,pinned:!0},{field:"freq",type:["numeric","rightAligned"],filter:"agNumberColumnFilter",headerName:Kf.freq,width:100}];function RV({gridRef:e,data:t,style:s,onSelected:o,extendedColumnDefs:a=[],maxRowsOnScreen:r,campaignId:i,exportProcessCellCallback:l}){const c=he(xn.view.grid),d=m.useMemo(()=>[...LV,...a],[a]),p=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),h=m.useCallback(w=>{o&&o(w.api.getSelectedRows())},[o]),g=m.useCallback(w=>{c.save(w.filter(C=>!C.colId.startsWith("positionLog-")))},[]),y=m.useMemo(()=>({fileName:`${i}_${xn.modelName}`,columnKeys:d.map(w=>w.colId||w.field),processCellCallback:w=>{if(l){const C=l(w);if(C)return C}return Cn(w)}}),[i]);return n.jsx(Ce,{isCompact:!0,gridRef:e,style:s,rowData:t,columnDefs:d,defaultColDef:p,columnsState:c.state,onColumnsStateChanged:g,rowSelection:"multiple",suppressRowClickSelection:!0,onSelectionChanged:h,maxRowsOnScreen:r,defaultExcelExportParams:y,processCellForClipboard:y.processCellCallback,rowHeight:38,rowClass:Jy.cellVerticalAlignMiddle})}const Uo={actions:Wx,config:xn,sagas:TV,selectors:MV},Rc=k("feature/cmp-search-query-add-form"),vs={modelName:Rc(),loading:{load:Rc("load")},analytics:{save:Rc("save")}},Hf=Q(vs.modelName),Uf={},Hx=_({name:vs.modelName,initialState:Uf,reducers:{setSelected:D("selected"),setShowModal:D("showModal"),reset:()=>Uf}}),EV=E.inject(Hx),vr={...Hx.actions,save:Hf("save"),remove:Hf("remove")};function*_V({list:e,id:t}){const s=yield F(ua.selectors.queriesById,t);yield u(ua.sagas.save,{id:t,list:s?[...s,...e]:e})}function*IV({id:e,list:t}){const s=yield F(ua.selectors.queriesById,e),o=s==null?void 0:s.filter(a=>!t.includes(a));yield u(ua.sagas.save,{id:e,list:o||[]})}function*OV(){yield I([N(vr.save,T(_V,[M,et(vs.loading.load),L(vs.loading.load)])),N(vr.remove,T(IV,[M,et(vs.loading.load),L(vs.loading.load)]))])}K(vs.modelName,OV);const VV={},Ux=V(vs.modelName,EV),qV=Ux("showModal"),Qx=Ux("selected"),BV=$(Qx,e=>!e||e.length===0),Yx={useShowModal:b(qV),useSelected:b(Qx),useSelectedIsEmpty:b(BV)};function WV({id:e,onSaveClick:t}){const[s,o]=m.useState(),{save:a}=x(vr),r=m.useMemo(()=>s?s.split(/[\r\n]+/gi).map(l=>l.trim()).filter(l=>l.length>0):[],[s]),i=()=>{a({id:e,list:r}),Te.click(vs.analytics.save),s&&t()};return n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx("div",{children:n.jsx(xe.Textarea,{value:s,onChange:l=>o(l.target.value)})}),n.jsx(A,{onClick:i,disabled:r.length===0,type:"purple",children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})]})}function zV({id:e}){const t=Yx.useShowModal(),{setShowModal:s}=x(vr);return n.jsx(Ye,{open:t,onCloseClick:()=>s(!1),title:"–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –≤ —Å–ø–∏—Å–æ–∫",children:n.jsx(WV,{id:e,onSaveClick:()=>s(!1)})})}const Xd={actions:vr,config:vs,sagas:VV,selectors:Yx};function Qf({gridRef:e}){const{setShowModal:t,remove:s}=x(Xd.actions),o=pe.selectors.useCard(),a=Xd.selectors.useSelectedIsEmpty();if(!o)return null;const r=()=>{var l;const i=(l=e==null?void 0:e.current)==null?void 0:l.api.getSelectedRows();i&&s({id:o==null?void 0:o.id,list:i==null?void 0:i.map(({query:c})=>c)})};return n.jsxs(n.Fragment,{children:[n.jsxs(f,{children:[n.jsx(xa,{gridRef:e}),n.jsx(A,{onClick:()=>t(!0),type:"grey",children:"–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã"}),n.jsx(A,{onClick:r,type:"grey",disabled:a,children:"–£–¥–∞–ª–∏—Ç—å"})]}),n.jsx(zV,{id:o==null?void 0:o.id})]})}const GV="DzAtxbX",KV={positionCell:GV},vi=k("widget/cmp-search-query-stats"),qt={modelName:vi(),loading:{load:vi("load")},view:{formPrevious:vi("view/form-previous")},analytic:{search:vi("search")},productsLookLimit:1e3},Ec=Q(qt.modelName),Yf={},Jx=_({name:qt.modelName,initialState:Yf,reducers:{setSearchParams:D("searchParams"),reset:()=>Yf}}),HV=E.inject(Jx),tr={...Jx.actions,search:Ec("search"),searchOnce:Ec("searchOnce"),stopSearch:Ec("stopSearch")},UV=V(qt.modelName,HV),Jf=UV("searchParams"),QV=$([Uo.selectors.data,Ke.selectors.query,je.selectors.loadingQuery,Ds.selectors.query],(e,t,s,o)=>e.map(a=>{const r=t==null?void 0:t[a.query];return{...a,position:{result:r,loading:(s==null?void 0:s[a.query])||!1},positionLog:o==null?void 0:o[a.query]}})),Zx={searchParams:Jf,useSearchParams:b(Jf),useData:te(QV)};function*Xx(e,t){const s=yield F(Zx.searchParams);if(!s.nm||!s.dest||!s.itemLimit)throw new $o("–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —Ñ–æ—Ä–º–∞");yield u(je.sagas.search,{nm:s.nm,dest:s.dest,type:"query",productsLookLimit:qt.productsLookLimit,pageFrom:t,items:e.map(({query:o})=>({query:o})).filter(Tn)}),yield S(On.actions.save({dest:s.dest,nm:s.nm,type:"query",items:e.map(({query:o})=>({key:o}))}))}function*YV(){yield u(je.sagas.reset,{type:"query",cleanResults:!1})}function*JV({items:e}){yield u(je.sagas.reset,{type:"query",cleanResults:!0}),yield u(Xx,e)}function*ZV({item:e}){yield u(Xx,[e],Wr(e))}function*XV(){yield I([N(tr.search,T(JV,[M,O(qt.loading.load),L(qt.loading.load)])),N(tr.searchOnce,T(ZV,[M,O(qt.loading.load),L(qt.loading.load)])),N(tr.stopSearch,T(YV,[M,O(qt.loading.load),L(qt.loading.load)]))])}K(qt.modelName,XV);function eq({gridRef:e}){const t=pe.selectors.useCard(),s=pe.selectors.useCardNms(),o=Zx.useData(t==null?void 0:t.id),{searchOnce:a}=x(tr),{setSelected:r}=x(Xd.actions),{load:i}=x(On.actions),{setShowModal:l}=x(Ss.actions),c=m.useCallback(h=>{r(h.map(({query:g})=>g))},[]),d=m.useMemo(()=>{const h=s==null?void 0:s[0];if(h)return{type:"query",nm:h,keys:o.map(({query:g})=>g),dest:-364001}},[t]);m.useEffect(()=>{d&&i(d)},[d]);const p=m.useMemo(()=>{var y;const h=[{field:"position",cellRenderer:Nl,cellRendererParams:{onSearchClick:({data:w})=>{w&&a({item:w})}},cellClass:KV.positionCell,headerName:"–ü–æ–∑–∏—Ü–∏—è",filter:!1,sortable:!1,width:160}],g=o.find(({positionLog:w})=>w&&w.length>0);return(y=g==null?void 0:g.positionLog)==null||y.forEach(({date:w},C)=>{h.push({colId:`positionLog-${w.valueOf()}`,valueGetter:j=>{var q,B;return(B=(q=j.data)==null?void 0:q.positionLog)==null?void 0:B[C]},filter:!1,sortable:!1,cellRenderer:Rl,cellRendererParams:{onShowDetailsClick:({value:j,data:q})=>{var B;j!=null&&j.date&&(q!=null&&q.query)&&((B=q==null?void 0:q.position)!=null&&B.result)&&d&&l({type:d.type,dest:q.position.result.dest||d.dest,nm:q.position.result.nm||d.nm,key:q.query,date:j.date})}},headerName:v.dateShort(w),suppressMovable:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,width:160})}),h},[o]);return o.length===0?n.jsxs(n.Fragment,{children:[n.jsx(dt,{type:"warning",message:n.jsxs(n.Fragment,{children:["–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞ –ø–æ –ª—é–±—ã–º –∑–∞–ø—Ä–æ—Å–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –¥–æ–±–∞–≤–∏—Ç–µ –≤ —Å–ø–∏—Å–æ–∫.",n.jsx("br",{}),"–≠—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏–∑ —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏.",n.jsx("br",{}),"–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–æ–±–Ω–æ–µ –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã."]})}),n.jsx(Qf,{gridRef:e})]}):n.jsxs(n.Fragment,{children:[n.jsx(RV,{gridRef:e,data:o,onSelected:c,extendedColumnDefs:p,maxRowsOnScreen:10,style:{fontSize:13},exportProcessCellCallback:hx,campaignId:t==null?void 0:t.id}),n.jsx(Qf,{gridRef:e}),n.jsx(Ln,{})]})}function tq({gridRef:e}){const t=pe.selectors.useCardNms(),s=je.selectors.useCountLoadingQuery(),{search:o,setSearchParams:a,stopSearch:r}=x(tr),i=he(qt.view.formPrevious,{withLoad:!0}),l=je.selectors.useDefaultSearchParams(),c=Ve.selectors.useDestination(),[d,p]=m.useState(),h=m.useCallback(()=>{var g;if(Te.click(qt.analytic.search),!(!(d!=null&&d.itemLimit)||!(d!=null&&d.nm)||!(d!=null&&d.dest))&&(g=e==null?void 0:e.current)!=null&&g.api){const y={itemLimit:d.itemLimit};d.dest!==(c==null?void 0:c.value)&&(y.dest=d.dest),i.save(y),a(d);const w=ka(e.current.api,d==null?void 0:d.itemLimit);o({items:w})}},[d]);return m.useEffect(()=>{if(!l||!i.isReady)return;const g={...l||{},...i.state||{}};p(g),a(g)},[l,i.isReady]),n.jsx(kl,{nms:t,form:d,onFormChange:p,onSearchClick:h,countLoadingPosition:s,onResetSearchClick:r})}function sq(){const e=m.useRef(null),{loadQueries:t}=x(Uo.actions),s=G.selectors.useSomeLoader([Uo.config.loading.load,Uo.config.loading.load,...Object.values(Uo.config.view)]),o=Z.selectors.useError(Uo.config.loading.load),a=pe.selectors.useCard();return m.useEffect(()=>{t()},[]),s?n.jsx(le,{}):o?n.jsx(ee,{value:o}):a?n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx(tq,{gridRef:e}),n.jsx(eq,{gridRef:e})]}):null}const ji=k("feature/cmp-search-recommendation-stats"),bn={modelName:ji(),loading:{load:ji("load"),search:ji("search")},view:{grid:ji("view/grid")}},nq=Q(bn.modelName),eb={loadRecommendations:nq("load-recommendations")},Zf=k("entity/wb/search-recommendation"),Ol={modelName:Zf(),storageKey:`${W.appName}/${Zf("storage-key")}`},Xf={},tb=_({name:Ol.modelName,initialState:Xf,reducers:{setRecommendations:D("recommendations"),reset:()=>Xf}}),oq=E.inject(tb),Cm={...tb.actions},aq=V(Ol.modelName,oq),sb=aq("recommendations"),rq=$([sb,(e,t)=>t],(e,t)=>t?e==null?void 0:e[t]:void 0),iq={recommendations:sb,recommendationsById:rq},sl=Ue(Ol.storageKey,{type:Qe.Local});function*lq(e){let t=!1;if(!e)return;const s={};return Object.keys(e).forEach(o=>{const a=Number(o);s[a]=e[a].filter(Boolean),s[a].length!==e[a].length&&(t=!0),s[a].length===0&&delete s[a]}),t?(yield u(sl.set,s),s):e}function*cq(){const e=yield u(sl.get),t=yield u(lq,e);yield S(Cm.setRecommendations(t))}function*dq({id:e,list:t}){let s=yield u(sl.get);s||(s={}),s[e]=oy(t),s[e].length===0&&delete s[e],yield u(sl.set,s),yield S(Cm.setRecommendations(s))}const uq={load:cq,save:dq},bo={actions:Cm,config:Ol,sagas:uq,selectors:iq};function*mq(){yield u(bo.sagas.load)}function*pq(){yield I([N(eb.loadRecommendations,T(mq,[M,vt([bn.view.grid]),O(bn.loading.load),L(bn.loading.load)]))])}K(bn.modelName,pq);const hq={};function fq(e,t){return e.map(s=>({nm:s,details:t==null?void 0:t[s]}))}const eg=$([bo.selectors.recommendationsById,Pe.selectors.details],(e,t)=>e?fq(e,t):wa.array),gq={data:eg,useData:te(eg),useNms:te(bo.selectors.recommendationsById)},yq="zs8bOjW",wq="uvzQ7lB",Sq="OozUbso",_c={wrapper:yq,price:wq,reviews:Sq},xq=({value:e})=>e?n.jsxs(f,{className:_c.wrapper,children:[n.jsx(f,{className:_c.price,children:v.currency(e.price/100,{fraction:0})}),n.jsxs(f,{justify:"center",className:_c.reviews,children:[v.numeric(e.feedbacks,{fraction:0}),n.jsx(Oe,{mouseEnterDelay:.4,overlay:"–û—Ç–∑—ã–≤–æ–≤",children:n.jsx(z.Message,{})})]})]}):null,bq="gPWx5hJ",vq={article:bq},jq={id:"–ê—Ä—Ç–∏–∫—É–ª",recommendations:"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"},Cq=[{field:"id",headerName:jq.id,filter:"agTextColumnFilter",filterValueGetter:({data:e})=>[e==null?void 0:e.id,e==null?void 0:e.details.brand,e==null?void 0:e.details.name].filter(Boolean).join(" "),cellRenderer:LT,cellClass:vq.article,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,suppressMovable:!0,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,checkboxSelection:!0,width:285,minWidth:250,pinned:!0},{field:"details",headerName:"–¶–µ–Ω–∞",cellRenderer:xq,filter:!1,sortable:!1,pinned:!0,width:85}];function $q({gridRef:e,data:t,style:s,onSelected:o,extendedColumnDefs:a=[],maxRowsOnScreen:r,campaignId:i,exportProcessCellCallback:l}){const c=he(bn.view.grid),d=m.useMemo(()=>[...Cq,...a],[a]),p=m.useMemo(()=>({filter:!0,floatingFilter:!0}),[]),h=m.useCallback(w=>{o&&o(w.api.getSelectedRows())},[o]),g=m.useCallback(w=>{c.save(w)},[]),y=m.useMemo(()=>({fileName:`${i}_${bn.modelName}`,columnKeys:d.map(w=>w.colId||w.field),processCellCallback:w=>{if(l){const C=l(w);if(C)return C}return Cn(w)}}),[i,d,l]);return n.jsx(Ce,{gridRef:e,style:s,rowData:t,columnDefs:d,defaultColDef:p,columnsState:c.state,onColumnsStateChanged:g,rowSelection:"multiple",suppressRowClickSelection:!0,onSelectionChanged:h,maxRowsOnScreen:r,defaultExcelExportParams:y,processCellForClipboard:y.processCellCallback,rowHeight:38,rowClass:Jy.cellVerticalAlignMiddle})}const Yn={actions:eb,config:bn,sagas:hq,selectors:gq},Ic=k("feature/cmp-search-recommendation-add-form"),js={modelName:Ic(),loading:{load:Ic("load")},analytics:{save:Ic("save")}},tg=Q(js.modelName),sg={},nb=_({name:js.modelName,initialState:sg,reducers:{setSelected:D("selected"),setShowModal:D("showModal"),reset:()=>sg}}),kq=E.inject(nb),jr={...nb.actions,save:tg("save"),remove:tg("remove")};function*Nq({list:e,id:t}){const s=yield F(bo.selectors.recommendationsById,t);yield u(bo.sagas.save,{id:t,list:s?[...s,...e]:e})}function*Tq({id:e,list:t}){const s=yield F(bo.selectors.recommendationsById,e),o=s==null?void 0:s.filter(a=>!t.includes(a));yield u(bo.sagas.save,{id:e,list:o||[]})}function*Pq(){yield I([N(jr.save,T(Nq,[M,et(js.loading.load),L(js.loading.load)])),N(jr.remove,T(Tq,[M,et(js.loading.load),L(js.loading.load)]))])}K(js.modelName,Pq);const Mq={},ob=V(js.modelName,kq),Fq=ob("showModal"),ab=ob("selected"),Dq=$(ab,e=>!e||e.length===0),rb={useShowModal:b(Fq),useSelected:b(ab),useSelectedIsEmpty:b(Dq)};function Aq({id:e,onSaveClick:t}){const[s,o]=m.useState(),{save:a}=x(jr),r=m.useMemo(()=>s?s.split(/[\r\n]+/gi).map(l=>Number(l)).filter(l=>l&&!isNaN(l)):[],[s]),i=()=>{a({id:e,list:r}),Te.click(js.analytics.save),s&&t()};return n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx("div",{children:n.jsx(xe.Textarea,{value:s,onChange:l=>o(l.target.value)})}),n.jsx(A,{type:"purple",onClick:i,disabled:!s,children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})]})}function Lq({id:e}){const t=rb.useShowModal(),{setShowModal:s}=x(jr);return n.jsx(Ye,{open:t,onCloseClick:()=>s(!1),title:"–î–æ–±–∞–≤–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª—ã –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤",children:n.jsx(Aq,{id:e,onSaveClick:()=>s(!1)})})}const eu={actions:jr,config:js,sagas:Mq,selectors:rb};function ng({gridRef:e}){const{setShowModal:t,remove:s}=x(eu.actions),o=pe.selectors.useCard(),a=eu.selectors.useSelectedIsEmpty();if(!o)return null;const r=()=>{var l;const i=(l=e==null?void 0:e.current)==null?void 0:l.api.getSelectedRows();i&&s({id:o==null?void 0:o.id,list:i==null?void 0:i.map(({id:c})=>c)})};return n.jsxs(n.Fragment,{children:[n.jsxs(f,{children:[n.jsx(xa,{gridRef:e}),n.jsx(A,{onClick:()=>t(!0),type:"grey",children:"–î–æ–±–∞–≤–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª—ã"}),n.jsx(A,{onClick:r,type:"grey",disabled:a,children:"–£–¥–∞–ª–∏—Ç—å"})]}),n.jsx(Lq,{id:o==null?void 0:o.id})]})}const Rq="sZknApI",Eq={positionCell:Rq},Ci=k("widget/cmp-search-recommendation-stats"),Bt={modelName:Ci(),loading:{load:Ci("load")},view:{formPrevious:Ci("view/form-previous")},analytic:{search:Ci("search")},productsLookLimit:300},Oc=Q(Bt.modelName),og={},ib=_({name:Bt.modelName,initialState:og,reducers:{setSearchParams:D("searchParams"),reset:()=>og}}),_q=E.inject(ib),sr={...ib.actions,search:Oc("search"),searchOnce:Oc("searchOnce"),searchStop:Oc("searchStop")},Iq=V(Bt.modelName,_q),ag=Iq("searchParams"),Oq=$([Yn.selectors.data,Ke.selectors.recommendation,je.selectors.loadingRecommendation,Ds.selectors.recommendations],(e,t,s,o)=>e.map(a=>{const{nm:r}=a,i=t==null?void 0:t[r];return{id:r,...a,position:{result:i,loading:(s==null?void 0:s[r])||!1},positionLog:o==null?void 0:o[r]}})),lb={searchParams:ag,useSearchParams:b(ag),useData:te(Oq)};function*cb(e,t){const s=yield F(lb.searchParams);if(!s.nm||!s.dest||!s.itemLimit)throw new $o("–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —Ñ–æ—Ä–º–∞");yield u(je.sagas.search,{nm:s.nm,dest:s.dest,type:"recommendation",productsLookLimit:Bt.productsLookLimit,pageFrom:t,items:e}),yield S(On.actions.save({dest:s.dest,nm:s.nm,type:"recommendation",items:e.map(({nm:o})=>({key:String(o)}))}))}function*Vq(){yield u(je.sagas.reset,{type:"recommendation",cleanResults:!1})}function*qq({items:e}){yield u(je.sagas.reset,{type:"recommendation",cleanResults:!0}),yield u(cb,e)}function*Bq({item:e}){yield u(cb,[e],Wr(e))}function*Wq(){yield I([N(sr.search,T(qq,[M,O(Bt.loading.load),L(Bt.loading.load)])),N(sr.searchOnce,T(Bq,[M,O(Bt.loading.load),L(Bt.loading.load)])),N(sr.searchStop,T(Vq,[M,O(Bt.loading.load),L(Bt.loading.load)]))])}K(Bt.modelName,Wq);function zq({gridRef:e}){const t=pe.selectors.useCard(),s=pe.selectors.useCardNms(),o=lb.useData(t==null?void 0:t.id),a=Yn.selectors.useNms(t==null?void 0:t.id),{searchOnce:r}=x(sr),{setSelected:i}=x(eu.actions),{load:l}=x(ct.actions),{load:c}=x(On.actions),{setShowModal:d}=x(Ss.actions);m.useEffect(()=>{a&&a.length>0&&l({nms:a})},[a]);const p=m.useMemo(()=>{const y=s==null?void 0:s[0];if(y)return{type:"recommendation",nm:y,keys:o.map(({nm:w})=>w.toString()),dest:-364001}},[s]),h=m.useCallback(y=>{i(y.map(({nm:w})=>w))},[i]);m.useEffect(()=>{p&&c(p)},[p]);const g=m.useMemo(()=>{var C;const y=[{field:"position",cellRenderer:Nl,cellRendererParams:{onSearchClick:({data:j})=>{j&&r({item:j})}},cellClass:Eq.positionCell,headerName:"–ü–æ–∑–∏—Ü–∏—è",filter:!1,sortable:!1,width:160}],w=o.find(({positionLog:j})=>j&&j.length>0);return(C=w==null?void 0:w.positionLog)==null||C.forEach(({date:j},q)=>{y.push({colId:`positionLog-${j.valueOf()}`,valueGetter:B=>{var X,U;return(U=(X=B.data)==null?void 0:X.positionLog)==null?void 0:U[q]},filter:!1,sortable:!1,cellRenderer:Rl,cellRendererParams:{onShowDetailsClick:({value:B,data:X})=>{var U,fe,$e,ut;B!=null&&B.date&&(X!=null&&X.nm)&&p&&d({type:p.type,dest:((fe=(U=X.position)==null?void 0:U.result)==null?void 0:fe.dest)??p.dest,nm:((ut=($e=X.position)==null?void 0:$e.result)==null?void 0:ut.nm)??p.nm,key:X.nm.toString(),date:B.date})}},headerName:v.dateShort(j),suppressMovable:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0,width:160})}),y},[o]);return o.length===0?n.jsxs(n.Fragment,{children:[n.jsx(dt,{type:"warning",message:n.jsxs(n.Fragment,{children:["–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ –∫–∞–∫–æ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤–∞—à —Ç–æ–≤–∞—Ä –≤ –±–ª–æ–∫–µ"," ",n.jsx("b",{children:'"—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Ç–∞–∫–∂–µ"'})," –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤",n.jsx("br",{}),n.jsx("b",{children:"–î–æ–±–∞–≤—å—Ç–µ –∞—Ä—Ç–∏–∫—É–ª—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"})]})}),n.jsx(ng,{gridRef:e})]}):n.jsxs(n.Fragment,{children:[n.jsx($q,{gridRef:e,data:o,onSelected:h,extendedColumnDefs:g,maxRowsOnScreen:10,exportProcessCellCallback:hx,campaignId:s==null?void 0:s[0]}),n.jsx(ng,{gridRef:e}),n.jsx(Ln,{})]})}function Gq({gridRef:e}){const t=pe.selectors.useCardNms(),s=je.selectors.useCountLoadingRecommendation(),{search:o,setSearchParams:a,searchStop:r}=x(sr),i=he(Bt.view.formPrevious,{withLoad:!0}),l=je.selectors.useDefaultSearchParams(),c=Ve.selectors.useDestination(),[d,p]=m.useState(),h=m.useCallback(()=>{var g;if(Te.click(Bt.analytic.search),!(!(d!=null&&d.itemLimit)||!(d!=null&&d.nm)||!(d!=null&&d.dest))&&(g=e==null?void 0:e.current)!=null&&g.api){const y={itemLimit:d.itemLimit};d.dest!==(c==null?void 0:c.value)&&(y.dest=d.dest),i.save(y),a(d);const w=ka(e.current.api,d==null?void 0:d.itemLimit);o({items:w})}},[d]);return m.useEffect(()=>{if(!l||!i.isReady)return;const g={...l||{},...i.state||{}};p(g),a(g)},[l,i.isReady]),n.jsx(kl,{nms:t,form:d,onFormChange:p,onSearchClick:h,buttonLabel:"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö",itemLimitLabel:"–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ä—Ç–æ—á–µ–∫",countLoadingPosition:s,onResetSearchClick:r})}function Kq(){const e=m.useRef(null),{loadRecommendations:t}=x(Yn.actions),s=G.selectors.useSomeLoader([Yn.config.loading.load,Yn.config.loading.load,...Object.values(Yn.config.view)]),o=Z.selectors.useError(Yn.config.loading.load),a=pe.selectors.useCard();return m.useEffect(()=>{t()},[]),s?n.jsx(le,{}):o?n.jsx(ee,{value:o}):a?n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx(Gq,{gridRef:e}),n.jsx(zq,{gridRef:e})]}):null}const Io=k("pages/cmp/campaigns-edit-page"),gn={modelName:Io(),section:{main:Io("main"),advertKeywordStatsView:Io("advert-keyword-stats-view"),searchQueryStatsView:Io("search-query-stats-view"),advertStatsView:Io("advert-stats-view"),searchRecommendationsStatsView:Io("search-recommendations-stats-view")}},Hq="qVyRFuh",Uq="OhDVdGJ",Qq="prgMKsH",Yq="k1qmcxt",Jq="cCh8a8Z",Zq="sohz-ar",ss={section:Hq,injector:Uq,auction:Qq,sectionMain:Yq,fixNeiromarket:Jq,fixNeiromarketContainer:Zq};function rg(){const e=G.selectors.useLoader(Fs.config.loading.load),t=Z.selectors.useError(Fs.config.loading.load);return e?n.jsx(le,{}):t?n.jsx(ee,{value:t}):n.jsxs(f,{type:"vertical",gap:"2xl",children:[n.jsx(H5,{}),n.jsx(xt,{title:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –†–ö –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (CTR %, –ø–æ–∑–∏—Ü–∏–∏, —á–∞—Å—Ç–æ—Ç—ã)",id:gn.section.advertKeywordStatsView,suppressAnalyticEvent:!0,className:ss.section,children:n.jsx(B5,{id:gn.section.advertStatsView,children:n.jsx(R5,{})})}),n.jsx(xt,{title:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –†–ö –ø–æ –î–ù–Ø–ú",id:gn.section.advertStatsView,suppressAnalyticEvent:!0,className:ss.section,children:n.jsx(gV,{id:gn.section.advertStatsView,children:n.jsx(H,{children:n.jsx(pV,{})})})}),n.jsx(xt,{title:"–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–π –ª—é–±—ã—Ö –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤",id:gn.section.searchQueryStatsView,className:ss.section,children:n.jsx(H,{children:n.jsx(sq,{})})}),n.jsx(xt,{title:"–ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–π –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤",id:gn.section.searchRecommendationsStatsView,className:ss.section,children:n.jsx(H,{children:n.jsx(Kq,{})})})]})}const Xq=()=>{var s;const e=(s=document.querySelector("#goods-section"))==null?void 0:s.parentElement;if(e)return e;const t=document.querySelector("main._2rg88yCM .nQiXfu9D");return t||null},eB=()=>{var s;const e=(s=document.querySelector("main"))==null?void 0:s.querySelector(".cQobLO, .hBjLUV");if(e)return e;const t=document.querySelector("main.w7d9rx7r .nQiXfu9D");return t||null};function tB(){const e=n.jsxs(f,{justify:"space-between",align:"center",display:"block",children:[n.jsxs(f,{gap:"l",align:"center",children:[n.jsx(ga,{}),n.jsx(pm,{})]}),n.jsx(We,{bannerId:"audit-2",showAppLogo:!1,children:"–ù–µ —É—Å—Ç—Ä–∞–∏–≤–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –†–ö?"})]});return n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:Xq,append:"after",className:ss.injector,children:n.jsx(fr,{title:e,id:gn.section.main,className:ss.sectionMain,children:n.jsx(rg,{})})}),n.jsx(J,{selector:eB,append:"after",className:P(ss.injector,ss.auction),children:n.jsx(fr,{title:e,id:gn.section.main,className:ss.sectionMain,children:n.jsx(rg,{})})}),n.jsx(J,{selector:"main.w7d9rx7r .n-main-window.sentry-block",targetClassName:ss.fixNeiromarket,children:n.jsx(J,{selector:".k8E-XV3N",targetClassName:ss.fixNeiromarketContainer})})]})}function sB(){const{id:e}=sy(),t=parseInt(e),{resetCard:s}=x(pe.actions),{load:o}=x(Fs.actions),{load:a}=x(Ys.actions),{load:r}=x(wo.actions),i=pe.selectors.useCard();return m.useEffect(()=>(o(t),()=>{s()}),[t]),m.useEffect(()=>{i&&a({id:i.id,type:i.type,callback:r})},[i]),n.jsxs(n.Fragment,{children:[n.jsx(H,{fallback:Qt,children:n.jsx(k_,{})}),n.jsx(tB,{}),n.jsx(B2,{}),n.jsx(I2,{}),n.jsx(g_,{}),n.jsx(v_,{}),n.jsx(C_,{})]})}const ig=k("feature/cmp-deeplink-create"),vo={modelName:ig(),loading:{load:ig("load")}},nB=Q(vo.modelName),lg={},db=_({name:vo.modelName,initialState:lg,reducers:{setResult:D("result"),setShowModal:D("showModal"),reset:()=>lg}}),oB=E.inject(db),Vl={...db.actions,save:nB("save")},aB=k("entity/evirma/deeplink"),$m={modelName:aB()},cg={},ub=_({name:$m.modelName,initialState:cg,reducers:{setList:D("list"),appendToList:fd("list"),reset:()=>cg}}),rB=E.inject(ub),mb={...ub.actions};function iB(e){return e!=null&&e.list?e.list.map(t=>({id:t.wb_article,deeplinkId:t.id,deeplink:t.link,targetUrl:t.url,views:t.visit_count,comment:t.name,lastViewDate:t.last_visit_date,createDate:t.create_date})):[]}function*pb(e){const t=yield u(hu.list,{supplierId:e,limit:1e3});t&&t.list&&(yield S(mb.setList(iB(t))))}function*lB({url:e,name:t,supplierId:s,code:o}){const a=yield u(hu.create,{supplierId:s,url:e,code:o,name:t});if(a)return yield u(pb,s),{url:a.url,link:e}}function*cB(e){yield u(hu.remove,e)}const dB={loadList:pb,create:lB,delete:cB},uB=V($m.modelName,rB),mB=uB("list"),hb={list:mB},pB="_7WltVxc",hB={button:pB};function dg({value:e}){return n.jsx(jt,{suffix:n.jsx(A,{onClick:()=>navigator.clipboard.writeText(e),className:hB.button,children:n.jsx(z.Copy,{})}),children:n.jsx("a",{href:e,target:"_blank",rel:"noreferrer",children:e})})}const nl={config:$m,actions:mb,selectors:hb,sagas:dB};function*fB({url:e,code:t,name:s}){const o=yield F(ie.selectors.supplierUuid);if(!o)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –ø—Ä–æ–¥–∞–≤—Ü–∞");const a=yield u(nl.sagas.create,{supplierId:o,url:e,code:t,name:s});yield S(Vl.setResult(a))}function*gB(){yield I([N(Vl.save,T(fB,[M,O(vo.loading.load),L(vo.loading.load),zt]))])}K(vo.modelName,gB);const yB={},fb=V(vo.modelName,oB),wB=fb("result"),SB=fb("showModal"),gb={useResult:b(wB),useShowModal:b(SB)},xB=e=>{const{supplierUuid:t,url:s,utmCampaign:o,utmSource:a,utmMedium:r,utmContent:i,utmTerm:l}=e,c=new URL(s.trim()),d=`${t}-id-${Ra(o)}`;return c.searchParams.set("utm_campaign",d),c.searchParams.set("utm_source",Ra(a)),c.searchParams.set("utm_medium",Ra(r)),i&&c.searchParams.set("utm_content",Ra(i)),l&&c.searchParams.set("utm_term",Ra(l)),c.toString()},qs={catalog:"/catalog/",brands:"/brands/",details:"/detail.aspx",ruCatalog:"/.ru/catalog/"};function bB(e){const t=new URL(e),{pathname:s,searchParams:o}=t;let a="product",r="";if(o.has("search"))a="search";else if(s.startsWith(qs.ruCatalog)&&!s.includes(qs.details))a="catalog";else if(s.includes(qs.catalog)&&s.includes(qs.details)){a="product";const i=s.substring(s.indexOf(qs.catalog)+qs.catalog.length);r=i.substring(0,i.lastIndexOf(qs.details))}else s.startsWith(qs.brands)&&(a="brand",r=s.substring(qs.brands.length));return{utmContent:a,utmTerm:r}}const vB="VwFL-rt",jB="HSRyx-z",CB="_8jY0x4y",Vc={hint:vB,labelText:jB,rightLabelText:CB};function Ht({children:e,title:t,error:s,className:o,style:a,rightTitle:r,hint:i,tooltip:l}){return n.jsxs(f,{as:"label",type:"vertical",gap:"s",className:o,style:a,children:[n.jsxs(f,{justify:"space-between",children:[n.jsxs(f,{type:"horizontal",gap:"s",align:"center",className:Vc.labelText,children:[t&&n.jsx("span",{children:t}),l&&n.jsx(z.QuestionCircle,{})]}),n.jsx("div",{className:Vc.rightLabelText,children:r})]}),e,i&&n.jsx("div",{className:Vc.hint,children:i}),s&&n.jsx("div",{children:s})]})}function $B({form:e,onFieldChange:t,onSubmit:s,isLoading:o}){return n.jsxs(f,{gap:"l",type:"vertical",style:{minWidth:"90vh"},children:[n.jsx(Ht,{title:"–ò—Å—Ö–æ–¥–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É Wildberries",children:n.jsx(xe,{value:e.url,onChange:a=>t("url",a.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: https://www.wildberries.ru/catalog/115642881/detail.aspx"})}),n.jsx(Ht,{title:"–ö–æ—Ä–æ—Ç–∫–∏–π url (code)",children:n.jsx(xe,{value:e.code,onChange:a=>t("code",a.target.value),placeholder:"bloger_xxx"})}),n.jsx(Ht,{title:"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π",hint:"–ß—Ç–æ–±—ã –ø–æ—Ç–æ–º –í—ã –º–æ–≥–ª–∏ –ø–æ–Ω—è—Ç—å, —á—Ç–æ —ç—Ç–æ –∑–∞ —Å—Å—ã–ª–∫–∞",children:n.jsx(xe,{value:e.name,onChange:a=>t("name",a.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: –°—Ç–∏–ª–∏—Å—Ç, –æ–±–∑–æ—Ä–Ω—ã–π —Ä–∏–ª–∑ —á–µ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç—å—è"})}),n.jsx(f,{gap:"m",children:n.jsx(A,{onClick:s,type:"purple",isLoading:o,children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})})]})}const kB="Vqfaxb3",NB="kC60EB4",qc={select:kB,hr:NB},TB=["","instagram","telegram","vk","tiktok","youtube"],PB=[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ"},{value:"social",label:"social - –ø–æ—Å—Ç –≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏"},{value:"cpc",label:"cpc - –æ–ø–ª–∞—Ç–∞ –∑–∞ –∫–ª–∏–∫–∏ - –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞, —è–Ω–¥–µ–∫—Å-–¥–∏—Ä–µ–∫—Ç, –≥—É–≥–ª –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ"},{value:"cpm",label:"cpm - –æ–ø–ª–∞—Ç–∞ –∑–∞ 1000 –ø–æ–∫–∞–∑–æ–≤"},{value:"organic",label:"organic - –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–æ—Å—Ç"},{value:"email",label:"email - —Ä–∞—Å—Å—ã–ª–∫–∞ –ø–æ –ø–æ—á—Ç–µ"},{value:"messenger",label:"messanger - —Ä–∞—Å—Å—ã–ª–∫–∞ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã"},{value:"banner",label:"banner - –º–µ–¥–∏–π–Ω–∞—è —Ä–µ–∫–ª–∞–º"},{value:"cpa",label:"cpa - –º–µ–¥–∏–π–Ω–∞—è —Ä–µ–∫–ª–∞–º"}],MB=[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ"},{value:"product",label:"—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞"},{value:"brand",label:"—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –±—Ä–µ–Ω–¥–∞"},{value:"shop",label:"—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞"},{value:"search",label:"—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞"}];function FB({form:e,onFieldChange:t,onSubmit:s,isLoading:o}){const[a,r]=m.useState(e.utmSource?e.utmSource.split(","):[]),i=l=>{const c=a.includes(l)?a.filter(d=>d!==l):[...a,l];r(c),t("utmSource",c.join(","))};return n.jsxs(f,{gap:"xl",type:"vertical",style:{minWidth:"80vw"},children:[n.jsx(Ht,{title:"–ò—Å—Ö–æ–¥–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É Wildberries",children:n.jsx(xe,{value:e.url,onChange:l=>t("url",l.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: https://www.wildberries.ru/catalog/115642881/detail.aspx"})}),n.jsx(Ht,{title:"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π",hint:"–ß—Ç–æ–±—ã –ø–æ—Ç–æ–º –í—ã –º–æ–≥–ª–∏ –ø–æ–Ω—è—Ç—å, —á—Ç–æ —ç—Ç–æ –∑–∞ —Å—Å—ã–ª–∫–∞",children:n.jsx(xe,{value:e.name,onChange:l=>t("name",l.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: –†–µ–∫–ª–∞–º–∞ –≤ –∏–Ω—Å—Ç–∞–≥—Ä–∞–º, –ø–æ—Å—Ç –ø—Ä–æ —á–µ—Ä–Ω–æ–µ –ø–ª–∞—Ç—å–µ"})}),n.jsx("hr",{className:qc.hr}),n.jsxs(f,{gap:"4xl",children:[n.jsxs(f,{gap:"xl",type:"vertical",style:{width:"50vw"},children:[n.jsx(Ht,{title:"–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏",rightTitle:"utm_campaign",tooltip:"–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏",children:n.jsx(f,{wrap:!1,children:n.jsx(xe,{value:e.utmCampaign,onChange:l=>t("utmCampaign",l.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: –∏–º—è –±–ª–æ–≥–µ—Ä–∞, –ø–∞–±–ª–∏–∫–∞ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ"})})}),n.jsx(Ht,{title:"–ù–∞ –∫–∞–∫–æ–π –ø–ª–æ—â–∞–¥–∫–µ –±—É–¥–µ—Ç —Ä–µ–∫–ª–∞–º–∞",rightTitle:"utm_source",tooltip:"–ù–∞ –∫–∞–∫–æ–π –ø–ª–æ—â–∞–¥–∫–µ –±—É–¥–µ—Ç —Ä–µ–∫–ª–∞–º–∞",children:n.jsxs(f,{gap:"m",children:[n.jsx(xe,{value:e.utmSource,onChange:l=>t("utmSource",l.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: instagram, vk, telegram"}),n.jsxs(f,{gap:"m",children:[n.jsx("span",{children:"–ü–æ–¥—Å—Ç–∞–≤–∏—Ç—å "}),TB.slice(1).map(l=>n.jsxs(f,{as:"label",type:"horizontal",children:[n.jsx(qr,{checked:a.includes(l),onChange:()=>i(l)}),n.jsx("span",{children:l})]},l))]})]})}),n.jsx(Ht,{title:"–í –∫–∞–∫–æ–π —Ñ–æ—Ä–º–µ –±—É–¥–µ—Ç —Ä–µ–∫–ª–∞–º–∞ (—Ç–∏–ø —Ä–µ–∫–ª–∞–º—ã)",rightTitle:"utm_medium",tooltip:"–í –∫–∞–∫–æ–π —Ñ–æ—Ä–º–µ –±—É–¥–µ—Ç —Ä–µ–∫–ª–∞–º–∞ (—Ç–∏–ø —Ä–µ–∫–ª–∞–º—ã)",children:n.jsxs(f,{wrap:!1,children:[n.jsx(la,{className:qc.select,value:e.utmMedium,onChange:l=>t("utmMedium",l),options:PB}),n.jsx(xe,{value:e.utmMedium,onChange:l=>t("utmMedium",l.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: organic, cpm, social"})]})})]}),n.jsxs(f,{gap:"xl",type:"vertical",style:{width:"30vw"},children:[n.jsx(Ht,{title:"–ö—É–¥–∞ –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–∞",rightTitle:"utm_content",tooltip:"–ö—É–¥–∞ –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–∞",children:n.jsxs(f,{wrap:!1,children:[n.jsx(la,{className:qc.select,value:e.utmContent,onChange:l=>t("utmContent",l),options:MB}),n.jsx(xe,{value:e.utmContent,onChange:l=>t("utmContent",l.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: product, brand, seller"})]})}),n.jsx(Ht,{title:"–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–µ–∫–ª–∞–º–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞",rightTitle:"utm_term",tooltip:"–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–µ–∫–ª–∞–º–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞",hint:"–ï—Å–ª–∏ —Ä–µ–∫–ª–∞–º–∏—Ä—É–µ—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞ - —Ç–æ —É–∫–∞–∂–∏—Ç–µ –∑–¥–µ—Å—å –µ–µ –∞—Ä—Ç–∏–∫—É–ª. –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—á–∫—É –±—Ä–µ–Ω–¥–∞ - —Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –∑–¥–µ—Å—å –∏–º—è –±—Ä–µ–Ω–¥–∞",children:n.jsx(f,{wrap:!1,children:n.jsx(xe,{value:e.utmTerm,onChange:l=>t("utmTerm",l.target.value),placeholder:"–Ω–∞–ø—Ä–∏–º–µ—Ä: –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞, –∏–º—è –±—Ä–µ–Ω–¥–∞"})})})]})]}),n.jsx(f,{gap:"m",children:n.jsx(A,{onClick:s,type:"purple",isLoading:o,children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})})]})}function DB(){const e=gb.useResult(),{reset:t}=x(Vl),s=()=>{t()};return e?n.jsx(Ye,{open:!!e,onCloseClick:s,title:n.jsx(f,{children:"Deeplink —Å–æ–∑–¥–∞–Ω"}),children:n.jsxs(f,{type:"vertical",children:[n.jsx(Ht,{title:"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞",children:n.jsxs(f,{wrap:!1,gap:"l",children:[n.jsx(xe,{readOnly:!0,value:e.link}),n.jsx(A,{onClick:()=>navigator.clipboard.writeText(e.link),children:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å"})]})}),n.jsx(Ht,{title:"Deeplink —Å—Å—ã–ª–∫–∞",children:n.jsxs(f,{wrap:!1,gap:"l",children:[n.jsx(xe,{readOnly:!0,value:e.url}),n.jsx(A,{onClick:()=>navigator.clipboard.writeText(e.url),children:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å"})]})})]})}):null}const to={actions:Vl,config:vo,sagas:yB,selectors:gb};function AB({onSubmit:e,isLoading:t}){const[s,o]=m.useState({url:"",name:"",code:""}),a=(i,l)=>{o({...s,[i]:l})},r=()=>{s&&e(s)};return n.jsx($B,{form:s,onFieldChange:a,onSubmit:r,isLoading:t})}const LB={switch:"rIfYcYs"};function RB({onSubmit:e,isLoading:t}){const s=ie.selectors.useSupplierUuid(),[o,a]=m.useState({url:"",name:"",utmCampaign:"",utmSource:"",utmMedium:"social",utmContent:"",utmTerm:""}),r=(l,c)=>{if(l==="url"&&c){const{utmContent:d,utmTerm:p}=bB(c);a({...o,url:c,utmContent:d,utmTerm:p});return}a({...o,[l]:c})},i=()=>{if(!o)return;const l=xB({supplierUuid:s,...o});e({url:l,name:o.name,code:o.utmCampaign})};return n.jsx(FB,{form:o,onFieldChange:r,onSubmit:i,isLoading:t})}const EB=[{label:"Deeplink",value:"deeplink"},{label:"UTM-—Å—Å—ã–ª–∫—É",value:"utm"}];function _B(){const[e,t]=m.useState("deeplink"),{setShowModal:s}=x(to.actions),{save:o}=x(to.actions),a=G.selectors.useSomeLoader([to.config.loading.load]),r=Z.selectors.useSomeError([to.config.loading.load]),i=({url:c,name:d,code:p})=>{o({url:c,name:d,code:p,callback:()=>{s(!1)}})},l=m.useMemo(()=>{switch(e){case"deeplink":return n.jsx(AB,{onSubmit:i,isLoading:a});case"utm":return n.jsx(RB,{onSubmit:i,isLoading:a});default:return null}},[e,i]);return n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(an,{value:e,onChange:t,options:EB,className:LB.switch}),l,r&&n.jsx(ee,{value:r})]})}function IB(){const e=to.selectors.useShowModal(),{setShowModal:t}=x(to.actions);return n.jsxs(n.Fragment,{children:[n.jsx(Ye,{open:e,onCloseClick:()=>t(!1),title:"–°–æ–∑–¥–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—É—é —Å—Å—ã–ª–∫—É",style:{maxWidth:"unset",width:"unset"},children:n.jsx(H,{children:n.jsx(_B,{})})}),n.jsx(DB,{})]})}function OB(){const{setShowModal:e}=x(to.actions);return n.jsx("div",{children:n.jsx(A,{prefix:n.jsx(z.Plus,{}),onClick:()=>e(!0),children:"–°–æ–∑–¥–∞—Ç—å Deeplink –∏–ª–∏ UTM-—Å—Å—ã–ª–∫—É"})})}const ug=k("feature/cmp-deeplink-list-stats"),ma={modelName:ug(),loading:{load:ug("load")}},VB=Q(ma.modelName),mg={},yb=_({name:ma.modelName,initialState:mg,reducers:{reset:()=>mg}});E.inject(yb);const wb={...yb.actions,load:VB("load")};function*qB(){const e=yield F(ie.selectors.supplierUuid);if(!e)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –ø—Ä–æ–¥–∞–≤—Ü–∞");yield u(nl.sagas.loadList,e)}function*BB(){yield I([N(wb.load,T(qB,[M,O(ma.loading.load),L(ma.loading.load)]))])}K(ma.modelName,BB);const WB={},zB={useList:b(hb.list)},Kn={id:"–ê—Ä—Ç–∏–∫—É–ª",deeplink:"Deeplink",targetUrl:"WB —Å—Å—ã–ª–∫–∞",views:"–ü–µ—Ä–µ—Ö–æ–¥–æ–≤",comment:"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π",lastViewDate:"–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ—Ö–æ–¥",createDate:"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è"},GB=({extendedColumnDefs:e})=>[{field:"id",headerName:Kn.id,cellRenderer:Vr,width:180},{field:"deeplink",headerName:Kn.deeplink,cellRenderer:dg,width:200},{field:"targetUrl",headerName:Kn.targetUrl,cellRenderer:dg,width:200},{field:"views",headerName:Kn.views,width:67},{field:"comment",headerName:Kn.comment,width:320},{field:"lastViewDate",headerName:Kn.lastViewDate,width:100,type:["dateClean"]},{field:"createDate",headerName:Kn.createDate,width:100,type:["dateClean"]},e==null?void 0:e.actions].filter(Tn);function KB({gridRef:e,data:t,style:s,maxRowsOnScreen:o,extendedColumnDefs:a,isCompact:r}){const i=m.useMemo(()=>GB({extendedColumnDefs:a}),[a]),l=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]);return n.jsx(Ce,{isCompact:r,gridRef:e,style:s,rowData:t,columnDefs:i,defaultColDef:l,maxRowsOnScreen:o,enableRangeSelection:!0})}const $i={actions:wb,config:ma,sagas:WB,selectors:zB},pg=k("feature/cmp-deeplink-remove"),pa={modelName:pg(),loading:{load:pg("load")}},HB=Q(pa.modelName),hg={},Sb=_({name:pa.modelName,initialState:hg,reducers:{reset:()=>hg}});E.inject(Sb);const xb={...Sb.actions,remove:HB("remove")};function*bb(e){const t=yield F(ie.selectors.supplierUuid);if(!t)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –ø—Ä–æ–¥–∞–≤—Ü–∞");yield u(nl.sagas.delete,{deeplinkId:e,supplierId:t}),yield u(nl.sagas.loadList,t)}function*UB(){yield I([N(xb.remove,T(bb,[M,et(pa.loading.load),L(pa.loading.load)]))])}K(pa.modelName,UB);const QB={remove:bb};function YB({onDeleteClick:e,...t}){return n.jsx(A,{prefix:n.jsx(z.Trash,{}),size:"small-grid",onClick:()=>e(t),children:"—É–¥–∞–ª–∏—Ç—å"})}const JB={actions:xb,config:pa,sagas:QB};function ZB(){const{load:e}=x($i.actions),{remove:t}=x(JB.actions),s=$i.selectors.useList(),o=Z.selectors.useError($i.config.loading.load),a=G.selectors.useLoader($i.config.loading.load),r=m.useMemo(()=>({actions:{colId:"actions",cellRenderer:YB,cellRendererParams:{onDeleteClick:({data:i})=>{i!=null&&i.deeplinkId&&confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É?")&&t(i.deeplinkId)}},headerName:"–î–µ–π—Å—Ç–≤–∏—è",filter:!1,sortable:!1,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,width:120}}),[]);return m.useEffect(()=>{e()},[]),a?n.jsx(le,{}):o?n.jsx(ee,{value:o}):!s||s.length===0?n.jsx(dt,{type:"warning",message:"Deeplinks not found"}):n.jsx(KB,{style:{"--ag-font-size":"12px"},data:s,maxRowsOnScreen:10,extendedColumnDefs:r})}function XB(){return n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(OB,{}),n.jsx(ZB,{})]})}const fg=k("pages/cmp/external-traffic-page"),eW={modelName:fg(),section:{deeplinkStatsView:fg("deeplink-stats-view")}},tW="xVt0oZA",sW={injector:tW};function nW(){return n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:".Ktst-QIY",append:"before",className:sW.injector,children:n.jsx(xt,{title:"–í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ —Å UTM-–º–µ—Ç–∫–∞–º–∏",id:eW.section.deeplinkStatsView,children:n.jsx(H,{children:n.jsx(XB,{})})})}),n.jsx(IB,{})]})}function oW(){const{auth:e}=x(Gs.actions),t=Gs.selectors.useIsReady(),s=Gs.selectors.useError(),{showApiTokenModal:o}=ju.selectors.useQueryParams(),a=ie.selectors.useSupplierUuid(),r=Ms.selectors.useParsedToken(a),{setShowModal:i}=x(cr.actions),l=G.selectors.useLoader(Gs.config.loading.auth);m.useEffect(()=>{r!=null&&r.isExpired&&i(!0)},[r]),m.useEffect(()=>{o&&i(!0)},[o]),m.useEffect(()=>{t||e()},[t]);const c=m.useMemo(()=>n.jsxs(J,{selector:"body",children:[n.jsx(Gi,{}),n.jsx(zi,{})]}),[]);if(l)return n.jsxs(J,{selector:"main",append:"before",tagName:"section",className:xh.injector,children:[n.jsxs(f,{type:"horizontal",display:"block",align:"center",gap:"2xl",children:[n.jsx(ml,{}),n.jsx(As,{})]}),c]});if(s){let d=n.jsx(ee,{value:s,onRetry:()=>e(),showLogo:!0});return s.error instanceof ds&&(d=n.jsx(dt,{showLogo:!0,type:"error",title:"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏",message:n.jsxs(n.Fragment,{children:["–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–π—Ç–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ –∫–∞–±–∏–Ω–µ—Ç–µ —Å–µ–ª–ª–µ—Ä–∞ (",n.jsxs("a",{href:`https://seller.${W.wb.hostname}/`,target:"_blank",rel:"noreferrer",children:["seller.",W.wb.hostname]}),")"]})})),n.jsxs(J,{selector:"main",append:"before",tagName:"section",className:xh.injector,children:[d,c]})}return t?n.jsxs(n.Fragment,{children:[n.jsxs(au,{children:[n.jsxs(Se,{path:"/campaigns/list",children:[n.jsx(H,{fallback:Qt,children:n.jsx(CE,{})}),c]}),n.jsxs(Se,{path:"/campaigns/edit/:id",children:[n.jsx(H,{fallback:Qt,children:n.jsx(sB,{})}),c]}),n.jsxs(Se,{path:"/external-traffic",children:[n.jsx(H,{fallback:Qt,children:n.jsx(nW,{})}),c]})]}),n.jsx(IR,{})]}):null}const Oo=e=>e.split("/").pop();function aW(){const{run:e,clear:t,transferFunnelSeasonalityData:s,transferFunnelComparisonsData:o,transferWbApiToken:a,transferDiscountData:r,transferFunnelData:i,transferFamousKeywords:l}=x(gt.actions),c=G.selectors.useLoader(gt.config.loading.run);return n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsxs(f,{type:"horizontal",children:[n.jsx(A,{size:"small",onClick:()=>t(),disabled:c,children:"–°–±—Ä–æ—Å–∏—Ç—å"}),n.jsx(A,{size:"small",onClick:()=>e(),isLoading:c,children:"–í—Å–µ"})]}),n.jsxs(f,{type:"horizontal",children:[n.jsx(A,{size:"small",onClick:()=>s({debug:!0}),disabled:c,children:Oo(gt.config.loading.transferFunnelSeasonalityData)}),n.jsx(A,{size:"small",onClick:()=>o({debug:!0}),disabled:c,children:Oo(gt.config.loading.transferFunnelComparisonsData)}),n.jsx(A,{size:"small",onClick:()=>a({force:!0}),disabled:c,children:Oo(gt.config.loading.transferWbApiToken)}),n.jsx(A,{size:"small",onClick:()=>r(),disabled:c,children:Oo(gt.config.loading.transferDiscountData)}),n.jsx(A,{size:"small",onClick:()=>i(),disabled:c,children:Oo(gt.config.loading.transferFunnelData)}),n.jsx(A,{size:"small",onClick:()=>l({debug:!0}),disabled:c,children:Oo(gt.config.loading.transferFamousKeywords)})]})]})}function rW(){const{load:e}=x(gt.actions),t=gt.selectors.useList(),[s,o]=m.useState(),a=Z.selectors.useError(s||"");return m.useEffect(()=>{(!t||(t==null?void 0:t.length)===0)&&e()},[t]),t?n.jsxs(n.Fragment,{children:[n.jsx(oA,{data:t,maxRowsOnScreen:20,onShowErrorClick:r=>o(r==null?void 0:r.job)}),a&&n.jsx(ee,{value:a})]}):null}function iW(){const e=gt.selectors.useShowModal(),{setShowModal:t}=x(gt.actions);return n.jsx(Ye,{open:e,onCloseClick:()=>t(!1),title:"[dev] –°—Ç–∞—Ç—É—Å —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á",style:{maxWidth:"70vw"},children:n.jsx(H,{children:n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(rW,{}),n.jsx(aW,{})]})})})}function lW(){return n.jsx(J,{selector:".Help-section__dCwn-33aQ2",append:"first",children:n.jsx(We,{bannerId:"prognoz-postavok-region",children:"–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø–æ—Å—Ç–∞–≤–∫—É"})})}const Bc=k("feature/seller-orders-stats"),Cs={modelName:Bc(),loading:{load:Bc("load")},storageKey:`${W.appName}/${Bc("storage-key")}`,sendAfter:[7,"days"]},Wc=Q(Cs.modelName),gg={},vb=_({name:Cs.modelName,initialState:gg,reducers:{reset:()=>gg}});E.inject(vb);const ol={...vb.actions,watcherStart:Wc("watcher-start"),watcherStop:Wc("watcher-stop"),load:Wc("load")},yg=Ue(Cs.storageKey,{type:Qe.Local});function*cW(){(yield F(wr.selectors.stats))||(yield u(wr.sagas.load))}function*dW(){const e=yield F(ie.selectors.supplierUuid);if(!e)return;const{channel:t,takeEvent:s}=yield u(wr.sagas.getStatsChannel);try{for(;;){const{done:o}=yield ls({done:u(s),canceled:ne(ol.watcherStop)});if(!o)break;const a=o==null?void 0:o.turnover;if(!a)return;const r=yield u(yg.get),i=r==null?void 0:r[e];(!i||R(i).isAfter(R()))&&(yield u(Po.sagas.transferTurnoverData,{supplierUUID:e,turnover:a}),yield u(yg.set,{...r||{},[e]:R().add(...Cs.sendAfter)}))}}finally{t.close()}}function*uW(){yield I([N(ol.watcherStart,T(dW,[M,O(Cs.loading.load),L(Cs.loading.load)])),N(ol.load,T(cW,[M,O(Cs.loading.load),L(Cs.loading.load)]))])}K(Cs.modelName,uW);const mW={},km={actions:ol,config:Cs,sagas:mW};function pW(){const e=lx.selectors.useIsPassTurnoverThreshold(),{load:t}=x(km.actions);return Ae.useEffect(()=>{t()},[]),e?n.jsx(J,{selector:".Help-section__dCwn-33aQ2",append:"first",children:n.jsx(We,{bannerId:"products-china-car",children:"–ó–∞–∫—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä"})}):null}function hW(){return n.jsx(J,{selector:".Help-section__dCwn-33aQ2",append:"first",children:n.jsx(We,{bannerId:"audit-analytics",children:"–ü–æ—á–µ–º—É –º–∞–ª–æ –ø—Ä–æ–¥–∞–∂"})})}const fW="Lrfz-Ko",gW={container:fW};function yW(){const e=lx.selectors.useIsPassTurnoverThreshold(),{load:t}=x(km.actions);return Ae.useEffect(()=>{t()},[]),e?n.jsx(J,{selector:"."+CSS.escape("Text--red500__N-9yJUaDB7"),className:P(gW.container),append:"last",children:n.jsx(We,{bannerId:"products-china-sneakers",showAppLogo:!1,children:"–°–Ω–∏–∑–∏—Ç—å —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å"})}):null}function wW(){const e=Fn("#Portal-header .ProfileView--is-new-menu"),t=Gs.selectors.useIsReady(),{run:s}=x(gt.actions);return m.useEffect(()=>{t&&s()},[e,t]),null}const SW="cgxyzYU",xW="WuAMqUe",bW="QzjED8m",vW="m0FFKeJ",jW="CcSn4b8",CW="zWYpu3F",$W="cVLNein",Hn={logo:SW,title:xW,videoWrapper:bW,iframe:vW,infoTitle:jW,infoText:CW,footer:$W},kW=k("widget/seller-conversion-bot-advert"),NW={modelName:kW()};function TW(){const[e,t]=m.useState(!1),s=()=>{Te.advView(NW.modelName),t(!0)},o=()=>t(!1),a=()=>{window.open(W.evirma.bot,"_blank")};return n.jsxs(n.Fragment,{children:[n.jsx(A,{type:"white",onClick:s,prefix:n.jsx(bt,{className:Hn.logo}),children:"–õ—É—á—à–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏"}),n.jsx(Ye,{open:e,onCloseClick:o,style:{width:"600px"},title:n.jsxs("span",{className:Hn.title,children:["–ü–æ—Å–º–æ—Ç—Ä–∏ –ª—É—á—à–∏–µ ",n.jsx("br",{})," –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –¢–í–û–ï–ô –Ω–∏—à–µ",n.jsx("br",{}),"–ë–ï–°–ü–õ–ê–¢–ù–û"]}),children:n.jsxs(f,{type:"vertical",justify:"center",align:"center",gap:"m",children:[n.jsxs(f,{type:"vertical",justify:"center",align:"center",gap:"s",children:[n.jsx("p",{children:"–£–∑–Ω–∞–π –¢–û–ü –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≤ —Ç–≤–æ–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:"}),n.jsxs("ul",{children:[n.jsx("li",{children:"–¢–û–ü –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É ‚Äì ???"}),n.jsx("li",{children:"–¢–û–ü –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –∑–∞–∫–∞–∑ ‚Äì ???"}),n.jsx("li",{children:"–¢–û–ü –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∫—É–ø–∞ ‚Äì ???"})]})]}),n.jsx(A,{type:"blue",onClick:a,children:"–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–æ—Ç–∞ –∏ —É–∑–Ω–∞—Ç—å –¢–û–ü-–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏"}),n.jsx("div",{className:Hn.videoWrapper,children:n.jsx("iframe",{className:Hn.iframe,src:"https://rutube.ru/play/embed/3acf5d56ce20492005cc2985332f06ff/",allow:"clipboard-write; autoplay",allowFullScreen:!0})}),n.jsxs(f,{type:"vertical",justify:"center",align:"start",gap:"s",children:[n.jsx("h3",{className:Hn.infoTitle,children:"–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–æ—Ä–æ–Ω–∫–∏ –¢–û–ü–∞ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Ç–≤–æ–π"}),n.jsx("p",{className:Hn.infoText,children:"–í–≤–µ–¥–∏ —Å–≤–æ–π –∞—Ä—Ç–∏–∫—É–ª, –±–æ—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–≤–æ—é –Ω–∏—à—É –∏ –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–±–µ –Ω–∞–¥–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è."})]}),n.jsxs(f,{type:"horizontal",justify:"end",align:"center",gap:"s",className:Hn.footer,children:[n.jsx(A,{type:"grey",onClick:o,children:"–ó–∞–∫—Ä—ã—Ç—å"}),n.jsx(A,{type:"blue",onClick:a,children:"–£–∑–Ω–∞—Ç—å –≤–æ—Ä–æ–Ω–∫—É –¢–û–ü–æ–≤ –≤ –Ω–∏—à–µ"})]})]})})]})}function PW(){return n.jsx(J,{selector:".Help-section__dCwn-33aQ2",append:"first",children:n.jsx(TW,{})})}const ki=k("feature/seller-entry-point-stats"),$s={modelName:ki(),loading:{load:ki("load")},view:{grid:ki("view/grid"),gridGroup:ki("view/grid-group")}},zc=Q($s.modelName),wg={},jb=_({name:$s.modelName,initialState:wg,reducers:{reset:()=>wg}});E.inject(jb);const Cr={...jb.actions,load:zc("load"),watcherStart:zc("watcher-start"),watcherStop:zc("watcher-stop")},MW=k("entity/wb/entry-point"),Nm={modelName:MW()},Sg={},Cb=_({name:Nm.modelName,initialState:Sg,reducers:{setList:D("list"),reset:()=>Sg}}),FW=E.inject(Cb),$b={...Cb.actions},DW=V(Nm.modelName,FW),xg=DW("list"),Tm={list:xg,useList:b(xg)};var ht;(e=>{(t=>{t.Search="search",t.Shelves="shelves",t.Catalog="catalog",t.External="external",t.Other="other"})(e.Type||(e.Type={}))})(ht||(ht={}));const AW={"–ü–æ–∏—Å–∫–æ–≤–∞—è –≤—ã–¥–∞—á–∞":"search","–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞":"shelves","–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞":"shelves",–ö–∞—Ç–∞–ª–æ–≥:"catalog",–î–æ—Å—Ç–∞–≤–∫–∏:"shelves",–ü–æ–∫—É–ø–∫–∏:"shelves","–õ—é–±–∏–º—ã–µ –±—Ä–µ–Ω–¥—ã":"shelves","–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤":"shelves","–õ–∏—Å—Ç –û–∂–∏–¥–∞–Ω–∏—è":"shelves",–ò–∑–±—Ä–∞–Ω–Ω–æ–µ:"shelves","–ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ –∫ —Ç–æ–≤–∞—Ä—É –∏–ª–∏ –∫ –≤—ã–¥–∞—á–µ":"external","–ü—Ä–æ–º–æ –≤—ã–¥–∞—á–∞ —Ç–æ–≤–∞—Ä–æ–≤":"shelves","–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç":"other",–î—Ä—É–≥–æ–µ:"other"},Gc=(e,t)=>e?t/e*100:void 0,Kc=(e,t)=>t?e/t*100:0,kb=e=>({openToCartConversion:Gc(e.openCard,e.addToCart),openToOrderConversion:Gc(e.openCard,e.orders),cartToOrderConversion:Gc(e.addToCart,e.orders)}),LW=(e,t)=>({openCardFraction:Kc(e.openCard,t.openCard),addToCartFraction:Kc(e.addToCart,t.addToCart),ordersFraction:Kc(e.orders,t.orders)});function RW(e){const t=new Map,s={openCard:0,addToCart:0,orders:0};Object.keys(e).forEach(a=>{var i,l;(l=(i=e[a].data)==null?void 0:i.entryPoints)==null||l.forEach(c=>{let d=t.get(c.name);d||(d={name:c.name,group:AW[c.name]||"other",openCard:0,addToCart:0,orders:0},t.set(c.name,d)),d[a]=c.count,s[a]=(s[a]||0)+c.count})});const o=[];return t.forEach(a=>{o.push({...a,...kb(a),...LW(a,s)})}),o}const EW=["openCard","addToCart","orders"];function*_W({params:e,intercepted:t}){const s=EW.reduce((a,r)=>(r!==(t==null?void 0:t.eventType)&&(a[r]=u(uy.list,{...e,eventType:r})),a),{}),o=yield I(s);t&&(o[t.eventType]=t.data),yield S($b.setList(RW(o)))}function*IW(){const t=yield u(()=>Ar(uy.listInterceptor));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}const OW={loadList:_W,loadListChannel:IW};function VW(e){switch(e){case ht.Type.Search:return"–ü–æ–∏—Å–∫";case ht.Type.Shelves:return"–ü–æ–ª–∫–∏";case ht.Type.Catalog:return"–ö–∞—Ç–∞–ª–æ–≥";case ht.Type.External:return"–í–Ω–µ—à–∫–∞";case ht.Type.Other:return"–î—Ä—É–≥–æ–µ";default:return e||""}}const qW={[ht.Type.Search]:"info",[ht.Type.Shelves]:"warning",[ht.Type.Catalog]:"gray",[ht.Type.External]:"error",[ht.Type.Other]:"default"};function Nb({value:e}){return n.jsx(be,{type:qW[e],children:n.jsx("span",{children:VW(e)})})}const Tb={config:Nm,actions:$b,selectors:Tm,sagas:OW};function*BW(e){yield u(Tb.sagas.loadList,e)}function*WW(){const{channel:e,takeEvent:t}=yield u(Tb.sagas.loadListChannel);try{for(;;){const{event:s}=yield ls({event:u(t),canceled:ne(Cr.watcherStop)});if(!s)break;const{request:o,response:a}=s,{eventType:r,...i}=o.body;yield S(Cr.load({params:i,intercepted:{eventType:r,data:a.data}}))}}finally{e.close()}}function*zW(){yield I([N(Cr.watcherStart,T(WW,[M,O($s.loading.load),L($s.loading.load)])),N(Cr.load,T(BW,[M,O($s.loading.load),L($s.loading.load)]))])}K($s.modelName,zW);const GW={};function KW(e){switch(e){case ht.Type.Search:return 4;case ht.Type.Shelves:return 3;case ht.Type.Catalog:return 2;case ht.Type.Other:return 1;default:return 0}}function HW(e){const t={};return e.forEach(s=>{t[s.group]||(t[s.group]={group:s.group,openCard:0,addToCart:0,orders:0,priority:KW(s.group)}),t[s.group].openCard+=s.openCard,t[s.group].addToCart+=s.addToCart,t[s.group].orders+=s.orders}),Object.values(t).map(s=>({...s,...kb(s)}))}const UW=$(Tm.list,e=>{if(e)return HW(e)}),QW={useList:b(Tm.list),useGroupedList:b(UW)},_e={name:"–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞",group:"–ì—Ä—É–ø–ø–∞",amount:"–ö–æ–ª-–≤–æ",fraction:"–î–æ–ª—è",openCard:"–ü–µ—Ä–µ—Ö–æ–¥—ã",addToCart:"–ö–æ—Ä–∑–∏–Ω—ã",openToCartConversion:"–ü–µ—Ä–µ—Ö–æ–¥—ã ‚Üí –∫–æ—Ä–∑.",orders:"–ó–∞–∫–∞–∑—ã",cartToOrderConversion:"–ö–æ—Ä–∑–∏–Ω–∞ ‚Üí –∑–∞–∫–∞–∑",openToOrderConversion:"–ö–æ–Ω–≤–µ—Ä—Å–∏—è",openToOrderConversionCRO:"–ü–µ—Ä–µ—Ö–æ–¥—ã ‚Üí –∑–∞–∫–∞–∑ (CRO)"},YW={"–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞":["–í —ç—Ç–æ–π —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ —Ç—Ä–∞—Ñ–∏–∫ –∏–∑ –¥—Ä—É–≥–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–æ–≤–∞—Ä–æ–≤, –Ω–æ —Ç–∞–∫–∂–µ –∏–∑ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –±–ª–æ–∫–æ–≤ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–° —ç—Ç–∏–º —Ç–æ–≤–∞—Ä–æ–º –∏—Å–∫–∞–ª–∏¬ª –∏–ª–∏ ¬´–°–º–æ—Ç—Ä–∏—Ç–µ —Ç–∞–∫–∂–µ¬ª.","–ò–∑ –∫–∞—Ä—É—Å–µ–ª–µ–π ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–° —ç—Ç–∏–º —Ç–æ–≤–∞—Ä–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç¬ª –∏–ª–∏ ¬´–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã¬ª. –ê —Ç–∞–∫–∂–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –ø–æ –±–∞–Ω–Ω–µ—Ä–∞–º –∞–∫—Ü–∏–π –∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Ñ–æ—Ç–æ"],–ë—Ä–µ–Ω–¥:["–ó–¥–µ—Å—å —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ —Å–ª–∞–π–¥–µ—Ä–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –∞ —Ç–∞–∫–∂–µ –∏–∑ –±–∞–Ω–Ω–µ—Ä–æ–≤, ¬´–ö–∞—Ç–∞–ª–æ–≥–∞¬ª –∏ –∫–∞—Ä—É—Å–µ–ª–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –±—Ä–µ–Ω–¥–∞"],–ö–∞—Ç–∞–ª–æ–≥:["–ü–æ–º–∏–º–æ –ø—Ä—è–º—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∏–∑ ¬´–ö–∞—Ç–∞–ª–æ–≥–∞¬ª, —ç—Ç–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ —Ç–µ–≥–æ–≤, –±–∞–Ω–Ω–µ—Ä–æ–≤ –∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–∞—Ö ¬´–ö–∞—Ç–∞–ª–æ–≥–∞¬ª"],–ü–æ—Å—Ç–∞–≤—â–∏–∫:["–ö—Ä–æ–º–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–¥–∞–≤—Ü–∞, —ç—Ç–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ –∫–∞—Ä—É—Å–µ–ª–µ–π ¬´–•–∏—Ç—ã –ø—Ä–æ–¥–∞–∂¬ª, ¬´–ù–æ–≤–∏–Ω–∫–∏¬ª –∏ ¬´–ê–∫—Ü–∏–∏¬ª, –∞ —Ç–∞–∫–∂–µ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –±–∞–Ω–Ω–µ—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–¥–∞–≤—Ü–∞"],"–ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥":["–í —ç—Ç–æ–π —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä—è–º—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –≤ –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞, –∞ —Ç–∞–∫–∂–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–µ–Ω–¥–∞, –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –ø–æ–∏—Å–∫ –∏ –∫–∞—Ä—É—Å–µ–ª—å ¬´–í—ã –Ω–µ–¥–∞–≤–Ω–æ —Å–º–æ—Ç—Ä–µ–ª–∏¬ª"],"–ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ –∫ —Ç–æ–≤–∞—Ä—É –∏–ª–∏ –∫ –≤—ã–¥–∞—á–µ":["–í —ç—Ç–æ–π —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä—è–º—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –≤ –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞, –∞ —Ç–∞–∫–∂–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–µ–Ω–¥–∞, –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –ø–æ–∏—Å–∫ –∏ –∫–∞—Ä—É—Å–µ–ª—å ¬´–í—ã –Ω–µ–¥–∞–≤–Ω–æ —Å–º–æ—Ç—Ä–µ–ª–∏¬ª"],–ü–æ–∫—É–ø–∫–∏:["–≠—Ç–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ ¬´–ú–æ–∏ –ø–æ–∫—É–ø–∫–∏¬ª, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∫–∞—Ä—É—Å–µ–ª–∏ ¬´–í—ã –Ω–µ–¥–∞–≤–Ω–æ —Å–º–æ—Ç—Ä–µ–ª–∏¬ª –∏ ¬´–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã¬ª"],"–ü—Ä–æ–º–æ –≤—ã–¥–∞—á–∞ —Ç–æ–≤–∞—Ä–æ–≤":["–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ email-—Ä–∞—Å—Å—ã–ª–æ–∫"],"–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞":["–≠—Ç–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ –±–∞–Ω–Ω–µ—Ä–æ–≤, –∫–∞—Ä—É—Å–µ–ª–µ–π –∏ —Å—Ç–æ—Ä–∏–∑ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π"],"–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞–∫—Ü–∏–∏":["–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ –∞–∫—Ü–∏–∏ ¬´–†–∞—Å–ø—Ä–æ–¥–∞—Ä–æ–º!¬ª –∏ ¬´–ß—ë—Ä–Ω–∞—è –ø—è—Ç–Ω–∏—Ü–∞¬ª"],–î–æ—Å—Ç–∞–≤–∫–∏:["–≠—Ç–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç –ª—é–±—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ ¬´–î–æ—Å—Ç–∞–≤–∫–∏¬ª"],"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã":["–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ, –∞ —Ç–∞–∫–∂–µ –∏–∑ –∫–∞—Ä—É—Å–µ–ª–µ–π ¬´–í–æ–∑–º–æ–∂–Ω–æ –≤–∞—Å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç¬ª –∏ ¬´–° —ç—Ç–∏–º —Ç–æ–≤–∞—Ä–æ–º –ø–æ–∫—É–ø–∞—é—Ç¬ª –Ω–∞ —ç–∫—Ä–∞–Ω–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞"],"WB Guru":["–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ –ø—Ä–µ–≤—å—é –∏ –∫–∞—Ä—É—Å–µ–ª–µ–π –Ω–∞ WB Guru ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Wildberries –¥–ª—è –±–ª–æ–≥–µ—Ä–æ–≤"],"–û—Ç–º–µ—Ç–∫–∏ –Ω–∞ —Ñ–æ—Ç–æ":["–≠—Ç–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ç—Ä–∞—Ñ–∏–∫ –∏–∑ –æ—Ç–º–µ—Ç–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Ñ–æ—Ç–æ –¥—Ä—É–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –≤–∞—à–µ–≥–æ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞"],–î—Ä—É–≥–æ–µ:["–ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–æ—á–∫–∞—Ö –≤—Ö–æ–¥–∞"],"–ü–æ–∏—Å–∫–æ–≤–∞—è –≤—ã–¥–∞—á–∞":["–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –Ω–∞ —Å–∞–π—Ç–µ –∏–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Wildberries"],"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç":["–≠—Ç–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ ¬´–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç¬ª"],"–ü—Ä–æ–º–æ–≤—ã–¥–∞—á–∞ —Ç–æ–≤–∞—Ä–æ–≤":["–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ email-—Ä–∞—Å—Å—ã–ª–æ–∫"]};function JW({value:e}){const t=YW[e],s=m.useMemo(()=>t==null?void 0:t.map(o=>n.jsx("p",{children:o},o)),[t]);return s?n.jsx(Oe,{overlay:s,overlayStyle:{maxWidth:300},children:n.jsxs(f,{type:"horizontal",gap:"s",align:"center",children:[n.jsx("span",{children:e}),n.jsx(z.QuestionCircle,{})]})}):n.jsx("span",{children:e})}const ZW="V-HuDFd",XW="wfKf3mo",e8="XcrAV-3",t8="j1U92Dr",s8="jCnvTgU",n8="vADb2Ga",o8="_4pORn-G",a8="KKqlEC2",Ee={openCard:ZW,openCardHeader:XW,openCardFraction:e8,addToCart:t8,addToCartFraction:s8,orders:n8,ordersFraction:o8,openToOrderConversion:a8},r8=()=>[{field:"name",headerName:_e.name,width:400,cellRenderer:JW},{field:"group",headerName:_e.group,cellRenderer:Nb,width:120},{headerName:_e.openCard,headerClass:Ee.openCard,children:[{field:"openCard",headerName:_e.amount,sort:"desc",headerClass:Ee.openCard,cellClass:Ee.openCard,type:["numeric"],width:100},{field:"openCardFraction",headerName:_e.fraction,type:["percent.2"],headerClass:Ee.openCard,cellClass:Ee.openCardFraction,width:100}]},{headerName:_e.addToCart,headerClass:Ee.addToCart,children:[{field:"addToCart",headerName:_e.amount,headerClass:Ee.addToCart,cellClass:Ee.addToCart,width:100,type:["numeric"]},{field:"addToCartFraction",headerName:_e.fraction,headerClass:Ee.addToCart,cellClass:Ee.addToCartFraction,type:["percent.2"],width:100},{field:"openToCartConversion",headerName:_e.openToCartConversion,headerClass:Ee.addToCart,cellClass:Ee.addToCart,type:["percent.2"],width:100}]},{headerName:_e.orders,headerClass:Ee.orders,children:[{field:"orders",headerName:_e.amount,headerClass:Ee.orders,cellClass:Ee.orders,width:100,type:["numeric"]},{field:"ordersFraction",headerName:_e.fraction,headerClass:Ee.orders,cellClass:Ee.ordersFraction,type:["percent.2"],width:100},{field:"cartToOrderConversion",headerName:_e.cartToOrderConversion,headerClass:Ee.orders,cellClass:Ee.orders,type:["percent.2"],width:100}]},{headerName:_e.openToOrderConversion,headerClass:Ee.openToOrderConversion,children:[{field:"openToOrderConversion",headerName:_e.openToOrderConversionCRO,headerClass:Ee.openToOrderConversion,cellClass:Ee.openToOrderConversion,type:["percent.2"],width:150}]}];function i8({gridRef:e,data:t,style:s,maxRowsOnScreen:o}){const a=he($s.view.grid,{withLoad:!0}),r=m.useMemo(()=>r8(),[]),i=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]);return n.jsx(Ce,{gridRef:e,style:s,rowData:t,columnDefs:r,defaultColDef:i,columnsState:a.state,onColumnsStateChanged:a.save,maxRowsOnScreen:o})}const l8=()=>[{field:"priority",headerName:"",hide:!0,sort:"desc",sortIndex:0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0},{field:"group",headerName:_e.group,cellRenderer:Nb},{field:"openCard",headerName:_e.openCard},{field:"addToCart",headerName:_e.addToCart,width:200},{field:"openToCartConversion",headerName:_e.openToCartConversion,type:["percent.2"]},{field:"orders",headerName:_e.orders},{field:"cartToOrderConversion",headerName:_e.cartToOrderConversion,type:["percent.2"]},{field:"openToOrderConversion",headerName:_e.openToOrderConversionCRO,type:["percent.2"]}];function c8({gridRef:e,data:t,style:s,maxRowsOnScreen:o}){const a=he($s.view.gridGroup,{withLoad:!0}),r=m.useMemo(()=>l8(),[]),i=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]);return n.jsx(Ce,{gridRef:e,style:s,rowData:t,columnDefs:r,columnsState:a.state,onColumnsStateChanged:a.save,defaultColDef:i,maxRowsOnScreen:o})}const no={actions:Cr,config:$s,sagas:GW,selectors:QW};function d8(){const e=no.selectors.useGroupedList(),t=Z.selectors.useError(no.config.loading.load);return G.selectors.useLoader(no.config.loading.load)?n.jsx(le,{}):t?n.jsx(ee,{value:t}):!e||e.length===0?n.jsx(dt,{type:"warning",message:"–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞–∏ÃÜ–¥–µ–Ω—ã"}):n.jsx(c8,{data:e,maxRowsOnScreen:5})}function u8(){return n.jsx(f,{type:"vertical",gap:"l",children:n.jsx(d8,{})})}function m8(){const e=no.selectors.useList(),t=Z.selectors.useError(no.config.loading.load);return G.selectors.useLoader(no.config.loading.load)?n.jsx(le,{}):t?n.jsx(ee,{value:t}):!e||e.length===0?n.jsx(dt,{type:"warning",message:"–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞–∏ÃÜ–¥–µ–Ω—ã"}):n.jsx(i8,{data:e,maxRowsOnScreen:11})}function p8(){return n.jsx(f,{type:"vertical",gap:"l",children:n.jsx(m8,{})})}const Hc=k("pages/seller/customer-profile-page"),bg={modelName:Hc(),section:{entryPointStatsView:Hc("entry-point-stats-view"),entryPointGroupStatsView:Hc("entry-point-group-stats-view")}},h8="TIUrtFs",f8={injector:h8};function g8(){const{watcherStart:e,watcherStop:t}=x(no.actions);return m.useEffect(()=>(e(),()=>{t()}),[]),n.jsx(J,{selector:".Customer-profile",append:"before",className:f8.injector,children:n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(xt,{title:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Ç–æ—á–∫–∞–º –≤—Ö–æ–¥–∞",id:bg.section.entryPointStatsView,children:n.jsx(H,{children:n.jsx(p8,{})})}),n.jsx(xt,{title:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Ç—Ä–∞—Ñ–∏–∫–∞",id:bg.section.entryPointGroupStatsView,children:n.jsx(H,{children:n.jsx(u8,{})})})]})})}const Ni=k("feature/seller-sales-funnel-stats"),y8=["openCard","addToCart","orders","ordersSum","buyoutPercent"],w8=["openToCart","cartToOrder","avgPrice","CRO"],S8=["openCard","addToCart","orders","ordersSum","avgPrice","openToCart","cartToOrder","CRO","buyoutPercent"],ye={modelName:Ni(),loading:{load:Ni("load"),showMore:Ni("show-more")},view:{grid:Ni("view/grid")},metrics:{base:y8,calculated:w8,order:S8},gridRowHeight:32,startLimit:20,loadMoreLimit:10,loadMoreRow:{id:"__load_more_button__",height:60}},Ti=Q(ye.modelName),vg={reportParams:null,page:0,showLoadMore:!1,timePeriod:"byDay"},Pb=_({name:ye.modelName,initialState:vg,reducers:{reset:()=>vg,setReportParams:D("reportParams"),setPage:D("page"),setShowLoadMore:D("showLoadMore"),setTimePeriod:D("timePeriod")}}),x8=E.inject(Pb),Gt={...Pb.actions,load:Ti("load"),watcherStart:Ti("watcher-start"),watcherStop:Ti("watcher-stop"),showMore:Ti("show-more")},b8=k("entity/wb/sales-funnel"),ql={modelName:b8(),chunkSize:10},Pi={},Mb=_({name:ql.modelName,initialState:Pi,reducers:{setChartData:Je("chartData"),appendChartData:Fj("chartData"),resetChartData:Le("chartData",Pi.chartData),setProductMeta:Je("productMeta"),appendProductMeta:Je("productMeta"),resetProductMeta:Le("productMeta",Pi.productMeta),reset:()=>Pi}}),v8=E.inject(Mb),Ga={...Mb.actions},Fb=V(ql.modelName,v8),jg=Fb("chartData"),tu=Fb("productMeta"),Cg=$([tu,(e,t)=>t],(e,t)=>t?e==null?void 0:e[t]:void 0),Db={chartData:jg,useChartData:b(jg),productMeta:tu,useProductMeta:b(tu),productMetaById:Cg,useProductMetaById:te(Cg)};function j8(e){const t={},s={};return Object.values(e).forEach(o=>{var a,r,i,l;(a=o==null?void 0:o.data)!=null&&a.chart&&Object.keys(o.data.chart).forEach(c=>{const d=o.data.chart[c];d&&(t[c]||(t[c]=[]),t[c].push(...d))}),(l=(i=(r=o==null?void 0:o.data)==null?void 0:r.groups)==null?void 0:i[0])!=null&&l.itemsGroup&&o.data.groups[0].itemsGroup.forEach(c=>{c.nmId&&(s[c.nmId]={nmId:c.nmId,name:c.name,vendorCode:c.vendorCode,brandName:c.brandName})})}),{chartData:t,productMeta:s}}function*C8({params:e,intercepted:t,append:s=!1}){const{currentPeriod:o,prevPeriod:a,nms:r,brands:i,subjects:l,tagIds:c,orderBy:d,skipDeletedNm:p}=e,h=r||[],g=Vi.chunk(h,ql.chunkSize),y={};for(const[j,q]of g.entries()){const B=`chunk_${j}`;(!t||j>0)&&(y[B]=u([ya,"report"],{nms:q,brands:i,subjects:l,tagIds:c,skipDeletedNm:p,currentPeriod:o,prevPeriod:a,orderBy:d||{field:"addToCart",mode:"desc"}}))}const w=yield I(y);t&&(w.chunk_0=t.data);const C=j8(w);s?(yield S(Ga.appendChartData(C.chartData)),yield S(Ga.appendProductMeta(C.productMeta))):(yield S(Ga.setChartData(C.chartData)),yield S(Ga.setProductMeta(C.productMeta)))}function*$8({params:e}){const t=yield u(()=>ya.reportDetails(e));return Array.isArray(t==null?void 0:t.data)?t.data.map(o=>o.nmId).filter(o=>!!o):[]}function*k8(){const t=yield u(()=>Ar(ya.reportInterceptor));function*s(){return yield ne(t)}return{channel:t,takeEvent:s}}const N8={loadStats:C8,loadDetails:$8,loadReportChannel:k8},T8="vjDeIRh",P8="REItGd0",M8="z7jdmGP",F8="IyqjjfT",D8="tKlrg1e",A8="-Kj3BRO",Vo={container:T8,productImage:P8,link:M8,iconCopy:F8,totalLabel:D8,productName:A8};function L8({value:e}){const t=ge.selectors.useMediaRouteHostsByType("mediabasket_route_map"),s=Db.useProductMetaById(e);if(!e)return null;const o=async i=>{i.preventDefault(),await navigator.clipboard.writeText(e.toString())},a=Co(W.outRoute.marketPlaceProduct,{id:e}),r=`${W.wb.marketPlaceBaseUrl}${a}`;return n.jsx(f,{type:"vertical",justify:"flex-start",align:"flex-start",className:Vo.container,gap:0,children:n.jsxs(f,{type:"vertical",align:"flex-start",gap:0,children:[n.jsx("img",{alt:(s==null?void 0:s.name)||e.toString(),src:va(e,t),className:Vo.productImage}),n.jsx("a",{href:r,className:Vo.link,children:n.jsxs(f,{type:"horizontal",align:"flex-start",children:[n.jsx("span",{children:e}),n.jsx(Oe,{mouseEnterDelay:.4,overlay:"–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞",children:n.jsx("button",{className:Vo.iconCopy,onClick:o,children:n.jsx(z.Copy,{})})})]})}),(s==null?void 0:s.brandName)&&n.jsx("div",{className:Vo.productBrandName,children:s.brandName}),(s==null?void 0:s.name)&&n.jsx("div",{className:Vo.productName,children:s.name})]})})}const R8="J2yQDQk",E8="haf7bbx",$g={container:R8,totalLabel:E8};function _8(){return n.jsx(f,{type:"vertical",justify:"center",align:"center",className:$g.container,children:n.jsx(f,{type:"vertical",align:"center",children:n.jsx("div",{className:$g.totalLabel,children:n.jsx("strong",{children:"–ò—Ç–æ–≥–æ"})})})})}const ha={config:ql,actions:Ga,selectors:Db,sagas:N8},I8={openCard:"openCardCount",addToCart:"addToCartCount",orders:"orderCount",ordersSum:"orderSum",buyoutCount:"buyoutCount",buyoutSum:"buyoutSum",buyoutPercent:"buyoutPercent"};function O8(e){return I8[e]}function V8(e,t){return t===0?e>0?100:0:(e-t)/t*100}function q8(e){const t={};for(const s of ye.metrics.base){t[s]={total:0,days:{}};for(const o of e)t[s].days[o]={current:0,dynamics:0}}return t}function B8(e,t){for(const s of ye.metrics.base)if(e[s])for(let o=0;o<t.length;o++){const a=t[o],r=e[s].days[a];if(r&&o<t.length-1){const i=t[o+1],l=e[s].days[i];if(l){const c=r.current,d=l.current;r.dynamics=V8(c,d)}}}}function Pm(e){return Object.keys(e).sort().reverse()}function Jn(e,t,s=1){return t===0?0:e/t*s}function Kt(e,t){var s;return((s=e==null?void 0:e[t])==null?void 0:s.total)??0}function $r(e,t,s){var o,a,r;return((r=(a=(o=e==null?void 0:e[t])==null?void 0:o.days)==null?void 0:a[s])==null?void 0:r.current)??0}function Ab(e,t,s){const o=$r(e,"openCard",t),a=$r(e,s,t);return Jn(a,o,100)}function W8(e){return Pm(e).map(s=>{var o,a;return{date:s,value:((o=e[s])==null?void 0:o.current)??0,dynamics:((a=e[s])==null?void 0:a.dynamics)??0}})}function Uc(e,t,s=1){return(o,a)=>{const r=$r(o,e,a),i=$r(o,t,a);return Jn(r,i,s)}}function z8(e){return(t,s)=>Ab(t,s,e)}function G8(){return new Date().toISOString().split("T")[0]}function Lb(e,t,s=!0){const o=Pm(e),a=q8(o),r=G8();for(const i of o){const l=e[i]||[];for(const c of ye.metrics.base){const d=O8(c);if(d&&a[c]){const p=t(l,d);i!==r&&(a[c].total+=p),s?a[c].days[i].current+=p:a[c].days[i].current=p}}}if(B8(a,o),a.buyoutPercent&&o.length>0){const i=o.filter(c=>c!==r),l=i.length>0?i.length:1;a.buyoutPercent.total=a.buyoutPercent.total/l}return a}function kg(e,t){return Lb(t,(s,o)=>{const a=s.find(r=>r.nmId===e);return a&&a[o]||0},!1)}function K8(e){return Lb(e,(s,o)=>{if(o==="buyoutPercent"){const a=s.filter(i=>i.nmId&&i.nmId!==-1);return a.length===0?0:a.reduce((i,l)=>i+(l[o]||0),0)/a.length}return s.filter(a=>a.nmId&&a.nmId!==-1).reduce((a,r)=>a+(r[o]||0),0)},!0)}const H8={openToCart:{totalCalculator:e=>Jn(Kt(e,"addToCart"),Kt(e,"openCard"),100),dailyCalculator:Uc("addToCart","openCard",100)},cartToOrder:{totalCalculator:e=>Jn(Kt(e,"orders"),Kt(e,"addToCart"),100),dailyCalculator:Uc("orders","addToCart",100)},avgPrice:{totalCalculator:e=>Jn(Kt(e,"ordersSum"),Kt(e,"orders")),dailyCalculator:Uc("ordersSum","orders")},CRO:{totalCalculator:e=>Jn(Kt(e,"orders"),Kt(e,"openCard"),100),dailyCalculator:z8("orders")},CRP:{totalCalculator:e=>{const t=Jn(Kt(e,"orders"),Kt(e,"openCard"),100),s=Kt(e,"buyoutPercent");return t*s/100},dailyCalculator:(e,t)=>{const s=Ab(e,t,"orders"),o=$r(e,"buyoutPercent",t);return s*o/100}}};function Ng(e,t,s){var i;const o=Pm(s),a=H8[e];if(a){const l=a.totalCalculator(t),c=o.map((d,p,h)=>{const g=a.dailyCalculator(t,d);let y=0;if(p<h.length-1){const w=h[p+1],C=a.dailyCalculator(t,w);C===0?y=g>0?100:0:y=(g-C)/C*100}return{date:d,value:g,dynamics:y}});return{totalValue:l,days:c}}const r=((i=t==null?void 0:t[e])==null?void 0:i.days)??{};return{totalValue:Kt(t,e),days:W8(r)}}const U8={addToCart:{dynamics:e=>v.percent(e,{fraction:0})},openCard:{dynamics:e=>v.percent(e,{fraction:0})},orders:{dynamics:e=>v.percent(e,{fraction:0})},buyoutCount:{dynamics:e=>v.percent(e,{fraction:0})},buyoutPercent:{value:e=>v.percent(e,{fraction:0}),dynamics:e=>v.percent(e,{fraction:0})},openToCart:{value:e=>v.percent(e,{fraction:0}),dynamics:e=>v.percent(e,{fraction:0})},cartToOrder:{value:e=>v.percent(e,{fraction:0}),dynamics:e=>v.percent(e,{fraction:0})},ordersSum:{value:e=>v.currency(e,{fraction:0}),dynamics:e=>v.percent(e,{fraction:0})},buyoutSum:{value:e=>v.currency(e,{fraction:0}),dynamics:e=>v.percent(e,{fraction:0})},avgPrice:{value:e=>v.currency(e,{fraction:0}),dynamics:e=>v.percent(e,{fraction:0})},CRO:{value:e=>v.percent(e,{fraction:2}),dynamics:e=>v.percent(e,{fraction:2})},CRP:{value:e=>v.percent(e,{fraction:2}),dynamics:e=>v.percent(e,{fraction:2})}},al=(e,t,s)=>{if(!t)return"0";const o=U8[e];return s&&(o!=null&&o.dynamics)?o.dynamics(t):!s&&(o!=null&&o.value)?o.value(t):v.numeric(t,{fraction:0})},Tg={openCard:"–ü–µ—Ä–µ—Ö–æ–¥—ã",addToCart:"–ö–æ—Ä–∑–∏–Ω—ã",orders:"–ó–∞–∫–∞–∑—ã, —à—Ç.",ordersSum:"–ó–∞–∫–∞–∑—ã, ‚ÇΩ",avgPrice:"–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞",buyoutCount:"–í—ã–∫—É–ø–∏–ª–∏ —Ç–æ–≤–∞—Ä–æ–≤",buyoutSum:"–í—ã–∫—É–ø–∏–ª–∏ –Ω–∞ —Å—É–º–º—É",buyoutPercent:"% –≤—ã–∫—É–ø–∞",openToCart:"CR –≤ –∫–æ—Ä–∑–∏–Ω—É",cartToOrder:"CR –≤ –∑–∞–∫–∞–∑",CRO:"CRO",CRP:"CRP"},Q8=e=>{var a,r,i;const{column:t,value:s}=e;if((a=t.getColDef().field)!=null&&a.startsWith("day_")){const l=(i=(r=e.node)==null?void 0:r.data)==null?void 0:i.name;return l&&(s==null?void 0:s.value)!==void 0?al(l,s.value).replace(/[^\d.,]/g,""):s==null?void 0:s.value}return Cn(e)};function Y8(e){var r;const t=Vi.chain(e).values().flatMap().map("nmId").filter(i=>!!(i&&i!==-1)).uniq().value();if(t.length===0)return[];const s=[];if(t.length>1){const i=K8(e);for(const l of ye.metrics.order){const{totalValue:c,days:d}=Ng(l,i,e);s.push({id:`total-${l}`,nm:-1,name:l,totalValue:c,days:d,isTotal:!0})}}const o={};for(const i of t){const l=kg(i,e);o[i]=((r=l.ordersSum)==null?void 0:r.total)||0}const a=Vi.chain(t).orderBy(i=>o[i],"desc").value();for(const i of a){const l=kg(i,e);for(const c of ye.metrics.order){const{totalValue:d,days:p}=Ng(c,l,e);s.push({id:`${i}-${c}`,nm:i,name:c,totalValue:d,days:p,isTotal:!1})}}return s}const Bl=V(ye.modelName,x8),Pg=Bl("reportParams"),Mg=Bl("page"),J8=Bl("showLoadMore"),su=Bl("timePeriod"),Rb=$([ha.selectors.chartData,su],(e,t)=>{if(!e||!t)return[];const s=e[t];if(!s)return[];const o={};return s.forEach(a=>{a.date&&(o[a.date]||(o[a.date]=[]),o[a.date].push(a))}),Y8(o)}),Z8=$(Rb,J8,(e,t)=>{if(!e)return[];const s=[...e];if(t){const o={id:ye.loadMoreRow.id,isLoadMore:!0,visible:t};s.push(o)}return s}),nu={useReportParams:b(Pg),useGridData:b(Rb),useGridRowData:b(Z8),usePage:b(Mg),useTimePeriod:b(su),reportParams:Pg,page:Mg,timePeriod:su};function*X8(e){yield S(Gt.setReportParams(e));const t={params:e};yield u(ha.sagas.loadStats,t)}function*ez(){var s,o,a,r;const{channel:e,takeEvent:t}=yield u(ha.sagas.loadReportChannel);try{for(;;){const{event:i}=yield ls({event:u(t),canceled:ne(Gt.watcherStop)});if(!i)break;const{request:l,response:c}=i,d=l.body;let p=d.nms||[],h=(r=(a=(o=(s=c==null?void 0:c.data)==null?void 0:s.data)==null?void 0:o.groups)==null?void 0:a[0])==null?void 0:r.itemsGroup;if(h=Vi.orderBy(h,["ordersSum.current"],["desc"]),h=h==null?void 0:h.slice(0,ye.startLimit),p.length===0&&h){const g=[];for(const y of h)y.nmId&&y.nmId!==0&&g.push(y.nmId);p=g}yield S(Gt.setShowLoadMore((h==null?void 0:h.length)===ye.startLimit)),yield S(ha.actions.reset()),yield S(Gt.load({...d,nms:p})),yield S(Gt.setPage(0))}}finally{e.close()}}function*Eb(){const e=yield F(nu.reportParams);if(!e)return;const s=(yield F(nu.page))+1,o={params:{...e,nms:[],limit:ye.loadMoreLimit,offset:ye.startLimit+ye.loadMoreLimit*(s-1)}},a=yield u(ha.sagas.loadDetails,o);if(a.length===0){yield S(Gt.setShowLoadMore(!1));return}a.length<ye.loadMoreLimit&&(yield S(Gt.setShowLoadMore(!1)));const r={params:{...e,nms:a},append:!0};yield u(ha.sagas.loadStats,r),yield S(Gt.setPage(s))}function*tz(){yield I([N(Gt.watcherStart,T(ez,[M,O(ye.loading.load),L(ye.loading.load)])),N(Gt.load,T(X8,[M,O(ye.loading.load),L(ye.loading.load)])),N(Gt.showMore,T(Eb,[O(ye.loading.showMore),L(ye.loading.showMore)]))])}K(ye.modelName,tz);const sz={showMore:Eb},nz="vxt73Vb",oz="HvGXlHS",Qc={trend:nz,value:oz};function az({data:e,value:t}){if(!e||Ot(e))return null;const s=al(e.name,t==null?void 0:t.value);return t!=null&&t.dynamics?n.jsxs(f,{align:"center",gap:"s",wrap:!1,children:[n.jsx("span",{className:Qc.value,children:s}),n.jsx("sup",{className:Qc.trend,children:n.jsx(so,{value:t.dynamics,formatter:o=>al(e.name,o,!0),showSign:!1})})]}):n.jsx("span",{className:Qc.value,children:s})}const rz="K1UBsZI",iz={loadMoreButtonRow:rz};function lz(){const{showMore:e}=x(Gt),t=G.selectors.useLoader(ye.loading.showMore),s=m.useCallback(()=>{e()},[e]);return n.jsx(f,{type:"horizontal",justify:"center",align:"center",className:iz.loadMoreButtonRow,children:n.jsx(A,{onClick:s,type:"purple",size:"default",isLoading:t,children:"–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ —Ç–æ–≤–∞—Ä—ã"})})}const cz="/assets/_FvPOxBv.png",dz="/assets/B5CqHqjA.png",uz=chrome.runtime.getURL(cz),mz=chrome.runtime.getURL(dz),pz="cECUozA",hz="aeVEZwI",fz="weYo710",gz="dqgdwyb",yz="pv-CFng",wz="_6mKhWzu",hn={lastChildRow:pz,accentRow:hz,orderSumRow:fz,totalRow:gz,loadMoreCell:yz,dayCell:wz},Mi=e=>e&&"name"in e,Ot=e=>e&&"isLoadMore"in e&&e.isLoadMore,Sz=[{headerName:"–ê—Ä—Ç–∏–∫—É–ª",field:"nm",enableRowGroup:!0,rowGroup:!0,hide:!0,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,suppressHeaderContextMenu:!0},{headerName:"–ê—Ä—Ç–∏–∫—É–ª",field:"nm",pinned:"left",cellRendererSelector:({node:e,data:t})=>{if(Ot(t))return{component:lz};if(e.childIndex===0)return t!=null&&t.isTotal?{component:_8}:{component:L8}},colSpan:({data:e})=>Ot(e)?2:1,rowSpan:({node:e,data:t})=>{var o,a;if(Ot(t))return 1;const s=(a=(o=e==null?void 0:e.parent)==null?void 0:o.childrenAfterFilter)==null?void 0:a.length;return(e==null?void 0:e.childIndex)===0&&s&&s>0?s:1},cellStyle:{padding:0}},{headerName:"–ú–µ—Ç—Ä–∏–∫–∞",field:"name",pinned:"left",width:125,valueFormatter:e=>{if(!e.data||Ot(e.data))return"";const t=e.value;return t&&Tg[t]?Tg[t]:""}},{headerName:"–ó–∞ –ø–µ—Ä–∏–æ–¥",field:"totalValue",valueFormatter:e=>!e.data||Ot(e.data)?"":al(e.data.name,e.data.totalValue),width:130,cellClass:e=>Ot(e.data)?hn.loadMoreCell:"",cellStyle:e=>Ot(e.data)?{backgroundImage:`url(${mz})`}:{backgroundColor:"var(--evirma-wb-color-black-004)"}}];function xz({gridRef:e,data:t,style:s,onSelected:o,maxRowsOnScreen:a}){const r=he(ye.view.grid),i=m.useRef(null),l=e||i,c=m.useMemo(()=>{var B;const j=t.filter(Mi);return(B=j==null?void 0:j[0])!=null&&B.days?j[0].days.map((X,U)=>({field:`day_${X.date}`,headerName:v.dateShort(X.date),valueGetter:({data:fe})=>{if(!Ot(fe))return fe==null?void 0:fe.days[U]},width:140,cellRenderer:az,cellClass:({data:fe})=>Ot(fe)?hn.loadMoreCell:hn.dayCell,cellStyle:({data:fe})=>{if(Ot(fe))return{backgroundImage:`url(${uz})`}}})):[]},[t]),d=m.useMemo(()=>[...Sz,...c],[c]),p=m.useMemo(()=>({filter:!1,suppressMovable:!0}),[]),h=m.useCallback(j=>{o&&o(j.api.getSelectedRows())},[o]),g=m.useCallback(j=>{r.save(j.filter(q=>!q.colId.startsWith("day_")))},[]),y=m.useMemo(()=>({fileName:`${ye.modelName}`,processCellCallback:Q8}),[]),w=m.useMemo(()=>({[hn.lastChildRow]:j=>!!j.node.lastChild,[hn.accentRow]:j=>Mi(j.data)&&j.data.name==="openToCart",[hn.orderSumRow]:j=>Mi(j.data)&&j.data.name==="ordersSum",[hn.totalRow]:j=>Mi(j.data)&&!!j.data.isTotal,[hn.loadMoreRow]:j=>Ot(j.data)}),[]),C=m.useCallback(j=>Ot(j.data)?ye.gridRowHeight*4:j.node.lastChild?ye.gridRowHeight+10:ye.gridRowHeight,[]);return n.jsx(Ce,{isCompact:!0,gridRef:l,style:s,rowData:t,columnDefs:d,defaultColDef:p,rowSelection:"multiple",suppressRowClickSelection:!0,onSelectionChanged:h,onColumnsStateChanged:g,maxRowsOnScreen:a,defaultExcelExportParams:y,processCellForClipboard:y.processCellCallback,rowHeight:ye.gridRowHeight,getRowHeight:C,rowClassRules:w,groupDisplayType:"groupRows",groupHideOpenParents:!0,groupDefaultExpanded:-1,suppressRowTransform:!0,suppressScrollOnNewData:!0})}const Xo={actions:Gt,config:ye,sagas:sz,selectors:nu};function bz(){const e=Xo.selectors.useGridData(),t=Xo.selectors.useGridRowData(),s=Z.selectors.useError(Xo.config.loading.load);return G.selectors.useLoader(Xo.config.loading.load)?n.jsx(le,{}):s?n.jsx(ee,{value:s}):!e||e.length===0?n.jsx(dt,{type:"warning",message:"–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"}):n.jsx(xz,{data:t,maxRowsOnScreen:20})}const vz=[{value:"byDay",label:"–ü–æ –¥–Ω—è–º"},{value:"byWeek",label:"–ü–æ –Ω–µ–¥–µ–ª—è–º"},{value:"byMonth",label:"–ü–æ –º–µ—Å—è—Ü–∞–º"}];function jz(){const e=Xo.selectors.useTimePeriod(),{watcherStart:t,watcherStop:s,reset:o,setTimePeriod:a}=x(Xo.actions);return Ae.useEffect(()=>(t(),()=>{s(),o()}),[t,s,o]),n.jsxs(f,{type:"vertical",children:[n.jsx(cx,{options:vz,value:e||"byDay",onChange:a}),n.jsx(bz,{})]})}const Cz="KIu9e9B",$z={injector:Cz};function kz(){return n.jsx(J,{selector:".Compare-with-period__table-wrapper__YMhYF6F6TD",append:"before",className:$z.injector,children:n.jsx(f,{type:"vertical",gap:"l",children:n.jsx(fr,{title:"–í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –¥–Ω—è–º",id:"sales-funnel-stats-view",children:n.jsx(H,{children:n.jsx(jz,{})})})})})}function Nz(){const{watcherStart:e,watcherStop:t}=x(km.actions);return m.useEffect(()=>(e(),()=>{t()}),[]),null}const Tz="YcuDY64",Pz="qX6lZpv",Mz={balance:Tz,wide:Pz};function Fz(){return n.jsx(J,{selector:"."+CSS.escape("CardsList__column-grid__-uswchxvXR"),className:P(Mz.wide),children:n.jsx(VI,{})})}const Dz="WLgxe79",Az="n7CnT8b",Lz="KS7yvKX",Rz="jdBQygK",Ez="HqioODW",_z="_5Q4cQvZ",Iz="iqjQC6E",Oz="eehL-Zv",Vz="hq80sHx",qz="A3sfefN",Bz="_9Xaoy0J",Wz="PZc8Lml",It={root:Dz,audit:Az,balance:Lz,feedbacksTarget:Rz,feedbacks:Ez,tariffConstructorTarget:_z,discountsTarget:Iz,paymentHistoryTarget:Oz,financialStatements:Vz,stocksManagement:qz,noWarehouses:Bz,endPosition:Wz};function zz(){return n.jsxs(n.Fragment,{children:[n.jsxs(Se,{exact:!0,path:"/",children:[n.jsx(J,{selector:"."+CSS.escape("StatsHeader__tabs__Tr+pzxpABT"),targetClassName:P(It.root,It.audit),append:"last",children:n.jsx(We,{bannerId:"finance-order",showAppLogo:!1,children:"–û—Ü–∏—Ñ—Ä–æ–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å"})}),n.jsx(Fz,{})]}),n.jsx(Se,{path:"/feedbacks/feedbacks-tab/not-answered",children:n.jsx(J,{selector:".Not-answered-feedbacks-top-panel__iGMSzlIZC3",append:"first",targetClassName:P(It.feedbacksTarget),className:P(It.feedbacks),children:n.jsx(We,{bannerId:"avtootvet",children:"–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—ã"})})}),n.jsx(Se,{path:"/new-goods/card",children:n.jsx(J,{selector:".Card-form__widgets__DwXkOLaW5\\+",append:"first",children:n.jsx(We,{bannerId:"ai24",display:"block",children:"–£–ª—É—á—à–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"})})}),n.jsx(Se,{path:"/new-goods/all-goods",children:n.jsx(J,{selector:".All-goods__header-wrapper__5VaATNcfGZ",className:P(It.endPosition),children:n.jsx(We,{bannerId:"ai24-all-goods",children:"–£–ª—É—á—à–∏—Ç—å —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞"})})}),n.jsx(Se,{path:"/product-card-a-b",children:n.jsx(J,{selector:".Header__help-block__JZhibhxLP8",append:"first",children:n.jsx(We,{bannerId:"ai24-a-b",children:"–°–æ–∑–¥–∞—Ç—å —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞"})})}),n.jsx(Se,{path:"/supplies-management",children:n.jsx(J,{selector:".Main-layout__title-content-right__kvFg\\+NAKN9",append:"first",children:n.jsx(We,{bannerId:"prognoz-postavok",children:"–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ—Å—Ç–∞–≤–æ–∫"})})}),n.jsx(Se,{path:"/popular-search-requests",children:n.jsx(J,{selector:".Requests-table-view__select__CKK9WZaRpz",append:"after",children:n.jsx(We,{bannerId:"konkurent",children:"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"})})}),n.jsx(Se,{path:"/tariff-constructor",children:n.jsx(J,{selector:".Home-page__segment-buttons-wrapper__fj\\+H\\+kVdES",targetClassName:It.tariffConstructorTarget,children:n.jsx(We,{bannerId:"schet-dlya-sellerov",children:"–°—á–µ—Ç –¥–ª—è —Å–µ–ª–ª–µ—Ä–∞"})})}),n.jsxs(Se,{path:"/marketplace-stocks-management",children:[n.jsx(J,{selector:".Remains-of-goods-view__actions__WZgjz0wm4P",children:n.jsx(We,{bannerId:"obnovit-ostatki",children:"–û–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"})}),n.jsx(J,{selector:".No-data__buttons__YRUxiY\\+ofh",children:n.jsx(We,{bannerId:"obnovit-ostatki",children:"–û–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"})}),n.jsx(J,{selector:".No-warehouses__button",targetClassName:P(It.stocksManagement,It.noWarehouses),children:n.jsx(We,{bannerId:"obnovit-ostatki",children:"–û–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"})})]}),n.jsx(Se,{path:"/discount-and-prices",children:n.jsx(J,{selector:".controls__top-row__zyfhGvC3Gd",targetClassName:It.discountsTarget,children:n.jsx(We,{bannerId:"marzhinalnost",children:"–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å"})})}),n.jsx(Se,{path:"/payment-history/active",children:n.jsx(J,{selector:".Main-Layout__tabs-content__RUbEoHK3J5",targetClassName:It.paymentHistoryTarget,children:n.jsx(We,{bannerId:"schet-dlya-sellerov",children:"–°—á–µ—Ç –¥–ª—è —Å–µ–ª–ª–µ—Ä–∞"})})}),n.jsx(Se,{path:"/suppliers-mutual-settlements/reports-implementations/reports-weekly-new",children:n.jsx(J,{selector:".Main-tabs-layout__tabs-container__MP8yPSwNk8",targetClassName:It.financialStatements,children:n.jsx(We,{bannerId:"nalog",children:"–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –Ω–∞–ª–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"})})}),n.jsx(Se,{path:"/marketplace-orders-fbs/new-tasks",children:n.jsx(J,{selector:"."+CSS.escape("Body__OiiBZF+8bx"),className:P(It.endPosition),children:n.jsx(We,{bannerId:"sborka-zakazov-fbs",children:"–°–æ–±—Ä–∞—Ç—å –≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ"})})}),n.jsx(Se,{path:"/monetization/jam",children:n.jsx(J,{selector:"."+CSS.escape("Subscription__container__K60JxUjaj7"),className:P(It.endPosition),children:n.jsx(We,{bannerId:"finance-order-jam",children:"–û—Ü–µ–Ω–∏—Ç—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å"})})})]})}function Gz(){return n.jsxs(n.Fragment,{children:[n.jsxs(au,{children:[n.jsx(Se,{exact:!0,path:"/",children:n.jsx(Nz,{})}),n.jsxs(Se,{path:"/content-analytics",children:[n.jsx(PW,{}),n.jsxs(Se,{path:"/content-analytics/customer-profile",children:[n.jsx(g8,{}),n.jsx(Gi,{}),n.jsx(zi,{})]}),n.jsx(Se,{path:"/content-analytics/interactive-report/main",children:n.jsx(hW,{})}),n.jsx(Se,{path:"/content-analytics/history-remains",children:n.jsx(pW,{})}),n.jsx(Se,{path:"/content-analytics/interactive-report",children:n.jsx(kz,{})}),n.jsx(Se,{path:"/content-analytics/deliveries-by-region",children:n.jsx(lW,{})})]}),n.jsx(Se,{path:"/prices-index",children:n.jsx(yW,{})})]}),n.jsx(zz,{}),n.jsxs(H,{fallback:Qt,children:[n.jsx(wW,{}),n.jsx(iW,{})]})]})}function Kz(){const[e,t]=m.useState([]),s=Fn([".autocomplete__scroll-container"]),o=a=>{const r=[];a==null||a.querySelectorAll(".autocomplete__item").forEach(i=>{var d;const l=i.querySelector(".autocomplete__phrase");if(!l)return;const c=(d=l.textContent)==null?void 0:d.toLowerCase();c&&r.push({el:l,data:{keyword:c}})}),t(r)};return m.useEffect(()=>{o(s);const a=new MutationObserver(()=>{o(s)});return s&&a.observe(s,{childList:!0}),()=>{a.disconnect()}},[s]),{items:e}}const Hz="_2gcgV2h",Uz="_5Kl0A8v",Fg={injector:Hz,wrapper:Uz};function Qz(){const{items:e}=Kz(),{loadCustom:t}=x(wo.actions);return m.useEffect(()=>{t(e.map(({data:s})=>s.keyword))},[e]),n.jsx(n.Fragment,{children:e.map(({el:s,data:o})=>n.jsx(Ps,{targetElement:s,append:"after",className:Fg.injector,children:n.jsx(GS,{keyword:o.keyword,className:Fg.wrapper})},o.keyword))})}const Yc=k("feature/wb-recommendations-product-stats"),aa={modelName:Yc(),loading:{load:Yc("load")},view:{grid:Yc("view/grid")}},Yz=Q(aa.modelName),_b={load:Yz("load")};function*Jz({nm:e}){const t=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.loadRecommendations,{nm:e,dest:t})}function*Zz(){yield I([N(_b.load,T(Jz,[M,vt([aa.view.grid]),O(aa.loading.load),L(aa.loading.load)]))])}K(aa.modelName,Zz);const Xz={},e6=e=>t=>({...t,count:Math.round(t.count/e*100)});function t6(e){const t=Object.values(e||{});if(t.length===0)return;const s={promoType:Wa.promoType()},o=Object.values(s);t.forEach(r=>{o.forEach(i=>i.process(r))});const a=e6(t.length);return{promoType:s.promoType.result().map(a)}}const Wl=Pe.selectors.recommendations,s6=$([Wl],e=>e==null?void 0:e.filter(({position:t})=>t.promoPosition)),n6=$([Wl],e=>{if(e)return e.reduce((t,s)=>(t[s.id]=s,t),{})}),o6=$([Wl],e=>t6(e)),a6={usePromotionList:b(s6),useList:b(Wl),useData:b(n6),useAggregated:b(o6)},Zn={actions:_b,config:aa,sagas:Xz,selectors:a6},Fi=k("feature/wb-search-supplier-product-stats"),st={modelName:Fi(),loading:{load:Fi("load"),loadRecommendations:Fi("load-recommendations")},view:{grid:Fi("view/grid")},pagesLimit:{current:3,all:20}},Dg={},Ib=_({name:st.modelName,initialState:Dg,reducers:{setPagesFilter:D("pagesFilter"),reset:()=>Dg}}),r6=E.inject(Ib),Jc=Q(st.modelName),oo={...Ib.actions,load:Jc("load"),loadAll:Jc("load-all"),loadRecommendations:Jc("load-recommendations")};function*i6({query:e}){yield S(oo.setPagesFilter("current"));const t=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.search,{query:e,page:1,dest:t,pageLimit:st.pagesLimit.current})}function*l6({query:e}){yield S(oo.setPagesFilter("all"));const t=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.search,{query:e,page:1,dest:t,pageLimit:st.pagesLimit.all})}function*c6({nm:e}){const t=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.loadRecommendations,{nm:e,dest:t})}function*d6(){yield I([N(oo.load,T(i6,[M,vt([st.view.grid]),O(st.loading.load),L(st.loading.load)])),N(oo.loadAll,T(l6,[M,O(st.loading.load),L(st.loading.load)])),N(oo.loadRecommendations,T(c6,[M,vt([st.view.grid]),O(st.loading.loadRecommendations),L(st.loading.loadRecommendations)]))])}K(st.modelName,d6);const u6={};function zl({stats:e,pages:t,suppliers:s,products:o}){const a=[];return t.forEach(r=>{var i;(i=e==null?void 0:e[r])==null||i.forEach(l=>{const c=o[l.id],d=s==null?void 0:s.find(({oldId:p})=>p===(c==null?void 0:c.supplierId));a.push({...l,supplier:d})})}),a}const m6=V(st.modelName,r6),Ob=m6("pagesFilter"),p6=$([Ob,(e,t)=>t],(e,t)=>e==="current"?Array.from({length:st.pagesLimit.current}).map((s,o)=>t+o):Array.from({length:st.pagesLimit.all}).map((s,o)=>o+1)),h6=$([p6,Pe.selectors.list,ie.selectors.list,yo.selectors.products],(e,t,s,o)=>zl({stats:t,pages:e,suppliers:s,products:o}).filter(r=>r.supplier)),f6=$([(e,t)=>t,Pe.selectors.list,ie.selectors.list,yo.selectors.products],(e,t,s,o)=>zl({stats:t,pages:[e],suppliers:s,products:o})),g6=$([Pe.selectors.recommendations,ie.selectors.list,yo.selectors.products],(e,t,s)=>zl({stats:{1:e},pages:[1],suppliers:t,products:s}).filter(a=>a.supplier)),y6=$([Pe.selectors.recommendations,ie.selectors.list,yo.selectors.products],(e,t,s)=>zl({stats:{1:e},pages:[1],suppliers:t,products:s})),Vb={usePagesFilter:b(Ob),useData:te(h6),useRecommendationsData:b(g6),useUnfilteredData:te(f6),useUnfilteredRecommendationsData:b(y6)},w6="fI95Uag",S6="RR-UiTP",Ag={promoName:w6,article:S6},x6=({extendedColumnDefs:e})=>[{field:"id",headerName:me.id,cellRenderer:Vr,width:180,cellClass:Ag.article},{field:"brand",headerName:me.brand,width:130},{field:"name",headerName:me.name,width:200},{colId:"promoType",field:"position.promoType",headerName:me.position.promoType,cellRenderer:Sl,filter:"agTextColumnFilter",suppressHeaderFilterButton:!0,width:100},{field:"position.organicPosition",type:["numeric","rightAligned"],headerName:me.position.organicPosition,width:80},{colId:"arrow",type:["numeric","rightAligned"],headerName:"‚Üí",valueGetter:()=>"‚Üí",width:46},{field:"position.promoPosition",type:["numeric"],headerName:me.position.promoPosition,width:80},{field:"position.promoCpm",type:["numeric","rightAligned"],headerName:me.position.promoCpm,width:80},{field:"promoTextCat",headerName:me.promoName,width:170,cellClass:Ag.promoName},{field:"supplier",headerName:"–ö–∞–±–∏–Ω–µ—Ç",valueGetter:s=>{var o,a;return(a=(o=s.data)==null?void 0:o.supplier)==null?void 0:a.name},filter:"agSetColumnFilter",width:170},e==null?void 0:e.actions].filter(Tn);function qb({data:e,gridRef:t,style:s,onFirstRender:o,extendedColumnDefs:a,maxRowsOnScreen:r}){const i=he(st.view.grid),l=m.useMemo(()=>x6({extendedColumnDefs:a}),[a]),c=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]),d=m.useCallback(p=>String(p.data.id),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:l,defaultColDef:c,columnsState:i.state,onColumnsStateChanged:i.save,onFirstDataRendered:o,getRowId:d,maxRowsOnScreen:r})}function b6({query:e}){const{loadAll:t}=x(oo);return Vb.usePagesFilter()==="all"?null:n.jsxs(A,{type:"purple",size:"small",onClick:()=>t({query:e}),children:["–ê–Ω–∞–ª–∏–∑–∏p–æ–≤–∞—Ç—å ",st.pagesLimit.all," —Å—Ç—Ä–∞–Ω–∏—Ü"]})}const v6="yBf4TF3",j6="_3OxYZrL",Lg={card:v6,previewContainer:j6},C6="_1s-zWeu",$6="_9VzYBOO",k6="SDUjvhU",N6="kLKxrG6",T6="UbDsM8L",Ka={previewItem:C6,defaultColors:$6,supplierItem:k6,gavelIcon:N6,crownIcon:T6},P6=n.jsx(z.Crown,{className:Ka.crownIcon});function M6({item:e}){var a;const t={c:n.jsx(z.Gavel,{className:Ka.gavelIcon}),b:n.jsx("span",{children:"A"}),unknown:n.jsx("span",{children:"?"})},s=(a=e.position)==null?void 0:a.promoType;let o=s?t[s]:null;return e.supplier&&(o=P6),n.jsx("div",{className:P(Ka.previewItem,{[Ka.defaultColors]:!s,[Ka.supplierItem]:!!e.supplier},fl(s)),children:o})}function F6({data:e,className:t}){return n.jsx(Da,{className:P(t,Lg.card),children:n.jsx("div",{className:Lg.previewContainer,children:e.map(s=>n.jsx(M6,{item:s},s.id))})})}const rt={actions:oo,config:st,sagas:u6,selectors:Vb},D6="wWPsWVt",A6={button:D6};function Zc({nm:e}){const t=()=>{var o;const s=`${W.evirma.bot}=${e}`;(o=window.open(s,"_blank"))==null||o.focus()};return n.jsx(A,{type:"blue",className:A6.button,onClick:t,children:n.jsxs(f,{align:"center",children:[n.jsx(bt,{}),"–£–∑–Ω–∞—Ç—å –°–ü–ü"]})})}const L6="cLiaTY2",R6="YWg7vNv",Xc={block:L6,inlineBlock:R6};function E6({nm:e}){return n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:".product-page__aside .product-page__price-block",append:"after",className:Xc.block,children:n.jsx(Zc,{nm:e})}),n.jsx(J,{selector:".product-page__grid .product-page__price-block .product-page__price-block-wrap",append:"after",className:Xc.block,children:n.jsx(Zc,{nm:e})}),n.jsx(J,{selector:".product-page__grid .product-page__top-blocks .product-page__price-block-wrap",append:"after",className:Xc.inlineBlock,children:n.jsx(Zc,{nm:e})})]})}const _6="NKNF0CF",I6="yrWzm7x",Rg={sizeInfo:_6,zero:I6};function O6({nm:e,size:t}){const s=ct.selectors.useData(e),o=G.selectors.useLoader(ct.config.loading.load),a=s==null?void 0:s.sizes[t];return o?n.jsx(at,{width:"fill"}):a?n.jsx(be,{type:"info",className:P(Rg.sizeInfo,{[Rg.zero]:a.quantity===0}),children:v.quantity(a.quantity)}):null}function V6(){const[e,t]=m.useState([]),s=Fn(".product-page__sizes-wrap .sizes-list"),o=a=>{const r=[];a&&(a.querySelectorAll("li.sizes-list__item").forEach(i=>{const l=i.querySelector(".sizes-list__size"),c=l==null?void 0:l.textContent;c&&r.push({el:i,data:{size:c}})}),a.style.maxHeight="max-content",t(r))};return m.useEffect(()=>{o(s);const a=new MutationObserver(()=>{o(s)});return s&&a.observe(s,{childList:!0}),()=>{a.disconnect()}},[s]),{items:e}}const q6="pjjmjNN",B6={size:q6};function W6({nm:e}){const{items:t}=V6();return n.jsx(n.Fragment,{children:t.map(({el:s,data:o})=>n.jsx(Ps,{targetElement:s,className:B6.size,children:n.jsx(O6,{nm:e,size:o.size})},o.size))})}const z6="eUqgNik",G6="fo8h2SS",K6="kowMI1z",H6="d22CGiZ",U6="E0KW9Og",Q6="ha1IJld",Y6="IRGASrv",J6="oe74dnC",Z6="tcNMh9y",X6="VxotmGh",es={table:z6,warehouse:G6,label:K6,size:H6,oddRow:U6,hours:Q6,sizeLabel:Y6,value:J6,arrow:Z6,expanded:X6},eG=k("widget/wb-product-warehouses-injector"),Bb={modelName:eG()},Eg={expanded:{}},Wb=_({name:Bb.modelName,initialState:Eg,reducers:{setExpanded:Je("expanded"),reset:()=>Eg}}),tG=E.inject(Wb),sG={...Wb.actions},nG=V(Bb.modelName,tG),oG=nG("expanded"),aG={useExpanded:b(oG)};function rG({nm:e}){const{setExpanded:t}=x(sG),s=aG.useExpanded(),o=ct.selectors.useDataQuantity(e),a=G.selectors.useLoader(ct.config.loading.load),r=i=>{t({[i]:!s[i]})};return a?n.jsx(n.Fragment,{children:Array.from({length:5}).map((i,l)=>n.jsx(at,{width:"random"},l))}):n.jsx("table",{className:es.table,children:n.jsx("tbody",{children:o.map(({warehouse:i,quantity:l,deliveryTime:c,sizes:d})=>n.jsxs(m.Fragment,{children:[n.jsxs("tr",{className:es.warehouse,children:[n.jsx("td",{children:n.jsx("button",{onClick:()=>r(i.id),children:n.jsx("span",{className:P(es.arrow,{[es.expanded]:s[i.id]})})})}),n.jsx("td",{className:es.label,onClick:()=>r(i.id),children:n.jsx(jt,{suffix:n.jsx("span",{className:es.hours,children:v.hours(c)}),children:i.name})}),n.jsx("td",{className:es.value,onClick:()=>r(i.id),children:v.quantity(l)})]},i.id),s[i.id]?d.map(({name:p,origName:h,quantity:g},y)=>n.jsxs("tr",{className:P(es.size,{[es.oddRow]:!(y%2)}),children:[n.jsx("td",{}),n.jsx("td",{className:es.sizeLabel,children:n.jsx(jt,{suffix:p!==h?p:void 0,children:h})}),n.jsx("td",{className:es.value,children:v.quantity(g)})]},`${i.id}-${p}`)):null]},i.id))})})}const iG="Zl8gO1r",lG="-Qdt8AU",_g={block:iG,blockAside:lG};function cG({nm:e}){const t=n.jsxs(f,{type:"vertical",children:[n.jsx(L_,{children:n.jsxs(f,{align:"center",children:[n.jsx(bt,{}),"–†–∞—Å–∫–ª–∞–¥–∫–∞ –ø–æ —Å–∫–ª–∞–¥–∞–º"]})}),n.jsx(rG,{nm:e})]});return n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:".product-page__grid .product-page__colors-wrap",className:P(_g.block),append:"last",children:t}),n.jsx(J,{selector:".product-page__aside .product-page__aside-container",className:P("product-page__aside-container",_g.blockAside),append:"after",children:t})]})}const ed=k("feature/wb-search-product-stats"),rs={modelName:ed(),loading:{load:ed("load")},view:{grid:ed("view/grid")},pagesLimit:1,promoRanges:[{start:0,end:5},{start:5,end:10},{start:10,end:20},{start:20,end:50},{start:50,end:100}]},dG=Q(rs.modelName),zb={load:dG("load")};function*uG({query:e,page:t}){const s=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.search,{query:e,page:t,dest:s,pageLimit:rs.pagesLimit})}function*mG(){yield I([N(zb.load,T(uG,[M,vt([rs.view.grid]),O(rs.loading.load),L(rs.loading.load),zt]))])}K(rs.modelName,mG);const pG={},Ig={min:"–ú–∏–Ω. CPM",max:"–ú–∞–∫—Å. CPM",avg:"–°—Ä–µ–¥–Ω–∏–π CPM"},hG=(e,t)=>{const s=e.filter(o=>{var r;const a=(r=o.position)==null?void 0:r.promoPosition;return a&&a>t.start&&a<=t.end}).map(o=>{var a;return Number((a=o.position)==null?void 0:a.promoCpm)}).filter(o=>!isNaN(o)&&o>0);return s.length===0?{min:0,max:0,avg:0}:{min:Math.min(...s),max:Math.max(...s),avg:s.reduce((o,a)=>o+a,0)/s.length}},Gb=(e,t)=>{const s=t.map(o=>hG(e,o));return Object.keys(Ig).map(o=>({label:Ig[o],tops:s.map(a=>a[o])}))};function Mm(e,t){const s={};return e.forEach(o=>{t.forEach(a=>{s[a]||(s[a]={max:o,min:o}),o[a]>s[a].max[a]&&(s[a].max=o),o[a]<s[a].min[a]&&(s[a].min=o)})}),s}function fG(e,t){if(e.length===0)return;const s=[...e].sort((i,l)=>Number(i[t])-Number(l[t])),o=Math.floor(s.length/2);if(s.length%2===0)return s[o][t];const a=s[o-1],r=s[o];if(a&&r){const i=a[t]||0,l=r[t]||0;return i+l/2}}const gG=e=>t=>({...t,count:Math.round(t.count/e*100)});function yG(e){const t=Object.values(e||{});if(t.length===0)return;const{promoCpm:s}=Mm(t.map(({position:i})=>i),["promoCpm"]),o={promoCpm:Wa.promoCpm({positionMinCpm:s.min,positionMaxCpm:s.max}),promoType:Wa.promoType(),isNew:Wa.isNew(),promoName:Wa.promoName()},a=Object.values(o);t.forEach(i=>{a.forEach(l=>l.process(i))});const r=gG(t.length);return{promoCpm:o.promoCpm.result().map(r),promoType:o.promoType.result().map(r),isNew:o.isNew.result().map(r),promoName:o.promoName.result().map(r)}}const Fm=$([Pe.selectors.list,(e,t)=>t],(e,t)=>e==null?void 0:e[t]),wG=$([Fm],e=>{if(e)return e.reduce((t,s)=>(t[s.id]=s,t),{})}),SG=$([Fm],e=>yG(e)),xG={useListByPage:te(Fm),useDataByPage:te(wG),useAggregatedByPage:te(SG)},bG="QS-2CIT",vG="wB0OtKT",Og={promoName:bG,article:vG},jG=()=>[{field:"id",headerName:me.id,cellRenderer:Vr,width:180,cellClass:Og.article},{field:"brand",headerName:me.brand,width:130},{field:"name",headerName:me.name,width:200},{colId:"promoType",field:"position.promoType",headerName:me.position.promoType,cellRenderer:Sl,filter:"agTextColumnFilter",suppressHeaderFilterButton:!0,width:100},{field:"position.organicPosition",type:["numeric","rightAligned"],headerName:me.position.organicPosition,width:80},{colId:"arrow",type:["numeric","rightAligned"],headerName:"‚Üí",valueGetter:()=>"‚Üí",width:46},{field:"position.promoPosition",type:["numeric"],headerName:me.position.promoPosition,width:60},{field:"position.promoCpm",type:["numeric","rightAligned"],headerName:me.position.promoCpm,width:80},{field:"deliveryTime",type:["numeric","rightAligned"],headerName:me.deliveryTimeShort,width:80},{field:"promoTextCat",headerName:me.promoName,width:170,cellClass:Og.promoName}].filter(Tn);function Kb({data:e,gridRef:t,style:s,onFirstRender:o,maxRowsOnScreen:a}){const r=he(rs.view.grid),i=m.useMemo(()=>jG(),[]),l=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]),c=m.useCallback(d=>String(d.data.id),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:i,defaultColDef:l,columnsState:r.state,onColumnsStateChanged:r.save,onFirstDataRendered:o,getRowId:c,maxRowsOnScreen:a})}const CG="_1NSbD-T",$G="guqZ5BT",kG="Z6dr-kr",NG="H8juZ--",Di={bar:CG,item:$G,itemLabel:kG,itemValue:NG};function Dm({data:e,style:t,className:s}){return n.jsx("div",{className:P(Di.bar,s),style:t,children:e.map(({key:o,backgroundColor:a,value:r,label:i,className:l})=>n.jsxs("div",{className:P(Di.item,l),style:{backgroundColor:a,width:`${r}%`},children:[n.jsx("div",{className:Di.itemLabel,children:i}),n.jsx("div",{className:Di.itemValue,children:v.percent(r,{fraction:0})})]},o||i))})}function Hb({data:e,style:t,className:s}){const o=m.useMemo(()=>e.map(({value:r,count:i})=>{const l=r,c=r==="unknown"||!r?2:1,d=fl(r),p=Rr(r)||"–±–µ–∑ —Ä–µ–∫–ª–∞–º—ã";return{key:l,label:p,value:i,className:d,orderKey:c}}).sort((r,i)=>r.orderKey-i.orderKey),[e]);return n.jsx(Dm,{data:o,style:t,className:s})}function Ub({gridRef:e,data:t}){const[s,o]=m.useState(),a=m.useMemo(()=>[{label:"–í—Å–µ",badge:t.length,value:void 0},{label:"–ê–≤—Ç–æ",badge:t.filter(({position:l})=>l.promoType==="b").length,value:"b"},{label:"–ê—É–∫—Ü–∏–æ–Ω",badge:t.filter(({position:l})=>l.promoType==="c").length,value:"c"},{label:"–û—Ä–≥–∞–Ω–∏–∫–∞",badge:t.filter(({position:l})=>!l.promoType).length,value:"organic"}],[t]),r=async i=>{let l;i!==void 0&&(i==="organic"?l={filterType:"text",type:"blank"}:l={filterType:"text",type:"equal",filter:i}),await(e==null?void 0:e.current.api.setColumnFilterModel("promoType",l)),o(i),e==null||e.current.api.onFilterChanged()};return n.jsx(an,{value:s,options:a,onChange:r})}const TG="_08aX8HK",PG="bJIPXaB",MG="_9N37e9y",FG="LNoIULj",DG="o3qJZsP",qo={logo:TG,tip:PG,wrapper:MG,label:FG,value:DG};function Qb({product:e,className:t}){return e!=null&&e.position.promoType?n.jsxs(f,{type:"horizontal",wrap:!1,align:"center",gap:0,className:P([qo.tip,t,fl(e.position.promoType)]),children:[n.jsxs(f,{type:"horizontal",wrap:!1,align:"center",gap:"s",className:qo.wrapper,children:[n.jsx(bt,{className:qo.logo}),n.jsxs(f,{type:"horizontal",wrap:!1,align:"center",gap:"xs",children:[n.jsxs("span",{className:qo.label,children:[Rr(e.position.promoType),":"]}),n.jsx("span",{children:v.numeric(e.position.organicPosition)}),n.jsx("span",{children:"‚Üí"}),n.jsx("span",{children:v.numeric(e.position.promoPosition)})]})]}),n.jsx("span",{className:P(qo.wrapper,qo.value),children:v.currency(e.position.promoCpm,{fraction:0})})]}):null}const AG="eCU1TTw",LG={tipIndex:AG};function Yb({product:e,index:t,className:s}){const o=typeof(e==null?void 0:e.index)=="number"?e==null?void 0:e.index:t;return n.jsx("span",{className:P(s,LG.tipIndex),children:o+1})}const RG=[{headerName:"–ú–µ—Ç—Ä–∏–∫–∞",field:"label",filter:!1,sortable:!1,pinned:"left",width:120},...rs.promoRanges.map((e,t)=>({headerName:`–¢–æ–ø ${e.start}‚Äî${e.end}`,colId:`tops-${t}`,valueGetter:s=>{var o,a;return(a=(o=s.data)==null?void 0:o.tops)==null?void 0:a[t]},filter:!1,sortable:!1,type:["currency.0"],width:100}))],td=e=>Gb(e,rs.promoRanges);function EG({data:e,style:t,gridRef:s}){const o=Ae.useCallback(c=>{var h,g,y;const d=(g=(h=s==null?void 0:s.current)==null?void 0:h.api)==null?void 0:g.getFilterModel(),p=(y=d==null?void 0:d.promoType)==null?void 0:y.filter;return p?c.filter(w=>{var C;return((C=w.position)==null?void 0:C.promoType)===p}):c},[s]),a=Ae.useCallback(c=>{const d=o(c);return Gb(d,rs.promoRanges)},[o]),[r,i]=Ae.useState(()=>td(e));Ae.useEffect(()=>{i(td(e))},[e,a]),Ae.useEffect(()=>{var p;const c=()=>{var h;(h=s==null?void 0:s.current)!=null&&h.api&&i(td(e))},d=(p=s==null?void 0:s.current)==null?void 0:p.api;return d==null||d.addEventListener("filterChanged",c),()=>{d==null||d.removeEventListener("filterChanged",c)}},[e,s,a]);const l=Ae.useMemo(()=>({resizable:!0,suppressMovable:!0,sortable:!1,filter:!1}),[]);return n.jsx(Ce,{style:t,rowData:r,columnDefs:RG,defaultColDef:l,isCompact:!0,suppressRowClickSelection:!0,suppressDragLeaveHidesColumns:!0,suppressColumnVirtualisation:!0,suppressRowVirtualisation:!0})}const _G="T0XpQ09",IG="S5XL0Bj",OG="A-NUzNr",sd={cardItem:_G,label:IG,percent:OG};function VG({items:e}){return n.jsx(f,{type:"vertical",style:{gap:"0"},children:e==null?void 0:e.map(({value:t,label:s},o)=>n.jsxs(f,{className:sd.cardItem,justify:"start",type:"horizontal",gap:"m",children:[n.jsx("div",{className:sd.percent,children:t}),n.jsx("div",{className:sd.label,children:s})]},o))})}function qG({data:e,style:t}){const s=m.useMemo(()=>e.reverse().map(({count:o,value:a})=>({label:a,value:v.percent(o)})),[e]);return n.jsx(Da,{style:t,children:n.jsx(VG,{items:s})})}const BG=Rn();function WG({data:e,style:t,className:s}){const o=m.useMemo(()=>e.map(({value:r,count:i})=>{const l=String(r),c=r?2:1,d=r?BG(l).backgroundColor:void 0;return{key:l,label:r?"New":"Old",value:i,backgroundColor:d,orderKey:c}}).sort((r,i)=>r.orderKey-i.orderKey),[e]);return n.jsx(Dm,{data:o,style:t,className:s})}const zG=Rn();function GG({data:e,style:t,className:s}){const o=m.useMemo(()=>e.map(({value:r,count:i})=>{const l=String(r),c=r?2:1,d=r?zG(r).backgroundColor:void 0;return{key:l,label:r||"–±–µ–∑ –∞–∫—Ü–∏–∏",value:i,backgroundColor:d,orderKey:c}}).sort((r,i)=>r.orderKey-i.orderKey),[e]);return n.jsx(Dm,{data:o,style:t,className:s})}const He={actions:zb,config:rs,sagas:pG,selectors:xG};function KG(){const[e,t]=m.useState([]),s=Fn(".cards-list__container"),o=a=>{const r=[];a==null||a.querySelectorAll("article.product-card").forEach(i=>{const l=i.dataset.popupNmId;if(!l)return;const c=i.querySelector(".product-card__tips--top");c&&r.push({el:{tipsTop:c},data:{nm:parseInt(l)}})}),t(r)};return m.useEffect(()=>{o(s);const a=new MutationObserver(()=>{o(s)});return s&&a.observe(s,{childList:!0}),()=>{a.disconnect()}},[s]),{items:e}}const HG="VTCPibq",UG="gXCnnVs",QG="qDR5mZd",Vg={alert:HG,tipsTop:UG,infoBottom:QG},qg="product-card__tip";function YG(){const{items:e}=KG(),t=Zn.selectors.useData();return t?n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:".cards-list__container",append:"before",children:n.jsx(Ln,{showLogo:!0,className:Vg.alert})}),e.map(({el:s,data:o},a)=>n.jsxs(Ps,{targetElement:s.tipsTop,append:"first",className:Vg.tipsTop,children:[n.jsx(Qb,{product:t[o.nm],className:qg}),n.jsx(Yb,{index:a,product:t[o.nm],className:qg})]},o.nm))]}):null}function Jb({filterActions:e,children:t}){const{setShowModal:s,load:o}=x(St.actions),a=ie.selectors.useList(),r=yS.selectors.useTokenIssueAt(),i=Z.selectors.useError(St.config.loading.load),l=G.selectors.useLoader(St.config.loading.load);return m.useEffect(()=>{!a&&r&&o()},[a,r]),l?n.jsx(le,{}):i?i.error instanceof lu||i.error instanceof ds?n.jsx(TA,{}):n.jsx(ee,{value:i}):n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsxs(f,{type:"horizontal",gap:"l",children:[n.jsx("div",{style:{flex:1},children:e}),n.jsxs(A,{size:"small",onClick:()=>s(!0),children:["–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã"," ",(a==null?void 0:a.length)&&n.jsx(be,{type:"info",children:a.length})]})]}),t]})}const Ai=k("feature/wb-search-any-product-stats"),Wt={modelName:Ai(),loading:{load:Ai("load"),loadRecommendations:Ai("load-recommendations")},view:{grid:Ai("view/grid")},pagesLimit:20},Bg={},Zb=_({name:Wt.modelName,initialState:Bg,reducers:{setNms:D("nms"),reset:()=>Bg}}),JG=E.inject(Zb),Wg=Q(Wt.modelName),rl={...Zb.actions,load:Wg("load"),loadRecommendations:Wg("load-recommendations")};function*ZG({query:e,page:t}){const s=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.search,{query:e,page:t,dest:s,pageLimit:Wt.pagesLimit})}function*XG({nm:e}){const t=yield F(Ve.selectors.destinationValue);yield u(Pe.sagas.loadRecommendations,{nm:e,dest:t})}function*e7(){yield I([N(rl.load,T(ZG,[M,vt([Wt.view.grid]),O(Wt.loading.load),L(Wt.loading.load)])),N(rl.loadRecommendations,T(XG,[M,vt([Wt.view.grid]),O(Wt.loading.loadRecommendations),L(Wt.loading.loadRecommendations)]))])}K(Wt.modelName,e7);const t7={},s7=V(Wt.modelName,JG),Am=s7("nms"),n7=$([Pe.selectors.list,Am],(e,t)=>{if(!t||t.length===0)return;const s=[],o=new Set(t),a=Object.values(e||{});for(const r of a)for(const i of r)if(o.delete(i.id)&&s.push(i),o.size===0)break;return s}),o7=$([Pe.selectors.recommendations,Am],(e,t)=>{if(!t||t.length===0||!e)return;const s=[],o=new Set(t);for(const a of e)if(o.delete(a.id)&&s.push(a),o.size===0)break;return s}),a7={useSearchNms:b(Am),useData:b(n7),useRecommendationsData:b(o7)},r7="FH-gQmP",i7="BwWAkT8",zg={promoName:r7,article:i7},l7=({extendedColumnDefs:e})=>[{field:"id",headerName:me.id,cellRenderer:Vr,width:180,cellClass:zg.article},{field:"brand",headerName:me.brand,width:130},{field:"name",headerName:me.name,width:200},{colId:"promoType",field:"position.promoType",headerName:me.position.promoType,cellRenderer:Sl,filter:"agTextColumnFilter",suppressHeaderFilterButton:!0,width:100},{field:"position.organicPosition",type:["numeric","rightAligned"],headerName:me.position.organicPosition,width:80},{colId:"arrow",type:["numeric","rightAligned"],headerName:"‚Üí",valueGetter:()=>"‚Üí",width:46},{field:"position.promoPosition",type:["numeric"],headerName:me.position.promoPosition,width:60},{field:"position.promoCpm",type:["numeric","rightAligned"],headerName:me.position.promoCpm,width:80},{field:"promoTextCat",headerName:me.promoName,width:170,cellClass:zg.promoName},e==null?void 0:e.actions].filter(Tn);function Xb({data:e,gridRef:t,style:s,onFirstRender:o,extendedColumnDefs:a,maxRowsOnScreen:r}){const i=he(Wt.view.grid),l=m.useMemo(()=>l7({extendedColumnDefs:a}),[a]),c=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]),d=m.useCallback(p=>String(p.data.id),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:l,defaultColDef:c,columnsState:i.state,onColumnsStateChanged:i.save,onFirstDataRendered:o,getRowId:d,maxRowsOnScreen:r})}function ev(){const[e,t]=m.useState(),{setNms:s}=x(rl),o=a=>{a.preventDefault();const r=e==null?void 0:e.split(/[^\d]+/i).map(i=>parseInt(i)).filter(Boolean);s(r)};return n.jsxs(f,{as:"form",type:"horizontal",onSubmit:o,children:[n.jsx(xe,{placeholder:"–í–≤–µ–¥–∏—Ç–µ –∞—Ä—Ç–∏–∫—É–ª, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–¥–æ –Ω–∞–π—Ç–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É",value:e,onChange:a=>t(a.target.value),style:{width:400}}),n.jsx(A,{htmlType:"submit",children:"–ò—Å–∫–∞—Ç—å –∞—Ä—Ç–∏–∫—É–ª"})]})}const ys={actions:rl,config:Wt,sagas:t7,selectors:a7};function c7({nm:e,onRegionSearchClick:t}){const{loadRecommendations:s}=x(ys.actions),o=ys.selectors.useSearchNms(),a=ys.selectors.useRecommendationsData(),r=Z.selectors.useError(ys.config.loading.load),i=G.selectors.useSomeLoader([ys.config.loading.load]);m.useEffect(()=>{!a&&(o!=null&&o.length)&&s({nm:e})},[a,o]);const l=m.useMemo(()=>({actions:{colId:"actions",cellRenderer:wl,cellRendererParams:{onSearchClick:({data:c})=>{c&&t&&t(c.id)}},headerName:"–ü–æ–∑–∏—Ü–∏—è –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö",filter:!1,sortable:!1,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,width:150}}),[]);return i?n.jsx(le,{}):r?n.jsx(ee,{value:r}):a?n.jsx(Xb,{data:a,extendedColumnDefs:l,maxRowsOnScreen:10}):null}function d7({nm:e,onRegionSearchClick:t}){return n.jsxs(cm,{id:"widget/wb-recommendation-any-product-stats-view",title:"–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–π –∞—Ä—Ç–∏–∫—É–ª–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É",defaultClose:!0,buttonType:"link",buttonSize:"middle",children:[n.jsx(ev,{}),n.jsx(c7,{nm:e,onRegionSearchClick:t})]})}const u7="uNOn2bt",m7={chart:u7};function p7(){const e=m.useRef(null),t=Zn.selectors.usePromotionList(),s=Zn.selectors.useList(),o=Zn.selectors.useAggregated(),a=Z.selectors.useError(Zn.config.loading.load);return G.selectors.useLoader(Zn.config.loading.load)?n.jsx(le,{}):a?n.jsx(ee,{value:a}):!s||!t?null:n.jsxs(f,{type:"vertical",gap:"4xl",children:[(o==null?void 0:o.promoType)&&n.jsx(Hb,{data:o==null?void 0:o.promoType,className:m7.chart}),n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(Ub,{data:s,gridRef:e}),n.jsx(Kb,{gridRef:e,data:t,style:{height:"300px"}}),n.jsx(Ln,{})]})]})}function h7({onRegionSearchClick:e}){const t=rt.selectors.useRecommendationsData(),s=Z.selectors.useError(rt.config.loading.load),o=G.selectors.useLoader(rt.config.loading.load),a=m.useMemo(()=>({actions:{colId:"actions",cellRenderer:wl,cellRendererParams:{onSearchClick:({data:r})=>{r&&e&&e(r.id)}},headerName:"–ü–æ–∑–∏—Ü–∏—è –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö",filter:!1,sortable:!1,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,width:120}}),[]);return o?n.jsx(le,{}):s?n.jsx(ee,{value:s}):(t==null?void 0:t.length)===0?n.jsx(dt,{type:"warning",message:"–ù–∞ –ø–µ—Ä–≤—ã—Ö 3-—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –≤–∞—à–∏ —Ç–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"}):n.jsx(qb,{data:t,maxRowsOnScreen:10,extendedColumnDefs:a})}function f7(){const e=rt.selectors.useRecommendationsData(),t=G.selectors.useSomeLoader([St.config.loading.load,rt.config.loading.load]),s=(e==null?void 0:e.length)||0;return t?n.jsx(As,{}):s?n.jsxs(n.Fragment,{children:["–ù–∞–π–¥–µ–Ω–æ ",s," –≤–∞—à–∏—Ö ",Zs(s,["—Ç–æ–≤–∞—Ä","—Ç–æ–≤–∞—Ä–∞","—Ç–æ–≤–∞—Ä–æ–≤"])]}):null}const nd={...$F,productCounter:"–¢–æ–≤–∞—Ä—ã, —à—Ç."},g7=[{field:"oldId",headerName:nd.oldId,width:100},{field:"name",headerName:nd.name,width:325},{field:"productCounter",type:["numeric","rightAligned"],headerName:nd.productCounter,width:100}];function y7({data:e,gridRef:t,style:s}){const o=he(ws.view.grid),a=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:g7,defaultColDef:a,columnsState:o.state,onColumnsStateChanged:o.save})}function w7(){const e=St.selectors.useData(),{update:t}=x(St.actions),s=Z.selectors.useError(St.config.loading.update),o=G.selectors.useLoader(St.config.loading.load),a=G.selectors.useLoader(St.config.loading.update);return o?n.jsx(le,{}):n.jsxs(f,{gap:"l",type:"vertical",children:[n.jsx(y7,{data:e,style:{height:300}}),s&&n.jsx(ee,{value:s}),n.jsx(A,{onClick:()=>t(),isLoading:a,children:"–û–±–Ω–æ–≤–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã –∏ —Ç–æ–≤–∞—Ä—ã"})]})}const S7=k("widget/wb-suppliers-view-modal"),x7={modelName:S7()};function tv(){const e=St.selectors.useShowModal(),{setShowModal:t}=x(St.actions);return m.useEffect(()=>{e&&Te.pageView(x7.modelName)},[e]),n.jsx(Ye,{open:e,onCloseClick:()=>t(!1),title:"–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã",children:n.jsx(H,{children:n.jsx(w7,{})})})}const Li=k("pages/wb/catalog-detail"),od={modelName:Li(),section:{main:Li("main"),productStatsView:Li("product-stats-view"),supplierProductStatsView:Li("supplier-product-stats-view")}},b7="G9-U1R8",v7="WmO1vRA",ad={wrapper:b7,section:v7};function j7(){const e=sy(),t=m.useMemo(()=>({nm:parseInt(e.nm)}),[e]),{load:s}=x(ct.actions),{load:o}=x(Zn.actions),{load:a}=x(St.actions),{loadRecommendations:r}=x(rt.actions),{setShowModal:i,setForm:l}=x(Tl.actions),c=m.useCallback(d=>{l({nmOur:d.toString(),queries:[`–ø–æ—Ö–æ–∂–∏–µ ${t.nm}`],nms:[],destinations:[],autoSubmit:!0}),i(!0)},[t.nm]);return m.useEffect(()=>{t.nm&&(a(),s({nms:[t.nm]}),o({nm:t.nm}),r({nm:t.nm}))},[t]),t.nm?n.jsxs(n.Fragment,{children:[n.jsxs(H,{fallback:Qt,children:[n.jsx(W6,{nm:t.nm}),n.jsx(cG,{nm:t.nm}),n.jsx(E6,{nm:t.nm}),n.jsx(YG,{})]}),n.jsx(J,{selector:".product-page__carousel",append:"after",className:ad.wrapper,children:n.jsx(fr,{title:n.jsxs(f,{gap:"l",align:"center",display:"block",children:[n.jsx(ga,{}),n.jsx(pm,{})]}),id:od.section.main,children:n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(xt,{title:"–†–µ–∫–ª–∞–º–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ",className:ad.section,id:od.section.productStatsView,children:n.jsx(H,{children:n.jsx(p7,{})})}),n.jsx(xt,{title:"–ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–π –≤–∞—à–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤",subTitle:n.jsx(f7,{}),className:ad.section,id:od.section.supplierProductStatsView,children:n.jsx(H,{children:n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(Jb,{children:n.jsx(h7,{onRegionSearchClick:c})}),n.jsx(d7,{nm:t.nm,onRegionSearchClick:c})]})})})]})})}),n.jsx(tv,{})]}):null}const Gg=k("feature/wb-keyword-stat"),jo={modelName:Gg(),loading:{load:Gg("load")}},Kg={},sv=_({name:jo.modelName,initialState:Kg,reducers:{setRequestedQuery:D("requestedQuery"),reset:()=>Kg}}),C7=E.inject(sv),$7=Q(jo.modelName),Lm={...sv.actions,load:$7("load")},k7=V(jo.modelName,C7),N7=k7("requestedQuery"),nv={requestedQuery:N7};function*T7(e){const t=yield F(nv.requestedQuery);t&&t!==e&&(yield S(Rt.actions.reset())),yield u(Rt.sagas.load,e),yield S(Lm.setRequestedQuery(e))}function*P7(){yield I([N(Lm.load,T(T7,[M,O(jo.loading.load),L(jo.loading.load)]))])}K(jo.modelName,P7);const M7={},F7="OLE4ANg",D7="r6j0Nza",A7="UoZ3cUI",Bo={table:F7,segment:D7,cluster:A7};function L7({stats:e}){var t,s,o,a,r,i;return n.jsxs("table",{className:Bo.table,children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{}),n.jsx("th",{children:"–°–µ–≥–º–µ–Ω—Ç"}),n.jsx("th",{children:"–ö–ª–∞—Å—Ç–µ—Ä"}),n.jsx("th",{children:"–ó–∞–ø—Ä–æ—Å"})]})}),n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("td",{children:"–º–µ—Å—è—Ü"}),n.jsx("td",{className:Bo.segment,children:v.numeric((t=e.cluster)==null?void 0:t.freq_common.monthly)}),n.jsx("td",{className:Bo.cluster,children:v.numeric((s=e.cluster)==null?void 0:s.freq_syn.monthly)}),n.jsx("td",{children:v.numeric(e.freq.monthly)})]}),n.jsxs("tr",{children:[n.jsx("td",{children:"—Å—É—Ç–∫–∏"}),n.jsx("td",{className:Bo.segment,children:v.numeric((((o=e.cluster)==null?void 0:o.freq_common.weekly)??0)/7,{fraction:0})}),n.jsx("td",{className:Bo.cluster,children:v.numeric((((a=e.cluster)==null?void 0:a.freq_syn.weekly)??0)/7,{fraction:0})}),n.jsx("td",{children:v.numeric((e.freq.weekly??0)/7,{fraction:0})})]}),n.jsxs("tr",{children:[n.jsx("td",{children:"—Ç—Ä–µ–Ω–¥"}),n.jsx("td",{className:Bo.segment,children:n.jsx(so,{value:(r=e.cluster)==null?void 0:r.freq_common.weekly_trend,formatter:v.percent})}),n.jsx("td",{children:n.jsx(so,{value:(i=e.cluster)==null?void 0:i.freq_syn.weekly_trend,formatter:v.percent})}),n.jsx("td",{children:n.jsx(so,{value:e.freq.weekly_trend,formatter:v.percent})})]})]})]})}const R7="lMTm25c",E7="PpqTlUm",Wo={badge:R7,badgeValue:E7};function _7({data:e,freq365:t,growthRate:s}){const o=e.filter(i=>!i.isForecast),a=Mm(o,["value"]),r=a==null?void 0:a.value;return r?n.jsxs(f,{type:"horizontal",gap:"l",children:[n.jsxs(f,{type:"horizontal",align:"center",children:["–ú–∞–∫—Å:",n.jsxs(be,{size:"small",type:"info",className:Wo.badge,children:[v.month(r.max.date)," ‚Äî ",n.jsx("span",{className:Wo.badgeValue,children:v.numeric(r.max.value)})]})]}),n.jsxs(f,{type:"horizontal",align:"center",children:["–ú–∏–Ω:",n.jsxs(be,{size:"small",type:"info",className:Wo.badge,children:[v.month(r.min.date)," ‚Äî ",n.jsx("span",{className:Wo.badgeValue,children:v.numeric(r.min.value)})]})]}),n.jsxs(f,{type:"horizontal",align:"center",children:["–ß–∞—Å—Ç–æ—Ç–∞ / –≥–æ–¥:",n.jsx(be,{size:"small",type:"info",children:n.jsx("span",{className:Wo.bold,children:v.numeric(t)})})]}),n.jsxs(f,{type:"horizontal",align:"center",children:["–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –≥–æ–¥:",n.jsx(be,{size:"small",type:"info",children:n.jsx("span",{className:Wo.bold,children:v.numeric(t*s,{fraction:0})})})]})]}):null}const I7="noIWdMf",rd={label:I7};function O7({stats:e}){var t,s,o;return n.jsxs(f,{type:"horizontal",gap:"xl",align:"center",children:[n.jsxs(f,{type:"horizontal",align:"center",children:[n.jsx("span",{className:rd.label,children:"–∫–ª–∞—Å—Ç–µ—Ä"}),n.jsxs(be,{size:"small",type:"info",children:[v.numeric((t=e.cluster)==null?void 0:t.freq_syn.monthly)," –≤ –º–µ—Å."]})]}),n.jsxs(f,{type:"horizontal",align:"center",children:[n.jsx("span",{className:rd.label,children:"—Å–µ–≥–º–µ–Ω—Ç"}),n.jsxs(be,{size:"small",type:"info",children:[v.numeric((s=e.cluster)==null?void 0:s.freq_common.monthly)," –≤ –º–µ—Å."]})]}),n.jsxs(f,{type:"horizontal",align:"center",children:[n.jsx("span",{className:rd.label,children:"–ß–∞—Å—Ç–æ—Ç–∞"}),n.jsxs(be,{size:"small",type:"info",children:[v.numeric(e.freq365)," –≤ –≥–æ–¥."]})]}),n.jsx("div",{children:n.jsx(so,{value:(o=e.cluster)==null?void 0:o.freq_common.weekly_trend,formatter:v.percent})})]})}const Hg={id:"shared",type:"linear",position:"left",beginAtZero:!0,display:!0},ov=[{id:"value",label:"–ß–∞—Å—Ç–æ—Ç–∞ / –º–µ—Å.",borderColor:"#2E7D32",backgroundColor:"rgba(46, 125, 50, 0.2)",fill:"start",tension:.4,pointBackgroundColor:"#2E7D32",pointBorderColor:"#2E7D32",pointRadius:1,pointHoverRadius:1,borderJoinStyle:"round",scale:Hg,type:["numeric.0"]},{id:"growth",label:"–ü—Ä–æ–≥–Ω–æ–∑",borderColor:"#9E9E9E",backgroundColor:"rgba(158, 158, 158, 0.2)",fill:"start",tension:.4,pointBackgroundColor:"#9E9E9E",pointBorderColor:"#9E9E9E",pointRadius:0,pointHoverRadius:0,borderDash:[10,10],borderJoinStyle:"round",scale:Hg,type:["numeric.0"]}];function V7({data:e,style:t,className:s}){return n.jsx(En,{lineData:e,lineDefs:ov,labelField:"date",labelFormatter:v.dateFull,className:s,style:t,sidebar:!1})}const q7="xtoGcfv",B7="YLa9BAO",W7={wrapper:q7,chart:B7};function z7({data:e,style:t,className:s}){const o=e==null?void 0:e.filter(a=>!a.isForecast);return n.jsx(En,{lineData:o,lineDefs:ov,labelField:"date",labelFormatter:v.dateShort,className:s,classNames:W7,showTooltip:!1,style:t,sidebar:!1,showAxios:!1})}const kr={actions:Lm,selectors:nv,config:jo,sagas:M7},id=k("feature/wb-external-advert-stats"),vn={modelName:id(),loading:{load:id("load")},view:{grid:id("view/grid")},measurementError:500},G7=Q(vn.modelName),av={load:G7("load")},K7=k("entity/evirma/external-advert"),Rm={modelName:K7()},Ug={},rv=_({name:Rm.modelName,initialState:Ug,reducers:{setList:Je("list"),reset:()=>Ug}}),H7=E.inject(rv),iv={...rv.actions},U7=V(Rm.modelName,H7),ou=U7("list"),Q7=$([ou],e=>Object.keys(e||{}).map(t=>parseInt(t))),lv={list:ou,listNms:Q7,useList:b(ou)};function*Y7(e){const t=yield F(lv.listNms),s=new Set(t);if(e.filter(r=>!s.delete(r)).length===0)return;const a=yield u(gd.getList,{keywords:e.map(r=>r.toString())});yield S(iv.setList(a==null?void 0:a.keywords))}const J7={load:Y7},cv={config:Rm,actions:iv,selectors:lv,sagas:J7};function*Z7({nms:e}){yield u(cv.sagas.load,e)}function*X7(){yield I([N(av.load,T(Z7,[M,vt([vn.view.grid]),O(vn.loading.load),L(vn.loading.load)]))])}K(vn.modelName,X7);const eK={};function tK({productsStats:e,externalAdverts:t}){const s={};if(!(!t||!e))return e.forEach(o=>{var r,i;const a=t[o.id];!((r=a==null?void 0:a.freq)!=null&&r.monthly)||((i=a==null?void 0:a.freq)==null?void 0:i.monthly)<vn.measurementError||(s[o.id]={...o,frequency:a.freq.monthly})}),s}const dv=$([Pe.selectors.list,cv.selectors.list,(e,t)=>t],(e,t,s)=>tK({externalAdverts:t,productsStats:e==null?void 0:e[s]}),{memoize:Ts,argsMemoize:Ts}),sK=$(dv,e=>e?Object.values(e).sort((t,s)=>s.frequency-t.frequency):void 0),nK={useData:te(dv),useList:te(sK)},oK="ojRGcf8",aK={article:oK},Ri={...me,frequency:"–ü–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤ –º–µ—Å—è—Ü, —à—Ç"},rK=[{field:"id",headerName:Ri.id,cellRenderer:Vr,width:180,cellClass:aK.article},{field:"brand",headerName:Ri.brand,width:170},{field:"name",headerName:Ri.name,width:425},{field:"frequency",headerName:Ri.frequency,type:["numeric"],width:200}];function iK({data:e,gridRef:t,style:s,maxRowsOnScreen:o}){const a=he(vn.view.grid),r=m.useMemo(()=>({filter:!1,floatingFilter:!1}),[]);return n.jsx(Ce,{gridRef:t,style:s,rowData:e,columnDefs:rK,defaultColDef:r,columnsState:a.state,onColumnsStateChanged:a.save,maxRowsOnScreen:o})}const lK="azekt3P",cK="_3bx1KuH",dK="g5ZJQUJ",uK="xdk21-a",mK="bspSVM6",zo={logo:lK,tip:cK,wrapper:dK,label:uK,value:mK};function pK({product:e}){return e?n.jsxs(f,{type:"horizontal",wrap:!1,align:"center",gap:0,className:P([zo.tip,"product-card__tip"]),children:[n.jsxs(f,{type:"horizontal",wrap:!1,align:"center",gap:"s",className:zo.wrapper,children:[n.jsx(bt,{className:zo.logo}),n.jsx("span",{className:zo.label,children:"–í–Ω–µ—à–∫–∞"})]}),n.jsx("span",{className:P(zo.wrapper,zo.value),children:v.numeric(e.frequency)})]}):null}const ao={actions:av,config:vn,sagas:eK,selectors:nK};function hK(){const[e,t]=m.useState([]),s=Fn(".product-card-list"),o=a=>{const r=[];a==null||a.querySelectorAll("article.product-card").forEach(i=>{const l=i.dataset.nmId;if(!l)return;const c=i.querySelector(".product-card__tips--top");if(!c)return;const d=i.querySelector(".product-card__bottom-wrap .product-card__order-wrap");d&&r.push({el:{tipsTop:c,infoBottom:d},data:{nm:parseInt(l)}})}),t(r)};return m.useEffect(()=>{o(s);const a=new MutationObserver(()=>{o(s)});return s&&a.observe(s,{childList:!0}),()=>{a.disconnect()}},[s]),{items:e,listElement:s}}const fK="Z5mBoeE",gK="_7qiwLla",yK="mQZKhV2",ld={alert:fK,tipsTop:gK,infoBottom:yK},Qg="product-card__tip";function wK({page:e}){const{items:t}=hK(),s=ao.selectors.useData(e),o=He.selectors.useDataByPage(e);return!o||!s?null:n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:".product-card-list",append:"before",children:n.jsx(Ln,{showLogo:!0,className:ld.alert})}),t.map(({el:a,data:r},i)=>n.jsxs(m.Fragment,{children:[n.jsxs(Ps,{targetElement:a.tipsTop,append:"first",className:ld.tipsTop,children:[n.jsx("div",{children:n.jsx(Qb,{product:o[r.nm],className:Qg})}),n.jsx("div",{children:n.jsx(Yb,{index:i,product:o[r.nm],className:Qg})}),n.jsx(pK,{product:s[r.nm]})]}),n.jsx(Ps,{targetElement:a.infoBottom,append:"before",className:ld.infoBottom,children:n.jsx(XR,{nm:r.nm})})]},r.nm))]})}function SK({page:e}){const t=ao.selectors.useList(e),s=Z.selectors.useError(ao.config.loading.load);return G.selectors.useSomeLoader([He.config.loading.load,ao.config.loading.load])?n.jsx(le,{}):s?n.jsx(ee,{value:s}):t?n.jsx(iK,{data:t,maxRowsOnScreen:5}):null}function xK({page:e}){const t=He.selectors.useListByPage(e),{load:s}=x(ao.actions);return m.useEffect(()=>{t!=null&&t.length&&s({nms:t.map(({id:o})=>o)})},[t]),null}function bK({page:e}){const t=ao.selectors.useList(e),s=G.selectors.useSomeLoader([He.config.loading.load,ao.config.loading.load]),o=(t==null?void 0:t.length)||0;return s?n.jsx(As,{}):o?n.jsxs("span",{children:[n.jsxs("span",{children:[o," ",Zs(o,["—Ç–æ–≤–∞—Ä","—Ç–æ–≤–∞—Ä–∞","—Ç–æ–≤–∞—Ä–æ–≤"])]})," ","–∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–Ω–µ—à–Ω—é—é —Ä–µ–∫–ª–∞–º—É"]}):null}function vK({page:e,query:t,onRegionSearchClick:s}){const{load:o}=x(ys.actions),a=ys.selectors.useSearchNms(),r=ys.selectors.useData(),i=Z.selectors.useError(ys.config.loading.load),l=G.selectors.useSomeLoader([ys.config.loading.load]);m.useEffect(()=>{!r&&(a!=null&&a.length)&&o({query:t,page:e})},[r,a]);const c=m.useMemo(()=>({actions:{colId:"actions",cellRenderer:wl,cellRendererParams:{onSearchClick:({data:d})=>{d&&s&&s(d.id)}},headerName:"–ü–æ–∑–∏—Ü–∏—è –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö",filter:!1,sortable:!1,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,width:150}}),[]);return l?n.jsx(le,{}):i?n.jsx(ee,{value:i}):r?n.jsx(Xb,{data:r,extendedColumnDefs:c,maxRowsOnScreen:10}):null}function jK({page:e,query:t,onRegionSearchClick:s}){return n.jsxs(cm,{id:"widget/wb-search-any-product-stats-view",title:"–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–π –∞—Ä—Ç–∏–∫—É–ª–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É",defaultClose:!0,buttonType:"link",buttonSize:"middle",children:[n.jsx(ev,{}),n.jsx(vK,{page:e,query:t,onRegionSearchClick:s})]})}const Yg=k("feature/wb-search-product-tops"),CK={modelName:Yg(),loading:{load:Yg("load")},limit:{warehouses:4}};function $K(){const e=new Map;return{process:({brand:o})=>{if(!o)return;let a=e.get(o);a||(a={count:0,value:o},e.set(o,a)),a.count+=1},result:()=>[...e.values()]}}function kK(){const e=new Map;return{process:({colors:o})=>{o&&o.forEach(a=>{let r=e.get(a);r||(r={count:0,value:a},e.set(a,r)),r.count+=1})},result:()=>[...e.values()]}}function NK(e){const{length:t=5,productMinPrice:s,productMaxPrice:o}=e,a=new Map,r=Math.ceil(s.price/100)*100,l=(Math.ceil(o.price/100)*100-r)/t,c=Array.from({length:t},(h,g)=>{const y=[r+l*g,r+l*(g+1)],w=`${y.map(C=>v.currency(Math.ceil(C/100),{fraction:0})).join(" ‚Äî ")}`;return a.set(y,{count:0,value:w}),y});return{process:({price:h})=>{const g=c.find(([w,C])=>h>w&&h<=C);if(!g)return;const y=a.get(g);y&&(y.count+=1)},result:()=>[...a.values()]}}const cd=e=>v.numeric(e,{fraction:0});function TK(e=5){const t=new Map,s=10,o=Array.from({length:e},(i,l)=>{const c=[l?Math.pow(s,l):0,l+1<e?Math.pow(s,l+1):Number.MAX_SAFE_INTEGER],d=c[1]===Number.MAX_SAFE_INTEGER?`${cd(c[0])}+`:`${cd(c[0])||0} ‚Äî ${cd(c[1])}`;return t.set(c,{count:0,value:d}),c});return{process:({feedbacks:i})=>{const l=o.find(([d,p])=>i>d&&i<=p);if(!l)return;const c=t.get(l);c&&(c.count+=1)},result:()=>[...t.values()]}}function PK({threshold:e,groupCount:t}){const s=new Map,o=typeof t=="number"?{max:t,min:t}:t;return{process:({rating:i})=>{if(!i)return;let l=s.get(i);l||(l={count:0,value:i},s.set(i,l)),l.count+=1},result:()=>{const i=[];s.forEach(({value:g,count:y},w)=>{(g>=e.valueMin||y>=e.countMin)&&i.push(w)});const c=i.sort((g,y)=>g-y).length,d=Math.min(o.max,Math.max(o.min,Math.ceil(c/2))),p=Math.ceil(c/d),h=[];for(;i.length;){const g=i.splice(0,p),y=g[0],w=g[g.length-1],C=g.reduce((q,B)=>{var U;const X=((U=s.get(B))==null?void 0:U.count)||0;return q+X},0),j=y!==w?[y,w].map(q=>v.numeric(q,{fraction:1,zeroFraction:!0})).join(" ‚Äî "):w;h.push({count:C,value:j})}return h}}}function MK(){const e=new Map;return{process:({subject:o})=>{if(!o)return;let a=e.get(o.id);a||(a={count:0,value:o.name||"unknown"},e.set(o.id,a)),a.count+=1},result:()=>[...e.values()]}}function FK(){const e=new Map;return{process:({warehouse:o,deliveryTime:a})=>{if(!o||!o.isAvailable||!a)return;let r=e.get(o.id);r||(r={count:0,value:{deliveryTime:a,warehouse:o}},e.set(o.id,r)),r.count+=1},result:()=>[...e.values()]}}const DK=e=>t=>({...t,count:Math.round(t.count/e*100)});function AK(e){const t=Object.values(e||{});if(t.length===0)return;const{price:s}=Mm(t,["price"]),o={brands:$K(),subjects:MK(),colors:kK(),warehouses:FK(),feedbacks:TK(),ratings:PK({groupCount:{min:5,max:7},threshold:{valueMin:2,countMin:t.length*.02}}),costs:NK({productMinPrice:s.min,productMaxPrice:s.max})},a=Object.values(o);t.forEach(i=>{a.forEach(l=>l.process(i))});const r=DK(t.length);return{brands:o.brands.result().map(r),subjects:o.subjects.result().map(r),colors:o.colors.result().map(r),warehouses:o.warehouses.result().map(r),feedbacks:o.feedbacks.result().map(r),ratings:o.ratings.result().map(r),costs:{items:o.costs.result().map(r),productMinPrice:s.min,productMaxPrice:s.max,medianPrice:fG(t,"price")}}}const LK=$(Pe.selectors.details,e=>e?Object.values(e):void 0,{memoize:Ts,argsMemoize:Ts}),RK=$(Pe.selectors.details,e=>AK(e),{memoize:Ts,argsMemoize:Ts}),EK={useDataList:b(LK),useTops:b(RK),useData:te(Pe.selectors.detailsByNm)},_K="SrCg-xY",IK="TP0aBW9",OK="_1WAGD9N",dd={cardItem:_K,label:IK,percent:OK};function VK({items:e}){return n.jsx(f,{type:"vertical",gap:"s",children:e==null?void 0:e.map(({value:t,label:s},o)=>n.jsxs(f,{className:dd.cardItem,justify:"start",type:"horizontal",gap:"m",children:[n.jsx("div",{className:dd.percent,children:t}),n.jsx("div",{className:dd.label,children:s})]},o))})}const qK="PFENyeg",BK={wrapper:qK};function Mo({label:e,rightSide:t,footer:s,className:o,style:a,items:r}){return n.jsx(Da,{label:e,style:a,className:o,footer:s,children:n.jsxs(f,{type:"horizontal",justify:"space-between",align:"center",className:BK.wrapper,children:[n.jsx(VK,{items:r}),t]})})}function WK({data:e,...t}){const s=m.useMemo(()=>e.filter(({count:o})=>o>1).sort((o,a)=>a.count-o.count).map(({count:o,value:a})=>({label:a,value:v.percent(o)})),[e]);return n.jsx(Mo,{label:"–ë—Ä–µ–Ω–¥—ã",items:s,...t})}function zK({data:e,...t}){const s=m.useMemo(()=>e.filter(({count:o})=>o>1).sort((o,a)=>a.count-o.count).map(({count:o,value:a})=>({label:a,value:v.percent(o)})),[e]);return n.jsx(Mo,{label:"–¶–≤–µ—Ç–∞",items:s,...t})}const GK="YmnCRKa",KK="_9yjErMu",HK="EusPbQS",ud={productImage:GK,link:KK,price:HK};function UK({medianPrice:e}){return e?n.jsxs(f,{type:"vertical",align:"end",gap:"xs",children:[n.jsx("div",{children:n.jsx("b",{children:"–ú–µ–¥–∏–∞–Ω–∞"})}),n.jsx("div",{children:v.currency(e/100,{fraction:0})})]}):null}function Jg({data:e,title:t}){const s=ge.selectors.useMediaRouteHostsByType("mediabasket_route_map"),o=Co(W.outRoute.marketPlaceProduct,{id:e.id}),a=`${W.wb.marketPlaceBaseUrl}${o}`;return n.jsx("a",{href:a,className:ud.link,children:n.jsx(jt,{suffix:n.jsx("img",{alt:e.id.toString(),src:va(e.id,s),className:ud.productImage}),children:n.jsxs(f,{type:"vertical",children:[n.jsxs("span",{className:ud.price,children:[t," ",v.currency(e.price/100,{fraction:0})]}),n.jsx("span",{children:e.id})]})})})}function QK({data:e,...t}){const s=m.useMemo(()=>e.items.reverse().map(({count:o,value:a})=>({label:a,value:v.percent(o)})),[e]);return n.jsx(Mo,{label:"–¶–µ–Ω—ã",items:s,footer:n.jsxs(f,{type:"horizontal",justify:"space-around",style:{width:"100%"},children:[n.jsx(Jg,{title:"Min",data:e.productMinPrice}),n.jsx(Jg,{title:"Max",data:e.productMaxPrice})]}),rightSide:n.jsx(UK,{medianPrice:e.medianPrice}),...t})}function YK({data:e,...t}){const s=m.useMemo(()=>e.reverse().map(({count:o,value:a})=>({label:a,value:v.percent(o)})),[e]);return n.jsx(Mo,{label:"–û—Ü–µ–Ω–∫–∏",items:s,...t})}function JK({data:e,...t}){const s=m.useMemo(()=>e.reverse().map(({count:o,value:a})=>({label:a,value:v.percent(o)})),[e]);return n.jsx(Mo,{label:"–†–µ–π—Ç–∏–Ω–≥–∏",items:s,...t})}function ZK({data:e,...t}){const s=m.useMemo(()=>e.filter(({count:o})=>o>1).sort((o,a)=>a.count-o.count).map(({count:o,value:a})=>({label:a,value:v.percent(o)})),[e]);return n.jsx(Mo,{label:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏",items:s,...t})}function XK({data:e,...t}){const s=m.useMemo(()=>e.sort((o,a)=>o.value.deliveryTime-a.value.deliveryTime).map(({count:o,value:{warehouse:a,deliveryTime:r}})=>({label:n.jsx(jt,{suffix:v.hours(r),children:a.name}),value:v.percent(o)})),[e]);return n.jsx(Mo,{label:"–°–∫–ª–∞–¥—ã",items:s,...t})}const Go={Brands:WK,Colors:zK,Costs:QK,Feedbacks:YK,Ratings:JK,Subjects:ZK,Warehouses:XK},Oi={config:CK,selectors:EK},e9="YuuuDvt",t9={deliveryTime:e9},s9=["l","2xl"];function n9({className:e}){const[t,s]=m.useState(!1),o=Oi.selectors.useTops(),a=Z.selectors.useError(He.config.loading.load),r=G.selectors.useSomeLoader([He.config.loading.load,ct.config.loading.load]),i=m.useMemo(()=>{const l=o==null?void 0:o.warehouses.sort((c,d)=>c.value.deliveryTime-d.value.deliveryTime);return t?l:l==null?void 0:l.slice(0,Oi.config.limit.warehouses)},[o,t]);return r?n.jsxs(f,{type:"horizontal",gap:"l",align:"center",className:e,children:[n.jsx(at,{width:150}),n.jsx(at,{width:100}),n.jsx(at,{width:130})]}):a?n.jsx(ee,{value:a}):i?n.jsxs(f,{type:"horizontal",gap:"l",children:[n.jsx(f,{type:"horizontal",gap:s9,align:"center",className:e,children:i.map(({count:l,value:{warehouse:c,deliveryTime:d}})=>n.jsxs(f,{type:"horizontal",align:"center",children:[n.jsx("span",{className:t9.deliveryTime,children:v.hours(d)}),n.jsx("span",{children:c.name}),n.jsx(be,{size:"small",type:"info",children:v.percent(l)})]},c.id))}),!t&&(o==null?void 0:o.warehouses)&&(o==null?void 0:o.warehouses.length)>Oi.config.limit.warehouses&&n.jsx("div",{className:e,children:n.jsx(A,{type:"link",size:"small",suffix:n.jsx(z.Chevron,{}),onClick:()=>s(!0),children:"–ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ"})})]}):null}const o9="SFkuhWV",a9="Q7QMc-v",r9="a8fo3kc",i9="k6gyhwe",md={main:o9,title:a9,content:r9,button:i9};function l9(){const{setShowModal:e}=x(Tl.actions);return n.jsx(Da,{children:n.jsxs(f,{type:"horizontal",align:"center",gap:"l",wrap:!1,children:[n.jsxs(f,{type:"horizontal",align:"center",gap:"xs",wrap:!1,className:md.title,children:[n.jsx(z.WarehouseCart,{}),n.jsx("span",{children:"–°–∫–ª–∞–¥—ã:"})]}),n.jsx(n9,{className:md.content}),n.jsx("div",{className:md.button,children:n.jsx(A,{size:"small",type:"purple",prefix:n.jsx(z.Location,{}),onClick:()=>e(!0),children:"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Å–∫–ª–∞–¥–æ–≤ –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö"})})]})})}const c9="TVZ5Xk2",d9="tI8EySk",u9="mWQkXYC",m9="sAoDAg-",Qo={subtitleChart:c9,statsRow:d9,statsCol:u9,firstRow:m9};function p9(){const e=Rt.selectors.useCard(),t=Rt.selectors.useFreqHistoryWeekly(),s=Z.selectors.useError(kr.config.loading.load),o=G.selectors.useLoader(kr.config.loading.load),{setShowModal:a}=x(is.actions);return o?n.jsx(le,{}):s?n.jsx(ee,{value:s}):!e||!(t!=null&&t.length)?n.jsx(dt,{type:"warning",title:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}):n.jsx(Da,{children:n.jsxs(f,{type:"horizontal",gap:"l",display:"block",wrap:!1,children:[n.jsxs(f,{type:"vertical",gap:"l",align:"center",display:"block",style:{flex:0},children:[n.jsx("div",{className:Qo.firstRow,children:"¬†"}),n.jsxs(f,{type:"vertical",gap:"l",align:"center",justify:"space-between",className:Qo.statsRow,children:[n.jsx(L7,{stats:e}),n.jsx(A,{type:"purple",prefix:n.jsx(z.Target,{}),onClick:()=>a(!0),children:"–ü–æ–¥–±–æ—Ä –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑"})]})]}),n.jsxs(f,{type:"vertical",gap:"l",align:"center",display:"block",className:Qo.statsCol,children:[n.jsx("div",{className:Qo.firstRow,children:n.jsx(_7,{data:t,freq365:e.freq365,growthRate:e.growth_rate})}),n.jsx(V7,{className:Qo.statsRow,data:t})]})]})})}function h9(){const e=Rt.selectors.useCard(),t=Rt.selectors.useFreqHistoryWeekly(),s=Z.selectors.useError(kr.config.loading.load);return G.selectors.useLoader(kr.config.loading.load)?n.jsxs(f,{type:"horizontal",gap:"l",align:"center",children:[n.jsx(at,{width:110}),n.jsx(at,{width:110}),n.jsx(at,{width:110}),n.jsx(at,{width:40}),n.jsx(at,{width:110})]}):s?n.jsx(ee,{value:s}):!e||!(t!=null&&t.length)?null:n.jsxs(f,{type:"horizontal",gap:"xl",align:"center",children:[n.jsx(O7,{stats:e}),n.jsx(z7,{data:t,className:Qo.subtitleChart})]})}function f9({page:e}){const t=rt.selectors.useUnfilteredData(e),s=Z.selectors.useSomeError([rt.config.loading.load]);return G.selectors.useSomeLoader([He.config.loading.load,rt.config.loading.load])?n.jsx(le,{}):s?n.jsx(ee,{value:s}):t?n.jsx(F6,{data:t}):null}const g9="sAuRV3L",y9="RWdxVak",w9="dC07aKy",pd={chart:g9,leftSide:y9,rightSide:w9};function S9({page:e}){const t=He.selectors.useListByPage(e),s=He.selectors.useAggregatedByPage(e),o=Z.selectors.useError(He.config.loading.load);return G.selectors.useLoader(He.config.loading.load)||o||!t?null:n.jsxs(f,{type:"horizontal",display:"block",gap:"s",className:pd.chart,children:[(s==null?void 0:s.isNew)&&n.jsx(WG,{data:s==null?void 0:s.isNew,className:pd.leftSide}),(s==null?void 0:s.promoName)&&n.jsx(GG,{data:s==null?void 0:s.promoName,className:pd.rightSide})]})}const x9="jnTfr-6",b9="vdso0GE",v9="QbP842f",hd={chart:x9,middle:b9,leftSide:v9};function j9({page:e,leftSide:t}){const s=m.useRef(null),o=He.selectors.useListByPage(e),a=He.selectors.useAggregatedByPage(e),r=Z.selectors.useError(He.config.loading.load);return G.selectors.useLoader(He.config.loading.load)?n.jsx(le,{}):r?n.jsx(ee,{value:r}):o?n.jsxs(f,{type:"vertical",gap:"4xl",children:[(a==null?void 0:a.promoType)&&n.jsx(Hb,{data:a==null?void 0:a.promoType,className:hd.chart}),n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsxs(f,{gap:"m",wrap:!1,children:[n.jsx("div",{className:hd.leftSide,children:t}),n.jsxs(f,{type:"vertical",gap:"m",className:hd.middle,children:[n.jsx(Ub,{data:o,gridRef:s}),n.jsx(Kb,{gridRef:s,data:o,style:{height:"353px",width:"100%"}})]})]}),n.jsx(cm,{id:"widget/wb-search-product-stats-promo-grid",title:"–ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã CPM",buttonType:"link",buttonSize:"middle",children:n.jsxs(f,{gap:"m",wrap:!1,children:[(a==null?void 0:a.promoCpm)&&n.jsx(qG,{data:a==null?void 0:a.promoCpm,style:{flexShrink:0,padding:0}}),n.jsx(EG,{gridRef:s,data:o,style:{height:"134px",fontSize:13,width:"100%"}})]})}),n.jsx(Ln,{})]})]}):null}const C9="E0APUMG",$9={cardList:C9};function k9(){const e=Oi.selectors.useTops(),t=Z.selectors.useSomeError([He.config.loading.load,ct.config.loading.load]);if(G.selectors.useSomeLoader([He.config.loading.load,ct.config.loading.load]))return n.jsx(le,{});if(t)return n.jsx(ee,{value:t});if(!e)return null;const o=8;return n.jsxs(f,{type:"horizontal",gap:o,justify:"space-evenly",className:$9.cardList,children:[n.jsx(Go.Subjects,{data:e.subjects,style:{width:`calc(14% - ${o}px)`,minWidth:200}}),n.jsx(Go.Brands,{data:e.brands,style:{width:`calc(14% - ${o}px)`,minWidth:200}}),n.jsx(Go.Ratings,{data:e.ratings,style:{width:`calc(14% - ${o}px)`,minWidth:120}}),n.jsx(Go.Feedbacks,{data:e.feedbacks,style:{width:`calc(14% - ${o}px)`,minWidth:120}}),n.jsx(Go.Colors,{data:e.colors,style:{width:`calc(14% - ${o}px)`,minWidth:100}}),n.jsx(Go.Costs,{data:e.costs,style:{width:`calc(25% - ${o}px)`,minWidth:300}})]})}function N9({page:e}){const t=He.selectors.useListByPage(e),{load:s}=x(ct.actions);return m.useEffect(()=>{t!=null&&t.length&&s({nms:t.map(({id:o})=>o)})},[t]),null}function T9({page:e,query:t,onRegionSearchClick:s}){const{loadAll:o}=x(rt.actions),a=rt.selectors.usePagesFilter(),r=rt.selectors.useData(e),i=Z.selectors.useSomeError([rt.config.loading.load]),l=G.selectors.useSomeLoader([He.config.loading.load,rt.config.loading.load]),c=m.useMemo(()=>({actions:{colId:"actions",cellRenderer:wl,cellRendererParams:{onSearchClick:({data:d})=>{d&&s&&s(d.id)}},headerName:"–ü–æ–∑–∏—Ü–∏—è –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö",filter:!1,sortable:!1,suppressColumnsToolPanel:!0,suppressFiltersToolPanel:!0,width:120}}),[]);return l?n.jsx(le,{}):i?n.jsx(ee,{value:i}):(r==null?void 0:r.length)===0?n.jsx(dt,{type:"warning",message:n.jsxs(f,{gap:"m",align:"center",children:[n.jsx("div",{children:"–í–∞—à–∏ —Ç–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"}),a==="current"&&n.jsxs(A,{onClick:()=>o({query:t}),size:"small",children:["–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"," ",rt.config.pagesLimit.all," ","—Å—Ç—Ä–∞–Ω–∏—Ü"]})]})}):n.jsx(qb,{data:r,maxRowsOnScreen:10,extendedColumnDefs:c})}function P9({page:e}){const t=rt.selectors.useData(e),s=G.selectors.useSomeLoader([He.config.loading.load,St.config.loading.load,rt.config.loading.load]),o=(t==null?void 0:t.length)||0;return s?n.jsx(As,{}):o?n.jsxs(n.Fragment,{children:["–ù–∞–π–¥–µ–Ω–æ ",o," –≤–∞—à–∏—Ö ",Zs(o,["—Ç–æ–≤–∞—Ä","—Ç–æ–≤–∞—Ä–∞","—Ç–æ–≤–∞—Ä–æ–≤"])]}):null}const Un=k("pages/wb/catalog-search"),Ko={modelName:Un(),section:{main:Un("main"),productTopsView:Un("product-tops-view"),keywordFrequencyStatsView:Un("keyword-frequency-stats-view"),productStatsView:Un("product-stats-view"),externalAdvertStatsView:Un("external-advert-stats-view"),supplierProductStatsView:Un("supplier-product-stats-view")}},M9="cfzaCG6",F9="_6liOA-E",Ho={wrapper:M9,section:F9};function D9(){const e=ju.selectors.useQueryParams(),t=m.useMemo(()=>({search:fy(e.search),page:parseInt(e.page)||1}),[e]),{setShowModal:s,setForm:o}=x(Tl.actions),a=m.useCallback(p=>{o({nmOur:p.toString(),queries:t.search?[t.search]:[],nms:[],destinations:[],autoSubmit:!0}),s(!0)},[t.search]),{load:r}=x(kr.actions),{load:i}=x(He.actions),{load:l}=x(rt.actions),{load:c}=x(St.actions),{reset:d}=x(Pe.actions);return m.useEffect(()=>()=>{d()},[t.search]),m.useEffect(()=>{t.search&&(c(),r(t.search),i({query:t.search,page:t.page,callback:()=>{l({query:t.search})}}))},[t]),t.search?n.jsxs(n.Fragment,{children:[n.jsx(J,{selector:"#appReactRoot",append:"before",className:Ho.wrapper,children:n.jsx(fr,{title:n.jsxs(f,{gap:"l",align:"center",display:"block",children:[n.jsx(ga,{}),n.jsx(pm,{})]}),id:Ko.section.main,children:n.jsxs(f,{type:"vertical",gap:"2xl",children:[n.jsx(H,{children:n.jsx(l9,{})}),n.jsx(xt,{title:"–ß–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞",subTitle:n.jsx(H,{children:n.jsx(h9,{})}),className:Ho.section,id:Ko.section.keywordFrequencyStatsView,children:n.jsx(H,{children:n.jsx(p9,{})})}),n.jsx(H,{children:n.jsx(N9,{page:t.page})}),n.jsx(xt,{title:"–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–æ–ø–∞",subTitle:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ / –ë—Ä–µ–Ω–¥—ã / –¶–≤–µ—Ç–∞ / –¶–µ–Ω—ã",className:Ho.section,id:Ko.section.productTopsView,children:n.jsxs(f,{type:"vertical",gap:"4xl",children:[n.jsx(H,{children:n.jsx(S9,{page:t.page})}),n.jsx(H,{children:n.jsx(k9,{})})]})}),n.jsx(xt,{title:"–†–µ–∫–ª–∞–º–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ",className:Ho.section,id:Ko.section.productStatsView,children:n.jsx(H,{children:n.jsx(j9,{page:t.page,leftSide:n.jsx(f9,{page:t.page})})})}),n.jsx(H,{children:n.jsx(xK,{page:t.page})}),n.jsx(xt,{title:"–í–Ω–µ—à–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—ã",subTitle:n.jsx(bK,{page:t.page}),className:Ho.section,id:Ko.section.externalAdvertStatsView,children:n.jsx(H,{children:n.jsx(SK,{page:t.page})})}),n.jsx(xt,{title:"–ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–π –≤–∞—à–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤",subTitle:n.jsx(P9,{page:t.page}),className:Ho.section,id:Ko.section.supplierProductStatsView,children:n.jsx(H,{children:n.jsxs(f,{type:"vertical",gap:"l",children:[n.jsx(Jb,{filterActions:n.jsx(b6,{query:t.search}),children:n.jsx(T9,{query:t.search,page:t.page,onRegionSearchClick:a})}),n.jsx(jK,{query:t.search,page:t.page,onRegionSearchClick:a}),n.jsx(Ln,{})]})})})]})})}),n.jsx(H,{fallback:Qt,children:n.jsx(wK,{page:t.page})}),n.jsx(tv,{})]}):null}function A9(){return n.jsxs(n.Fragment,{children:[n.jsxs(au,{children:[n.jsxs(Se,{path:"/catalog/:id/search.aspx",children:[n.jsx(D9,{}),n.jsx(Gi,{}),n.jsx(zi,{})]}),n.jsxs(Se,{path:"/catalog/:nm/detail.aspx",children:[n.jsx(j7,{}),n.jsx(Gi,{}),n.jsx(zi,{})]})]}),n.jsx(H,{fallback:Qt,children:n.jsx(Qz,{})})]})}function L9(){const{initApp:e}=x(wh.actions),t=wh.selectors.useIsReady();return m.useEffect(()=>{e({origin:window.location.origin})},[]),t?n.jsxs(n.Fragment,{children:[n.jsx(Hl,{host:["cmp-new.wildberries.ru","cmp.wildberries.ru"],children:n.jsx(H,{fallback:Qt,children:n.jsx(oW,{})})}),n.jsx(Hl,{host:"www.wildberries.ru",children:n.jsx(H,{fallback:Qt,children:n.jsx(A9,{})})}),n.jsx(Hl,{host:"seller.wildberries.ru",children:n.jsx(H,{fallback:Qt,children:n.jsx(Gz,{})})}),n.jsx(E1,{}),n.jsx(cF,{})]}):null}Mj();function R9(){return n.jsx(m.StrictMode,{children:n.jsxs(Ev,{store:W$,children:[n.jsx(e0,{}),n.jsx(H,{fallback:Qt,children:n.jsx(L9,{})})]})})}function E9(){return new Promise(e=>{if(document.body)return e(document.body);const t=new MutationObserver(()=>{document.body&&(e(document.body),t.disconnect())});t.observe(document.documentElement,{childList:!0,subtree:!0})})}(async()=>{const e=document.createElement("div");try{const t=await E9();t.appendChild(e),t.classList.add(Gv.root)}catch(t){on.clone().captureException(t,{mechanism:{handled:!1}})}_v(e).render(n.jsx(R9,{}))})();
//# sourceMappingURL=BjwNwwC7.js.map
